(function(){function a(a){return function(){var c=function(){},b={};if(window.console)b=window.console,c=window.console[a]||window.console.info||c;else if(window.opera)b=window.opera,c=window.opera.postError||c;try{c.apply(b,arguments)}catch(d){try{c(arguments.join(" "))}catch(f){}}}}function b(a){function c(){b._releaseActive()}var b=this;a=a||{};this._win=a.window||window;this._doc=a.document||this._win.document;this._prefixes=["webkit","moz","ms","o"];this._localStorage=a.localStorage||this._win.localStorage;
this._idStorageKey=a.idStorageKey||"_BrowserTabIDStorageKey";this._id=(""+Math.random()+Math.random()).replace(/\./g,"");this._listen(this._win,"unload",c);this._listen(this._win,"beforeunload",c);this._supportsVisibility()?this._initializeWithVisibility():this._initializeWithBlurring();(!this.hidden()||!this._anyTabsActive())&&this._makeActive()}olark._.P("application");olark("api.chat.onBeginConversation",function(){olark._.hlog("started chatting #begin_conversation")});var e=/^\s*(__Extension0\..+|__ChatApiHelper|__BoxApiHelper|[A-Z]\w+)\s*$/,
c=/^\s*(api|box|browser|chat|data|extensions|system|olark|.*olark.*)\s*$/,g={GoogleAnalytics:null,VisitorInsight:null,VisitorImportance:null,Mixpanel:null,OfflineWarning:null,EndConversation:null},j="bf177f47611e55d4707c4d9942b696e0";j="bf177f47611e55d4707c4d9942b696e0";var m={Shopify:"3a36a58c72d4661d9a9ac484606f012e",WelcomeAssist:j,CalloutBubble:"423092e252ccbf364ff4b006e43a1b3b",WelcomeAssist:j,OfflineWarning:"a019e45d1183d9dd0d80ab0b3c283982",Cobrowse:"f06d866d2e973c62cf196ca6cc010eac"},l=/.*YOUR-SITE-ID-HERE.*/;
olark.extend("VisitorInsight");olark.extend("VisitorImportance");olark.extend("Mixpanel");olark.extend("OfflineWarning");olark.extend("EndConversation");window.olark.__buildinfo=window.olark.__buildinfo||{olarkfile:"/javascript/olark.js",corefile:"/javascript/application.js",jshost:window.olark.__version?"static.olark.com":"olarkdev:8001",dev:!0};var d;if(window.olark.__buildinfo.dev)d={log:a("log"),info:a("info"),warn:a("warn"),error:a("error"),debug:a("debug"),showErrorBacktrace:a("error")};else{d=
{log:function(){},info:function(){},warn:a("warn"),error:a("error"),debug:function(){},showErrorBacktrace:function(){}};var i=d.error,t=d.warn;d.error=function(){try{var a=Array.prototype.slice.call(arguments||[]);olark._.hlog(a.join(" "),"#error")}catch(c){}try{i.apply(d,arguments)}catch(b){}};d.warn=function(){try{var a=Array.prototype.slice.call(arguments||[]);olark._.hlog(a.join(" "),"#warn")}catch(c){}try{t.apply(d,arguments)}catch(b){}}}window.olark.__legacy_shim=window.olark.__legacy_shim||
{};document.hbl_ssl=/.*https:.*/.test(document.location.protocol)?!0:!1;var r=function(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent?a.attachEvent("on"+c,b):a["on"+c]=b};(function(a){a.active=function(){if(arguments.length>0)throw Error("'active' property is not settable");this._localStorage||window.console&&window.console.warn&&window.console.warn("localStorage is required to use the active() property");return this._localStorage.getItem(this._idStorageKey)===this._id};a.hidden=
function(){if(arguments.length>0)throw Error("'hidden' property is not settable");return this._supportsVisibility()?this._getProperty(this._doc,"hidden"):this._blurred};a.on=function(a,c){a=a.split(/\s+/);for(var b=0;b<a.length;b++){var d=a[b];switch(d){case "change:hidden":this._listenForVisibilityChange(c);break;case "change:active":this._listenForActiveChange(c);break;default:throw Error("invalid event '"+d+"'");}}};a._getProperty=function(a,c){var b=c.charAt(0).toString().toUpperCase()+c.slice(1);
if(c in a)return a[c];else{var d;this._eachBrowserPrefix(function(c){c+=b;c in a&&(d=a[c])});return d}};a._supportsVisibility=function(){return this._getProperty(this._doc,"visibilityState")!=="undefined"};a._eachBrowserPrefix=function(a){for(var c=0;c<this._prefixes.length;c++)a(this._prefixes[c])};a._listen=function(a,c,b){a.addEventListener?a.addEventListener(c,b,!1):a.attachEvent?a.attachEvent("on"+c,b):a["on"+c]=b};a._listenForVisibilityChange=function(a){var c=this;this._listen(this._doc,"visibilitychange",
a);this._eachBrowserPrefix(function(b){c._listen(c._doc,b+"visibilitychange",a)});this._blurChangeCallbacks&&this._blurChangeCallbacks.push(a)};a._listenForActiveChange=function(a){var c=this;this._localStorage&&this._listen(this._win,"storage",function(b){b=b||window.event;b.key===c._idStorageKey&&a()})};a._makeActive=function(){this._localStorage&&this._localStorage.setItem(this._idStorageKey,this._id)};a._releaseActive=function(){this._localStorage&&this._localStorage.getItem(this._idStorageKey)===
this._id&&this._localStorage.removeItem(this._idStorageKey)};a._anyTabsActive=function(){return this._localStorage?this._localStorage.getItem(this._idStorageKey)!=="undefined":!1};a._initializeWithVisibility=function(){function a(){c._blurred=c.hidden();c.hidden()||c._makeActive()}var c=this;this._blurred=this.hidden();this._uncertain=!1;a();this._listenForVisibilityChange(a)};a._initializeWithBlurring=function(){function a(){for(var c=0;c<blurChangeCallbacks.length;c++)setTimeout(blurChangeCallbacks[c],
0)}function c(){d._blurred=!0;d._uncertain=!1;a()}function b(){d._blurred=!1;d._uncertain=!1;d._makeActive();a()}var d=this;this._blurred=!1;this._uncertain=!0;this._blurChangeCallbacks=blurChangeCallbacks=[];this._listen(this._doc,"focusin",b);this._listen(this._doc,"focusout",c);this._listen(this._win,"focus",b);this._listen(this._win,"blur",c);this._listen(this._doc,"scroll",b);this._listen(this._doc,"keydown",b);this._listen(this._doc,"mousemove",b);this._listen(this._doc,"select",b);this._listen(this._win,
"scroll",b);this._listen(this._win,"keydown",b);this._listen(this._win,"mousemove",b);this._listen(this._win,"select",b);this._listenForActiveChange(function(){d.active()||c()})}})(b.prototype);var s=null,o=null;(function(){var a={};s=function(c){var b=c.namespace,d=c.type;c=c.callback;if(!b)throw Error("[olark] namespace required");if(!d)throw Error("[olark] type required");if(!c)throw Error("[olark] callback required");a[b]=a[b]||{};a[b][d]=a[b][d]||[];a[b][d].push(c)};o=function(c){var b=c.namespace,
f=c.type,h=c.after||null;if(!b)throw Error("[olark] namespace required");if(!f)throw Error("[olark] type required");try{c.namespace=void 0,c.type=void 0,delete c.namespace,delete c.type,delete c.after}catch(g){}a[b]=a[b]||{};for(var n=a[b][f]||[],i=0;i<n.length;){var k=n[i++];k&&p(function(){k(c)},function(a){d.error("[olark] event handler for '"+b+"."+f+"' failed: "+a.toString());d.showErrorBacktrace(a)})}h&&h()}})();var h=null,q=null,k=null,f=null,x=null,n=null,w=null,y=null,v=null,u=null,p=null;
(function(){var a=[];x=function(c,b){var d=setTimeout(b,c.delay);a.push(d);return d};h=function(a){var c=!1;return function(){if(!c)return c=!0,a.apply(a,arguments)}};q=function(a){for(var c=a.length,b="\n";c--;){var d=a[c];b+=c===0?"- "+d:"- "+d+"\n"}return b};v=function(a){var c=a.url;if(typeof c!="string")throw Error("[olark] string 'url' is required");a=c.indexOf("http://")!=-1;var b=c.indexOf("https://")!=-1;c=c.split("/")[0].indexOf(".")!==0;return!a&&!b&&!c};var c={};k=function(a){var b=a.url;
if(typeof b!="string")throw Error("[olark] string 'url' is required");var f="https:"==document.location.protocol?!0:!1;a=b.indexOf("http://")==-1?!1:!0;var h=b.indexOf("https://")==-1?!1:!0,g=a||h;a=null;a=v({url:b})?b:g?b:(f?"https://":"http://")+b;f&&g&&!h&&d.warn("[olark] you cannot load from ",a," when you are on an SSL page, you will probably get mixed-content warnings");if(!c[a])c[a]=!0,b=document.createElement("script"),f=document.getElementsByTagName("script")[0],b.setAttribute("async",""),
b.setAttribute("defer","true"),b.src=a,f.parentNode.insertBefore(b,f)};f=function(a,c){var b=!1,d=function(){a()?b||(b=!0,c()):b||x({delay:50},d)};d()};n=function(a){if(a===null||typeof a!="object")return a;var c=a.constructor(),b;for(b in a)a.hasOwnProperty(b)&&(c[b]=n(a[b]));return c};w=function(a,c){if(a==c||typeof a=="number"&&typeof c=="number"&&isNaN(a)&&isNaN(c))return!0;else if(typeof a=="object"&&typeof c=="object"&&a!==null&&c!==null){for(var b in a)if(!w(a[b],c[b]))return!1;for(var d in c)if(!w(a[d],
c[d]))return!1;return!0}else return!1};y=function(a){return a.replace(/\s+$/,"").replace(/^\s+/,"")};u=function(a){if(typeof a.list=="undefined")throw Error("[olark] 'list' required");if(typeof a.separator=="undefined")throw Error("[olark] 'separator' required");var c=a.list;a=a.separator;for(var b=!0,d="",f=0;f<c.length;f++){var h=c[f];b?(b=!1,d+=h):d+=a+h}return d};p=function(a,c){if(window.olark.__buildinfo.strict)return a();else try{return a()}catch(b){return c(b)}}})();var z=function(a,c){var b=
window[a];if(!b)throw Error("[lightloader] stub library not defined: "+a);var d=b.__lightload,f={publicMethods:{}},h=[],g=[];f.getLightloaderVersion=function(){return d.V};f.isDocumentReady=function(){return d.A||0};f.isWindowLoaded=function(){return d.B||0};f.whenDocumentReady=function(a){f.isDocumentReady()?a():h.push(a)};f.whenWindowLoaded=function(a){f.isWindowLoaded()?a():g.push(a)};f.reloadLibrary=function(){d.D=[];d.l()};var n=function(a){for(var c=a.length>0?a.shift():void 0;c;)c(),c=a.shift()};
d.a=function(){d.A=!0;n(h)};d.b=function(){d.B=!0;n(g)};c(b,f);olark.extend=f.publicMethods.extend;olark.declare=f.publicMethods.declare;olark.configure=f.publicMethods.configure;olark.ready=f.publicMethods.ready;(function(){var a=d.D;a.reverse();for(var c=a.length;c-- >0;){var f=a[c],h=f[0];f=f[1];var g=b[h];g?g.apply(b,f):window.console&&window.console.error&&window.console.error("[lightloader] missing method '"+h+"'")}a.reverse()})()},C=function(a,c){function b(){for(var a=f.callstack,c,i,k,j,
l;a.length;)if((c=a.shift())&&c.length)try{if(k=Array.prototype.slice.call(c||[]),i=k.length?k.shift():void 0,l=/api\.[a-zA-Z]+\.(__SPI_)?[a-zA-Z]+/.test(i),i=="debug")(function(){var a=document.createElement("script");a.src="https://static.olark.com/record.js";document.getElementsByTagName("head")[0].appendChild(a)})();else if(l){var e;a:switch(i){case "api.chat.getVisitorNickname":case "api.chat.getVisitorStatus":case "api.chat.operatorsAreAvailable":case "api.chat.operatorsAreBusy":case "api.chat.operatorsAreAway":case "api.chat.onNotificationToVisitor":case "api.chat.getVisitorNickname":case "api.chat.getVisitorNickname":e=
!0;break a;default:e=!1}e?d.warn("[olark] the API call '"+i+"' is deprecated"):(g.push([i,k]),n())}else h.publicMethods.hasOwnProperty(i)?(j=h.publicMethods[i],j.apply(j,k)):d.warn("[olark] unknown method 'olark."+i+"'")}catch(m){d.error("[olark] unknown exception in dequeueCallbacks: method: "+i+" ",m.message)}else d.warn("[olark] empty method call in dequeueCallbacks #empty_dequeue_call")}var f=olark._,h={publicMethods:{}};h.getLightloaderVersion=function(){return f.v};h.whenDocumentReady=function(a){a()};
h.reloadLibrary=function(){olark=olark._=null;f.i()};var g=[],n=function(){};olark.extend(function(a){n=function(){for(var c;g.length;){c=g.shift();var b=c[0];c=c[1];var f=b.split("."),h=f[1];f=f[2];if(a[h]&&a[h][f])try{a[h][f].apply(a[h],c)}catch(i){d.error(i.toString())}else d.warn("[olark] unknown API call '"+b+"'")}};g.length>0&&n()});c(olark,h);h.publicMethods.call=function(a,c){var b=h.publicMethods[a];b?b.apply(b,c):d.warn("[olark] unknown method 'olark."+a+"'")};olark._.s={push:function(a){f.callstack.push(a);
b()}};b()};(function(){var a=window.olark;if(a.__v){d.warn("[olark] you are using an old version of the Olark Code on your page, please check your dashboard to get the new code.");var c=olark.__v[0],b=olark.__v[1],f=olark.__v[2],h=olark.__v[3],g;for(g in c)typeof c[g]!="function"&&a.configure.apply(a,c[g]);for(var i in b)typeof b[i]!="function"&&a.extend.apply(a,b[i]);for(var n in f)typeof f[n]!="function"&&a.declare.apply(a,f[n]);for(var k in h)typeof h[k]!="function"&&a.ready.apply(a,h[k]);a.__lightload.A=
!0}})();(function(a,c){olark._?C(a,c):z(a,c)})("olark",function(a,i){var j=function(a){this.__name=a.name;this.__startup=a.startup;if(typeof this.__name=="undefined")throw Error("[olark] 'name' required");if(typeof this.__startup=="undefined")throw Error("[olark] 'startup' required");this.__version=a.version||null;this.__source=a.source||null};(function(c){c.get_name=function(){return this.__name};c.get_version=function(){return this.__version};c.get_source=function(){return this.__source};c.get_pretty_string=
function(){var a=this.__name;this.__version&&this.__source?a+=" (version "+this.__version+", from "+this.__source+")":this.__version&&(a+=" (version "+this.__version+")");return a};c.activate=function(c){c=c.configuration;if(typeof c=="undefined")throw Error("[olark] 'configuration' required");var b=/__.+/.test(this.__name)?"__inline":this.__name;c[b]&&c[b].enabled===!1||(this.__startup(new a.__core.api.ApiInstance({conf:c,namespace:b,extension_name:this.__name}),c),o({namespace:"Extension",type:"extensionActivated"}))}})(j.prototype);
var t=function(a){this.__name=a.name;if(typeof this.__name=="undefined")throw Error("[olark] 'name' required");this.__version=a.version||null;this.__source=a.source||A.get_instance().get_expected_source_for_extension({name:this.__name})};(function(a){a.get_name=function(){return this.__name};a.get_version=function(){return this.__version};a.get_source=function(){return this.__source};a.get_pretty_string=function(){return this.__name&&this.__version&&this.__source?this.__name+" (version "+this.__version+
", from "+this.__source+")":this.__name&&this.__version?this.__name+" (version "+this.__version+")":this.__name&&this.__source?this.__name+" (from "+this.__source+")":this.__name};a.begin_download=function(){this.__source&&k({url:this.__source})};a.is_downloaded=function(){return A.get_instance().search_for_extension({extension_spec:this}).length>0?!0:!1};a.when_downloaded=function(a){var c=this,b=!1,d=function(){c.is_downloaded()&&!b&&(b=!0,a())};d();s({namespace:"ExtensionManager",type:"registeredExtension",
callback:d})}})(t.prototype);var A=function(){this.__extension_specs=[];this.__extension_specs_by_name={};this.__extensions_by_name={};this.__extensions_by_source={};this.__extensions_by_name_and_version={};this.__extensions_by_name_and_source={};this.__extensions_by_name_and_version_and_source={}};(function(b){var f=null;A.get_instance=function(){return f=f||new A};var h=0;A.get_next_extension_name=function(){h+=1;return"__Extension0."+h};b.__lazy_load_data_structures=function(a){var c=a.name,b=
a.version;a=a.source;this.__extensions_by_name[c]=this.__extensions_by_name[c]||[];this.__extensions_by_source[a]=this.__extensions_by_name[a]||[];this.__extensions_by_name_and_version[c]=this.__extensions_by_name_and_version[c]||{};this.__extensions_by_name_and_version[c][b]=this.__extensions_by_name_and_version[c][b]||[];this.__extensions_by_name_and_source[c]=this.__extensions_by_name_and_source[c]||{};this.__extensions_by_name_and_source[c][a]=this.__extensions_by_name_and_source[c][a]||[];this.__extensions_by_name_and_version_and_source[c]=
this.__extensions_by_name_and_version_and_source[c]||{};this.__extensions_by_name_and_version_and_source[c][b]=this.__extensions_by_name_and_version_and_source[c][b]||{};this.__extensions_by_name_and_version_and_source[c][b][a]=this.__extensions_by_name_and_version_and_source[c][b][a]||[]};b.get_expected_source_for_extension=function(b){if(typeof b.name=="undefined")throw Error("[olark] 'name' required for extension source lookup");b=b.name;var d=e.test(b)?!1:!0;d=(d=d||c.test(b.toLowerCase()))||
/.*_.*/.test(b);if(typeof g[b]!="undefined")return g[b];else if(d)return null;else{d="";for(var f=0;f<b.length;f++){var h=b[f]||b.slice(f,f+1);/[ABCDEFGHIJKLMNOPQRSTUVWXYZ]/.test(h)?(d.length>0&&(d+="-"),d+=h.toLowerCase()):d+=h}return(a._&&a._.plugins?a._.plugins:window.olark.__buildinfo.jshost+"/javascript/plugins")+"/"+d+".js?v="+(m[b]||"1")}};b.register_declared_extension=function(a){a=a.extension;if(typeof a=="undefined")throw Error("[olark] 'extension' required");var c=a.get_name(),b=a.get_version(),
d=a.get_source();d&&v({url:d})&&(d=null);this.__lazy_load_data_structures({name:c,version:b,source:d});this.__extensions_by_name[c].push(a);this.__extensions_by_source[d].push(a);this.__extensions_by_name_and_version[c][b].push(a);this.__extensions_by_name_and_source[c][d].push(a);this.__extensions_by_name_and_version_and_source[c][b][d].push(a);o({namespace:"ExtensionManager",type:"registeredExtension"})};b.for_each_extension_spec=function(a){for(var c=this.__extension_specs.length,b=this.__extension_specs,
f=0;f<c;)(function(c){p(function(){a(c,b)},function(a){d.error("[olark] error while iterating over required extension spec:",c,"error was: "+a.toString());d.showErrorBacktrace(a)})})(this.__extension_specs[f]),f++};b.register_extension_spec=function(a){a=a.extension_spec;if(typeof a=="undefined")throw Error("[olark] 'extension_spec' required");var c=a.get_name(),b=a.get_version(),f=a.get_source();f&&v({url:f})&&(f=null);var h=this.__extension_specs_by_name[c];if(!(h&&h.get_source()===a.get_source())){if(h){var i=
h.get_version(),g=h.get_source();b&&f&&i&&g?(b!=i||f!=g)&&d.warn("[olark] conflicting extensions:",a.get_pretty_string(),"and",h.get_pretty_string()):b&&i?b!=i&&d.warn("[olark] conflicting extensions:",a.get_pretty_string(),"and",h.get_pretty_string()):f&&g&&f!=g&&d.warn("[olark] conflicting extensions:",a.get_pretty_string(),"and",h.get_pretty_string())}a.begin_download();this.__extension_specs.unshift(a);this.__extension_specs_by_name[c]=a;o({namespace:"ExtensionManager",type:"registeredExtensionSpec"})}};
b.search_for_extension=function(a){var c=a.name,b=a.version,d=a.source;if(a=a.extension_spec)c=a.get_name(),b=a.get_version(),d=a.get_source();d&&v({url:d});d=null;this.__lazy_load_data_structures({name:c,version:b,source:d});if(c&&b&&d)return this.__extensions_by_name_and_version_and_source[c][b][d];else if(c&&b)return this.__extensions_by_name_and_version[c][b];else if(c&&d)return this.__extensions_by_name_and_source[c][d];else if(b&&d)throw Error("[olark] cannot search by version and source");
else if(c)return this.__extensions_by_name[c];else if(d)return this.__extensions_by_source[d];else if(b)throw Error("[olark] cannot search by version");else throw Error("[olark] missing search criteria");}})(A.prototype);var z=function(){var a=this;a.__configuration_callbacks=[];s({namespace:"ExtensionManager",type:"registeredExtensionSpec",callback:function(){a.__check_for_olark_key()}})};(function(c){function b(c){var d,f,h=a._?a._.defaults:null;if(h)for(d in h)if(h.hasOwnProperty(d))for(f in c[d]||
(c[d]={}),h[d])h[d].hasOwnProperty(f)&&(c[d][f]=h[d][f]);return c}var f=null;z.get_instance=function(){return f=f||new z};c.register_configure_callback=function(a){a=a.callback;if(typeof a=="undefined")throw Error("[olark] 'callback' required");this.__configuration_callbacks.push(a);this.__check_for_olark_key()};c.read_configuration=function(){var a=this.__read_configuration({ignore_errors:!1});a.system.olark_key=this.get_olark_key();return a};c.get_olark_key=function(){var a=this.__read_configuration({ignore_errors:!0});
if(a.chat.legacy_site_id)a.system.legacy_site_id=a.system.legacy_site_id||a.chat.legacy_site_id,d.warn("[olark] conf.chat.legacy_site_id is deprecated, please use conf.system.legacy_site_id instead");var c=this.__parse_olark_site_id_from_dom();if(a=a.system.site_id||a.system.olark_key||a.system.legacy_site_id||window.olark.__k||c)a=a.replace(/^\s*/,"").replace(/\s*$/,""),l.test(a)&&(a="0000-0000-0000-0000");return a};c.__parse_olark_site_id_from_dom=function(){var a=document.getElementById("olark-key");
if(a&&a.className)return y(a.className.replace("site-",""));else for(var c in a=document.getElementsByTagName("a"),a)if(typeof a[c]!="function"){var b=a[c];if(b&&b.className=="olark-key")return b.style.display="none",b.id.replace("olark-","")}return null};c.__read_configuration=function(a){a=a||{};a=a.ignore_errors?!0:!1;var c={box:{},chat:{},data:{},browser:{},extensions:{},system:{},locale:{}};c=b(c);A.get_instance().for_each_extension_spec(function(a){c[a.get_name()]=c[a.get_name()]||{}});for(var f=
0;f<this.__configuration_callbacks.length;){if(typeof this.__configuration_callbacks[f]=="function"){var h=this.__configuration_callbacks[f];if(a)try{h(c)}catch(i){}else p(function(){h(c)},function(a){d.error("[olark] error with your configuration, overall configuration may be incomplete now: "+a.toString());d.showErrorBacktrace(a)})}f++}return c};c.__check_for_olark_key=function(){this.get_olark_key()&&o({namespace:"ConfigurationManager",type:"olarkKeyAvailable"})}})(z.prototype);var C=function(a){if(a.length<
6)throw Error("[olark] extensions cannot be named '"+a+"', names must be more than 6 letters long");if(e.test(a)){if(c.test(a.toLowerCase()))throw Error("[olark] extensions cannot be named '"+a+"', that name is protected for internal use");}else throw Error("[olark] extensions cannot be named '"+a+"', names must start with a capital alphabetic letter and contain only alpha characters");},H=function(a){var c=!1,b=function(){var b=!0;A.get_instance().for_each_extension_spec(function(a){a.is_downloaded()||
(b=!1)});b&&!c&&(c=!0,a())};b();s({namespace:"ExtensionManager",type:"registeredExtension",callback:b});x({delay:6E3},function(){if(!c){c=!0;a();var b=[];A.get_instance().for_each_extension_spec(function(a){a.is_downloaded()||b.push(a.get_pretty_string())});d.warn("[olark] unable to download some extensions:",b.join(","))}})},G=function(a){var c=!1;f(function(){return window.olark&&window.olark.__core&&window.olark.__core.api&&window.olark.__core.box&&window.olark.__core.chat&&window.olark.__core.data&&
window.olark.__core.extensions&&window.olark.__core.framestorewithjson&&window.olark.__legacy_shim&&window.olark.__legacy_shim.legacy_stub_is_loaded&&window.olark.__legacy_shim.legacy_post_stub_is_loaded},function(){c||(c=!0,a())});x({delay:5E3},function(){c||(c=!0,a(),d.warn("[olark] unable to download core libraries."))})},B=function(a){var c={};A.get_instance().for_each_extension_spec(function(b,f){var h=A.get_instance().search_for_extension({extension_spec:b}),i=null;if(h.length===0)d.error("[olark] no loaded extensions matched:"+
b.get_pretty_string(),f);else if(h.length==1)i=h[0];else{i=h[0];h=h.slice(1);for(var g=[],n=h.length;n--;){var k=h[n].get_pretty_string();g.push(k)}d.warn("[olark] more than one extension matched for "+b.get_pretty_string(),", so we used the first one:",i.get_pretty_string(),"\nYou might want to be more specific. These extensions were also found:",q(g))}(h=c[b.get_name()])?d.warn("[olark] we already loaded an extension by the name of "+b.get_name(),"(",h.get_pretty_string(),")",f):i&&(i.activate({configuration:a}),
c[b.get_name()]=i)});o({namespace:"core",type:"extensionsActivated"})},O=function(){i.publicMethods.extend=function(a){d.warn("[olark] you cannot do olark.extend() once Olark is already starting up (dropping extension:"+a+")")};i.publicMethods.configure=function(){d.warn("[olark] you cannot do olark.configure() once Olark is already starting up.")}},P=function(a){var c=z.get_instance().get_olark_key();a=h(a);c?a():s({namespace:"ConfigurationManager",type:"olarkKeyAvailable",callback:a})},V=function(a){if(/Chrome/.test(navigator.userAgent))a.chat.onReady(function(){try{for(var a=
document.styleSheets,c=a.length-1;c>=0;c--){var b=a[c].cssRules;if(b){var f=b[0],h=f.selectorText;f.selectorText="#olark-workaround";f.selectorText=h;break}}}catch(i){d.warn("[olark] Chrome stylesheet workaround not active")}})},W=function(c,b){a._.opm.install(["olark-targeting-plugin"],function(f,h){if(f)d.warn("[olark] unable to install 'olark-targeting-plugin' due to",f);else{try{h("olark-targeting-plugin").activate(a,b)}catch(i){d.warn("[olark] unable to activate plugin 'olark-targeting-plugin'"),
d.error(i)}R(c,b)}})},R=function(c,b){V(c);if(b.system.force_ssl)window.hbl_ext="https",window.hblStaticPath=window.hblStaticPath.replace("http:","https:"),window.hblPostURL=window.hblPostURL.replace("http:","https:");var d=b.system.deferred_chat_connection!==!0||c.chat.__SPI_hasConnectedAlready();a._.preventBoot!=!0&&d&&b.system.disable_event_connection!==!0&&c.chat.connect()},Q=function(){var a=document.getElementsByTagName("head")[0],c=document.createElement("style");c.type="text/css";c.styleSheet?
c.styleSheet.cssText="@media print {#habla_beta_container_do_not_rely_on_div_classes_or_names {display: none !important}}":c.appendChild(document.createTextNode("@media print {#habla_beta_container_do_not_rely_on_div_classes_or_names {display: none !important}}"));a.appendChild(c)};a.__core={listen_for_event:s,trigger_event:o,async_script_load:k,logger:d,format_bulleted_list_for_logger:q,wait_for:f,is_extension_required:function(a){var c=a.extension_name;if(typeof c=="undefined")throw Error("[olark] 'extension_name' required");
var b=!1;A.get_instance().for_each_extension_spec(function(a){a.get_name()==c&&(b=!0)});return b},create_idempotent_callback:h,trigger_olark_boot_process:function(){window.olark.__buildinfo.dev&&k({url:window.olark.__buildinfo.jshost+"/javascript/olark/__development.js?"+ +new Date});a._.P("bootstart");G(function(){i.whenDocumentReady(function(){a._.P("domready");P(function(){a._.P("keyready");var c=z.get_instance().get_olark_key(),b=z.get_instance().read_configuration();a._.P("getstorage");window.olark.__core.data.prepare(c,
b.system.force_localstorage_fallback,function(){a._.P("storage");var c=new window.olark.__core.data.StorejsKeyStore;if(a._.isNewConversation)c.clearConversationData(),window.olark.__legacy_shim.isNewConversation=!0;O();H(function(){a._.P("extready");var c=z.get_instance().read_configuration();if(c.system.allow_end_conversation)a.__legacy_shim.allowEndConversation=!0;if(c.system.domain)try{window.olark.__core.data.forceDomain(c.system.domain),window.olark.__legacy_shim.forced_cookie_domain=c.system.domain}catch(b){d.warn("[olark] unable to use domain '"+
c.system.domain+"' ("+b+")")}if(c.system.path)try{window.olark.__core.data.forcePath(c.system.path)}catch(f){d.warn("[olark] unable to use path '"+c.system.path+"' ("+f+")")}B(c);var h=new a.__core.api.ApiInstance({conf:c,namespace:"__bootprocessplugin",extension_name:"__bootprocessplugin"});h.chat.onReady(Q);for(var i=c.system.rules||[],g=a._.rulesLookup={},n=!1,k=0;k<i.length;k++){var j=i[k];j.enabled&&(n=!0,g[j.id]=j)}n?W(h,c):R(h,c)})})})})})},when_document_is_ready:function(a){i.whenDocumentReady(a)},
when_corelib_is_available:G,do_async_call:x,run_legacy_code:function(a){return a(window)},clone_object:n,deep_equals:w,join_string_list:u,for_each_extension_name_starting_with_most_recent:function(a){A.get_instance().for_each_extension_spec(function(c){a(c.get_name())})},after_extensions_are_activated:function(a){s({namespace:"core",type:"extensionsActivated",callback:a})},try_and_optionally_catch:p,listen_for_browser_event:r,ConfigurationManager:z,BrowserTab:b};i.publicMethods.extend=function(c,
b){p(function(){var d=null,f=null,h=null;if(typeof c=="function")d=A.get_next_extension_name(),a.declare({name:d,startup:c});else if(typeof c=="string")d=c,f=b?b.version:null,h=b?b.source:null,C(d);else throw Error("[olark] extend requires either an extension name or an inline startup function");d=new t({name:d,version:f,source:h});A.get_instance().register_extension_spec({extension_spec:d})},function(a){d.error("[olark] failed in olark.extend: "+a.toString());d.showErrorBacktrace(a)})};i.publicMethods.declare=
function(a,c){p(function(){var b=null,f=null,h=null;typeof a=="string"?(d.warn("[olark] old-style extension declarations are no longer supported"),f=a.split("@"),b=f[0],f=f.length==2?f[1]:null,h=c):(b=a.name,f=a.version,h=a.startup);C(b);b=new j({name:b,version:f,startup:h});A.get_instance().register_declared_extension({extension:b})},function(a){d.error("[olark] failed in olark.declare: "+a.toString());d.showErrorBacktrace(a)})};i.publicMethods.configure=function(a,c){var b,f;typeof a=="string"?
(f=a.split("."),b=function(a){var b=f[0];(a=a[f[0]])?(b=f[1],a[b]=c,b[0]=="_"&&d.warn("[olark] cannot configure private key:",b)):d.warn("[olark] unknown configuration namespace:",b)}):b=a;z.get_instance().register_configure_callback({callback:b})};i.publicMethods.ready=function(a){a()};i.publicMethods.identify=function(){};i.publicMethods.load=function(){}});try{window.olark.__core.trigger_olark_boot_process()}catch(A){k({url:""})}})();window.hbl_ssl=document.location.protocol=="https:"?!0:!1;
hbl_ext=window.hbl_ssl?"https":"http";hblCacheConstant="application";hbl_hostname="olark.com/nrpc";hbl_static_hostname="static.olark.com";hblStaticPath=hbl_ext+"://static.olark.com/js";hblPostURL=hbl_ext+"://www.olark.com/emails/create";hblPopupURL=olark&&olark._&&olark._.popout?olark._.popout:hblStaticPath+"/html/popout.html";hblUrlHandler=olark&&olark._&&olark._.follow?olark._.follow:hblStaticPath+"/html/url_handler.html";hblPostStub=hblStaticPath+"/wc_post.js?"+hblCacheConstant;hblJSInline=!0;
hblName="Olark Chat";hblInstallUrl="http://www.olark.com/dashboard/install";var hbl={util:{},pipelines:{},themes:{},hwindow_util:{},plugins:{},hwindow:{config:function(){this.vars={};this.palette={};this.style_id={};this.style={};this.style_classes={};this.style_classes_map={}}},jsoncallback_norv:function(){}};
hbl.util.eventmanager=function(){this.registered_events={};this.register=function(a,b,e){this.registered_events[a]==void 0&&(this.registered_events[a]=[]);e==void 0&&(e=999);this.registered_events[a].push({handler:b,priority:e});this.registered_events[a]=this.registered_events[a].sort(function(a,b){return a.priority-b.priority})};this.handle=function(a,b){if(this.registered_events[a]!=void 0){b==void 0&&(b={});b.window=this.win;b.event_name=a;var e="",c;for(c in b)b.hasOwnProperty(c)&&(e+=c+"="+b[c]+
"|");for(var g in this.registered_events[a])this.registered_events[a].hasOwnProperty(g)&&this.registered_events[a][g]&&typeof this.registered_events[a][g].handler=="function"&&this.registered_events[a][g].handler(b)}};this.unregister_all=function(a){this.registered_events[a]=[]};this.setWindow=function(a){this.win=a}};var hblrpcTrick=1,hblDEBUG=0,hblnoconsole=1,hblHideUnsupported=1,hblJavaScriptVersion="0.5m",hblBegincall="begin_2",hblJSInline=!0,hbl_max_event=1E3,hbl_hostname_delimiter=".";
hbl.eventmgr=new hbl.util.eventmanager;habla_window=void 0;hbl.get_current_page=function(){return document.URL};hbl.get_current_referrer=function(){return document.referrer};hbl.hconfig=function(){this.vars={input_width_offset_normal:16,input_width_offset_ie:16,input_width_offset_compat:8,theme_url:"../theme.js"};this.palette={};this.style={};this.plugins=new hbl.util.pluginlist;this.style_id={};this.style_classes={};this.style_classes_map={}};
hbl.hconfig.prototype.setMargin=function(a){this.setMargins(a,a,a,a)};hbl.hconfig.prototype.setMargins=function(a,b,e,c){this.vars.bottom_margin=c;this.vars.right_margin=e;this.vars.left_margin=a;this.vars.top_margin=b};hbl.hconfig.prototype.setPosition=function(a){this.vars.corner_position=a};
hbl.hconfig.prototype.setDirectionRtl=function(a){this.vars.rtl=a;this.style_classes.habla_conversation_div='height: $vars["convo_height_px"]; overflow: auto; border-bottom: 1px dotted $palette["control"]; background: transparent; line-height: 1.5em; padding: 3px 23px 3px 3px; border: 1px solid';this.style_classes.habla_window_div="z-index:3000; direction: rtl";this.style_classes.habla_conversation_message_off="margin: 0; padding: 3px 23px 3px 3px;";this.style_classes.habla_conversation_p_item='color: $palette["main_fg"]; margin: 0; padding: 0; text-indent: -20px; background: transparent; text-align: right;';
this.style_classes.habla_conversation_person1='color: $palette["local"]; padding-left: 5px; float: right;';this.style_classes.habla_conversation_person2='color: $palette["remote"]; padding-left: 5px; float: right;'};hbl.hconfig.prototype.setInline=function(a){a?(this.vars.is_inline=1,this.vars.disableFocus=1):(this.vars.is_inline=0,this.vars.disableFocus=0)};hbl.hconfig.prototype.setHeight=function(a){this.vars.convo_height=a};hbl.hconfig.prototype.setWidth=function(a){this.vars.width=a};
hbl.util.pluginlist=function(){this.todo=[];this.defined={};this.add=function(a,b){b==void 0&&(b=999);if(a!=void 0&&!this.defined[a.name])this.defined[a.name]=1,this.todo.push({handler:a,priority:b}),this.todo=this.todo.sort(function(a,c){return a.priority-c.priority})}};
hbl.util.get_body=function(){var a=document.getElementsByTagName("html"),b=null;a.length<1?(b=document.createElement("html"),document.appendChild(b)):b=a[0];a=document.getElementsByTagName("body");var e=null;a.length>0?e=document.getElementsByTagName("body").item(0):(e=document.createElement("body"),b.appendChild(e));return e};
hbl.util.get_head=function(){var a=document.getElementsByTagName("html"),b=null;a.length<1?(b=document.createElement("html"),document.appendChild(b)):b=a[0];a=document.getElementsByTagName("head");var e=null;a.length>0?e=document.getElementsByTagName("head").item(0):(e=document.createElement("head"),b.appendChild(e));return e};
hbl.util.simple_load_js_async=function(a){html_doc=hbl.util.get_body();var b=document.createElement("script");b.setAttribute("language","javascript");b.setAttribute("type","text/javascript");b.setAttribute("data-cfasync","false");b.setAttribute("src",a);html_doc.appendChild(b)};
hbl.util.BrowserDetect={_initialized:!1,init:function(){if(!this._initialized){this.browser=this.searchString(this.dataBrowser,1)||"An unknown browser";this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"an unknown version";this.need_submit_button=this.backwards_dimension=this.use_position_absolute_on_ie=!1;if(document.compatMode=="BackCompat")this.backwards_dimension=!0;if(this.browser=="Explorer"){var a=0,b=navigator.userAgent.match(/Trident\/(\d+)/);
b&&(a=b[1]);if(this.version>=10||a>=6)this.use_position_absolute_on_ie=!1;else if(this.use_position_absolute_on_ie=!0,(this.version>=7||document.body&&typeof document.body.style.maxHeight!="undefined")&&document.compatMode!="BackCompat")this.use_position_absolute_on_ie=!1}if(navigator.userAgent&&navigator.userAgent.toLowerCase().indexOf("wii")>-1)this.need_submit_button=!0;this._initialized=!0}},searchString:function(a,b){for(var e=0;e<a.length;e++){var c=a[e].string,g=a[e].prop;this.versionSearchString=
a[e].versionSearch||a[e].identity;if(c){if(c.indexOf(a[e].subString)!=-1){if(b!=void 0)this.supported=a[e].supported;return a[e].identity}}else if(g){if(a[e].identity)this.supported=a[e].supported;return a[e].identity}}},searchVersion:function(a){var b=a.indexOf(this.versionSearchString);if(b!=-1)return parseFloat(a.substring(b+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.vendor,subString:"Apple",identity:"Safari",supported:"1"},{prop:window.opera,identity:"Opera",supported:"1"},
{string:navigator.userAgent,subString:"Firefox",identity:"Firefox",supported:"1"},{string:navigator.vendor,subString:"Camino",identity:"Camino",supported:"1"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape",supported:"1"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE",supported:"1"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv",supported:"1"},{string:navigator.userAgent,subString:"Mozilla",identity:"Netscape",
versionSearch:"Mozilla",supported:"1"},{string:navigator.userAgent,subString:"iPad",identity:"iPad",supported:"1"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone",supported:"1"}]};function wc_config(){return new hbl.hconfig}hblHasinit=void 0;
function wc_init(a,b){if(!(hblHasinit||document.URL.search("hblNoInit")>-1))if(hblHasinit=1,hbl.util.BrowserDetect.init(),hbl.util.BrowserDetect.supported||!hblHideUnsupported){a=a||window.__get_olark_key();if(typeof a=="undefined"||!a){var e=document.getElementById("hbl_code");e?(a=e.href.split("#")[1],e.style.display="none"):a="missing-site-id"}olark._.identityManager.setSiteId(a);if((hbl.config=b)&&b.palette)for(var c in b.palette)if(typeof b.palette[c]=="string")hbl.need_ugly_backwards_palette_hack=
!0;hbl.started=0;hbl.prev_onload=window.onload;window.onload=function(){habla_load_func(hbl.prev_onload)};window.setTimeout("habla_load_func(hbl.prev_onload)",2500)}}function habla_load_func(a){if(!hbl.started){hbl.started=1;if(a&&typeof a=="function")try{a()}catch(b){}hblJSInline||hbl.util.simple_load_js_async(hblPostStub);hbl.eventmgr.handle("habla_called_wc_init")}}window.__olark_external_start&&window.__olark_external_start();var hbl_link=document.getElementById("hbl_code");
if(hbl_link)hbl_link.style.display="none";(function(){try{var a=document.getElementsByTagName("head")[0],b=document.createElement("style"),e=document.createTextNode(".olark-key,#hbl_code,#olark-data{display: none !important;}");b.type="text/css";b.styleSheet?b.styleSheet.cssText=e.nodeValue:b.appendChild(e);a.appendChild(b)}catch(c){}})();
window.__get_olark_key=function(){var a=document.getElementById("olark-data");if(a&&a.childNodes)for(var b=a.childNodes.length;b--;){var e=a.childNodes[b];if((e.className||"").indexOf("olark-key")!=-1)return e.id.replace("olark-","")}a=document.getElementsByTagName("a");for(b=a.length;b--;)if(e=a[b],(e.className||"").indexOf("olark-key")!=-1)return e.id.replace("olark-","");return null};if(window.olark&&window.olark.__legacy_shim)window.olark.__legacy_shim.legacy_stub_is_loaded=!0;
hbl.hconfig.prototype.merge=function(a,b){this.copy_hash(this.vars,a.vars,b);this.copy_hash(this.style,a.style,b);this.copy_hash(this.palette,a.palette,b);this.copy_hash(this.style_id,a.style_id,b);this.copy_hash(this.style_classes,a.style_classes,b);this.copy_hash(this.style_classes_map,a.style_classes_map,b);if(a.plugins&&a.plugins.todo)for(var e in a.plugins.todo)a.plugins.todo.hasOwnProperty(e)&&this.plugins.add(a.plugins.todo.handler,a.plugins.todo.priority)};
hbl.hconfig.prototype.copy_hash=function(a,b,e){if(b)for(var c in b)if(b.hasOwnProperty(c)&&(e||a[c]==void 0))a[c]=b[c]};hbl.hconfig.prototype.up=function(a){this.merge(a,!0)};hbl.hconfig.prototype.render_all_styles=function(a){for(var b in this.style_classes_map)this.style_classes_map.hasOwnProperty(b)&&typeof b=="string"&&a[b]&&this.render_element_classes(a,b)};
hbl.hconfig.prototype.render_stylesheet=function(){hbl.util.css.create_css_class("div#habla_window_div p","padding:0;");for(var a in this.style_classes)if(this.style_classes.hasOwnProperty(a)){var b=this.render_part(this.style_classes[a]);hbl.util.css.create_css_class("."+a,b)}};hbl.hconfig.prototype.smart_join=function(a,b){var e="",c;for(c in a)a.hasOwnProperty(c)&&typeof a[c]=="string"&&(e+=a[c]+b);return e};
hbl.hconfig.prototype.render_element_classes=function(a,b){this.set_element_classes(a[b],b)};hbl.hconfig.prototype.set_element_classes=function(a,b){if(a&&this.style_classes_map[b]&&this.style_classes_map[b].join)a.className=this.smart_join(this.style_classes_map[b]," ")};hbl.hconfig.prototype.render_element=function(a,b){this.render_element_classes(a,b)};
hbl.hconfig.prototype.render_class=function(a,b,e){if(a&&a.className){var c=a.className.split(" "),g=[],j;for(j in c)c.hasOwnProperty(j)&&typeof j=="string"&&c[j]!=e&&c[j]!=b&&g.push(c[j]);g.push(b);a.className=this.smart_join(g," ")}};hbl.hconfig.prototype.render_ie_hacks=function(){if((hbl.util.BrowserDetect.use_position_absolute_on_ie&&this.vars.disableJSStyles&&!this.vars.is_inline||this.vars.yahoo_ui)&&!window.hbl.__ie6_floating_div_monitor)window.hbl.__ie6_floating_div_monitor=new window.__ie6_float_hack};
hbl.hconfig.prototype.remap_palette=function(){var a={mainbg:"main_bg",mainfg:"main_fg",titlebg:"title_bg",titlefg:"title_fg",buttonbg:"button_bg",buttonfg:"button_fg",buttonhi:"button_bg_highlight",titlebg_highlight:"title_bg_highlight",titlefg_highlight:"title_fg_highlight",control:"control_border",control_highlight:"control_highlight_border",local:"local_fg",remote:"remote_fg",border:"panel_border"},b;for(b in a)a.hasOwnProperty(b)&&typeof b=="string"&&this.palette[b]&&(this.palette[a[b]]=this.palette[b]);
this.palette.buttonfg&&(this.palette.button_fg_highlight=this.palette.buttonfg)};
hbl.hconfig.prototype.init_from_config=function(a){a.setWidth(this.vars.width);a.setHeight(this.vars.height);this.vars.is_inline?a.setInline(this.vars.is_inline):a.setPosition(this.vars.corner_position);a.setMargins(this.vars.left_margin,this.vars.top_margin,this.vars.right_margin,this.vars.bottom_margin);a.setInputHeight(this.vars.input_height);a.setFormInputHeight(this.vars.input_height);hbl.util.BrowserDetect.browser=="Opera"&&(this.vars.poll=!0)};
hbl.hconfig.prototype.load_defaults=function(){this.plugins=new hbl.util.pluginlist;this.vars=[];this.palette={};this.palette.link="#e75917";this.vars.line_length=21;this.vars.bottom_margin=10;this.vars.right_margin=10;this.vars.left_margin=10;this.vars.top_margin=10;this.vars.width=260;this.vars.height=155;this.vars.panel_offset=20;this.vars.resize_input_height=60;this.vars.input_height=20;this.vars.corner_position="BR";this.vars.offline_msg_mode=!0;this.vars.rtl=!1;this.vars.resize_length=25;this.vars.myname=
"you";this.vars.say_text="Type here and hit enter to chat";this.vars.send_text="Send";this.vars.check_for_status=hblName+" (startup)";this.vars.disable_expand_text_input=!1;this.vars.disable_set_cookies=!1;this.vars.disable_get_cookies=!1;this.vars.cookie_path="/";this.vars.hbl_cookie_path="/";this.vars.session_expire=void 0;this.vars.local_user_display_name="&rarr;";this.vars.disableGoogleAnalytics=0;this.vars.expandOnMessageReceived=0;this.vars.enable_google_analytics=!1;this.vars.google_analytics_domain=
"auto";this.vars.language="en";this.vars.enableLanguageTranslation=!1;this.vars.expandOnFirstMessageReceived=1;this.vars.close_hides_window=!1;this.vars.plugin_path=hblStaticPath+"/plugins/";this.vars.divid="habla_window_div";this.vars.poll=!1;hbl.util.BrowserDetect.browser=="Opera"&&(this.vars.poll=!0);this.vars.habla_name_input_text="click here and type your Name";this.vars.habla_offline_email_text="click here and type your Email";this.vars.habla_offline_phone_text="click here and type your Phone";
this.vars.habla_offline_body_text="We're not around but we still want to hear from you!  Leave us a note:";this.vars.habla_offline_submit_value="Send";this.vars.habla_offline_sent_text="Thanks for your message!  We'll get back to you shortly.";this.vars.in_chat_text="Now Chatting";this.vars.before_chat_text="Chat with us!";this.vars.not_available_text="Contact us!";this.vars.busy_text="Contact us";this.vars.away_text="Contact us";this.vars.offline_message="We're not around, but we'd love to chat another time.";
this.vars.welcome_msg="Questions? We'd love to chat!";this.vars.busy_message="All of our representatives are with other customers at this time. We will be with you shortly.";this.vars.enable_buttons=1;this.vars.hide_min_max_buttons=0;this.vars.local_name_override=void 0;this.vars.url_handler_target_window="_top";this.vars.url_handler=hblUrlHandler;this.vars.url_local_pattern=document.domain;this.vars.parse_links=1;this.vars.is_inline=0;this.vars.start_expanded=0;this.vars.start_hidden=0;this.vars.hide_not_available=
0;this.vars.append_to_body=1;this.vars.show_away=0;this.vars.hide_when_away=0;this.vars.show_away_as_header=0;this.vars.habla_sizebutton_text_expanded="_";this.vars.habla_sizebutton_text_compressed="^";this.vars.habla_closebutton_text="x";this.vars.habla_popout_text=">";this.vars.habla_end_popout_text="<<";this.vars.start_visible=!1;this.vars.start_habla_window_visible=!1;this.vars.pre_chat_message="Hi, I am around, click 'start chatting' to contact me.";this.vars.pre_chat_submit="Click here to start chatting";
this.vars.pre_chat_error_text="Please enter your name and email in case we get disconnected.";this.vars.show_pre_chat=0;this.vars.require_name=2;this.vars.require_email=1;this.vars.require_phone=0;this.vars.require_offline_phone=0;this.vars.show_end_popout=0;this.vars.show_popout=0;this.vars.is_popup=0;this.vars.sending_text="sending";this.vars.email_body_error_text="You must complete all fields and specify a valid email address";this.vars.habla_special_div_show_type="block";this.vars.operator_has_stopped_typing_text=
"has stopped typing";this.vars.operator_is_typing_text="is typing...";this.vars.flash_icons=1;this.vars.flash_titlebar=1;this.vars.default_flash_off_icon=hblStaticPath+"/images/white.ico";this.vars.default_flash_on_icon=hblStaticPath+"/images/orange.ico";this.vars.ended_chat_message="This chat has ended, start typing below if you need anything else!";this.style_classes_map={};this.style_id={};this.style_classes={}};if(!window.hbl)window.hbl={};window.hbl.__ie6_floating_div_monitor=void 0;
window.__ie6_float_hack=function(){var a=this;a.__moving=!1;a.__need_to_move=function(){var b=a.__with_complete_habla_window(function(a){var c=a.config.vars;c=__get_element_position({dom_element:a.theme.habla_window_div,top:c.top_margin,bottom:c.bottom_margin,left:c.left_margin,right:c.right_margin,corner:c.corner_position});if(a.theme){var b={x:a.theme.getX(),y:a.theme.getY()};a=c.x-b.x;c=c.y-b.y;return{x:a,y:c,max_diff:Math.max(Math.abs(a),Math.abs(c))}}else return{x:0,y:0,max_diff:0}});return b?
b:{x:0,y:0,max_diff:0}};a.__with_complete_habla_window=function(a){var e=window.habla_window;if(e&&e.config&&e.config.vars&&e.config.vars.corner_position)return a(e)};a.__move_window=function(b,e){a.__with_complete_habla_window(function(a){var g=a.config.vars;g=__get_element_position({dom_element:a.theme.habla_window_div,top:g.top_margin,bottom:g.bottom_margin,left:g.left_margin,right:g.right_margin,corner:g.corner_position});a.theme.setXY(g.x-b,g.y-e)})};a.__check_location=function(){a.__move_to_correct_location();
setTimeout(function(){a.__check_location()},500)};a.__move_to_correct_location=function(b){var e=a.__need_to_move();if(b||!(e.max_diff<2))b||e.max_diff<15?a.__move_window(0,0):(a.__move_window(0,e.y*0.5),setTimeout(function(){a.__move_to_correct_location()},40))};a.stop=function(){a.__timeout&&clearTimeout(a.__timeout);a.__timeout=void 0};a.start=function(){a.stop();a.__timeout=setTimeout(function(){a.__check_location()},500)};a.__move_to_correct_location(!0);a.start()};
var __get_element_position=function(a){var b=0,e=0;b=a.dom_element.offsetWidth;e=a.dom_element.offsetHeight;var c=window.innerWidth||(document.documentElement.clientWidth?document.documentElement.clientWidth:document.body.clientWidth),g=window.innerHeight||(document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight),j=document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft,m=document.documentElement.scrollTop?document.documentElement.scrollTop:
document.body.scrollTop;b=a.corner.match("R")?c+j-a.right-b:a.left+j;e=a.corner.match("B")?g+m-a.bottom-e:a.top+m;if(!e)e=margin.top;if(!b)b=margin.right;return{x:b,y:e}};hbl.util.pluginlist.prototype.load=function(a){for(var b=0;b<this.todo.length;b++)this.todo[b]&&this.todo[b].handler&&typeof this.todo[b].handler.load=="function"&&this.defined[this.todo[b].handler.name]==1&&(this.todo[b].handler.load(a),this.defined[this.todo[b].handler.name]=2);return a};hbl.util.last_js_id=0;
hbl.util.last_js_pollid=0;hbl.util.pipeline=function(a){this.todo=[];this.host_obj=a;this.add=function(a,e){e==void 0&&(e=999);this.todo.push({handler:a,priority:e});this.todo=this.todo.sort(function(a,b){return a.priority-b.priority})};this.run=function(a){for(var e=a,c=0;c<this.todo.length;c++)if(this.todo[c]&&typeof this.todo[c].handler=="function"){e=this.todo[c].handler(a,this.host_obj);if(e==void 0)return;a=e}return e};this.setTarget=function(a){this.host_obj=a}};
hbl.util.listenForEvent=function(a,b,e){return a.addEventListener?a.addEventListener(b,e,!1):a.attachEvent?a.attachEvent("on"+b,e):a["on"+b]=e};hbl.util.pluginloader=function(a,b,e){hbl.pluginArgs={conf:a,client:b,hwindow:e};a.plugins.load({conf:a,client:b,hwindow:e})};hbl.util.timestamp=function(){return(new Date).toUTCString()};hbl.util.reportException=function(a){olark._.hlog("exception:",a,"#error")};
hbl.util.urlencode=function(a){var b="",e;for(e in a)a.hasOwnProperty(e)&&(b+=e+"="+encodeURIComponent(a[e])+"&");return b};
hbl.util.load_js_async=function(a){hbl.util.last_js_id+=1;hbl.util.last_js_pollid+=1;var b="jscript"+hbl.util.last_js_id;a+=a.indexOf("?")>-1?"&"+b:"?"+b;if(hbl.util.last_js_id>1900)if(a.match(/sendmessage/i)||a.match(/begin/i))hbl.util.last_js_id=1;else return;html_doc=hbl.util.get_body();var e=document.createElement("script");e.setAttribute("language","javascript");e.setAttribute("id",b);e.setAttribute("type","text/javascript");e.setAttribute("data-cfasync","false");e.setAttribute("src",a);html_doc.appendChild(e)};
hbl.util.remove_element=function(a){a=document.getElementById(a);a!=void 0&&a.parentNode!=void 0&&a.parentNode.removeChild(a)};hbl.util.calculate_retry_delay=function(a,b,e){a*=1+b;return a>e?e:a};
hbl.util.append_script=function(a,b,e){var c=hbl.util.append_script,g=e.scriptid,j=e.url,m=e.tries,l=e.previous_tries||0,d=e.timeout,i=e.error_callback,t=e.success_callback,r=e.cache,s=e.retryid?e.retryid:"";a.opera&&!d&&(d=200);var o=function(h){var f=b.getElementById(g+s);f?(f.loaded=!0,f.parentNode!=void 0&&f.parentNode.removeChild(f),i&&i({status:h}),m>0?a.setTimeout(function(){c(a,b,{scriptid:g,retryid:"r"+m,url:j,tries:m,previous_tries:l+1,timeout:d,error_callback:i,cache:r})},hbl.util.calculate_retry_delay(1200,
l,15E3)):window.olark&&window.olark._.hlog&&olark._.hlog("#rpc_call_error-"+h+" url:"+j)):t&&t()};e=j;if(!r){var h=e.length>0&&e.charAt(e.length-1)!="&"&&e.charAt(e.length-1)!="?";e.match(/\?/)?h&&(e+="&"):e+="?";e+="_rnd="+Math.random()}e=e.replace("?","?j="+g+s+"&");var q=b.createElement("script");q.setAttribute("language","javascript");q.setAttribute("id",g+s);q.setAttribute("type","text/javascript");q.setAttribute("data-cfasync","false");q.setAttribute("src",e);q.loaded=!1;m&&(m-=1);if(d)q.timeout=
a.setTimeout(function(){o("timeout")},d);q.readyState?q.onreadystatechange=function(){if((q.readyState=="loaded"||q.readyState=="complete")&&!q.loaded)q.onreadystatechange=function(){},q.loaded=!0,q.timeout&&a.clearTimeout(q.timeout),a.setTimeout(function(){o("error")},100)}:(q.onload=function(){if(!q.loaded)q.loaded=!0,q.timeout&&a.clearTimeout(q.timeout),a.setTimeout(function(){o("error")},100)},q.onerror=function(){if(!q.loaded)q.loaded=!0,q.timeout&&a.clearTimeout(q.timeout),a.setTimeout(function(){o("error")},
100)});h=b.getElementsByTagName("script")[0];h.parentNode.insertBefore(q,h);olark._.internalLog&&olark._.internalLog.logHttpRequest(e)};hbl.util.as_dom=function(a){var b;if(typeof a=="object")return a;b=document.createElement("span");b.innerHTML=a;return b};hbl.util.set_inner_text=function(a,b){a.textContent!==null&&a.textContent!==void 0?a.textContent=b:a.innerText=b};
hbl.util.encode_html_entities=function(a,b){b||(b=[]);var e={ampersand:{regex:/&/gi,replaceValue:"&amp;"},lessThan:{regex:/\</gi,replaceValue:"&lt;"},greaterThan:{regex:/\>/gi,replaceValue:"&gt;"},doubleQuote:{regex:/\"/gi,replaceValue:"&quot;"},singleQuote:{regex:/\'/gi,replaceValue:"&#x27;"},slash:{regex:/\//gi,replaceValue:"&#x2F;"}},c;for(c in e)e.hasOwnProperty(c)&&b.indexOf(c)<=-1&&(a=a.replace(e[c].regex,e[c].replaceValue));return a};
hbl.util.decode_html_entities=function(a){try{var b=hbl.util.encode_html_entities(a,["ampersand"]),e=document.createElement("div");e.innerHTML=b;var c=e.childNodes.length===0?"":e.childNodes[0].nodeValue;return c&&!/^\s*$/.test(c)?c:a}catch(g){return a}};hbl.util.find_or_create_el=function(a,b,e){var c=document.getElementById(a);if(!c||c.length<0)b==void 0&&(b="div"),c=document.createElement(b),c.setAttribute("id",a),e!=void 0&&e.appendChild(c);if(b=="input"||b=="textarea")c.name=a;return c};
hbl.util.find_or_create_div=function(a,b){return hbl.util.find_or_create_el(a,"div",b)};hbl.util.hide_div=function(a){typeof a!="object"&&(a=document.getElementById(a));if(a!=void 0)return a.style.display="none",!0;return!1};hbl.util.show_div=function(a,b){b==void 0&&(b="block");typeof a!="object"&&(a=document.getElementById(a));if(a!=void 0)return a.style.display=b,!0;return!1};hbl.util.clean_whitespace=function(a){a=a.replace(/^\s*/,"");a=a.replace(/\s*$/,"");return a=a.replace("'","")};
hbl.util.decode_base64=function(a){var b="";try{b=window.atob(a)}catch(e){var c,g,j,m,l,d=0;a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");do c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a.charAt(d++)),
c=c<<2|g>>4,g=(g&15)<<4|m>>2,j=(m&3)<<6|l,b+=String.fromCharCode(c),m!=64&&(b+=String.fromCharCode(g)),l!=64&&(b+=String.fromCharCode(j));while(d<a.length)}return b};
hbl.util.encode_base64=function(a){var b,e,c,g,j=0,m=0,l="";l=[];if(!a)return a;a=hbl.util.utf8_encode(a+"");do b=a.charCodeAt(j++),e=a.charCodeAt(j++),c=a.charCodeAt(j++),g=b<<16|e<<8|c,b=g>>18&63,e=g>>12&63,c=g>>6&63,g&=63,l[m++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(c)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(g);
while(j<a.length);l=l.join("");switch(a.length%3){case 1:l=l.slice(0,-2)+"==";break;case 2:l=l.slice(0,-1)+"="}return l};hbl.util.strip_whitespace=function(a){return a.replace(/^\s*/,"").replace(/\s*$/,"")};hbl.util.is_valid_email=function(a){if(!a)return!1;return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(a)};
hbl.util.is_valid_phone=function(a){if(!a)return!1;return/[\+01]{0,4}(9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)\d{0,14}(x\d{1,5})?$/.test(a.replace(/[^\+\d]/g,""))};
hbl.util.utf8_encode=function(a){a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var b="",e,c,g=0;e=c=0;g=a.length;for(var j=0;j<g;j++){var m=a.charCodeAt(j),l=null;m<128?c++:l=m>127&&m<2048?String.fromCharCode(m>>6|192)+String.fromCharCode(m&63|128):String.fromCharCode(m>>12|224)+String.fromCharCode(m>>6&63|128)+String.fromCharCode(m&63|128);l!==null&&(c>e&&(b+=a.substring(e,c)),b+=l,e=c=j+1)}c>e&&(b+=a.substring(e,a.length));return b};hbl.util.css={};
hbl.util.getElementsByClass=function(a,b){a||(a=document.getElementsByTagName("body")[0]);for(var e=[],c=RegExp("\\b"+b+"\\b"),g=a.getElementsByTagName("*"),j=0,m=g.length;j<m;j++)c.test(g[j].className)&&e.push(g[j]);return e};
var PollingManager=function(a,b,e,c,g){var j=this,m=1,l=!0,d=!1,i=!1,t=!1,r=void 0,s=void 0,o=void 0,h=void 0,q=void 0,k=!1,f=15,x=0,n=+new Date;e("api.chat.onOperatorsAvailable",function(){t=!0;q=+new Date});e("api.chat.onOperatorsAway",function(){t=!1});k=!0;/irefox/.test(g.userAgent)&&a.addEventListener&&a.addEventListener("unload",function(){d&&i&&c.client.sendcommand("return_long_poll_now","")},!1);j.getMinAvailablePollTime=function(){return x};j.setMinAvailablePollTime=function(a){x=a};j.setAllowedDelayWhenSlow=
function(a){f=a};j.reset=function(){n=+new Date};j.__timeOnPage=function(){return(+new Date-n)/1E3};j.__secondsSinceOnline=function(){return q?(+new Date-q)/1E3:void 0};j.__setLastPollStartedTimestamp=function(a){o=a};j.setLongPoll=function(a){l=a};j.startFailSafeIntervalIfNeeded=function(){r||(r=a.setInterval(function(){j.getNextPollTime(function(a){var c=!1,b=o?(+new Date-o)/1E3:void 0,d=a-+new Date;a==void 0?o==void 0?c=!0:b>300&&(c=!0):o&&+new Date-(o+d)<f&&(c=!0);c&&(j.finishLastPoll(),j.startNextPollNow())})},
3E4))};j.startNextPollNow=function(){i||w()};j.finishLastPoll=function(){i&&(i=!1);h=void 0;lastPollFinishedTimestamp=+new Date;return d};var w=function(c){d=!0;s&&a.clearTimeout(s);s=void 0;j.startFailSafeIntervalIfNeeded();c==void 0&&(c=l?0:900);s=a.setTimeout(function(){j.poll()},c);h=+new Date+c;m=c};j.__determinePollTime=function(a,c,b){return a?(a=0,a=c<120?4E3:c<300?1E4:c<1800?3E4:c<7200?45E3:c/20*1E3,a<x?x:a):b&&b<60?15E3:c<300?45E3:c<3600?15E5:(c=c/2*1300,c<15E5?15E5:c)};j.getNextPollTime=
function(a){var c,b=function(b){c=b;a&&a(b)};e("api.visitor.getDetails",function(a){var c=a.secondsSinceLastMessage,d=a.secondsSinceLastNotificationToOperator;a=c;if(d!=void 0&&(c==void 0||d<c))a=d;c=j.__timeOnPage();d=j.__secondsSinceOnline();return a!=void 0?a<180?b(void 0):a<300?b(1E4):a<1800?b(2E4):b(j.__determinePollTime(t,c,d)):b(j.__determinePollTime(t,c,d))});return c};j.scheduleNextPoll=function(){i||j.getNextPollTime(function(a){if(!h||a==void 0||h>+new Date+a)k?a>18E5?j.stop():w(a):(a>
18E5&&(a=18E5),w(a))})};j.stop=function(){d?(d=!1,s&&a.clearTimeout(s),r&&a.clearInterval(r),r=s=void 0,c.client.sendcommand("return_long_poll_now","")):d=!1};j.isRunning=function(){return d};j.poll=function(){i=!0;o=+new Date;m==0&&l?c.client.proxy2.getmessages(olark._.identityManager.getConversationId(),c.client.last_poll_index,c.client.callbacks.getmessages):c.client.proxy3.pollmessages(olark._.identityManager.getConversationId(),c.client.last_poll_index,c.client.callbacks.pollmessages)}};
hbl._pollevents_errors=0;
hbl.client={SENDMESSAGE_DELAY:100,incoming_pipeline:new hbl.util.pipeline,first_time:!0,recorded_ssl_ip:!1,op_nickname_map:{},pollingmanager:new PollingManager(window,document,olark,hbl,navigator),is_conversation:function(){var a,b=!1,e=!1;for(a=0;a<hbl.client.buffer.length;++a)hbl.client.buffer[a]&&(hbl.client.buffer[a][0]=="you"&&(b=!0),hbl.client.buffer[a][0]!="you"&&(e=!0));return b&&e},current_operator:function(){var a,b="";for(a=0;a<hbl.client.buffer.length;++a)hbl.client.buffer[a]&&hbl.client.buffer[a][0]!=
"you"&&(b=hbl.client.buffer[a][0]);return b},noop:function(){},geolocation_ready:function(a){hbl.client.eventmgr.handle("geolocation_ready",a)},callbacks:{begin:function(a){hbl.client.jsoncallback(a,hbl.client.begin_call_back)},sendmessage:function(a){hbl.client.msg_callback(a)},sendpresence:function(){},sendcommand:function(){},pollevents:function(a){hbl._pollevents_errors=0;hbl.client.pollingmanager.finishLastPoll()&&hbl.client.jsoncallback(a,hbl.client.callbacks.pollmessages1)},pollmessages1:function(a){var b=
a;setTimeout(function(){hbl.client.eventmgr.handle("handled_nrpc_response")});b.is_new_conversation&&hbl.client.eventmgr.handle("session_was_not_in_memcache",{});b.ipaddress_lookup_needed&&hbl.client.record_ssl_ip();hbl.client.site_is_online=b.site_is_online;hbl.client.conversation_has_slot=b.conversation_has_slot;a={sid:b.conversation_id,hblid:b.visitor_id,chatting:b.in_active_conversation,opstatus:b.status_state,opavailable:b.site_is_online,geoip:b.geolocation_data,ipaddress:b.ipaddress,pop_out:b.is_popup,
ssl:b.ssl,box_visible:!0,opbusy:!1,operator_composing_state:a.operator_composing_state,operator_nickname:a.operator_nickname};if(b.operator_has_sent_message&&b.site_is_online)a.opstatus="available";if(!b.operator_has_sent_message&&b.site_is_online&&a.opstatus!="available")a.opavailable=!1;hbl.client.chatting=a.chatting;if(!a.disconnected){if(hbl.client.first_time)hbl.client.first_time=!1;if(a.exception!="no session found"){if(a.opavailable!=hbl.client.opavailable||hbl.client.opmessage!=a.opmessage||
hbl.client.opstatus!=a.opstatus||hbl.client.opbusy!=a.opbusy||hbl.client.pop_out!=a.pop_out)hbl.client.eventmgr.handle("operator_status_change",{available:a.opavailable,opavailable:a.opavailable,status:a.opstatus,opstatus:a.opstatus,message:a.opmessage,busy:a.opbusy,pop_out:a.pop_out,pop_out_change:hbl.client.pop_out!=a.pop_out,chatting:hbl.client.chatting,box_visible:hbl.client.box_visible,opbusy:a.opbusy}),hbl.client.first_time=!1,hbl.client.opavailable=a.opavailable,hbl.client.opmessage=a.opmessage,
hbl.client.opstatus=a.opstatus,hbl.client.opbusy=a.opbusy,hbl.client.pop_out=a.pop_out;if(hbl.client.composing!=a.operator_composing_state)hbl.client.eventmgr.handle("operator_composing",{composing_type:a.operator_composing_state,operator_nickname:a.operator_nickname}),hbl.client.composing=a.operator_composing_state;a=[];for(var e=!1,c,g=b.new_events||[],j=0;j<g.length;j++){var m=g[j][0];if(m>hbl.client.last_poll_index)hbl.client.last_poll_index=m;var l=g[j][1];if(l.body&&l.nickname!="you")a.push([l.nickname,
l.body,m]),hbl.client.op_nickname_map[l.nickname]=l.operator_id;if(l.type=="site_config_changed")e=!0,c=l.md5}hbl.client.append1(a);e&&(olark._.setSiteAssetHash(c),olark._.setLoaderUseAssets("1"));hbl.client.whenNicknameAndPresenceAreAllowed(function(){b.resend_nickname&&hbl.client.eventmgr.handle("resend_nickname",{});b.resend_status&&hbl.client.eventmgr.handle("resend_status",{})});hbl.client.pollingmanager.scheduleNextPoll()}}}},siteid:"",wc_sid:"",sid:"",proxy:null,buffer:[],myname:"you",jsoncallback:function(a,
b){if(a.http_traffic_blocked)return olark("api.box.hide"),hbl.util.append_script=function(){},window.console&&window.console.warn&&window.console.warn("[olark] Olark Chat is turned off for this website, if you own this website please contact Olark via support@olark.com"),!1;a.ended&&hbl.client.eventmgr.handle("conversation_ended",{next_conversation_id:a.ended.next_conversation_id});a.conversation_does_not_exist?hbl.client.restart_session():a.retry?hbl.client.pollingmanager.startNextPollNow():b!=null&&
!a.duplicate_session_id&&b(a)},begin_call_back:function(a){function b(){olark._.identityManager.deleteIdentityFromCookies()}var e=olark._.hlog,c=a;if(a.error){var g=[];a.error=="fatal_boot_exception"&&(b(),g.push("#fatal_boot_exception"));c.invalid_id_format&&(b(),g.push("#invalid_id_format"));c.conversation_does_not_exist&&(b(),g.push("#conversation_does_not_exist"));e("stopped begin call:",a.error,"#error #begin_call_error",g.join(" "))}else if(c.invalid_id_format||c.conversation_does_not_exist)b(),
e("RPC reported no errors, but gave error flags #error #unexpected_rpc_output");else{c.conversation_id!=olark._.identityManager.getConversationId()&&e("RPC reported new conversationId:",c.conversation_id,"!=",olark._.identityManager.getConversationId(),"#error #new_rpc_wcsid");c.visitor_id!=olark._.identityManager.getVisitorId()&&(e("RPC reported new visitorId, re-storing to cookie:",c.visitor_id,"!=",olark._.identityManager.getVisitorId(),"#error #new_rpc_hblid"),c.visitor_id&&olark._.identityManager.setVisitorId(c.visitor_id));
var j=function(){olark("api.box.__SPI_getLegacyState",function(c){olark._.needsFirstTimeOperatorLogin=!1;var b=a;a.site_config_changed&&(olark._.setSiteAssetHash(a.site_md5||a.assets_config_md5),olark._.setLoaderUseAssets("1"));a={sid:b.conversation_id,hblid:b.visitor_id,chatting:b.in_active_conversation,opstatus:b.status_state,opavailable:b.site_is_online,geoip:b.geolocation_data,ipaddress:b.ipaddress,pop_out:b.is_popup,ssl:b.ssl,opbusy:!1,operator_composing_state:a.operator_composing_state,operator_nickname:a.operator_nickname,
habla_message:a.habla_message,box_visible:c.box_visible,box_open:c.box_open};if(b.operator_has_sent_message&&b.site_is_online)a.opstatus="available";if(!b.operator_has_sent_message&&b.site_is_online&&a.opstatus!="available")a.opavailable=!1;if(a!=null&&!a.error){olark._.identityManager.setConversationId(a.sid);olark._.identityManager.setVisitorId(a.hblid);hbl.client.chatting=a.chatting;hbl.client.site_is_online=b.site_is_online;hbl.client.conversation_has_slot=b.conversation_has_slot;hbl.client.opavailable=
a.opavailable;hbl.client.opmessage=a.opmessage;hbl.client.opstatus=a.opstatus;hbl.client.opbusy=a.opbusy;hbl.client.pop_out=a.pop_out;hbl.client.ssl=a.ssl;hbl.client.box_visible=a.box_visible;c=function(a){return{available:a.opavailable,opavailable:a.opavailable,opstatus:a.opstatus,status:a.opstatus,message:a.opmessage,busy:a.opbusy,pop_out:a.pop_out,pop_out_change:hbl.client.pop_out!=a.pop_out,chatting:hbl.client.chatting,box_visible:hbl.client.box_visible,opbusy:a.opbusy}};olark._.geoip=a.geoip;
olark._.ipaddress=a.ipaddress;hbl.client.eventmgr.handle("nrpc_data_ready",c(a));hbl.client.eventmgr.handle("chat_started",{chatting:a.chatting,box_open:a.box_open,box_visible:a.box_visible,opstatus:a.opstatus,opavailable:a.opavailable,opmessage:a.opmessage,opbusy:a.opbusy,pop_out:a.pop_out,config:a.config,dconfig:a.dconfig,habla_message:a.habla_message,browser_ip:a.ipaddress,geolocation:a.geocode_ip});hbl.client.last_poll_index=0;if(b.conversation_history){for(var d=[],i=0;i<b.conversation_history.length;i++){var g=
b.conversation_history[i][0];if(g>hbl.client.last_poll_index)hbl.client.last_poll_index=g;var j=b.conversation_history[i][1];if(j.body)j.type=="visitor_message"&&(g=0),d.push([j.nickname,j.body,g]),hbl.client.op_nickname_map[j.nickname]=j.operator_id}hbl.client.setContents(d)}hbl.client.eventmgr.handle("operator_status_change",c(a));hbl.client.opavailable=a.opavailable;hbl.client.opmessage=a.opmessage;hbl.client.opstatus=a.opstatus;hbl.client.opbusy=a.opbusy;hbl.client.pop_out=a.pop_out;hbl.client.eventmgr.handle("operator_composing",
{composing_type:a.operator_composing_state,operator_nickname:a.operator_nickname});hbl.client.composing=a.composing_type;hbl.client.whenNicknameAndPresenceAreAllowed(function(){b.resend_nickname&&hbl.client.eventmgr.handle("resend_nickname",{});b.resend_status&&hbl.client.eventmgr.handle("resend_status",{})});b.is_new_conversation&&hbl.client.eventmgr.handle("session_was_not_in_memcache",{});hbl.client.pollingmanager.scheduleNextPoll()}else a&&a.error&&hbl.client.eventmgr.handle("habla_error",{etype:a.error})})};
a.error!="fatal exception"?a.ipaddress_lookup_needed?(olark._.identityManager.setConversationId(a.conversation_id),hbl.client.record_ssl_ip(),hbl.client.eventmgr.register("geolocation_ready",function(c){a.geolocation_data=c.geolocation;a.ipaddress=c.geolocation.ipaddress;j()})):j():olark._.hlog("#boot #spoof detected")}},start:function(a,b,e,c,g){olark._.identityManager.setSiteId(e);olark._.identityManager.setConversationId(a);olark._.identityManager.setVisitorId(b);hbl.client.eventmgr=c;hbl.client.config=
g;hbl.client.opstatus=null;hbl.client.opavailable=null;hbl.client.opmessage=null;hbl.client.chatting=!1;hbl.client.pop_out=!1;hbl.client.buffer=[];hbl.client.the_count=0;hbl.client.newlinecount=0;hbl.client.lastindex=0;hbl.client.last_getmessages=new Date;hbl.client.jsondata=null;hbl.client.datareadycallback=null;hbl.client.getmsgcallback=null;hbl.client.first_time=!0;hbl.client.incoming_pipeline.setTarget(this);try{var j=new hbl.client.jsonproxy(olark._.nrpcBaseUrl);hbl.client.proxy=hbl.client.proxy3=
hbl.client.proxy2=j;hbl.config&&hbl.config.vars&&!hbl.config.vars.local_mode&&(olark._.P("begin"),hbl.client.proxy.begin(olark._.identityManager.getConversationId(),olark._.identityManager.getVisitorId(),olark._.identityManager.getSiteId(),hbl.get_current_page(),hbl.get_current_referrer(),g.vars.start_passive,g.vars.force_nickname,g.vars.no_system_messages,hbl.client.begin_call_back))}catch(m){throw hbl.client.chatting=!1,hbl.util.reportException(m),m;}},jsoncallback_norv:function(){},jsonproxy:function(a,
b){this.uri=a;this.callq=[];this.rnd=b},check_getmsg:function(){},setContents:function(a){if(!a||a.length==0)if(window.olark&&window.olark.__legacy_shim&&window.olark.__legacy_shim.has_messages_in_history)a=[[null,"  ",0.2]];else return;for(var b=hbl.client.lastindex=0;b<a.length;++b)if(hbl.client.buffer[hbl.client.buffer.length]=[a[b][0],a[b][1],a[b][2]],a[b][2]>hbl.client.lastindex)hbl.client.lastindex=a[b][2];hbl.client.newlinecount=1;window.olark&&window.olark.__legacy_shim&&window.olark.__legacy_shim.load_missed_messages&&
window.olark.__legacy_shim.load_missed_messages(a);hbl.client.eventmgr.handle("receive_message",{type:"start",msg:a})},append:function(a){if(a&&a.length>0){for(var b=0;b<a.length;++b)hbl.client.buffer[hbl.client.buffer.length]=[a[b][0],a[b][1],a[b][2]];hbl.client.newlinecount+=a.length;hbl.client.chatting=!0;hbl.client.eventmgr.handle("send_message",{type:"local_update",msg:a})}},append1:function(a){if(a&&a.length>0){for(var b=[],e=0,c=0;c<a.length;++c)if(a[c][2]>hbl.client.lastindex){hbl.client.lastindex=
a[c][2];var g=hbl.client.incoming_pipeline.run(a[c]);g!=void 0&&(hbl.client.buffer[hbl.client.buffer.length]=g,b.push(g));a[c]&&(e+=1)}hbl.client.newlinecount+=a.length;if(e>0)hbl.client.chatting=!0;b.length>0&&hbl.client.eventmgr.handle("receive_message",{type:"remote_update",msg:b})}},msg_callback:function(a){a.error=="operator_is_busy"&&hbl.eventmgr.handle("habla_error",{etype:"operator_is_busy"})},sendmessage:function(a,b,e,c,g,j){hbl.client.lastNickname=g;hbl.client.lastStatusMessage=j;var m=
!b;b=[[hbl.client.myname,a,m,e]];m&&hbl.client.append(b);c&&(hbl.client.proxy.setnickname(olark._.identityManager.getConversationId(),g),hbl.client.proxy.sendpresence(olark._.identityManager.getConversationId(),j,"chat"));setTimeout(function(){hbl.client.proxy.sendmessage(olark._.identityManager.getConversationId(),a,m,e,hbl.client.msg_callback)},hbl.client.SENDMESSAGE_DELAY);hbl.client.pollingmanager.startNextPollNow()},sendofflinemessage:function(a,b){hbl.client.proxy.setnickname(olark._.identityManager.getConversationId(),
hbl.client.lastNickname);hbl.client.proxy.sendpresence(olark._.identityManager.getConversationId(),hbl.client.lastStatusMessage,"chat");setTimeout(function(){hbl.client.proxy.sendofflinemessage(olark._.identityManager.getConversationId(),a,b)},hbl.client.SENDMESSAGE_DELAY)},setnickname:function(a){hbl.client.lastNickname=a;hbl.client.whenNicknameAndPresenceAreAllowed(function(){hbl.client.proxy.setnickname(olark._.identityManager.getConversationId(),a)})},sendcommand:function(a,b){hbl.client.proxy.sendcommand(olark._.identityManager.getConversationId(),
a,b)},record_ssl_ip:function(){if(!hbl.client.recorded_ssl_ip)hbl.client.proxy.geolocation(olark._.identityManager.getConversationId(),olark._.identityManager.getVisitorId()),hbl.client.recorded_ssl_ip=!0},restart_session:function(){hbl.client.proxy.noop(olark._.identityManager.getConversationId(),olark._.identityManager.getVisitorId())},setvcard:function(){},sendpresence:function(a,b){hbl.client.lastStatusMessage=a;hbl.client.whenNicknameAndPresenceAreAllowed(function(){hbl.client.proxy.sendpresence(olark._.identityManager.getConversationId(),
a,b)})},log_event:function(a,b){hbl.client.proxy&&hbl.client.proxy.log_event(olark._.identityManager.getConversationId(),a,b)},sendexpand:function(){},sendcompress:function(){},sendend:function(){},sendhide:function(){},sendshow:function(){},popout:function(){hbl.client.proxy&&hbl.client.proxy.popout(olark._.identityManager.getConversationId())},end_popout:function(){hbl.client.proxy&&hbl.client.proxy.end_popout(olark._.identityManager.getConversationId())},whenNicknameAndPresenceAreAllowed:function(a){olark("api.visitor.getDetails",
function(b){if(b.secondsSinceLastMessage!=void 0||b.secondsSinceLastNotificationToOperator!=void 0)a();else if(hbl.config.vars.show_in_buddy_list!="chatting")b=hbl.client.site_is_online,hbl.client.conversation_has_slot&&b&&a()})}};hbl.client.map={command:"c",callback:"cb",group_id:"g",group_idstring:"g",conversation_id:"i",script_id:"j",site_idstring:"s",sequence_id:"q",status_message:"m",status_state:"p",current_url:"u",visitor_id:"v",referrer_url:"r"};
hbl.client.jsonproxy.prototype.__build_nrpc_arguments=function(a){var b="";a.command&&(b+="&c="+encodeURIComponent(a.command+""));a.sequence_id&&(b+="&q="+a.sequence_id);var e=hbl.client.map,c=[],g;for(g in a)if(c.push(g),a.hasOwnProperty(g)&&a[g]&&g!="append_settings"&&g!="throttle"&&g!="sequence_id"&&g!="command"){var j=encodeURIComponent(a[g]+"");e[g]&&(g=e[g]);b+="&"+g+"="+j}b==""&&(b="?command=invalid_buffer&buffer_is_empty="+escape(c.join(",")));return b};
hbl.client.jsonproxy.prototype.do_nrpc_call=function(a){var b=hbl.client.pollingmanager.getNextPollTime();if(b)a.next_poll_time=b;if(hbl._pollevents_errors)a.num_retries=hbl._pollevents_errors;this.do_raw_nrpc_call(a)};
hbl.client.jsonproxy.prototype.do_raw_nrpc_call=function(a){var b=a.command,e=a.append_settings,c="",g=hbl_ext;if(olark.__legacy_shim.allowEndConversation&&(a.end_conversation=1,olark._.identityManager.isNewConversation()&&b==="create"))a.is_new_conversation=1;a.visitor_id=a.visitor_id||olark._.identityManager.getVisitorId();if(b=="create"||b=="sendmessage")hbl.util.last_js_id=1;hbl.util.last_js_id+=1;if(hbl.util.last_js_id<1900){hbl.util.last_js_pollid+=1;this.rnd&&(c=parseInt(Math.random()*10).toString()+
"-");var j="/"+b.charAt(0)+"?";b=="geolocation"&&hblrpcTrick?(c="start-"+parseInt(Math.random()*3).toString()+"."+hbl_hostname,c+=j,g="https"):c+=this.uri+j;b=parseInt(Math.random()*1E4)+"."+ +new Date%1E5+"."+hbl.util.last_js_pollid;a.sequence_id=b;a.version=hblJavaScriptVersion;a.pretty=!0;a.throw_exceptions=window.olark.__buildinfo.strict?!0:!1;c+=this.__build_nrpc_arguments(a);hbl.util.append_script(window,document,{scriptid:"o"+hbl.util.last_js_pollid,url:g+"://"+c,tries:e.tries,timeout:e.timeout,
cache:!1,error_callback:e.error_callback})}};
hbl.client.jsonproxy.prototype.begin=function(a,b,e,c,g){a||olark._.hlog("missing sid #no_begin_wcsid_input");b||olark._.hlog("missing hblid #no_begin_hblid_input");var j=olark.__legacy_shim.currentGroupIdstring||"ALL",m=this,l=function(){m.do_nrpc_call({command:"create",conversation_id:a,visitor_id:b,site_idstring:e,current_url:c,referrer_url:g,callback:"hbl.client.callbacks.begin",group_id:j,throttle:!1,append_settings:{tries:3,timeout:2E4}})},d=function(a){a.status?l():hbl.client.callbacks.begin(a)},
i=olark._.nrpcPrecache;i?i.response?d(i.response):i.responseCallback=d:l()};hbl.client.jsonproxy.prototype.sendmessage=function(a,b,e,c){var g=olark.__legacy_shim.currentGroupIdstring;this.do_nrpc_call({command:"sendmessage",conversation_id:a,site_idstring:olark._.identityManager.getSiteId(),body:b,no_history:!e,notification:c,callback:"hbl.client.callbacks.sendmessage",group_idstring:g,version:hblJavaScriptVersion,append_settings:{tries:3,timeout:45E3}})};
hbl.client.jsonproxy.prototype.sendofflinemessage=function(a,b,e){var c=olark.__legacy_shim.currentGroupIdstring;a={command:"sendofflinemessage",conversation_id:a,site_idstring:olark._.identityManager.getSiteId(),body:b,callback:"hbl.client.noop",group_idstring:c,version:hblJavaScriptVersion,append_settings:{tries:3,timeout:45E3}};for(var g in e)e.hasOwnProperty(g)&&(a["form_"+g]=e[g]);this.do_nrpc_call(a)};
hbl.client.jsonproxy.prototype.sendcommand=function(a,b,e){var c=olark.__legacy_shim.currentGroupIdstring;if(b=="disconnectchat")this.do_nrpc_call({command:"destroy",conversation_id:a,callback:"hbl.client.noop",group_idstring:c,append_settings:{tries:3,timeout:45E3}});else if(b=="send_compose_state")this.do_nrpc_call({command:"sendcomposing",conversation_id:a,callback:"hbl.client.noop",state:e,group_idstring:c,append_settings:{tries:3,timeout:45E3}});else if(b=="return_long_poll_now")this.do_nrpc_call({command:"finishlongpoll",
conversation_id:a,callback:"hbl.client.noop",state:e,group_idstring:c,append_settings:{tries:3,timeout:45E3}});else if(b=="unlock_operator")this.do_nrpc_call({command:"sendunlock",conversation_id:a,callback:"hbl.client.noop",message:e,group_idstring:c,append_settings:{tries:3,timeout:45E3}});else throw"Unsupported command: "+b;};
hbl.client.jsonproxy.prototype.setnickname=function(a,b){this.do_nrpc_call({command:"sendnickname",conversation_id:a,callback:"hbl.client.noop",nickname:b,group_idstring:olark.__legacy_shim.currentGroupIdstring,append_settings:{tries:3,timeout:45E3}})};hbl.client.jsonproxy.prototype.noop=function(a,b){this.do_nrpc_call({command:"noop",conversation_id:a,visitor_id:b,site_idstring:olark._.identityManager.getSiteId(),callback:"hbl.client.noop",append_settings:{tries:3,timeout:45E3}})};
hbl.client.jsonproxy.prototype.geolocation=function(a,b){this.do_nrpc_call({command:"geolocation",conversation_id:a,visitor_id:b,site_idstring:olark._.identityManager.getSiteId(),callback:"hbl.client.geolocation_ready",append_settings:{tries:3,timeout:45E3}})};
hbl.client.jsonproxy.prototype.sendpresence=function(a,b,e){this.do_nrpc_call({command:"sendpresence",conversation_id:a,callback:"hbl.client.noop",status_message:b,status_state:e,group_idstring:olark.__legacy_shim.currentGroupIdstring,append_settings:{tries:5,timeout:45E3}})};
hbl._exponential_backoff_pollevents_error_handler=function(){var a=1E3*hbl._pollevents_errors*hbl._pollevents_errors;a>45E3&&(a=45E3);setTimeout(function(){hbl.client.pollingmanager.finishLastPoll();hbl.client.pollingmanager.startNextPollNow()},a);hbl._pollevents_errors+=1};
hbl.client.jsonproxy.prototype.getmessages=function(a,b){hbl.client.the_count++;hbl.client.last_getmessages=new Date;this.do_nrpc_call({command:"pollevents",throttle:!1,conversation_id:a,callback:"hbl.client.callbacks.pollevents",timeout:29,after:b,append_settings:{timeout:4E4,error_callback:hbl._exponential_backoff_pollevents_error_handler}})};
hbl.client.jsonproxy.prototype.pollmessages=function(a,b){hbl.client.the_count++;this.do_nrpc_call({command:"pollevents",throttle:!1,conversation_id:a,callback:"hbl.client.callbacks.pollevents",timeout:0,after:b,append_settings:{timeout:1E4,error_callback:hbl._exponential_backoff_pollevents_error_handler}})};hbl.client.jsonproxy.prototype.popout=function(a){this.do_nrpc_call({command:"popout",conversation_id:a,callback:"hbl.client.noop",append_settings:{tries:3,timeout:45E3}})};
hbl.client.jsonproxy.prototype.end_popout=function(a){this.do_nrpc_call({command:"endpopout",conversation_id:a,callback:"hbl.client.noop",append_settings:{tries:3,timeout:45E3}})};hbl.client.jsonproxy.prototype.log_event=function(a,b,e){this.do_nrpc_call({command:"logevent",conversation_id:a,site_idstring:olark._.identityManager.getSiteId(),callback:"hbl.client.noop",event_type:b,body:e,append_settings:{tries:3,timeout:45E3}})};
hbl._hwindow=function(a,b,e){this.config=b;this.client=a;this.handlers=!1;this.theme=void 0;this.eventmgr=e;this.pop_out=this.offline_msg_visible=this.offline_msg_started=this.has_typed=this.expanded_textbox=this.loaded=!1;this.setTheme=function(a){this.theme&&this.theme.remove();this.theme=a;this.theme.build(this.config,this.client,this.config.vars.start_visible,this.config.vars.start_habla_window_visible);this.check_theme_for_link_div();hbl.util.pluginloader(this.config,this.client,this)};this.check_theme_for_link_div=
function(){if(this.theme){this.config.vars.hkey&&(this.config.vars.special_link=hbl.util.decode_base64(this.config.vars.hkey).replace("href",'style="'+this.config.vars._habla_link_a+'" href'));if(!this.theme.habla_link_div||this.theme.habla_link_div.style&&this.theme.habla_link_div.style.display=="none"||this.theme.habla_link_div.innerHTML.indexOf("http://hab.la")<0&&this.theme.habla_link_div.innerHTML.indexOf("http://www.olark.com")<0||!this.theme.habla_link_div.parentNode){this.theme.habla_link_div=
document.createElement("div");this.config.vars.force_name_habla_link_div&&this.theme.habla_link_div.setAttribute("id","habla_link_div");if(this.config.vars.special_link)this.theme.habla_link_div.innerHTML=this.config.vars.special_link.replace("hblink1","hblink9");this.theme.config.vars.append_middle?this.theme.habla_middle_div.appendChild(this.theme.habla_link_div):this.theme.habla_expanded_div.appendChild(this.theme.habla_link_div)}if(!document.getElementById("hblink9"))this.theme.habla_link_div.innerHTML=
hbl.util.decode_base64("RnJlZSA8YSBocmVmPSJodHRwOi8vd3d3Lm9sYXJrLmNvbS8/ZnJlZV9saXZlaGVscCIgaWQ9ImhibGluazkiIHRhcmdldD0iX2JsYW5rIj5PbGFyazwvYT4gbGl2ZWhlbHAgfCA8YSBocmVmPSJodHRwOi8vd3d3Lm9sYXJrLmNvbS8/bW9yZSIgaWQ9ImhibGluazk5IiB0YXJnZXQ9Il9ibGFuayI+R2V0IGl0ITwvYT48IS0taHR0cDovL3d3dy5vbGFyay5jb20tLT4=");this.set_link(document.getElementById("hblink9"));this.set_link(document.getElementById("hblink99"));this.theme.habla_link_div.setAttribute("style",this.config.vars._habla_link_div);this.theme.habla_link_div.style.clear=
"both";document.getElementById("hblink9")&&document.getElementById("hblink9").setAttribute("style",this.config.vars._habla_link_a);document.getElementById("hblink99")&&document.getElementById("hblink99").setAttribute("style",this.config.vars._habla_link_a)}};this.set_link=function(a){if(a&&a.href){var b=a.href.split(/[\?\#]/);a.href=b[0]+"?rid="+olark._.identityManager.getSiteId()+"&"+b[1];a.href=a.href.replace("olark.com/","olark.com/welcome/");a.target="_blank";var j=window.olark.__legacy_shim.box_state==
"expanded"?!0:!1;olark("api.box.onExpand",function(){setTimeout(function(){j=!0},2E3)});a.onclick=function(){hbl.client.eventmgr.handle("olark_link_clicked",{});if(j)return!0;return!1}}};this.register_handlers=function(){if(!this.handlers)this.handlers=!0,this.eventmgr.register("window_focus",this.events.onWindowFocus,0),this.eventmgr.register("window_click",this.events.onWindowFocus,0),this.eventmgr.register("window_submit",this.events.onWindowSubmit,0),this.eventmgr.register("window_form_submit",
this.events.onWindowFormSubmit,0),this.eventmgr.register("window_topbar_clicked",this.events.topBarClicked,0),this.eventmgr.register("habla_closebutton_a_onclick",this.events.closeClicked,0),this.eventmgr.register("habla_sizebutton_a_onclick",this.events.topBarClicked,0),this.eventmgr.register("habla_oplink_a_onclick",this.events.topBarClicked,0),this.eventmgr.register("operator_status_change",this.events.onOpstatusStatusChanged,0),this.eventmgr.register("receive_message",this.events.onChatUpdated,
0),this.eventmgr.register("send_message",this.events.onChatUpdated,0),this.eventmgr.register("chat_started",this.events.onChatStarted,0),this.eventmgr.register("theme_loaded",this.events.onThemeLoaded,0)};this.get_operator_state=function(){if(this.config.vars.local_mode)return this.config.vars.local_operator_state||"available";return this.opavailable?this.opbusy?this.config.vars.show_busy_message?"busy":"available":this.opstatus=="chat"||this.opstatus=="available"||!this.opstatus||this.opstatus==
""?"available":"notavailable":"notavailable"};this.determine_window_status=function(a){var b={};if(window.olark&&window.olark.__legacy_shim){b=window.olark.__legacy_shim;b.box_state!=null&&(a.box_open=b.box_state=="expanded"?!0:!1);if(b.box_visible!=null)a.window.theme.visible=b.box_visible?!0:!1,a.box_visible=b.box_visible?!0:!1;a.window.config.vars.close_hides_window&&b.box_state=="closed"&&(a.box_visible=!1);a.window.theme.state=b.box_state||a.window.theme.state}if(a.pop_out&&!a.window.config.vars.is_popup)return!1;
if(a.pop_out_change&&!a.pop_out)return!0;if(a.chatting||hbl.client.buffer.length>0&&!a.window.config.vars.close_hides_window)return!0;if(a.box_open||a.window.theme.state=="expanded")return!0;if(a.window.config.vars.start_hidden&&!a.window.theme.visible)return!1;if(a.window.config.vars.close_hides_window&&!a.box_visible)return!1;if(a.window.config.vars.hide_not_available&&!a.opavailable)return!1;b=a.opavailable&&a.opstatus!="chat"&&a.opstatus!=void 0&&a.opstatus!=""&&a.opstatus!="available";if(a.window.config.vars.hide_not_available&&
b)return!1;return!0};this.setInputBox=function(a,b,j){this.theme.setInputBox(a,b,j)};this.setWindowText=function(){var a=this.get_operator_state();if((a=="notavailable"||this.offline_msg_started)&&this.config.vars.offline_msg_mode)this.setHeader(this.config.vars.not_available_text),this.setOfflineWindow(this.config.vars.offline_message||" ");else if(this.setOfflineWindow(!1),a=="notavailable")this.setHeader(this.config.vars.not_available_text),hbl.client.buffer.length<1&&this.setBody(this.config.vars.offline_message);
else if(a=="away")this.config.vars.show_away_as_header&&this.opmessage?this.setHeader(this.opmessage,!0):this.setHeader(this.config.vars.busy_text||this.config.vars.away_text),this.client.buffer.length==0&&this.setBody(this.config.vars.away_message||this.config.vars.busy_message||this.config.vars.offline_message);else if(a=="busy")this.setHeader(this.config.vars.busy_text),this.setBody(this.config.vars.busy_message);else if(this.client.buffer.length==0){a=b.vars.force_nickname&&b.vars.force_nickname!=
"";var g=window.olark&&window.olark.__legacy_shim?!0:!1;this.config.vars.show_pre_chat&&!this.theme.pre_chat_sent&&(g||!a)?this.setShowPreChat(!0):this.setBody(this.config.vars.welcome_msg);this.setHeader(this.config.vars.before_chat_text)}else this.setHeader(this.config.vars.in_chat_text)};this.appendFromBuffer=function(a){if(!this.offline_msg_started)if(this.theme)for(var b=0;b<a.length;b++)a[b]&&this.theme.appendNiceMessage(a[b][0],a[b][1],!0);else hbl.hwindow_last_buffer=a,this.eventmgr.register("theme_loaded",
function(a){a.window.appendFromBuffer(hbl.hwindow_last_buffer);hbl.hwindow_last_buffer=""},100)};this.setHeader=function(a,b){a!=void 0&&(b&&(a=".."+a.substr(0,10)+".."),this.theme.setHeader(a))};this.events={onOpstatusStatusChanged:function(a){a.window.opstatus=a.status;a.window.opmessage=a.message;a.window.opbusy=a.busy;a.window.pop_out=a.pop_out;!a.window.opavailable&&a.available&&(!a.window.config.vars.offline_msg_mode||!a.window.offline_msg_mode)&&a.window.reloadBuffer();a.window.opavailable=
a.available;a.window.setWindowText();var b=a.window.determine_window_status(a),j=!a.pop_out&&a.pop_out_change;if(window.olark&&window.olark.__legacy_shim&&j&&window.olark.__legacy_shim.populate_message_history_from_chat_api)habla_conversation_div.innerHTML="",window.olark.__legacy_shim.populate_message_history_from_chat_api();b||(a.available||!a.window.config.vars.hide_not_available)&&a.window.theme.visible?a.window.show():a.window.hide(1)},onChatUpdated:function(a){a.window.setShowPreChat(!1);a.window.appendFromBuffer(a.msg)},
onChatStarted:function(a){a.window.opavailable=a.opavailable;a.window.opbusy=a.busy;a.nick!=null&&!a.nick.match(/webuser\d\d/)&&a.window.setnickname(a.nick,1);hbl.chat_started_arg=a;if(a.window.theme)a.window.theme.build(a.window.config,a.window.client,!0),a.window.events.onThemeLoaded(a);else if(a.window.config.vars.theme_obj)a.window.setTheme(b.vars.theme_obj),a.window.events.onThemeLoaded(a);else{hbl.chat_started_arg=a;var g="";a.window.config.vars.theme_path&&(g="http://"+hbl_static_hostname+
"/"+a.window.config.vars.theme_path);a.window.config.vars.theme_url&&(g=a.window.config.vars.theme_url);hbl.util.simple_load_js_async(g)}hbl.client.eventmgr.handle("chat_loaded",a)},onThemeLoaded:function(a){a.window.theme||a.window.setTheme(a.obj);hbl.util.BrowserDetect.use_position_absolute_on_ie&&hbl.config.render_ie_hacks();a=hbl.chat_started_arg;a.window.determine_window_status(a)?(a.window.show(1),(!a.pop_out||a.window.config.vars.is_popup)&&(a.box_open||a.window.config.vars.start_expanded||
window.olark&&window.olark.__legacy_shim&&olark.__legacy_shim.box_state=="expanded")&&a.window.expand()):a.window.hide(1);if(a.habla_message){a.window.config.vars.offline_message=a.habla_message.msg;if(a.habla_message.header)a.window.config.vars.not_available_text=a.habla_message.header,a.window.setHeader(habla_window.config.vars.not_available_text);a.window.show(1);a.habla_message.expand&&a.window.expand();a.window.theme.habla_conversation_div.scrollTop=0}},onWindowFocus:function(a){a.window.normal();
a.window.setWindowText()},topBarClicked:function(a){a.window.normal();a.window.expanded?(a.window.compress(),hbl.client.eventmgr.handle("window_compressed")):(a.window.expand(),hbl.client.eventmgr.handle("window_expanded"));return!1},closeClicked:function(a){a.window.close();hbl.client.eventmgr.handle("window_closed");return!1},onWindowFormSubmit:function(a){a.window.send()},onWindowSubmit:function(a){a.window.send()}};this.send_pipeline=new hbl.util.pipeline(this);this.send_pipeline.add(hbl.pipelines.nickname,
999);return this};hbl._hwindow.prototype.setnickname=function(a,b){b==void 0&&this.client.setnickname(nickname)};hbl._hwindow.prototype.show=function(a){this.theme.state=="closed"&&this.theme.__set_css_window_state("compressed");this.theme.show();this.visible=!0;!a&&!this.config.vars.disable_rpc_state&&this.client.sendshow();hbl.eventmgr.handle("habla_window_changed",{type:"show"})};
hbl._hwindow.prototype.popout=function(a){if(habla_popup=window.open(hblPopupURL+"?_ok="+olark._.identityManager.getSiteId()+"&wcsid="+olark._.identityManager.getConversationId()+"&_oklv="+olark._.identityManager.getOklvValueForPopout()+"&hblid="+olark._.identityManager.getVisitorId()+"&_okgid="+olark._.cookieManager.get("_okgid")+"&olfsk="+olark._.cookieManager.get("olfsk")+"&host="+window.location.host,"habla_popout","width=300,height=400,scrollbars=no,location=no,status=no,menubar=no,toolbar=no,directories=no,resizable=yes"))a||
this.client.popout(),this.pop_out=!0,hbl.client.pop_out=!0,habla_popup.focus(),this.hide(a),hbl.eventmgr.handle("habla_window_changed",{type:"popout"})};hbl._hwindow.prototype.end_popout=function(a){this.pop_out=!1;a||this.client.end_popout();hbl.eventmgr.handle("habla_window_changed",{type:"endpop_out"})};
hbl._hwindow.prototype.close=function(a){this.theme.close();!a&&!this.config.vars.disable_rpc_state&&this.client.sendend();this.config.vars.close_hides_window&&this.hide();hbl.eventmgr.handle("habla_window_changed",{type:"close"})};hbl._hwindow.prototype.hide=function(a){this.theme.hide();this.visible=!1;!a&&!this.config.vars.disable_rpc_state&&this.client.sendhide();hbl.eventmgr.handle("habla_window_changed",{type:"hide"})};
hbl._hwindow.prototype.setWidth=function(a){this.theme&&this.theme.setWidth(a);hbl.eventmgr.handle("habla_window_changed",{type:"resize"})};hbl._hwindow.prototype.setInputHeight=function(a){this.theme.setInputHeight(a);hbl.eventmgr.handle("habla_window_changed",{type:"resize"})};hbl._hwindow.prototype.setHeight=function(a){this.theme&&this.theme.setHeight(a);hbl.eventmgr.handle("habla_window_changed",{type:"resize"})};
hbl._hwindow.prototype.compress=function(){this.expanded=!1;this.theme.compress();hbl.util.BrowserDetect.use_position_absolute_on_ie&&this.visible&&window.hbl.__ie6_floating_div_monitor&&window.hbl.__ie6_floating_div_monitor.__move_to_correct_location();hbl.eventmgr.handle("habla_window_changed",{type:"compress"});this.config.vars.disable_rpc_state||this.client.sendcompress()};
hbl._hwindow.prototype.expand=function(){this.expanded=!0;hbl.util.BrowserDetect.use_position_absolute_on_ie&&this.config.vars.ycorner=="bottom"&&this.theme.setXY(this.theme.habla_window_div.style.left.match(/\d\d*/),this.theme.habla_window_div.style.top.match(/\d\d*/)-this.config.vars.convo_height-this.config.vars.panel_offset);this.theme&&this.theme.expand();this.config.vars.disable_rpc_state||this.client.sendexpand();hbl.eventmgr.handle("habla_window_changed",{type:"expand"})};
hbl._hwindow.prototype.setPosition=function(a){this.theme.setPosition(a)};hbl._hwindow.prototype.setInline=function(a){this.theme.setInline(a)};hbl._hwindow.prototype.setMargins=function(a,b,e,c){this.theme.setMargins(a,b,e,c)};hbl._hwindow.prototype.getHeader=function(){return this.theme.getHeader()};hbl._hwindow.prototype.reloadBuffer=function(){this.theme.setBody("");this.appendFromBuffer(this.client.buffer)};
hbl._hwindow.prototype.setBody=function(a){this.setOfflineWindow(!1);this.theme.setBody(a||"")};hbl._hwindow.prototype.setOfflineWindow=function(a){this.theme.setOfflineWindow(a)};hbl._hwindow.prototype.setShowPreChat=function(a){this.theme.setShowPreChat(a)};hbl._hwindow.prototype.highlight=function(){this.theme.highlight()};hbl._hwindow.prototype.normal=function(){this.theme.normal()};
hbl._hwindow.prototype.send=function(){var a=this.theme.getMessageInputField(),b=this.theme.getMessageInputFieldValue();if(b==this.config.vars.say_text)this.theme.setMessageInputFieldValue("");else if(b&&b.length>0)try{this.theme.setMessageInputFieldValue(""),(b=this.send_pipeline.run(b))&&this.client.sendmessage(b),this.normal()}catch(e){throw e;}this.config.vars.disableFocus||(a.focus(),setTimeout(function(){habla_window.theme.getMessageInputField().focus()},10));return!1};
hbl.hwindow_util.wrap_and_create_links=function(a,b){function e(a){var c=a.childNodes;if(c.length==0){if(a.data&&(c=a.data.replace(/([^\s]{13})/g,"$1%|%").split("%|%"),c.length>1))for(var b in a=document.createElement("span"),c)if(c.hasOwnProperty(b)&&typeof c[b]=="string"){var g=document.createElement("span");b>0&&g.setAttribute("class","olark_new_line");c[b]=c[b].replace("<","&lt;");c[b]=c[b].replace(">","&gt;");g.innerHTML=c[b];a.appendChild(g);a.appendChild(document.createElement("wbr"))}}else for(b in c)typeof c[b]==
"object"&&a.replaceChild(e(c[b]),c[b]);return a}function c(a){var c={":)":"smile",":(":"frown"},b;for(b in c)if(c.hasOwnProperty(b)){var g=RegExp("\\s"+b.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"g"),j="olark-smiley-"+c[b];a=a.replace(g,function(a){return' <span class="'+j+'">'+a+"</span>"})}return a}function g(a,c,b){var g=/^\+?[\<\[]?(?:\%3C)?\s*((https?|ftp|file|telnet|ldap|irc|nntp|news|irc):\/\/\/?)?([\w-]+\.)+[a-zA-Z]{2,4}(:\d+)?(\/[\w\!\#\$\%\&\'\*\+\/\-\=\?\^\_\.\`\{\|\}\~\-]*)*(\?.*)?[\>\]]?$|^[\w\!\#\$\%\&\'\*\+\.\/\-\=\?\^\_\`\{\|\}\~\-]+(?:\.[\w!\#$%&'*+\/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?$/;
a=a.split(" ");for(var j in a)a.hasOwnProperty(j)&&(a[j]=a[j].replace(g,function(a){var g=!0;a.charAt(0)==="+"&&(g=!1,a=a.slice(1));var h=a,j='<a href="'+b(a,g)+'" target="',k=m.config.vars.chat_does_not_follow_external_links?!0:!1;a=hbl.hwindow_util.refers_to_local_domain(a)?!1:!0;return j+(!g||k&&a?"_blank":c)+'" >'+h.replace(/</,"&lt;").replace(/>/,"&gt")+"</a>"}));return a.join(" ")}function j(a,c){return hbl.hwindow_util.get_habla_url(a,m,c)}var m=b;return function(a){a=a.replace(/<\/*body[^>]*>/ig,
"");a=a.replace(/<((\/[^a]|[^\/a])[^>]*)>/ig,"<wbr>&lt;$1&gt;<wbr>");m.config.vars.parse_links&&(a=g(a,m.config.vars.url_handler_target_window,j));m.config.vars.parse_smileys!==!1&&(a=c(a));var b=document.createElement("div");b.innerHTML=a;b=e(b);return b.innerHTML}(a)};hbl.hwindow_util.refers_to_local_domain=function(a,b){function e(a){return a.replace(/^(?:https?\:\/\/)?(?:www\.)?/,"").split("/")[0]}b=b||window.location.host;return e(b)===e(a)};
hbl.hwindow_util.get_habla_url=function(a,b,e){var c=/^\s*(ftp|file|telnet|ldap|irc|nntp|news|irc).*/,g=/^\s*(\/).*/,j=/^\s*(https?)\:\/\/.+/,m=function(a){if(b.config.vars.url_handler&&e){for(var c=window.location.search.replace(/^\?/,"").split(/&/),i=c.length-1;i>=0;i--)c[i].split(/=/);return b.config.vars.url_handler+"?_ok="+olark._.identityManager.getSiteId()+"&wcsid="+olark._.identityManager.getConversationId()+"&_oklv="+olark._.identityManager.getOklvValueForPopout()+"&hblid="+olark._.identityManager.getVisitorId()+
"&_okgid="+olark._.cookieManager.get("_okgid")+"&olfsk="+olark._.cookieManager.get("olfsk")+"&url="+hbl.util.encode_base64(a)+"&host="+window.location.host}else return a};a=a.replace(/^\s*%3C\s*/,"");return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)?"mailto:"+a:c.test(a)?a:g.test(a)?document.location.protocol+"//"+document.domain+a:(c=null,c=j.test(a)?a:hbl.hwindow_util.refers_to_local_domain(a)?
document.location.protocol+"//"+a:"http://"+a,b.config.vars.chat_does_not_follow_external_links||hbl.hwindow_util.refers_to_local_domain(c)?c:m(c))};hbl.pipelines.nickname=function(a,b){if(a.substr(0,6)=="/nick "){var e=a.substr(6);b.client.setnickname(e)}else return a};hbl.pipelines.wrap_text=function(a,b){return hbl.hwindow_util.wrap_and_create_links(a,b)};hbl.pipelines.emoticons=function(a){a=a.replace(/\;\-\)/,"<code><big>;-)</big></code>");return a=a.replace(/\:\-\)/,"<code><big>:-)</big></code>")};
hbl.pipelines.push_url=function(a){msg_t=a;a=a[1];if(a.substr(0,6)=="!push "){var b="";a=a.replace(/&lt;/i,"[");a=a.replace(/\/*&gt;/i,"]");a.match(/<a/)?(a=a.match(/src\s*=\s*"*([^\"]+)\"*/i),a.length>1&&(b=a[1])):a.match(/\[(http[^\]]+)\s*\]/i)?(a=a.match(/\[(http[^\]]+)\]/i),b=a[1]):b=a.substr(6,a.length-6);b=b.split(" ")[0];b=b.split("%20")[0];if(b!=""){var e=hbl.hwindow_util.get_habla_url(b,habla_window,!0);setTimeout(function(){window.location=e},0);return}}return msg_t};
hbl.client.incoming_pipeline.add(hbl.pipelines.push_url,999);hbl.plugins.incoming_notification_vars={};
hbl.plugins.incoming_notification=function(){this.name="incoming_notification";this.load=function(a){var b=this;hbl.plugins.incoming_notification_vars.freq=3E3;hbl.plugins.incoming_notification_vars.flashicon=!1;hbl.plugins.incoming_notification_vars.flashing=!1;hbl.plugins.incoming_notification_vars.original_favicon=!1;habla_wcsend_input=hbl.util.find_or_create_el("habla_wcsend_input","textarea");hbl.plugins.incoming_notification_vars.windowTextCleared=!0;a.hwindow.config.vars.flash_titlebar&&(a.hwindow.eventmgr.register("receive_message",
this.onReceiveMessage),a.hwindow.eventmgr.register("send_message",this.onWindowFocus),a.hwindow.eventmgr.register("window_focus",this.onWindowFocus),a.hwindow.eventmgr.register("window_click",this.onWindowFocus));if(a.hwindow.config.vars.flash_icons){hbl.plugins.incoming_notification_vars.default_flash_on_icon=a.hwindow.config.vars.default_flash_off_icon;if(!hbl.oldtitle)hbl.oldtitle=/Message Received/i.test(document.title)?"":document.title||"";if(!hbl.plugins.incoming_notification_vars.originalFavicon)hbl.plugins.incoming_notification_vars.originalFavicon=
hbl.plugins.incoming_notification_vars.remove_current_icon(!0)||a.hwindow.config.vars.default_flash_on_icon;hbl.plugins.incoming_notification_vars.default_flash_off_icon=hbl.plugins.incoming_notification_vars.originalFavicon;habla_wcsend_input.onkeypress=function(){b.onWindowFocus({window:a.hwindow});hbl.plugins.incoming_notification_vars.windowTextCleared=!0}}};this.onReceiveMessage=function(a){if(!/^\s*!/.test(a.msg[a.msg.length-1][1])&&a.type=="remote_update"){a.window.highlight();hbl.plugins.incoming_notification_vars.last_msg=
"";if(hbl.client.buffer&&hbl.client.buffer[hbl.client.buffer.length-1])hbl.plugins.incoming_notification_vars.last_msg=hbl.client.buffer[hbl.client.buffer.length-1][1].substr(0,10),a.window.setHeader(".."+hbl.plugins.incoming_notification_vars.last_msg+"..");hbl.plugins.incoming_notification_vars.windowTextCleared=!1;hbl.plugins.incoming_notification_vars.flashOlarkFavicon()}};this.onWindowFocus=function(a){hbl.plugins.incoming_notification_vars.resetFavicon();if(!hbl.plugins.incoming_notification_vars.windowTextCleared)a.window.setWindowText(),
hbl.plugins.incoming_notification_vars.windowTextCleared=!0,a=document.getElementById("habla_topbar_div"),a.className=a.className.replace(/habla_topbar_div_highlighted/,"habla_topbar_div_normal")};hbl.plugins.incoming_notification_vars.flashOlarkFavicon=function(){document.title="(Message Received: "+hbl.plugins.incoming_notification_vars.last_msg+") "+hbl.oldtitle;hbl.plugins.incoming_notification_vars.set_icon(hbl.plugins.incoming_notification_vars.default_flash_on_icon);var a=!0;hbl.plugins.incoming_notification_vars.flashingInterval=
setInterval(function(){a?hbl.plugins.incoming_notification_vars.set_icon(hbl.plugins.incoming_notification_vars.originalFavicon):hbl.plugins.incoming_notification_vars.set_icon(hbl.plugins.incoming_notification_vars.default_flash_on_icon);a=!a},hbl.plugins.incoming_notification_vars.freq)};hbl.plugins.incoming_notification_vars.resetFavicon=function(){document.title=hbl.oldtitle;clearInterval(hbl.plugins.incoming_notification_vars.flashingInterval);var a=hbl.plugins.incoming_notification_vars.originalFavicon||
"";hbl.plugins.incoming_notification_vars.remove_current_icon();hbl.plugins.incoming_notification_vars.set_icon(a);hbl.plugins.incoming_notification_vars.flashing=!1};hbl.plugins.incoming_notification_vars.remove_current_icon=function(a){if(document.getElementsByTagName("head")&&document.getElementsByTagName("head").length!=0)for(var b=document.getElementsByTagName("head")[0].getElementsByTagName("link"),e=0;e<b.length;e++){var c=b[e];if(c.type=="image/x-icon"&&/favicon|favico|shortcut|icon|shortcut\s*icon/i.test(c.rel))return b=
c.href,a||document.getElementsByTagName("head")[0].removeChild(c),b}};hbl.plugins.incoming_notification_vars.set_icon=function(a){var b=document.createElement("link");b.type="image/x-icon";b.rel="shortcut icon";b.href=a;hbl.plugins.incoming_notification_vars.remove_current_icon();document.getElementsByTagName("head")&&document.getElementsByTagName("head").length!=0&&document.getElementsByTagName("head")[0].appendChild(b)}};hbl.plugins.messages_received=0;
hbl.plugins.expand_on_receive_message=function(){this.name="expand_on_receive_message";this.load=function(a){a.hwindow.eventmgr.register("receive_message",this.onReceiveMessage,-1)};this.onReceiveMessage=function(a){if(!/^\s*!/.test(a.msg[a.msg.length-1][1])&&(hbl.plugins.messages_received+=1,!a.window.pop_out))if(a.type!="start"&&(!a.window.config.vars.expandOnFirstMessageReceived||a.window.config.vars.expandOnMessageReceived||hbl.plugins.messages_received==1))hbl.client.eventmgr.handle("window_expanded"),
a.window.expand(),a.window.show();else if(a.type!="start"&&a.window.theme&&a.window.theme.state=="closed")a.window.theme.state="compressed",a.window.show()}};
hbl.plugins.away_div_handler=function(){this.name="away_div_handler";this.load=function(a){hbl.util.hide_div("habla_unavailable_div");hbl.util.hide_div("habla_available_div");hbl.util.show_div("habla_loading_div",a.hwindow.config.vars.habla_special_div_show_type)||hbl.util.show_div("habla_unavailable_div",a.hwindow.config.vars.habla_special_div_show_type);(document.getElementById("habla_available_div")!=void 0||document.getElementById("habla_unavailable_div")!=void 0)&&a.hwindow.eventmgr.register("operator_status_change",
this.onOperatorStatusChange)};this.onOperatorStatusChange=function(a){var b=a.status;a.available&&(!b||b=="chat"||!a.window.config.vars.hide_when_away)?(hbl.util.show_div("habla_available_div",a.window.config.vars.habla_special_div_show_type),hbl.util.hide_div("habla_unavailable_div")):(hbl.util.hide_div("habla_available_div"),hbl.util.show_div("habla_unavailable_div",a.window.config.vars.habla_special_div_show_type));hbl.util.hide_div("habla_loading_div")}};
hbl.plugins.auto_initiate=function(){this.load=function(a){a.hwindow.config.vars.auto_initiate_allowed&&a.hwindow.config.vars.auto_initiate&&a.hwindow.eventmgr.register("chat_loaded",this.onChatLoad)};this.onChatLoad=function(a){if(a.session_start&&!a.opbusy&&a.opavailable)habla_window.auto_initiated=!1,setTimeout(function(){if(hbl.client.buffer.length==0&&hbl.client.opavailable){habla_window.show();habla_window.expand();habla_window.auto_initiated=!0;var b=a.window.config.vars.auto_initiate_message;
habla_window.theme.appendNiceMessage(a.window.config.vars.auto_initiate_name,b[Math.floor(Math.random()*b.length)],!0,!1,!0);habla_window.highlight();hbl.client.buffer=[" "];habla_window.send_pipeline.add(function(a){if(habla_window.auto_initiated)hbl.client.sendmessage(habla_window.config.vars.auto_initiate_response_notify,!0),habla_window.auto_initiated=!1;return a},1E4);habla_window.config.vars.auto_initiate_notify&&hbl.client.sendmessage(habla_window.config.vars.auto_initiate_notify_msg,!0)}},
parseInt(a.window.config.vars.auto_initiate_period*1E3))}};hbl.plugins.google_translate=function(){this.name="googletranslate";this.load=function(){}};hbl.plugins.sounds=function(){this.name="sounds";this.load=function(a){a.conf.vars.enableSounds==1&&hbl.util.simple_load_js_async(a.conf.vars.plugin_path+"contributed/sounds.js")}};hbl.plugins.smileys=function(){this.name="smileys";this.load=function(a){a.conf.vars.enableSmileys==1&&hbl.util.simple_load_js_async(a.conf.vars.plugin_path+"contributed/smileys.js")}};
hbl.themes.default_theme=function(){this.appended=!0;this.last_msg=-1;this.highlighted=this.visible=!1;this.state="compressed";this.ready=this.pre_chat_sent=this.offline_window=this.message_sent=!1;this.position="BR";this.build=function(a,b,j){this.client=b;this.config=a;this.set_config();this.load_styles();this.div=void 0;this.divid=a.vars.divid;this.build_dom(j);this.set_dom_event_handlers();this.config.init_from_config(this);this.palette_hack();this.render_styles();!this.config.vars.disableJSStyles&&
!this.config.vars.no_palette&&this.render_palette();this.set_default_text();this.register_handlers();this.ready=!0;this.config.vars.disableJSStyles&&!this.config.vars.start_hidden&&this.show();hbl.eventmgr.handle("post_theme_loaded")};this.palette_hack=function(){if(hbl.need_ugly_backwards_palette_hack){var a={},b;for(b in this.config.style_classes_map)if(this.config.style_classes_map.hasOwnProperty(b))for(var j in this.config.style_classes_map[b])if(this.config.style_classes_map[b].hasOwnProperty(j))for(var e in this.config.palette)this.config.palette.hasOwnProperty(e)&&
"hbl_pal_"+e==this.config.style_classes_map[b][j]&&(this.config.style_classes_map[b][j]="hbl_pal_"+e+"_local",a[e+"_local"]=this.config.palette[e]);this.config.palette=a}};this.set_config=function(){var a=new hbl.hconfig;a.style_classes={};a.style_classes_map={habla_window_div:["habla_window_div_position","habla_window_div_base","hbl_pal_main_width"],habla_closebutton_a:["habla_button","habla_button_a_normal","hbl_pal_header_font_size","hbl_pal_main_font_family","hbl_pal_button_bg","hbl_pal_button_fg"],
habla_sizebutton_a:["habla_button","habla_button_a_normal","hbl_pal_header_font_size","hbl_pal_main_font_family","hbl_pal_button_bg","hbl_pal_button_fg"],habla_popout_a:["habla_button","habla_button_a_normal","hbl_pal_header_font_size","hbl_pal_main_font_family","hbl_pal_button_bg","hbl_pal_button_fg"],habla_end_popout_a:["habla_button","habla_button_a_normal","hbl_pal_header_font_size","hbl_pal_main_font_family","hbl_pal_button_bg","hbl_pal_button_fg"],habla_button_normal:["habla_button","habla_button_a_normal",
"hbl_pal_header_font_size","hbl_pal_button_bg","hbl_pal_button_fg"],habla_button_highlighted:["habla_button","habla_button_a_highlighted","hbl_pal_header_font_size","hbl_pal_button_bg_highlight","hbl_pal_button_fg_highlight"],habla_button_hover:["habla_button","habla_button_a_hover","hbl_pal_header_font_size","hbl_pal_button_bg_hover","hbl_pal_button_fg_hover"],habla_panel_div:["habla_panel_border","hbl_pal_main_bg","hbl_pal_panel_border","hbl_pal_main_font_family","hbl_pal_main_font_size"],habla_oplink_a:["habla_oplink_a_normal",
"hbl_pal_header_font_size","hbl_pal_title_fg"],habla_oplink_hover:["habla_oplink_a_hover","hbl_pal_header_font_size","hbl_pal_title_fg"],habla_wcsend_input_pre:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_input_pre_fg","hbl_pal_main_font_family","hbl_pal_input_font_size","hbl_pal_control_border"],habla_wcsend_input_post:["habla_wcsend_field","habla_wcsend_input_post","habla_wcsend_input_normal","hbl_pal_main_fg","hbl_pal_main_font_family","hbl_pal_input_font_size"],
habla_wcsend_input:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_control_border","hbl_pal_main_font_family","hbl_pal_input_font_size"],habla_wcsend_input_highlighted:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_highlighted","hbl_pal_control_highlight_border","hbl_pal_main_font_family","hbl_pal_input_font_size"],habla_name_input:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border",
"hbl_pal_input_font_size"],habla_wcsend_input:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border","hbl_pal_input_font_size"],habla_offline_email_input:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border","hbl_pal_input_font_size"],habla_offline_phone_input:["habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family",
"hbl_pal_control_border","hbl_pal_input_font_size"],habla_offline_body_input:["habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border","hbl_pal_input_font_size"],habla_offline_clear_div:["clear_style"],habla_chatform_form:["habla_chatform_form"],habla_input_div:["habla_input_div"],habla_pre_chat_email_input:["habla_pre_chat_form_field","habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border",
"hbl_pal_input_font_size"],habla_pre_chat_name_input:["habla_pre_chat_form_field","habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border","hbl_pal_input_font_size"],habla_pre_chat_phone_input:["habla_pre_chat_form_field","habla_wcsend_field","habla_wcsend_input_pre","habla_wcsend_input_normal","hbl_pal_main_font_family","hbl_pal_control_border","hbl_pal_input_font_size"],habla_offline_message_sent_div:["hbl_panel","habla_offline_message_sent_div",
"hbl_pal_main_height","hbl_pal_control_border","hbl_pal_main_fg"],habla_pre_chat_div:["hbl_panel","habla_pre_chat_div","hbl_pal_main_height","hbl_pal_main_fg"],habla_offline_message_div:["hbl_panel","habla_offline_message_div","hbl_pal_control_border","hbl_pal_main_fg"],habla_conversation_div:["hbl_panel","habla_conversation_div","hbl_pal_main_height","hbl_pal_control_border","hbl_pal_main_fg","hbl_pal_main_bg"],habla_say_text_span:["habla_say_text_span","hbl_pal_main_fg"],habla_submit_button:["habla_submit_button"],
habla_offline_submit_input:["habla_offline_submit_input","hbl_pal_offline_submit_fg","hbl_pal_control_border","hbl_pal_offline_submit_bg"],habla_pre_chat_submit_input:["habla_pre_chat_form_field","habla_offline_submit_input","hbl_pal_offline_submit_fg","hbl_pal_control_border","hbl_pal_offline_submit_bg"],habla_offline_error_span:["habla_offline_error_span"],habla_pre_chat_clear_div:["clear_style"],habla_conversation_p_item:["habla_conversation_p_item","hbl_pal_main_fg"],habla_conversation_person1:["habla_conversation_person1",
"hbl_pal_local_fg"],habla_conversation_person2:["habla_conversation_person2","hbl_pal_remote_fg"],habla_conversation_text_span:["habla_conversation_text_span","hbl_pal_main_fg"],habla_conversation_notification_nickname:["habla_conversation_person2","hbl_pal_remote_fg","habla_conversation_notification_nickname"],habla_conversation_notification_text_span:["habla_conversation_text_span","hbl_pal_main_fg","habla_conversation_notification"],habla_topbar_div_compressed:["habla_topbar_div_normal","hbl_pal_title_fg",
"hbl_pal_title_bg","habla_topbar_div_compressed"],habla_topbar_div:["habla_topbar_div_normal","hbl_pal_title_fg","hbl_pal_title_bg","habla_topbar_div_expanded"],habla_topbar_div_highlighted:["habla_topbar_div_highlighted","hbl_pal_title_fg_highlight","hbl_pal_title_bg_highlight","habla_topbar_div_expanded"]};a.vars={habla_sizebutton_text_expanded:"_",habla_sizebutton_text_compressed:"^",habla_closebutton_text:"x",habla_popout_text:">",habla_end_popout_text:"&lt;&lt;",_habla_link_div:"padding: 3px 0 5px 0 !important; font-family: helvetica, sans-serif; text-align: center; text-transform: uppercase; font-size: 9px; letter-spacing: 2px; font-weight: bold; color: #aaa !important;",
_habla_link_a:"font-family: helvetica, sans-serif; text-transform: uppercase; font-size: 9px !important; letter-spacing: 2px; font-weight: bold; color: #e75917 !important;"};this.config.merge(a);a=new hbl.hconfig;a.load_defaults();this.config.merge(a);hbl.client.pollingmanager.setLongPoll(!this.config.vars.poll);this.config.remap_palette();this.config.remap_palette();if(this.config.vars.right_to_left)this.config.vars.local_user_display_name="&larr;";this.config.vars.enable_buttons&&(this.config.style_classes_map.habla_topbar_div=
["habla_topbar_div_normal","habla_topbar_clickable","hbl_pal_title_fg","hbl_pal_title_bg","habla_topbar_div_expanded"]);if(this.config.vars.corner_position)this.config.vars.corner_position=this.__getAdjustedPosition(this.config.vars.corner_position)};this.build_dom=function(a,b){if(document.getElementById(this.divid))this.appended=!1;this.habla_container=hbl.util.find_or_create_div(this.divid,this.config.vars.not_append==void 0?hbl.util.get_body():void 0);this.habla_container.id="habla_beta_container_do_not_rely_on_div_classes_or_names";
this.habla_container.className=this.__get_browser_class()+" "+this.__get_mobile_class()+" "+(document.compatMode=="BackCompat"?"olrk-quirks":"olrk-noquirks");var j=hbl.util.find_or_create_div("hbl_operator_state_div",this.habla_container);j.className="olrk-unknown";olark("api.chat.onOperatorsAvailable",function(){j.className="olrk-available"});olark("api.chat.onOperatorsAway",function(){j.className="olrk-away"});var e=hbl.util.find_or_create_div("hbl_region",j);e.className=this.config.vars.right_to_left?
"olrk-rtl":"olrk-normal";this.window_state_div=hbl.util.find_or_create_div("habla_window_state_div",e);this.window_state_div.className=this.config.vars.show_end_popout?"olrk-state-popout":" olrk-state-compressed";this.habla_window_div=hbl.util.find_or_create_div(this.divid,this.window_state_div);b||hbl.util.hide_div(this.habla_window_div);if(e=this.config.vars.corner_position&&this.config.vars.corner_position.match(/B/))this.habla_compressed_div=hbl.util.find_or_create_div("habla_compressed_div",
this.habla_window_div);this.habla_panel_div=hbl.util.find_or_create_div("habla_panel_div",this.habla_window_div);this.habla_both_div=hbl.util.find_or_create_div("habla_both_div",this.habla_panel_div);hbl.util.hide_div(this.habla_panel_div);this.habla_topbar_div=hbl.util.find_or_create_div("habla_topbar_div",this.habla_both_div);if(this.config.vars.add_tab_closure_span)this.olrk_tab_closure_span=hbl.util.find_or_create_el("olrk_tab_closure_span","span"),this.habla_both_div.appendChild(this.olrk_tab_closure_span);
this.habla_expanded_div=hbl.util.find_or_create_div("habla_expanded_div",this.habla_panel_div);if(!e)this.habla_compressed_div=hbl.util.find_or_create_div("habla_compressed_div",this.habla_window_div);if(this.config.vars.left_align_widget)this.habla_compressed_div.className="olrk-left-align";this.habla_closed_div=hbl.util.find_or_create_div("habla_closed_div",this.habla_window_div);a||this.hide();this.habla_oplink_a=hbl.util.find_or_create_el("habla_oplink_a","a");this.config.vars.append_oplink_before_buttons&&
this.habla_topbar_div.appendChild(this.habla_oplink_a);if(this.config.vars.show_end_popout)this.habla_end_popout_a=hbl.util.find_or_create_el("habla_end_popout_a","a"),this.habla_topbar_div.appendChild(this.habla_end_popout_a);else if(this.config.vars.show_popout)this.habla_popout_a=hbl.util.find_or_create_el("habla_popout_a","a"),this.habla_topbar_div.appendChild(this.habla_popout_a);if(this.config.vars.enable_buttons&&!this.config.vars.hide_min_max_buttons)this.habla_closebutton_a=hbl.util.find_or_create_el("habla_closebutton_a",
"a"),this.config.vars.close_hides_window&&this.habla_topbar_div.appendChild(this.habla_closebutton_a),this.habla_sizebutton_a=hbl.util.find_or_create_el("habla_sizebutton_a","a"),this.habla_topbar_div.appendChild(this.habla_sizebutton_a);this.config.vars.append_oplink_before_buttons||this.habla_topbar_div.appendChild(this.habla_oplink_a);e=function(a){var c=document.createElement("div");c.className="hbl_txt_wrapper";c.appendChild(a);return c};this.habla_middle_div=hbl.util.find_or_create_div("habla_middle_div",
this.habla_expanded_div);var l=hbl.util.find_or_create_div("habla_middle_wrapper_div",this.habla_middle_div);this.habla_conversation_div=hbl.util.find_or_create_div("habla_conversation_div",l);this.habla_offline_message_sent_div=hbl.util.find_or_create_div("habla_offline_message_sent_div",l);this.habla_offline_message_sent_div.style.display="none";this.habla_offline_message_span=hbl.util.find_or_create_el("habla_offline_message_span","span");this.habla_offline_message_div=hbl.util.find_or_create_div("habla_offline_message_div",
l);this.habla_offline_message_div.style.display="none";this.habla_name_input=hbl.util.find_or_create_el("habla_name_input","textarea");this.habla_offline_phone_input=hbl.util.find_or_create_el("habla_offline_phone_input","textarea");this.habla_offline_email_input=hbl.util.find_or_create_el("habla_offline_email_input","textarea");this.habla_offline_body_input=hbl.util.find_or_create_el("habla_offline_body_input","textarea");this.habla_offline_clear_div=hbl.util.find_or_create_el("habla_offline_clear_div",
"div");this.habla_offline_submit_input=hbl.util.find_or_create_el("habla_offline_submit_input","input");try{this.habla_offline_submit_input.setAttribute("type","submit")}catch(d){}this.habla_offline_error_span=hbl.util.find_or_create_el("habla_offline_error_span","span");this.habla_offline_message_div.appendChild(this.habla_offline_message_span);this.habla_offline_message_div.appendChild(e(this.habla_name_input));this.habla_offline_message_div.appendChild(e(this.habla_offline_email_input));hbl.config.vars.require_offline_phone>
0&&this.habla_offline_message_div.appendChild(e(this.habla_offline_phone_input));this.habla_offline_message_div.appendChild(e(this.habla_offline_body_input));hbl.config.vars.disable_extra_br||this.habla_offline_message_div.appendChild(hbl.util.find_or_create_el("habla_br","br"));this.habla_offline_message_div.appendChild(this.habla_offline_error_span);this.habla_offline_message_div.appendChild(this.habla_offline_submit_input);this.habla_offline_message_div.appendChild(this.habla_offline_clear_div);
this.habla_pre_chat_span=hbl.util.find_or_create_el("habla_pre_chat_span","span");this.habla_pre_chat_div=hbl.util.find_or_create_div("habla_pre_chat_div",l);this.habla_pre_chat_div.style.display="none";this.habla_pre_chat_name_input=hbl.util.find_or_create_el("habla_pre_chat_name_input","textarea");this.habla_pre_chat_clear_div=hbl.util.find_or_create_el("habla_pre_chat_clear_div","div");this.habla_pre_chat_email_input=hbl.util.find_or_create_el("habla_pre_chat_email_input","textarea");this.habla_pre_chat_phone_input=
hbl.util.find_or_create_el("habla_pre_chat_phone_input","textarea");this.habla_pre_chat_submit_input=hbl.util.find_or_create_el("habla_pre_chat_submit_input","input");try{this.habla_pre_chat_submit_input.setAttribute("type","submit")}catch(i){}this.habla_pre_chat_error_span=hbl.util.find_or_create_el("habla_pre_chat_error_span","span");this.habla_pre_chat_div.appendChild(this.habla_pre_chat_span);this.habla_pre_chat_div.appendChild(e(this.habla_pre_chat_name_input));this.habla_pre_chat_div.appendChild(e(this.habla_pre_chat_email_input));
this.habla_pre_chat_div.appendChild(e(this.habla_pre_chat_phone_input));hbl.config.vars.disable_extra_br||this.habla_pre_chat_div.appendChild(hbl.util.find_or_create_el("habla_br_2","br"));this.habla_pre_chat_div.appendChild(this.habla_pre_chat_error_span);this.habla_pre_chat_div.appendChild(this.habla_pre_chat_submit_input);this.habla_pre_chat_div.appendChild(this.habla_pre_chat_clear_div);this.habla_chatform_form=hbl.util.find_or_create_el("habla_chatform_form","form");this.habla_chatform_form.setAttribute("action",
"#");this.habla_chatform_form.setAttribute("method","GET");this.habla_chatform_form.setAttribute("autocomplete","off");this.habla_input_div=hbl.util.find_or_create_el("habla_input_div","div");this.habla_wcsend_input=hbl.util.find_or_create_el("habla_wcsend_input","textarea");this.habla_wcsend_input.setAttribute("size",this.config.vars.input_box_size);this.habla_input_div.appendChild(e(this.habla_wcsend_input));if(hbl.util.BrowserDetect.need_submit_button){this.habla_submit_button=hbl.util.find_or_create_el("habla_submit_button",
"input");try{this.habla_submit_button.setAttribute("type","button")}catch(t){}this.habla_input_div.appendChild(this.habla_submit_button)}this.habla_chatform_form.appendChild(this.habla_input_div);this.habla_middle_div.appendChild(this.habla_chatform_form)};this.set_events=function(a,b){if(typeof a!="undefined"){var j=function(b,j,d){return function(i){var g;if(!i)i=window.event;if(i.target)g=i.target;else if(i.srcElement)g=i.srcElement;if(g.nodeType==3)g=g.parentNode;if(g==a&&(habla_window.eventmgr.handle(b+
"_"+j,{target:g,event:i}),d&&(i.cancelBubble=!0,i.stopPropagation)))return i.stopPropagation(),!1}};a.onblur=j(b,"onblur");a.onfocus=j(b,"onfocus");a.onclick=j(b,"onclick",!0);a.onmouseover=j(b,"onmouseover");a.onmouseout=j(b,"onmouseout")}};this.set_dom_event_handlers=function(){if(this.habla_submit_button)this.habla_submit_button.onclick=function(){habla_window.eventmgr.handle("window_form_submit",{event:void 0})};this.set_events(this.habla_wcsend_input,"habla_wcsend_input",!0);this.set_events(this.habla_name_input,
"habla_name_input");this.set_events(this.habla_offline_email_input,"habla_offline_email_input");this.set_events(this.habla_offline_phone_input,"habla_offline_phone_input");this.set_events(this.habla_offline_body_input,"habla_offline_body_input");this.set_events(this.habla_offline_submit_input,"habla_offline_submit_input");this.set_events(this.habla_pre_chat_email_input,"habla_pre_chat_email_input");this.set_events(this.habla_pre_chat_phone_input,"habla_pre_chat_phone_input");this.set_events(this.habla_pre_chat_name_input,
"habla_pre_chat_name_input");this.set_events(this.habla_pre_chat_submit_input,"habla_pre_chat_submit_input");this.habla_conversation_div.onclick=function(){return habla_window.eventmgr.handle("habla_conversation_div_onclick")};this.habla_chatform_form.onfocus=function(){habla_window.eventmgr.handle("habla_chatform_form_onfocus")};this.habla_chatform_form.onsubmit=function(a){habla_window.eventmgr.handle("window_form_submit",{event:a});return!1};this.habla_pre_chat_phone_input.onkeypress=function(a){if(!a)a=
window.event;keynum=void 0;if(window.event)a=window.event,keynum=a.keyCode;else if(a.which)keynum=a.which;if(keynum==13||keynum==10)return habla_window.eventmgr.handle("habla_pre_chat_submit_input_onclick"),!1};this.habla_pre_chat_email_input.onkeypress=function(a){if(!a)a=window.event;keynum=void 0;if(window.event)a=window.event,keynum=a.keyCode;else if(a.which)keynum=a.which;if(keynum==13||keynum==10)return habla_window.eventmgr.handle("habla_pre_chat_submit_input_onclick"),!1};this.habla_pre_chat_name_input.onkeypress=
function(a){if(!a)a=window.event;keynum=void 0;if(window.event)a=window.event,keynum=a.keyCode;else if(a.which)keynum=a.which;if(keynum==13||keynum==10)return habla_window.eventmgr.handle("habla_pre_chat_submit_input_onclick"),!1};this.habla_wcsend_input.onkeydown=function(a){if(!a)a=window.event;(function(b){function j(a){olark.__legacy_shim.disableComposing||hbl.client.sendcommand("send_compose_state",a)}function e(){clearTimeout(b.visitorHasPausedTyping);b.visitorHasPausedTyping=setTimeout(function(){l();
j(d.PAUSED)},i)}function l(){clearTimeout(b.visitorHasPausedTyping);j(d.ACTIVE);b.visitorHasStartedTyping=!1}var d={ACTIVE:"active",INACTIVE:"inactive",COMPOSING:"composing",PAUSED:"paused"},i=3E3;b.visitorHasStartedTyping=b.visitorHasStartedTyping||!1;b.visitorHasPausedTyping=b.visitorHasPausedTyping||-1;switch(a.keyCode){case 10:case 13:l();break;default:if(habla_window.theme.habla_wcsend_input.value=="")l();else{if(!b.visitorHasStartedTyping)b.visitorHasStartedTyping=!0,j(d.COMPOSING);e()}}})(this);
if(!habla_window.theme.habla_wcsend_input.has_typed)return a.keyCode!=13&&a.keyCode!=10?habla_window.setInputBox(habla_window.theme.habla_wcsend_input,String.fromCharCode(a.keyCode),"highlight"):habla_window.setInputBox(habla_window.theme.habla_wcsend_input,"","highlight"),habla_window.theme.habla_wcsend_input.has_typed=!0,!1;(function(){function a(d,i){function g(){b=!1}if(b)return!1;else{var e=i.parentNode||document.body||document.documentElement;b=!0;setTimeout(g,600);if(typeof c=="undefined")c=
document.createElement("olark"),c.style.display="block",c.style.visibility="hidden",c.style.position="absolute",e.appendChild(c);var l=d.replace(/(\<|\>)/g,"^");c.innerHTML=l;l=parseInt(c.offsetWidth)>=parseInt(i.offsetWidth);e.removeChild(c);return l}}var b=!1,c;if(!habla_window.config.vars.disable_expand_text_input&&!habla_window.expanded_textbox&&a(habla_window.theme.getMessageInputFieldValue(),habla_window.theme.getMessageInputField())){habla_window.expanded_textbox=!0;habla_window.setInputHeight(habla_window.config.vars.resize_input_height);
var e=habla_window.theme.habla_wcsend_input.parentNode;e.className=e.className.replace("hbl_long_text_entered","")+" hbl_long_text_entered"}if(!habla_window.config.vars.disable_expand_text_input&&habla_window.expanded_textbox&&habla_window.theme.getMessageInputFieldValue().length<habla_window.config.vars.resize_length)habla_window.expanded_textbox=!1,habla_window.setInputHeight(habla_window.config.vars.input_height),e=habla_window.theme.habla_wcsend_input.parentNode,e.className=e.className.replace("hbl_long_text_entered",
"")+" hbl_long_text_entered"})();if(a.keyCode==13||a.keyCode==10){if(habla_window.theme.getMessageInputFieldValue().replace(/^\s*|\s*$/g,"")=="")return;habla_window.expanded_textbox=!1;habla_window.setInputHeight(habla_window.config.vars.input_height);habla_window.eventmgr.handle("window_submit",{event:a});return!1}return!0};this.set_events(this.habla_oplink_a,"habla_oplink_a");this.config.vars.show_end_popout?this.set_events(this.habla_end_popout_a,"habla_end_popout_a"):this.config.vars.show_popout&&
this.set_events(this.habla_popout_a,"habla_popout_a");this.config.vars.enable_buttons?(this.habla_topbar_div.onclick=function(a){habla_window.eventmgr.handle("window_topbar_clicked");if(!a)a=window.event;a.cancelBubble=!0;a.stopPropagation&&a.stopPropagation();return!1},this.config.vars.hide_min_max_buttons||(this.set_events(this.habla_closebutton_a,"habla_closebutton_a"),this.set_events(this.habla_sizebutton_a,"habla_sizebutton_a"))):this.habla_oplink_a.onclick=function(){return!1}};this.styles=
[];this.set_css_style=function(a){if(a)if(a=a.replace("static.olark.com",hbl_static_hostname),/^\s*http/i.test(a)||(a=hbl_ext+"://"+a),a+="?"+hbl_ext,this.style_div){var b=hbl.util.find_or_create_el("habla_style_div_alternative","link");b.setAttribute("type","text/css");b.setAttribute("rel","alternative stylesheet");hbl.util.get_head().appendChild(b);b.setAttribute("href",a);a=document.getElementById("habla_style_div");b=document.getElementById("habla_style_div_alternative");a.setAttribute("rel",
"alternative stylesheet");b.setAttribute("rel","stylesheet");a.id="habla_style_div_alternative";b.id="habla_style_div"}else this.style_div=hbl.util.find_or_create_el("habla_style_div","link"),this.style_div.setAttribute("type","text/css"),this.style_div.setAttribute("rel","stylesheet"),hbl.util.get_head().appendChild(this.style_div),this.style_div.setAttribute("href",a)};this.load_styles=function(){var a=this.config.vars.legacy_css_for_linkfollow;if(window.__olark_iframe_wrapper&&a)this.set_css_style(a);
else if(!this.config.vars.disableJSStyles||this.config.vars.force_olark_css){a=hbl.util.BrowserDetect.use_position_absolute_on_ie;var b=document.compatMode=="BackCompat"?!0:!1,j=void 0;j=window.__olark_popout?this.config.vars.popout_css_url?this.config.vars.popout_css_url:hbl_static_hostname+"/themes/azul_popout/preview_theme.css?"+hblCacheConstant:this.config.vars.inline_css_url?a?b&&this.config.vars.inline_css_url_quirks?this.config.vars.inline_css_url_quirks:this.config.vars.inline_css_url_ie?
this.config.vars.inline_css_url_ie:this.config.vars.inline_css_url:b&&this.config.vars.inline_css_url_quirks?this.config.vars.inline_css_url_quirks:this.config.vars.inline_css_url:a?hbl_static_hostname+"/themes/defaults/base.ie.css?"+hblCacheConstant:hbl_static_hostname+"/themes/defaults/base.css?"+hblCacheConstant;this.set_css_style(j)}};this.render_styles=function(){if(!this.config.vars.require_name)this.habla_pre_chat_name_input.style.display="none",this.habla_pre_chat_name_input.parentNode.style.display=
"none";if(!this.config.vars.require_phone)this.habla_pre_chat_phone_input.style.display="none",this.habla_pre_chat_phone_input.parentNode.style.display="none";if(!this.config.vars.require_email)this.habla_pre_chat_email_input.style.display="none",this.habla_pre_chat_email_input.parentNode.style.display="none";this.config.render_all_styles(this)};this.setInputBox=function(a,b,j,e){a.value=b;this.setInputBoxStyle(a,j,e)};this.setInputBoxStyle=function(a,b,j){j?this.config.set_element_classes(a,"habla_wcsend_input_post"):
this.config.set_element_classes(a,"habla_wcsend_input_pre");b=="normal"?this.config.set_element_classes(a,"habla_wcsend_input"):b=="highlight"&&this.config.set_element_classes(a,"habla_wcsend_input_highlighted")};this.set_default_text=function(){this.set_default_text_event(this.habla_name_input,"habla_name_input",this.config.vars.habla_name_input_text);this.set_default_text_event(this.habla_offline_email_input,"habla_offline_email_input",this.config.vars.habla_offline_email_text);this.set_default_text_event(this.habla_offline_phone_input,
"habla_offline_phone_input",this.config.vars.habla_offline_phone_text);this.set_default_text_event(this.habla_offline_body_input,"habla_offline_body_input",this.config.vars.habla_offline_body_text);this.set_default_text_event(this.habla_pre_chat_name_input,"habla_pre_chat_name_input",this.config.vars.habla_name_input_text);this.set_default_text_event(this.habla_pre_chat_email_input,"habla_pre_chat_email_input",this.config.vars.habla_offline_email_text);this.set_default_text_event(this.habla_pre_chat_phone_input,
"habla_pre_chat_phone_input",this.config.vars.habla_offline_phone_text);this.set_default_text_event(this.habla_wcsend_input,"habla_wcsend_input",this.config.vars.textbox_message||this.config.vars.say_text);this.habla_offline_submit_input.value=this.config.vars.habla_offline_submit_value;this.set_events(this.habla_wcsend_input,"habla_wcsend_input");this.set_events(this.habla_offline_email_input,"habla_offline_email_input");this.set_events(this.habla_offline_phone_input,"habla_offline_phone_input");
this.set_events(this.habla_offline_body_input,"habla_offline_body_input");this.set_events(this.habla_offline_submit_input,"habla_offline_submit_input");this.habla_offline_message_sent_div.innerHTML=this.config.vars.habla_offline_sent_text;if(this.habla_closebutton_a)this.habla_closebutton_a.innerHTML=this.config.vars.habla_closebutton_text;if(this.habla_sizebutton_a)this.habla_sizebutton_a.innerHTML=this.config.vars.habla_sizebutton_text_compressed;if(this.habla_popout_a)this.habla_popout_a.innerHTML=
this.config.vars.habla_popout_text;if(this.habla_end_popout_a)this.habla_end_popout_a.innerHTML=this.config.vars.habla_end_popout_text;if(this.habla_submit_button)this.habla_submit_button.value=this.config.vars.send_text;if(this.habla_pre_chat_submit_input)this.habla_pre_chat_submit_input.value=this.config.vars.pre_chat_submit;this.habla_pre_chat_span.innerHTML=this.config.vars.pre_chat_message;this.setHeader(this.config.vars.check_for_status);window.olark.__legacy_shim.has_messages_in_history!=!0&&
this.setBody(this.config.vars.welcome_msg)};this.set_default_text_event=function(a,b,j){"placeholder"in a?(this.setInputBox(a,""),a.placeholder=j,a.has_typed=!1,hbl.eventmgr.register(b+"_onblur",function(a){a.target.has_typed=a.target.value==""?!1:!0}),a=function(a){a.target.has_typed=!0},hbl.eventmgr.register(b+"_onfocus",a),hbl.eventmgr.register(b+"_onclick",a)):(this.setInputBox(a,j),a.default_text=j,a.has_typed=!1,hbl.eventmgr.register(b+"_onblur",function(a){a.window.theme.setInputBoxStyle(a.target,
"normal");if(a.target.value=="")a.target.value=a.target.default_text,a.target.has_typed=!1},0),hbl.eventmgr.register(b+"_onclick",function(a){if(!a.target.has_typed)a.target.has_typed=!0,a.window.setInputBox(a.target,"","highlight");a.window.theme.setInputBoxStyle(a.target,"highlight")},0),hbl.eventmgr.register(b+"_onfocus",function(a){if(!a.target.has_typed)a.target.has_typed=!0,a.window.setInputBox(a.target,"","highlight");a.window.theme.setInputBoxStyle(a.target,"highlight")},0))};this.set_rollover_event=
function(a,b,j,e){if(a)a.on_class=e,a.off_class=j,hbl.eventmgr.register(b+"_onmouseover",function(a){a.window.config.set_element_classes(a.target,a.target.on_class)},0),hbl.eventmgr.register(b+"_onmouseout",function(a){a.window.config.set_element_classes(a.target,a.target.off_class)},0),hbl.eventmgr.register(b+"_onclick",function(a){a.window.config.set_element_classes(a.target,a.target.off_class)},0)};this.register_handlers=function(){this.set_rollover_event(this.habla_popout_a,"habla_popout_a","habla_button_normal",
"habla_button_hover");this.set_rollover_event(this.habla_end_popout_a,"habla_end_popout_a","habla_button_normal","habla_button_hover");this.set_rollover_event(this.habla_sizebutton_a,"habla_sizebutton_a","habla_button_normal","habla_button_hover");this.set_rollover_event(this.habla_closebutton_a,"habla_closebutton_a","habla_button_normal","habla_button_hover");this.set_rollover_event(this.habla_oplink_a,"habla_oplink_a","habla_oplink_a","habla_oplink_hover");hbl.eventmgr.register("habla_conversation_div_onclick",
function(){habla_window.eventmgr.handle("window_click")},0);hbl.eventmgr.register("habla_chatform_form_onfocus",function(){habla_window.eventmgr.handle("window_focus")},0);hbl.eventmgr.register("habla_popout_a_onclick",function(a){a.window.popout()},0);hbl.eventmgr.register("habla_end_popout_a_onclick",function(a){a.window.end_popout();setTimeout(function(){window.close()},2)},0);hbl.eventmgr.register("habla_wcsend_input_onclick",function(a){a.window.eventmgr.handle("window_focus")},0);hbl.eventmgr.register("habla_pre_chat_submit_input_onclick",
function(a){var b=a.window.config,j=a.window.theme.habla_pre_chat_email_input,e=a.window.theme.habla_pre_chat_name_input,l=a.window.theme.habla_pre_chat_phone_input,d=j.value?hbl.util.strip_whitespace(j.value):void 0,i=e.value?hbl.util.strip_whitespace(e.value):void 0,t=l.value?hbl.util.strip_whitespace(l.value):void 0;e=e.has_typed?!0:!1;l=l.has_typed&&hbl.util.is_valid_phone(t)?!0:!1;var r=j.has_typed&&hbl.util.is_valid_email(d)?!0:!1;!r&&e&&hbl.util.is_valid_email(i)&&(e=i,i=d,d=e,r=!0,e=j.has_typed?
!0:!1);(b.vars.require_name<=1||e)&&(b.vars.require_phone<=1||l)&&(b.vars.require_email<=1||r)?(a.window.theme.habla_pre_chat_error_span.innerHTML="",window.olark.__legacy_shim.send_prechat_info({name:i,email:hbl.util.is_valid_email(d)?d:null,phone:hbl.util.is_valid_phone(t)?t:null}),a.window.theme.pre_chat_sent=!0,a.window.setShowPreChat(!1)):a.window.theme.habla_pre_chat_error_span.innerHTML=a.window.config.vars.pre_chat_error_text},0);hbl.eventmgr.register("habla_offline_submit_input_onclick",
function(a){var b=a.window.theme.habla_offline_body_input,j=a.window.theme.habla_offline_email_input,e=a.window.theme.habla_offline_phone_input,l=a.window.theme.habla_name_input,d=a.window.theme.config.vars.require_offline_phone;if(a.window.theme.message_sent)a.window.theme.setOfflineWindow(a.window.theme.config.vars.habla_offline_sent_text||" ");else{var i=hbl.util.strip_whitespace(j.value);b.has_typed&&j.has_typed&&hbl.util.is_valid_email(i)&&(d<=1||hbl.util.is_valid_phone(e.value))?(a.window.theme.message_sent=
!0,tocall=hblPostURL+"?site_id="+olark._.identityManager.getSiteId()+"&"+hbl.util.urlencode({body:b.value,email:j.value,name:l.value,phone:e.value,location:document.location,referrer:document.referrer}),a.window.theme.habla_offline_error_span.innerHTML=a.window.config.vars.sending_text,hbl.util.load_js_async(tocall),olark("api.visitor.updateEmailAddress",i),olark("api.visitor.updateFullName",l.value),olark("api.visitor.updatePhoneNumber",e.value),hbl.client.sendofflinemessage(b.value,{email:i,name:l.value,
phone:e.value,location:document.location,referrer:document.referrer}),a.window.eventmgr.handle("offlineMessageToOperator",{body:b.value,nickname:l.value}),a.window.theme.setOfflineWindow(a.window.theme.config.vars.habla_offline_sent_text||" ")):a.window.theme.habla_offline_error_span.innerHTML=a.window.config.vars.email_body_error_text}},0);hbl.eventmgr.register("habla_wcsend_input_onmouseover",function(a){a.window.eventmgr.handle("window_focus")},0)};this.remove=function(){this.appended&&hbl.util.remove_element(this.divid)};
this.setShowPreChat=function(a){if(!window.olark||!window.olark.__legacy_shim||!window.olark.__legacy_shim.ignore_prechat_status)a?this.showOnlyThisDiv(this.habla_pre_chat_div):this.showOnlyThisDiv(this.habla_conversation_div)};this.showOnlyThisDiv=function(a){var b=this.habla_conversation_div,j=this.habla_offline_message_div,e=this.habla_offline_message_sent_div,l=this.habla_pre_chat_div,d=this.habla_chatform_form,i=this.habla_wcsend_input;if(a==b){if(b.style.display="block",j.style.display="none",
e.style.display="none",l.style.display="none",habla_window.get_operator_state()!="notavailable")d.style.display="block",i.style.display="block"}else if(a==j)b.style.display="none",j.style.display="block",e.style.display="none",l.style.display="none",d.style.display="none",i.style.display="none";else if(a==e)b.style.display="none",j.style.display="none",e.style.display="block",l.style.display="none",d.style.display="none",i.style.display="none";else if(a==l)b.style.display="none",j.style.display="none",
e.style.display="none",l.style.display="block",d.style.display="none",i.style.display="none";olark._.needsFirstTimeOperatorLogin?(this.habla_name_input.style.display="none",this.habla_offline_email_input.style.display="none",this.habla_offline_phone_input.style.display="none",this.habla_offline_body_input.style.display="none",this.habla_offline_submit_input.style.display="none"):(this.habla_name_input.style.display="block",this.habla_offline_email_input.style.display="block",this.habla_offline_phone_input.style.display=
"block",this.habla_offline_body_input.style.display="block",this.habla_offline_submit_input.style.display="block")};this.setOfflineWindow=function(a){if(!window.olark||!window.olark.__legacy_shim||!window.olark.__legacy_shim.ignore_prechat_status){var b=this.config.vars.show_pre_chat&&this.config.vars.disable_offline_messaging_fallback!=!0&&habla_window.get_operator_state()=="notavailable";!a&&!b?(this.offline_window=!1,this.showOnlyThisDiv(this.habla_conversation_div)):(this.habla_offline_message_span.innerHTML=
a||this.config.vars.offline_message,this.message_sent?(this.showOnlyThisDiv(this.habla_offline_message_sent_div),this.offline_window=!1):(this.offline_window=!0,this.showOnlyThisDiv(this.habla_offline_message_div)))}};this.scroll_conversation_history_to_most_recent=function(){var a=this;setTimeout(function(){a.habla_conversation_div.scrollTop=a.habla_conversation_div.scrollHeight},10)};this.setBody=function(a){if(!hbl.client.buffer.length||!hbl.client.is_conversation()){this.habla_conversation_div.innerHTML=
"";this.config.render_class(this.habla_conversation_div,"habla_conversation_message_off","habla_conversation_message_on");if(a!="")a=hbl.util.as_dom(a),this.config.render_class(this.habla_conversation_div,"habla_conversation_message_on","habla_conversation_message_off"),this.habla_conversation_div.appendChild(a),a.id="hbl_body_message";this.scroll_conversation_history_to_most_recent()}};this.disableMessageInput=function(a){this.habla_wcsend_input.disabled=!0;this.habla_wcsend_input.value=a||""};this.getBody=
function(){return this.habla_conversation_div.innerHTML};var a={},b=null,e=function(a){var b=document.createElement("div");b.appendChild(document.createTextNode(a));a=b.innerHTML;delete b;return a};this.appendNiceMessage=function(c,g,j,m){if(!(g==void 0||c==void 0)){g&&(g=e(g));m||(g=this.display_pipeline.run(g));if(g){window.olark&&window.olark.__legacy_shim&&window.habla_window&&(g=hbl.hwindow_util.wrap_and_create_links(g,window.habla_window));m=hbl.client.op_nickname_map[c];var l=null;if(hbl.config.vars.operators&&
m&&hbl.config.vars.operators[m.toString()])l=hbl.config.vars.operators[m.toString()].avatar_url;document.location.protocol==="https:"&&typeof l=="string"&&(l=l.replace("http://","https://"));m=document.createElement("p");if(l&&!a[c]){a[c]=!0;var d=document.createElement("img");d.className="olrk_avatar";d.src=l;m.appendChild(d)}this.config.set_element_classes(m,"habla_conversation_p_item");b!=null&&b!=c&&(m.className+=" olrk_new_sender");b=c;l=document.createElement("span");var i=document.createElement("span");
if(c===this.config.vars.myname)this.config.set_element_classes(l,"habla_conversation_person1"),this.config.set_element_classes(i,"habla_conversation_text_span"),c=this.config.vars.local_user_display_name,c==="&rarr;"||c==="&larr;"?l.innerHTML=c:hbl.util.set_inner_text(l,c);else if(/^INTERNAL_NOTIFICATION/.test(c)){this.config.set_element_classes(l,"habla_conversation_notification_nickname");this.config.set_element_classes(i,"habla_conversation_notification_text_span");hbl.util.set_inner_text(l,"");
var t=c.split("-");c=t.slice(2).join("-");t=t.slice(0,2);t.push(c);t.length===3&&setTimeout(function(){olark.__core.trigger_event({namespace:"chat",type:"interfaceElementReady",extensionName:t[1],key:t[2],dom:i})},0)}else this.config.set_element_classes(l,"habla_conversation_person2"),this.config.set_element_classes(i,"habla_conversation_text_span"),(c=this.config.vars.local_name_override?this.config.vars.local_name_override:c)&&!/^\s*$/.test(c)?hbl.util.set_inner_text(l,c+": "):hbl.util.set_inner_text(l,
c);i.innerHTML=g;m.appendChild(l);m.appendChild(i);this.appendMessage(m,j)}window.habla_window.theme.scroll_conversation_history_to_most_recent()}};this.appendMessage=function(a,b){this.last_msg==-1&&b&&this.setBody("");a=hbl.util.as_dom(a);this.last_msg+=1;a.setAttribute("id","habla_msg_"+this.last_msg);this.habla_conversation_div.appendChild(a);this.scroll_conversation_history_to_most_recent()};this.setHeader=function(a){this.habla_oplink_a.innerHTML=a};this.getHeader=function(){return this.habla_oplink_a.innerHTML};
this.hide=function(){this.visible=!1;if(this.habla_conversation_div)this.habla_conversation_div.style.overflow="hidden";hbl.util.hide_div(this.habla_window_div);hbl.util.hide_div(this.habla_panel_div);hbl.util.hide_div(this.habla_both_div);hbl.util.hide_div(this.habla_closed_div);hbl.util.hide_div(this.habla_expanded_div);hbl.util.hide_div(this.habla_compressed_div)};this.focus_on_the_input_box=function(){var a=this,b=document.activeElement&&document.activeElement.tagName?document.activeElement.tagName:
null;if(!b||!/^(input|textarea|select|option|button|optgroup|form)$/i.test(b))a.config.vars.disable_input_focusing||(!window.olark||!window.olark.__legacy_shim||!window.olark.__legacy_shim.disable_input_focusing)&&!a.config.vars.is_inline&&!a.config.vars.disableFocus&&a.habla_wcsend_input&&a.habla_chatform_form.style.display!="none"&&setTimeout(function(){if(a.habla_chatform_form.style.display!="none")try{a.habla_wcsend_input.focus()}catch(b){}},20)};this.expand=function(){this.__set_css_window_state("expanded");
if(this.habla_sizebutton_a&&this.config.vars.habla_sizebutton_text_expanded)this.habla_sizebutton_a.innerHTML=this.config.vars.habla_sizebutton_text_expanded;this.show();this.focus_on_the_input_box()};this.compress=function(){this.__set_css_window_state("compressed");if(this.habla_sizebutton_a&&this.config.vars.habla_sizebutton_text_compressed)this.habla_sizebutton_a.innerHTML=this.config.vars.habla_sizebutton_text_compressed;this.show()};this.show=function(){if(this.ready)if(this.visible=!0,this.config.vars.disableJSStyles&&
hbl.util.show_div(this.habla_window_div),this.state=="closed")hbl.util.hide_div(this.habla_expanded_div),hbl.util.hide_div(this.habla_panel_div),hbl.util.hide_div(this.habla_compressed_div),this.habla_conversation_div.style.overflow="hidden",hbl.util.show_div(this.habla_closed_div);else if(this.state=="expanded"){hbl.util.hide_div(this.habla_compressed_div);hbl.util.hide_div(this.habla_closed_div);hbl.util.show_div(this.habla_panel_div);hbl.util.show_div(this.habla_expanded_div);hbl.util.show_div(this.habla_both_div);
this.habla_conversation_div.style.overflow="auto";this.scroll_conversation_history_to_most_recent();if(this.habla_sizebutton_a)this.habla_sizebutton_a.innerHTML=this.config.vars.habla_sizebutton_text_expanded;this.focus_on_the_input_box();this.normal()}else if(this.state=="compressed"&&(hbl.util.hide_div(this.habla_expanded_div),hbl.util.hide_div(this.habla_closed_div),hbl.util.show_div(this.habla_panel_div),hbl.util.show_div(this.habla_both_div),hbl.util.show_div(this.habla_compressed_div),this.habla_conversation_div.style.overflow=
"hidden",this.config.set_element_classes(this.habla_topbar_div,"habla_topbar_div_compressed"),this.habla_sizebutton_div))this.habla_sizebutton_div.innerHTML=this.config.vars.habla_sizebutton_text_compressed};this.close=function(){this.__set_css_window_state("closed");this.show()};this.__set_css_window_state=function(a){this.state=a;this.window_state_div.className=(this.config.vars.show_end_popout?"olrk-state-popout":"")+"olrk-state-"+a};this.__get_browser_class=function(){return"habla-browser-"+hbl.util.BrowserDetect.browser.toLowerCase()};
this.__get_mobile_class=function(){return navigator.userAgent.match(/Android/i)&&navigator.userAgent.match(/Mobile/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)?"habla-mobile":navigator.userAgent.match(/iPad/)?"habla-ipad":"habla-desktop"};this.setWidth=function(a){if(!this.config.vars.disable_width){var b=a;this.habla_panel_div.style.width=a+"px";b=hbl.util.BrowserDetect.backwards_dimension||hbl.util.BrowserDetect.browser=="Explorer"&&
hbl.util.BrowserDetect.backwards_dimension?a-this.config.vars.input_width_offset_compat+"px":hbl.util.BrowserDetect.browser=="Explorer"?a-this.config.vars.input_width_offset_ie+"px":a-this.config.vars.input_width_offset_normal+"px";this.habla_wcsend_input.style.width=b;this.habla_name_input.style.width=b;this.habla_offline_body_input.style.width=b;this.habla_offline_email_input.style.width=b;this.habla_offline_phone_input.style.width=b;this.habla_pre_chat_name_input.style.width=b;this.habla_pre_chat_email_input.style.width=
b;this.habla_pre_chat_phone_input.style.width=b}};this.setInputHeight=function(a){if(!hbl.config.vars.disable_height){a=a>18?a:18;hbl.util.BrowserDetect.backwards_dimension&&(a=a>24?a:24);if(typeof this.originalHeight=="undefined")this.originalHeight=a,this.habla_wcsend_input.style.lineHeight=a+"px";this.habla_wcsend_input.style.height=a+"px"}};this.setFormInputHeight=function(a){if(!hbl.config.vars.disable_height)a=a>18?a:18,hbl.util.BrowserDetect.backwards_dimension&&(a=a>24?a:24),a+="px",this.habla_name_input.style.height=
a,this.habla_offline_email_input.style.height=a,this.habla_offline_phone_input.style.height=a,this.habla_pre_chat_name_input.style.height=a,this.habla_pre_chat_name_input.style.lineHeight=a,this.habla_pre_chat_email_input.style.height=a,this.habla_pre_chat_email_input.style.lineHeight=a,this.habla_pre_chat_phone_input.style.height=a,this.habla_pre_chat_phone_input.style.lineHeight=a};this.render_palette=function(){var a=this.config.palette;this.config.vars.limited_palette&&(a=this.config.vars.limited_palette);
for(var b in a)if(a.hasOwnProperty(b)&&typeof this.config.palette[b]=="string"){var e=hbl.util.getElementsByClass(this.habla_window_div,"hbl_pal_"+b),m;for(m in e)if(e.hasOwnProperty(m)&&e[m]&&e[m].style)if(b.match("_fg"))e[m].style.color=this.config.palette[b];else if(b.match("_bg"))e[m].style.backgroundColor=this.config.palette[b];else if(b.match("_border"))e[m].style.borderColor=this.config.palette[b]}};this.getX=function(){return this.habla_window_div.style.left.match(/\d\d*/)};this.getY=function(){return this.habla_window_div.style.top.match(/\d\d*/)};
this.setXY=function(a,b){this.habla_window_div.style.top=b;this.habla_window_div.style.left=a};this.setHeight=function(a){if(!hbl.config.vars.disable_height){a=parseInt(a);var b=function(a,b){if(a)a.style.height=b+"px"};b(this.habla_conversation_div,a);b(this.habla_pre_chat_div,a);b(this.habla_offline_body_input,a-85>0?a-85:0)}};this.setMargins=function(a,b,e,m){if(!this.config.vars.disable_javascript_position)this.habla_window_div.style.marginTop=b+"px",this.habla_window_div.style.marginLeft=a+"px",
this.habla_window_div.style.marginRight=e+"px",this.habla_window_div.style.marginBottom=m+"px"};this.setInline=function(a){a?(a=this.habla_window_div.style.display,this.habla_window_div.setAttribute("style",""),this.config.style_classes_map.habla_window_div=["habla_window_div_position_inline","habla_window_div_base","hbl_pal_main_width"],this.habla_window_div.style.display=a,this.config.render_element_classes(this,"habla_window_div")):this.setPosition(this.config.vars.corner_position)};this.__getAdjustedPosition=
function(a){a=a.toUpperCase();this.config.vars.theme_requires_position&&(this.config.vars.theme_requires_position.match(/B/)?a=a.replace("T","B")+"B":this.config.vars.theme_requires_position.match(/T/)&&(a=a.replace("B","T")),this.config.vars.theme_requires_position.match(/R/)?a=a.replace("L","R")+"R":this.config.vars.theme_requires_position.match(/L/)&&(a=a.replace("R","L")));return a};this.setPosition=function(a){var b=this.habla_window_div.style.display;this.config.style_classes_map.habla_window_div=
["habla_window_div_base","hbl_pal_main_width"];a=this.__getAdjustedPosition(a);this.habla_window_div.setAttribute("style","");if(a.match(/B/)){if(!this.config.vars.disable_javascript_position)this.habla_window_div.style.marginBottom=this.config.vars.bottom_margin+"px",this.habla_window_div.style.bottom="0px";this.config.style_classes_map.habla_window_div.push("olrk-fixed-bottom")}else{if(!this.config.vars.disable_javascript_position)this.habla_window_div.style.marginTop=this.config.vars.top_margin+
"px",this.habla_window_div.style.top="0px";this.config.style_classes_map.habla_window_div.push("olrk-fixed-top")}if(a.match(/R/)){if(!this.config.vars.disable_javascript_position)this.habla_window_div.style.marginRight=this.config.vars.right_margin+"px",this.habla_window_div.style.right="0px";this.config.style_classes_map.habla_window_div.push("olrk-fixed-right")}else{if(!this.config.vars.disable_javascript_position)this.habla_window_div.style.marginLeft=this.config.vars.left_margin+"px",this.habla_window_div.style.left=
"0px";this.config.style_classes_map.habla_window_div.push("olrk-fixed-left")}this.habla_window_div.style.display=b;if(!this.config.vars.disable_javascript_position)this.habla_window_div.style.position=hbl.util.BrowserDetect.use_position_absolute_on_ie?"absolute":"fixed";this.config.render_element_classes(this,"habla_window_div");this.position=a};this.highlight=function(){if(!this.highlighted)this.config.set_element_classes(this.habla_closebutton_a,"habla_button_highlighted"),this.config.set_element_classes(this.habla_sizebutton_a,
"habla_button_highlighted"),this.config.set_element_classes(this.habla_topbar_div,"habla_topbar_div_highlighted"),this.config.set_element_classes(this.habla_wcsend_input,"habla_wcsend_input_highlighted"),this.highlighted=!0};this.normal=function(){if(this.highlighted)this.config.set_element_classes(this.habla_closebutton_a,"habla_button_normal"),this.config.set_element_classes(this.habla_sizebutton_a,"habla_button_normal"),this.config.set_element_classes(this.habla_topbar_div,"habla_button_normal"),
this.config.set_element_classes(this.habla_topbar_div,"habla_topbar_div"),this.config.set_element_classes(this.habla_wcsend_input,"habla_wcsend_input"),this.highlighted=!1};this.getMessageInputField=function(){return this.habla_wcsend_input};this.getMessageInputFieldValue=function(){return this.habla_wcsend_input.value};this.setMessageInputFieldValue=function(a){this.habla_wcsend_input.value=a};this.display_pipeline=new hbl.util.pipeline(this);this.display_pipeline.add(hbl.pipelines.wrap_text,999);
this.display_pipeline.add(hbl.pipelines.emoticons,1E3);window.olark&&window.olark.__legacy_shim&&window.olark.__legacy_shim.pipeline_disabler&&this.display_pipeline.add(window.olark.__legacy_shim.pipeline_disabler,1001)};hbl.eventmgr.register("habla_preload_done",function(){!hbl.config.vars.theme_path&&!hbl.config.vars.theme_obj&&(hbl.config.vars.theme_obj=new hbl.themes.default_theme)},0);
function habla_start_func(){if(!hbl.post_started)if(hbl.post_started=1,olark._.identityManager.getSiteId()?olark._.identityManager.getSiteId()=="missing-site-id"&&olark._.identityManager.setSiteId(window.__get_olark_key()):olark._.identityManager.setSiteId(window.__get_olark_key()),window.habla_window||(habla_window=new hbl._hwindow(hbl.client,hbl.config,hbl.eventmgr),hbl.eventmgr.setWindow(habla_window),habla_window.register_handlers()),hbl.config.vars.local_mode)hbl.client.start(olark._.identityManager.getConversationId(),
olark._.identityManager.getVisitorId(),olark._.identityManager.getSiteId(),hbl.eventmgr,hbl.config),habla_window.setTheme(hbl.config.vars.theme_obj),habla_window.config.vars.welcome_msg="Hab.la is in testing mode. set <em>config.vars['local_mode'] = false;</em> to go back to normal.",habla_window.config.vars.in_chat_text="Hab.la Local Mode",habla_window.config.vars.before_chat_text="Hab.la Local Mode",habla_window.config.vars.not_available_text="Hab.la Local Mode",habla_window.setHeader(habla_window.config.vars.not_available_text),
habla_window.show(1);else{var a=olark._.identityManager.getSiteId();a&&(a.match(/(olark|\@)/i)||!a.match(/\d\d*\-\d/))&&hbl.config.vars.theme_obj?habla_error({etype:"invalid_site_id"}):!a&&hbl.config.vars.theme_obj?habla_error({etype:"invalid_site_link"}):(hbl.eventmgr.register("habla_error",habla_error,10),hbl.client.start(olark._.identityManager.getConversationId(),olark._.identityManager.getVisitorId(),olark._.identityManager.getSiteId(),hbl.eventmgr,hbl.config),hbl.eventmgr.handle("habla_started"))}}
function habla_error(a){if(a.etype=="invalid_site_id")hbl.client.eventmgr=new hbl.util.eventmanager,habla_window.setTheme(hbl.config.vars.theme_obj),habla_window.config.vars.offline_message="<em>"+olark._.identityManager.getSiteId()+"</em> is not a valid <a href='"+hblInstallUrl+"'>"+hblName+"</a> site ID.<p> Your "+hblName+" Site ID is in the format '###-##-###-##' and can be found on your <a href='"+hblInstallUrl+"' target='_blank'>Dashboard</a>.</p>",habla_window.config.vars.not_available_text=
hblName+": Site ID Error",habla_window.setHeader(habla_window.config.vars.not_available_text),habla_window.show(1),habla_window.theme.habla_conversation_div.scrollTop=0;else if(a.etype=="invalid_site_link")hbl.client.eventmgr=new hbl.util.eventmanager,habla_window.setTheme(hbl.config.vars.theme_obj),habla_window.config.vars.offline_message="Unable to determine your site-id.  Please make sure you have copied and pasted all the code as it appears on your <a href='"+hblInstallUrl+"' target='_blank'>"+
hblName+" Dashboard</a>.",habla_window.config.vars.not_available_text=hblName+": Site ID Error",habla_window.setHeader(habla_window.config.vars.not_available_text),habla_window.show(1),habla_window.theme.habla_conversation_div.scrollTop=0;else if(a.etype=="operator_is_busy")hbl.client.opbusy=!0,habla_window.opbusy=!0,habla_window.setWindowText()}
function wc_init_post(a){window.olark&&window.olark.__legacy_shim&&hbl.util.BrowserDetect.init();hbl.config=hbl.config||new hbl.hconfig;if(!hbl.config.merge){var b=hbl.config;hbl.config=new hbl.hconfig;hbl.config.merge(b,!0)}if(hbl.config.vars.disable_get_cookies||hbl.config.vars.wcsid)hbl.config.vars.wcsid&&olark._.identityManager.setConversationId(hbl.config.vars.wcsid),hbl.config.vars.hblid&&olark._.identityManager.setVisitorId(hbl.config.vars.hblid);if(!hbl.config.plugins)hbl.config.plugins=new hbl.util.pluginlist;
a=a||["incoming_notification","away_div_handler","expand_on_receive_message","google_translate","auto_initiate"];for(b=0;b<a.length;b++){var e=new hbl.plugins[a[b]];hbl.config.plugins.add(e)}hbl.eventmgr.handle("habla_preload_done");habla_start_func()}if(!window.olark||window.olark&&!window.olark.__legacy_shim)if(!window.olark||!window.olark.__internal||!window.olark.__internal.skip_wc_init_post)hblJSInline?hbl.eventmgr.register("habla_called_wc_init",function(){wc_init_post()}):wc_init_post();
window.olark&&window.olark.__internal&&window.olark.__internal.declare("__internal.legacy",function(){});if(window.olark&&window.olark.__legacy_shim)window.olark.__legacy_shim.legacy_post_stub_is_loaded=!0;
window.olark.__core.framestorewithjson=function(a,b,e,c,g){a=function(){function a(b){return b<10?"0"+b:b}function b(a){i.lastIndex=0;return i.test(a)?'"'+a.replace(i,function(a){var b=s[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function c(a,d){var h,i,j,q,v=e,u,p=d[a];p&&typeof p==="object"&&typeof p.__jsonlib_toJSON==="function"&&(p=p.__jsonlib_toJSON(a));typeof o==="function"&&(p=o.call(d,a,p));switch(typeof p){case "string":return b(p);
case "number":return isFinite(p)?String(p):"null";case "boolean":case "null":return String(p);case "object":if(!p)return"null";e+=g;u=[];if(Object.prototype.toString.apply(p)==="[object Array]"){q=p.length;for(h=0;h<q;h+=1)u[h]=c(h,p)||"null";j=u.length===0?"[]":e?"[\n"+e+u.join(",\n"+e)+"\n"+v+"]":"["+u.join(",")+"]";e=v;return j}if(o&&typeof o==="object"){q=o.length;for(h=0;h<q;h+=1)i=o[h],typeof i==="string"&&(j=c(i,p))&&u.push(b(i)+(e?": ":":")+j)}else for(i in p)Object.hasOwnProperty.call(p,
i)&&(j=c(i,p))&&u.push(b(i)+(e?": ":":")+j);j=u.length===0?"{}":e?"{\n"+e+u.join(",\n"+e)+"\n"+v+"}":"{"+u.join(",")+"}";e=v;return j}}if(typeof Date.prototype.__jsonlib_toJSON!=="function")Date.prototype.__jsonlib_toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.__jsonlib_toJSON=Number.prototype.__jsonlib_toJSON=Boolean.prototype.__jsonlib_toJSON=
function(){return this.valueOf()};var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,e,g,s={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},o,h=null;typeof h!=="function"&&(h=function(a,b,d){var h;g=e="";if(typeof d==="number")for(h=0;h<d;h+=1)g+=" ";else typeof d==="string"&&
(g=d);if((o=b)&&typeof b!=="function"&&(typeof b!=="object"||typeof b.length!=="number"))throw Error("stringify failed");return c("",{"":a})});var q=null;typeof q!=="function"&&(q=function(a,b){function c(a,d){var h,e,i=a[d];if(i&&typeof i==="object")for(h in i)Object.hasOwnProperty.call(i,h)&&(e=c(i,h),e!==void 0?i[h]=e:delete i[h]);return b.call(a,d,i)}var h;d.lastIndex=0;d.test(a)&&(a=a.replace(d,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,
"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return h=eval("("+a+")"),typeof b==="function"?c({"":h},""):h;throw new SyntaxError("JSON parse error: "+a);});return{encode:h,decode:q}}(window,document);b=function(){function a(){function d(a){(a=a.key)?b(a):c()}window.addEventListener?window.addEventListener("storage",d,!1):window.attachEvent("onstorage",d)}function b(a){var c=s[a],d=o(a);g[a]=g[a]||[];s[a]=d;if(c!=d)for(c=0;c<
g[a].length;c++)try{g[a][c]({newValue:d})}catch(f){window.console&&window.console.error&&window.console.error(f)}}function c(){for(var a in g)g.hasOwnProperty(a)&&b(a)}var d={},i=window,e=i.document,g={},s={},o,h;d.set=function(){};d.get=function(){};d.remove=function(){};d.clear=function(){};d.transact=function(a,b){var c=d.get(a);typeof c=="undefined"&&(c={});b(c);d.set(a,c)};d.listen=function(a,b){s[a]=o(a);g[a]=g[a]||[];g[a].push(b)};d.serialize=function(a){return JSON.stringify(a)};d.deserialize=
function(a){if(typeof a=="string")return JSON.parse(a)};var q;try{q="localStorage"in i&&i.localStorage}catch(k){q=!1}if(q)h=i.localStorage,d.set=function(a,b){h.setItem(a,d.serialize(b))},d.get=function(a){return d.deserialize(h.getItem(a))},d.remove=function(a){h.removeItem(a)},d.clear=function(){h.clear()},o=function(a){return h.getItem(a)},a();else{var f;try{f="globalStorage"in i&&i.globalStorage&&i.globalStorage[i.location.hostname]}catch(x){f=!1}if(f)h=i.globalStorage[i.location.hostname],d.set=
function(a,b){h[a]=d.serialize(b)},d.get=function(a){return d.deserialize(h[a]&&h[a].value)},d.remove=function(a){delete h[a]},d.clear=function(){for(var a in h)delete h[a]},o=function(a){return h[a]},setInterval(c,750);else if(e.documentElement.addBehavior){h=e.createElement("div");var n={},w={},y={},v=function(a){return function(){var b=Array.prototype.slice.call(arguments||[],0);b.unshift(h);e.body.appendChild(h);h.addBehavior("#default#userData");h.load("localStorage");b=a.apply(d,b);e.body.removeChild(h);
return b}},u=function(){var a=Array.prototype.slice.call(arguments||[],0),b=a.shift();try{return w[b].apply(w,a),y[b].apply(y,a)}catch(c){return w[b].apply(w,a)}};y.set=v(function(a,b,c){a.setAttribute(b,d.serialize(c));a.save("localStorage")});y.get=v(function(a,b){return d.deserialize(a.getAttribute(b))});y.remove=v(function(a,b){a.removeAttribute(b);a.save("localStorage")});y.clear=v(function(a){var b=a.XMLDocument.documentElement.attributes;a.load("localStorage");for(var c=0,d;d=b[c];c++)a.removeAttribute(d.name);
a.save("localStorage")});w.set=function(a,b){n[a]=b};w.get=function(a){return n[a]};w.remove=function(a){delete n[a]};w.clear=function(){n={}};d.set=function(a,b){return u("set",a,b)};d.get=function(a){return u("get",a)};d.remove=function(a){return u("remove",a)};d.clear=function(){return u("clear")};o=function(a){try{return v(function(a,b){return a.getAttribute(b)})(a)}catch(b){return n[a]}};setInterval(c,750)}else{var p="; path="+document.location.pathname,z=function(){for(var a=document.cookie.split(";"),
b=0;b<a.length;b++){var c=a[b].replace(/^\s*/,"").replace(/\s*$/,"");if(c.indexOf("storejs=")==0)return d.deserialize(unescape(c.slice(8)))}return{}},C=function(a){document.cookie="storejs="+escape(d.serialize(a))+p;document.cookie.length>4E3&&(window.console&&window.console.warn&&window.console.warn("cookie is too large, clearing storejs"),C({}))};d.set=function(a,b){var c=z();c[a]=b;C(c)};d.get=function(a){return z()[a]};d.remove=function(a){var b=z();try{delete b[a]}catch(c){b[a]=void 0}C(b)};
d.clear=function(){C({})};o=function(a){return d.serialize(z()[a])}}}return d}();e=function(a,b){function c(){if(a.console&&a.console.error)try{a.console.error.apply(a.console,arguments)}catch(b){try{a.console.error(Array.prototype.slice.call(arguments||[]).join(" "))}catch(d){}}}function d(){if(a.console&&a.console.warn)try{a.console.warn.apply(a.console.warn,arguments)}catch(b){try{a.console.warn(Array.prototype.slice.call(arguments||[]).join(" "))}catch(c){}}}function e(){if(a.ActiveXObject)try{var b=
new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),c;return b?(c=b.GetVariable("$version"),parseInt(/([0-9]+)/.exec(c)[1])):-1}catch(d){return-1}else return-1}function g(a){return/^\s*(file\:|[a-zA-Z]\:).*/.test(a)}function r(a){return a?a.length==""?null:g(a)?"file:":(a=a.split("//"),a.length>1?a[0]+"//"+a[1].split("/")[0]:a[0]):null}function s(c,d){var f=Math.floor(Math.random()*99999).toString(),h,e=b.createElement("span"),i="framesocket"+f;f="framesocket"+f;var n=b.getElementsByTagName("body")[0],
k,g=!1,x="try{window."+f+"()}catch(e){"+f+"()}";n?k=function(){n.appendChild(e)}:(n=b.getElementsByTagName("script")[0],k=function(){n.parentNode.insertBefore(e,n)});a[f]=function(){d&&!g&&(g=!0,d(h))};e.style.display="none";/(Firefox)/.test(navigator.userAgent)?(e.innerHTML='<iframe style="display: none !important" id="'+i+'" onload="'+x+'"></iframe>',k(),h=b.getElementById(i),h.src=c):(e.innerHTML='<iframe style="display: none !important" id="'+i+'" src="'+c+'" onload="'+x+'"></iframe>',k(),h=b.getElementById(i));
return h}function o(a){setTimeout(a,0)}function h(a){return r(a=="file:"?null:a)}function q(a,b){function c(){if(a()){var h=d.shift();f=!1;typeof h!="undefined"&&b(h);d.length>0&&!f&&(f=!0,o(c))}}var d=[],f=!1,h=null;return h={queuedSend:function(a){d.push(a);c()},attemptDequeue:c}}function k(){function c(){var b,d,f;f=q(function(){return typeof b!="undefined"&&typeof d!="undefined"?!0:!1},function(c){if(d==null||g(d))a.postMessage?b.postMessage(c,"*"):b.document.postMessage(c,"*");else{var f=r(d);
a.postMessage?b.postMessage(c,f):b.document.postMessage(c,f)}});return{setPostMessageTargetWindow:function(a){b=a;f.attemptDequeue()},setPostMessageTargetOrigin:function(a){d=a;f.attemptDequeue()},send:function(a){f.queuedSend(a)}}}function f(c){function d(a){var f=r(a.origin||a.uri);a.origin=="null"&&(f="file:");f&&!g(f)&&(a.uri&&a.uri.toString().indexOf(f)==0?a.uri.toString().slice(f.length):b.referrer&&b.referrer.toString().indexOf(f)==0&&b.referrer.toString().slice(f.length));f=h(f);if(typeof i==
"undefined"||i==f)(typeof n=="undefined"||n==a.source)&&c({data:a.data,origin:f})}var e={},i,n;a.addEventListener?a.addEventListener("message",d,!1):a.attachEvent("onmessage",d);e.setExpectedOrigin=function(a){i=h(a)};e.setExpectedWindow=function(a){n=a};return e}n.connect=function(a,b){function d(a){i.send(k+w+a)}var h=a.server||a,e=null,i=c(),n,k=Math.random().toString().replace("0.","TK"),j=h.replace(/\#[^?]*/,"")+"#"+k;b=b||function(){};i.setPostMessageTargetOrigin(h);s(j,function(a){a=a.contentWindow?
a.contentWindow:a.contentDocument.window;n=f(b);n.setExpectedOrigin(r(j));n.setExpectedWindow(a);i.setPostMessageTargetWindow(a)});d(y);return e={send:d}};n.accept=function(b){var h=null,e=c(),i,n=(a.location.hash||"").slice(1),k=!1;b=b||function(){};e.setPostMessageTargetWindow(a.parent);i=f(function(a){var c=a.data.split(w),f=c[1];c[0]==n?f==y?k||(k=!0,i.setExpectedOrigin(a.origin),e.setPostMessageTargetOrigin(a.origin)):o(function(){b({data:f,origin:a.origin})}):d("[framesocket] received a message from an origin with an invalid identity")});
i.setExpectedWindow(a.parent);return h={send:e.send}}}function f(){n.connect=function(b,c){function d(b,c){if(b==k)c();else return a.console&&a.console.warn&&a.console.warn("[framesocket] invalid security token given to client in frameElement transport"),null}var f=b.server||b,e,i,n=!1,k=Math.random().toString().replace("0.","TK"),g=f.replace(/\#[^?]*/,"")+"#"+k;c=c||function(){};e=q(function(){return n},function(a){i.frameElementContext.sendToChild(a,k)});i=s(g);i.frameElementContext=function(){};
i.frameElementContext.markChildAsReady=function(a){d(a,function(){o(function(){n=!0;e.attemptDequeue()})})};i.frameElementContext.sendToParent=function(a,b){d(b,function(){c({data:a,origin:h(f)})})};return{send:function(a){e.queuedSend(a)}}};n.accept=function(c){function d(b,c){if(b==f)c();else return a.console&&a.console.warn&&a.console.warn("[framesocket] invalid security token given to server in frameElement transport"),null}var f=(a.location.hash||"").slice(1),e;c=c||function(){};a.frameElement.frameElementContext();
a.frameElement.frameElementContext.sendToChild=function(a,f){d(f,function(){c({data:a,origin:h(b.referrer)})})};a.frameElement.frameElementContext.markChildAsReady(f);e=q(function(){return!0},function(b){a.frameElement.frameElementContext.sendToParent(b,f)});return{send:function(a){e.queuedSend(a)}}}}function x(){function c(){for(;k.length;)k.shift()(f())}function d(a){var c=b.getElementsByTagName("script")[0],f=b.createElement("script");f.type="text/javascript";f.async=!0;f.src=a;c.parentNode.insertBefore(f,
c)}function f(){var b=null;if(a.minixdm)b=a.minixdm.easyXDM;return b||a.easyXDM}function h(a,b){k.push(b);f()?c():e||(e=!0,d(a),i=setInterval(function(){f()&&(c(),clearInterval(i))},100))}var e=!1,i=null,k=[];n.connect=function(b,c){var d=b.server||b,f=d.replace(/(\/[^\/]+)$/,""),e=f+"/minixdm.swf",i=f+"/minixdm.js",n;a.location.protocol=="http:"&&(e=e.replace("https","http"));h(i,function(a){n=new a.Socket({protocol:v,lazy:!1,swf:e,remote:d.replace(/\#[^?]*/,"")+"#basepath="+encodeURIComponent(f),
onMessage:function(a,b){c({data:a,origin:r(b)})}})});return newSocket={send:function(a){h(i,function(){n.postMessage(a)})}}};n.accept=function(b){var c=decodeURIComponent(/basepath=([^?&]+)/.exec(a.location.href.slice(1))[1]),d=c+"/minixdm.swf",f=c+"/minixdm.js",e;a.location.protocol=="http:"&&(d=d.replace("https","http"));h(f,function(a){e=new a.Socket({protocol:v,swf:d,onMessage:function(a,c){b({data:a,origin:r(c)})}})});return newSocket={send:function(a){h(f,function(){e.postMessage(a)})}}}}var n=
{},w="~:DATA:~",y="~:INIT:~",v="6";if(a.postMessage||b.postMessage)k();else if(navigator.product=="Gecko"&&"frameElement"in a&&navigator.userAgent.indexOf("WebKit")==-1)f();else if(e()>6)x();else{var u=function(){c("[framesocket] unsupported browser")};n.connect=function(){u();return{send:u}};n.accept=function(){u();return{send:u}};n.isCompatible=function(){return!1}}n.isCompatible=n.isCompatible||function(){return!0};return n}(window,document);c=function(a,b,c,d,e){function g(){if(a.console&&a.console.error)try{a.console.error.apply(a.console,
arguments)}catch(b){try{a.console.error(Array.prototype.slice.call(arguments||[]).join(" "))}catch(c){}}}function r(){if(a.console&&a.console.warn)try{a.console.warn.apply(a.console.warn,arguments)}catch(b){try{a.console.warn(Array.prototype.slice.call(arguments||[]).join(" "))}catch(c){}}}function s(){this.name="ReadTimeoutError"}function o(){this.name="WriteTimeoutError"}function h(a,b){for(var d=Array.prototype.slice.call(arguments||[]).slice(2),f=b.toString(),h=0;h<d.length;h++)f+=typeof d[h]==
"undefined"?p+escape(z):p+escape(c.encode(d[h]));a.send(f)}function q(a,b){var d=a.split(p),f=d[0];d=d.slice(1);for(var h=b[f],e=[],i,n=0;n<d.length;n++)i=unescape(d[n]),i==z?e.push({}.undefinedValue):e.push(c.decode(i));h?h.apply(h,e):r("[framestore] unknown command type:",f)}function k(a,b){try{d.remove("__framestore__.locks."+a)}catch(c){}b(function(){})}function f(){try{return d.get("__framestore__.index")||{}}catch(a){return r("[framestore] index capture failed, resetting"),d.set("__framestore__.index",
{}),{}}}function x(a){try{return d.set("__framestore__.index",a)}catch(b){r("[framestore] index capture failed, clearing entire storage"),d.clear(),d.set("__framestore__.index",a)}}function n(a){var b=f();d.remove(y(a));delete b[a];x(b)}function w(a){var b=f();b[a]=(new Date).getTime();x(b)}function y(a){return"__framestore__.stores."+a}function v(a,c,f){w(a);k("stores."+a,function(h){var e=y(a),i={metadata:{creator:b.referrer,lastUpdated:(new Date).getTime()},data:{}},n;try{n=d.get(e)||i}catch(k){if(f)n=
i;else throw k;}c(n.data,n.metadata,function(a,b){if(a||b){if(a)n.data=a;if(b)n.metadata=b;n.metadata.lastUpdated=(new Date).getTime();d.set(e,n)}h()})})}var u={},p=",",z="~UNDEFINED",C=100;u.connect=function(b,c,d){function f(){p||(p=setTimeout(n,C))}function n(){g.flush()}function k(a){a.code===22||/QUOTA/.test(a.name||"")?v?N&&N():z&&z():a instanceof o?S&&S():a instanceof s?X&&X():!v&&!l?(r("[framestore] failed to boot, trying to dump storage"),l=!0,g.dump(),g.pull()):t&&t(a)}var g={},x=b.key,
v=!1,l=!1,w={},u=[],y,p=null,m=!1,t=b.onFailure,z=b.onDisabled,N=b.onOverflow,X=b.onReadTimeout,S=b.onWriteTimeout,Y=!1,T=null,U=null,M=null,Z=b.maxMillisecondsForResponse||2100;y=e.connect(b.server,function(b){q(b.data,{DOWNLOADED:function(){d&&d.onDownloaded()},FLUSHDONE:function(a){T==a&&(m=!1,u=[],Y&&n())},FLUSHFAIL:function(a,b){T==a&&(m=!1,k(b))},PULLFAIL:function(a){M&&(clearTimeout(M),M=null);k(a)},PUSH:function(b,f,h){d&&!v&&d.onFirstPullReceived();var e;if(h)b=f;else{b=f;for(f=0;f<u.length;f++)h=
u[f],e=w[h],b[h]=e}w=b;M&&(clearTimeout(M),M=null);v||(v=!0,a.addEventListener?a.addEventListener("beforeunload",n,!1):a.attachEvent("onbeforeunload",n),d&&d.onFirstPullParsed(),c(g))}})});g.pull=function(){M=setTimeout(function(){r("[framesocket] timed out while pulling from persistent storage");k(new s)},Z);h(y,"PULL",x)};g.flush=function(){if(m)Y=!0;else if(p&&(clearTimeout(p),p=null),U&&(clearTimeout(U),U=null),Y=!1,v&&u.length>0){var a={},b,c,d;for(b=0;b<u.length;b++)c=u[b],d=w[c],a[c]=typeof d==
"undefined"?"~DELETEDKEY":d;T=(+new Date).toString();m=!0;U=setTimeout(function(){if(m){r("[framesocket] timed out while flushing to persistent storage");var a=new o;m=!1;k(a)}},Z);h(y,"FLUSH",x,a,T)}};g.get=function(a){return w[a]};g.set=function(a,b){w[a]=b;u.push(a);f()};g.remove=function(a){try{w[a]=void 0,delete w[a]}catch(b){}u.push(a);f()};g.clear=function(){w={};p&&(clearTimeout(p),p=null);h(y,"CLEAR",x)};g.dump=function(){h(y,"DUMP",x,w)};g.reclaim=function(a){h(y,"RECLAIM",x,a)};g.reject=
function(a){for(var b in w){var c;try{c=a(b)?!0:!1}catch(d){c=!1}if(w.hasOwnProperty(b)&&c){try{w[b]=void 0,delete w[b]}catch(h){}u.push(b)}}f()};g.pull();return g};u.accept=function(){function a(b,d){r("[framestore] unable to flush to persistent storage");g(b);h(c,"FLUSHFAIL",d,b)}function b(a){r("[framestore] unable to pull from persistent storage");g(a);h(c,"PULLFAIL",a)}var c,k={};c=e.accept(function(e){q(e.data,{PULL:function(a){function e(d){try{v(a,function(b,f,e){h(c,"PUSH",a,b,d);e(null,
null)})}catch(f){b(f)}}k[a]||(k[a]=!0,d.listen(y(a),e),d.listen("__framestore__.index",function(){var b=f(),c;for(c in b)if(c==a)return;r("[framestore] storage reclaimed, pushing cleared contents");e(!0)}));e()},FLUSH:function(b,d,f){try{v(b,function(b,e,i){var n,k={};for(n in d)if(d.hasOwnProperty(n))if(e=d[n],k[n]=b[n],e=="~DELETEDKEY")try{b[n]=void 0,delete b[n]}catch(g){}else b[n]=e;try{i(b,null),h(c,"FLUSHDONE",f)}catch(j){for(var x in k)k.hasOwnProperty(x)&&(b[x]=k[x]);a(j,f)}})}catch(e){a(e,
f)}},CLEAR:function(a){n(a)},DUMP:function(a,b){v(a,function(a,c,d){d(b,null)},!0)},RECLAIM:function(a,b){if(b&&b>0)for(var c=b;c;){c--;var d=a,h=f(),e=null,i=(new Date).getTime(),k=null,g=void 0;for(g in h)if(g!=d&&h.hasOwnProperty(g)&&(k=h[g],e===null||k===!0||k<i))e=g,i=k===!0?0:k;e&&n(e)}else r("[framestore] number of reclaimed entries must be nonzero")}})});h(c,"DOWNLOADED")};d.serialize=function(a){return c.encode(a)};d.deserialize=function(a){if(typeof a=="string")return c.decode(a)};return u}(window,
document,a,b,e);return g={framestore:c,json:a,framesocket:e}}();
(function(a,b){a.wait_for(function(){return a.framestorewithjson},function(){function e(c,d){function e(a){olark._.cookieManager.set("olfsk",a,63072E6)}var i=!1,f=olark._&&olark._.storage?olark._.storage:"https://static.olark.com/jsclient/storage.html?v=1";olark._.storage||olark._.hlog("no storage URL specified in loader, falling back #warn #no_storage_url");var g;if(!(g=olark._.cookieManager.get("olfsk")))olark._.isNewConversation||olark._.hlog("already booted once, but lost olfsk #warn #olfsk_regen"),
g=Math.random().toString().replace("0.","olfsk");(function(n){function g(b){if(!i)i=!0,a.data.forceDomain=function(){olark._.cookieManager.erase("olfsk");e(n)},a.data.forcePath=function(){olark._.cookieManager.erase("olfsk");e(n)},e(n),a.data.storejs=b,d()}function j(){var b=a.framestorewithjson.json;g({set:function(a,c){localStorage.setItem(a,b.encode(c))},get:function(a){return b.decode(localStorage.getItem(a)||"null")},remove:function(a){localStorage.removeItem(a)}})}var x=!1,l=!1,p=function(){a.data.storejs.reject(function(a){return a==
"vsession"||a==olark._.identityManager.getConversationId()?!1:!0});a.data.storejs.reclaim(1);a.data.storejs.flush()},m=!1,t=document.referrer||"";location.protocol==="https:"&&/^http\:/.test(t)&&(m=!0);location.protocol==="http:"&&/^https\:/.test(t)&&(m=!0);t===""&&location.protocol==="http:"&&(m=!0);m&&olark._.hlog("switching from HTTP to HTTPS #ssl_protocol_switch");m={server:f,key:n,onDisabled:function(){"localStorage"in window&&(b.warn("[olark] persistent storage disabled, chat will restart when crossing over into SSL or other subdomains"),
olark._.hlog("data persistence lowered due to #local_storage_disabled"),j())},onOverflow:function(){x?(olark._.hlog("storage overflow, #overflow_cleared_convo_storage"),a.data.storejs.clear()):(olark._.hlog("storage overflow, #eliminated_convo_data"),x=!0,p())},onReadTimeout:function(){olark._.hlog("reads taking too long #storage_read_timeout");p()},onWriteTimeout:function(){olark._.hlog("writes taking too long #storage_write_timeout");p()},onFailure:function(c){l?(olark._.hlog("storage failure, #failure_cleared_convo_storage"),
a.data.storejs.clear()):(l=!0,b.warn("[olark] dumping storage cache due to unexpected issue:",c),olark._.hlog("unable to persist storage #storage_failure"),a.data.storejs.dump())}};c?j():a.data.storejs=a.framestorewithjson.framestore.connect(m,g,{onDownloaded:function(){olark._.P("storedownloaded")},onFirstPullReceived:function(){olark._.P("storereceived")},onFirstPullParsed:function(){olark._.P("storeparsed")}})})(g);setTimeout(function(){i||olark._.hlog("slow data connection (>8s) #slow_framestore_connection")},
8E3)}var c=/^\s*(__.*|chatNickname|chatStatus)\s*$/,g=function(a,b){a=a||{};for(var c=b.length;c--;){var d=b[c];if(typeof a[d]=="undefined")throw Error("[olark] '"+d+"' is a required argument");}return a},j=function(a){this.__key=a.key;this.__keystore=a.keystore;this.__link_to_conversation=a.link_to_conversation;this.__link_to_visitor=a.link_to_visitor;this.__initial_value=a.initial_value;this.__backup=a.backup;this.__backupTransform=a.backupTransform;if(this.__link_to_visitor&&this.__link_to_conversation)throw Error("cannot link object reference to both the visitor and conversation");
this.__event_object_string="PersistentObjectReference."+this.__key;typeof this.get()=="undefined"&&typeof this.__initial_value!="undefined"&&this.set(this.__initial_value);if(this.__link_to_conversation&&this.__keystore.isLinkedToVisitor({key:this.__key}))throw Error("this object is already linked to the visitor, cannot link it to the conversation");if(this.__link_to_visitor&&this.__keystore.isLinkedToConversation({key:this.__key}))throw Error("this object is already linked to the conversation, cannot link it to the visitor");
};j.prototype.get=function(){var b=this.__keystore.get({key:this.__key,backup:this.__backup,backupTransform:this.__backupTransform});return typeof b=="undefined"?(this.set(this.__initial_value),a.clone_object(this.__initial_value)):a.clone_object(b)};j.prototype.set=function(b){if(typeof b=="undefined")throw Error("'value' required for object set");var c=this.__keystore.get({key:this.__key,backup:this.__backup,backupTransform:this.__backupTransform});a.deep_equals(c,b)||(this.__keystore.set({key:this.__key,
value:b,link_to_conversation:this.__link_to_conversation,link_to_visitor:this.__link_to_visitor,backup:this.__backup}),a.trigger_event({namespace:this.__event_object_string,type:"keyChange",key:this.__key,newValue:b,oldValue:c}))};j.prototype.edit=function(a){var b=this.get();a(b);this.set(b)};j.prototype.change=function(a){b.warn("[olark] 'change' is deprecated, use __SPI_onChange instead");this.__SPI_onChange(a)};j.prototype.__SPI_onChange=function(b){a.listen_for_event({namespace:this.__event_object_string,
type:"keyChange",callback:b})};var m=function(){};m.prototype.get=function(){throw Error();};m.prototype.set=function(){throw Error();};m.prototype.clearConversationData=function(){throw Error();};m.prototype.clearVisitorData=function(){throw Error();};m.prototype.isLinkedToConversation=function(){throw Error();};m.prototype.isLinkedToVisitor=function(){throw Error();};var l=function(){this.__conversation_expiration_delta_in_days=0.1;this.__visitor_expiration_delta_in_days=365;r({key:"csession",defaultValue:null,
expiration_access_tag:olark._.identityManager.getConversationId()})||t({key:"csession",value:{},expiration_in_milliseconds:this.__conversation_expiration_delta_in_days*864E5,expiration_access_tag:olark._.identityManager.getConversationId()});r({key:"vsession",defaultValue:null,expiration_access_tag:olark._.identityManager.getVisitorId()})||t({key:"vsession",value:{},expiration_in_milliseconds:this.__visitor_expiration_delta_in_days*864E5,expiration_access_tag:olark._.identityManager.getVisitorId()});
this.set({key:"siteId",value:olark._.siteId,link_to_visitor:!0})};l.prototype=new m;l.prototype.constructor=l;l.prototype.get=function(a){a=a||{};var c=a.key;a=a.backup;if(typeof c=="undefined")throw Error("'key' required");var d=r({key:"vsession",defaultValue:{},expiration_access_tag:olark._.identityManager.getVisitorId()}),e=r({key:"csession",defaultValue:{},expiration_access_tag:olark._.identityManager.getConversationId()});d=d[c];e=e[c];var f;typeof e!="undefined"?typeof d!="undefined"?b.warn("[olark]",
c,"was stored as associated with both the visitor and conversation, falling back to the conversation value"):f=e:f=d;if(typeof f=="undefined"&&a){c=(olark._.cookieManager.getAllowingNullAndUndefinedAndEmptyString("_okbk")||"").split(",");var i;for(d=0;d<c.length;d++)i=c[d].split("="),e=i[0],i=unescape(i[1]),e==a&&(f=i)}return f};l.prototype.set=function(a){a=a||{};var b=a.key,c=a.value,d=a.link_to_visitor,f=a.link_to_conversation;a=a.backup;if(typeof b=="undefined")throw Error("'key' required");if(typeof c==
"undefined")throw Error("'value' required for key store set");if(d&&f)throw Error("cannot link data to both a visitor and conversation");if(!d&&!f)throw Error("currently, you must link to either a conversation or visitor");var e=r({key:"vsession",defaultValue:{},expiration_access_tag:olark._.identityManager.getVisitorId()}),i=r({key:"csession",defaultValue:{},expiration_access_tag:olark._.identityManager.getConversationId()});if(d)if(i[b])throw Error("[error] cannot link "+b+" to the visitor, it is already associated with the conversation");
else e[b]=c,t({key:"vsession",value:e,expiration_in_milliseconds:this.__visitor_expiration_delta_in_days*864E5,expiration_access_tag:olark._.identityManager.getVisitorId()});if(f)if(e[b])throw Error("cannot link this value to the conversation, it is already associated with the visitor");else i[b]=c,t({key:"csession",value:i,expiration_in_milliseconds:this.__conversation_expiration_delta_in_days*864E5,expiration_access_tag:olark._.identityManager.getConversationId()});if(a){b=(olark._.cookieManager.get("_okbk")||
"").split(",");e=[a+"="+escape(c)];for(f=0;f<b.length;f++)c=b[f].split("="),d=c[0],unescape(c[1]),d!=a&&e.push(b[f]);olark._.cookieManager.setAllowingNullAndUndefinedAndEmptyString("_okbk",e.join(",")||null)}};l.prototype.clearConversationData=function(){s({key:"csession"});olark._.cookieManager.erase("_okbk")};l.prototype.clearVisitorData=function(){s({key:"vsession"})};l.prototype.isLinkedToConversation=function(a){a=a||{};a=a.key;if(typeof a=="undefined")throw Error("'key' required");return typeof r({key:"csession",
defaultValue:{},expiration_access_tag:olark._.identityManager.getConversationId()})[a]!="undefined"};l.prototype.isLinkedToVisitor=function(a){a=a||{};a=a.key;if(typeof a=="undefined")throw Error("'key' required");return typeof r({key:"vsession",defaultValue:{},expiration_access_tag:olark._.identityManager.getVisitorId()})[a]!="undefined"};var d=function(a){a=a||{};if(typeof a.namespace=="undefined")throw Error("'namespace' required");this.__namespace=a.namespace;this.__keystore=new l};d.prototype.__SPI_clearVisitorAndConversationData=
function(){this.__keystore.clearVisitorData();this.__keystore.clearConversationData()};d.prototype.__SPI_clearOnlyConversationData=function(){this.__keystore.clearConversationData()};(function(){var a=d.prototype;a.declareConversationObject=function(a){b.warn("[olark] api.data.declareConversationObject is deprecated, please use api.data.getConversationObject instead");return this.getConversationObject(a)};a.declareVisitorObject=function(a){b.warn("[olark] api.data.declareVisitorObject is deprecated, please use api.data.getVisitorObject instead");
return this.getVisitorObject(a)}})();d.prototype.getConversationObject=function(a){a=a||{};if(typeof a.key=="undefined")throw Error("'key' required for getConversationObject");if(typeof a.initialValue=="undefined")a.initialValue=null;if(c.test(a.key))throw Error("[olark] '"+a.key+"' is a protected key name, please choose something else");return new j({key:(a.__SPI_forceNamespace||this.__namespace)+"."+a.key,keystore:this.__keystore,initial_value:a.initialValue,link_to_conversation:!0,backup:a.backup,
backupTransform:a.backupTransform})};d.prototype.getVisitorObject=function(a){a=a||{};if(typeof a.key=="undefined")throw Error("'key' required for getVisitorObject");if(typeof a.initialValue=="undefined")a.initialValue=null;if(c.test(a.key))throw Error("[olark] '"+a.key+"' is a protected key name, please choose something else");return new j({key:(a.__SPI_forceNamespace||this.__namespace)+"."+a.key,keystore:this.__keystore,initial_value:a.initialValue,link_to_visitor:!0,backup:a.backup,backupTransform:a.backupTransform})};
var i=null;(function(){var b={};i={get:function(c){var d=(new Date).getTime(),e=b[c];return e&&d-e.timestamp<900?e.val:(e=a.data.storejs.get(c),b[c]={val:e,timestamp:d},e)},set:function(c,d){var e=(new Date).getTime();e={val:d,timestamp:e};a.data.storejs.set(c,d);b[c]=e},remove:function(c){a.data.storejs.remove(c);b[c]=void 0;try{delete b[c]}catch(d){}}}})();var t=function(a){a=g(a,["key","value","expiration_in_milliseconds"]);var b=a.key,c=(new Date).getTime();c={value:a.value,unix_timestamp:c,expiration_in_milliseconds:a.expiration_in_milliseconds};
if(a.expiration_access_tag){var d=i.get("prev-"+b);d&&d.expiration_access_tag===a.expiration_access_tag&&(b="prev-"+b);c.expiration_access_tag=a.expiration_access_tag}i.set(b,c)},r=function(c){c=g(c,["key"]);return a.try_and_optionally_catch(function(){var a=i.get(c.key);if(a&&a.expiration_access_tag&&a.expiration_access_tag!==c.expiration_access_tag){var b=i.get("prev-"+c.key);b&&b.expiration_access_tag===c.expiration_access_tag?a=b:(olark._.hlog("new session started, #returning_visitor_session"),
i.set("prev-"+c.key,a),i.remove(c.key),a=i.get(c.key))}return a?(new Date).getTime()-a.unix_timestamp<a.expiration_in_milliseconds?a.value:(s({key:c.key}),c.defaultValue):c.defaultValue},function(a){b.error("[olark] problem retrieving '"+c.key+"' from storejs: "+a.toString());b.showErrorBacktrace(a)})},s=function(a){a=g(a,["key"]);i.remove(a.key)};a.data={AbstractKeyStore:m,StorejsKeyStore:l,DataApi:d,prepare:function(a,b,c){e(b,c)},storejs:null}})})(window.olark.__core,window.olark.__core.logger);
(function(a,b){a.wait_for(function(){return a.data&&window.olark.__legacy_shim.legacy_post_stub_is_loaded},function(){var e=null,c=null,g=!1,j=!1,m=!1,l=function(b){var c=this;c.__conf=b.conf;if(typeof c.__conf=="undefined")throw Error("'conf' required");c.__chat_api=b.chat_api;if(typeof c.__chat_api=="undefined")throw Error("'chat_api' required");c.__initialize_legacy_event_handlers();c.__setup_chat_history_handling();c.__conf.box.behave_like_popout&&c.__setup_popout_behavior();c.__keystore=new a.data.StorejsKeyStore;
c.__renderWelcomeMessage();c.__SPI_onPrechatWelcomeMessage(function(){c.__renderWelcomeMessage()});if(!c.__conf.system.offline_msg_mode)c.__prevent_showing=!1,c.__pending_show=!1,c.__chat_api.__SPI_onOperatorGroupChanging(function(){c.__prevent_showing=!0}),c.__chat_api.__SPI_onOperatorGroupChanged(function(){c.__prevent_showing=!1;c.__chat_api.operatorsAreAvailable()&&c.__pending_show&&c.show()})};l.prototype.listen=function(c,e){var g=string.charAt(0).toUpperCase()+string.slice(1);b.warn("[olark] api.box.listen is deprecated, please use api.box.on"+
g+" instead");a.listen_for_event({namespace:"box",type:c,callback:e})};l.prototype.expand=function(){this.__SPI_whenRendered(function(){habla_window.expand()})};l.prototype.onExpand=function(b){window.olark.__legacy_shim.disable_input_focusing=!1;a.listen_for_event({namespace:"box",type:"expand",callback:b})};l.prototype.shrink=function(){this.__SPI_whenRendered(function(){habla_window.compress()})};l.prototype.onShrink=function(b){window.olark.__legacy_shim.disable_input_focusing=!1;a.listen_for_event({namespace:"box",
type:"shrink",callback:b})};l.prototype.show=function(){this.__prevent_showing?this.__pending_show=!0:this.__SPI_whenRendered(function(){habla_window.show()})};l.prototype.onShow=function(b){window.olark.__legacy_shim.disable_input_focusing=!1;a.listen_for_event({namespace:"box",type:"show",callback:b})};l.prototype.overlay=function(){this.__SPI_whenRendered(function(){habla_window.theme.setInline(0);habla_window.end_popout()})};l.prototype.onOverlay=function(b){window.olark.__legacy_shim.disable_input_focusing=
!1;a.listen_for_event({namespace:"box",type:"overlay",callback:b})};l.prototype.hide=function(){this.__SPI_whenRendered(function(){habla_window.hide()})};l.prototype.onHide=function(b){window.olark.__legacy_shim.disable_input_focusing=!0;a.listen_for_event({namespace:"box",type:"hide",callback:b})};l.prototype.popout=function(){habla_window.popout()};l.prototype.onPopout=function(b){window.olark.__legacy_shim.disable_input_focusing=!1;a.listen_for_event({namespace:"box",type:"popout",callback:b})};
l.prototype.dismiss=function(){this.__SPI_whenRendered(function(){habla_window.close()})};l.prototype.onDismiss=function(b){window.olark.__legacy_shim.disable_input_focusing=!0;a.listen_for_event({namespace:"box",type:"dismiss",callback:b})};l.prototype.__SPI__onOlarkLinkClicked=function(b){a.listen_for_event({namespace:"box",type:"olark_link_clicked",callback:b})};l.prototype.__SPI_disableUserInterface=function(){var a=document.getElementById("habla_beta_container_do_not_rely_on_div_classes_or_names");
a.style.visibility="hidden";a.style.display="none"};l.prototype.__SPI_inline=function(){this.__SPI_whenRendered(function(){habla_window.theme.setInline(1)})};l.prototype.__SPI_onInline=function(b){window.olark.__legacy_shim.disable_input_focusing=!1;a.listen_for_event({namespace:"box",type:"inline",callback:b})};l.prototype.__SPI_injectStyleIntoPage=function(a){function b(){var c=document.getElementsByTagName("head")[0];c.insertBefore(a,c.firstChild)}/(Chrome)/.test(navigator.userAgent)?setTimeout(b,
1E3):b()};l.prototype.__clear_message_history=function(){this.__SPI_whenRendered(function(){a.run_legacy_code(function(a){a.habla_window.setBody("")})})};l.prototype.__renderWelcomeMessage=function(){function a(){return b.__keystore.get({key:"__box.welcomeMessage"})}var b=this;if(a()){var c=function(){var c=a();c&&b.__chat_api.sendMessageToVisitor({nickname:" ",body:c,__SPI_notification:!0});b.__keystore.set({key:"__box.welcomeMessage",value:null,link_to_conversation:!0})};b.__chat_api.onReady(function(){window.hbl.config.vars.show_pre_chat?
b.__chat_api.__SPI_onPrechatInfoReceived(c):c()});b.__SPI_whenRendered(function(){var b=a();if(b)window.habla_window.theme.habla_pre_chat_span.innerHTML=b})}};l.prototype.__SPI_setPrechatWelcomeMessage=function(b){this.__keystore.set({key:"__box.welcomeMessage",value:b,link_to_conversation:!0});a.trigger_event({namespace:"box",type:"prechatWelcomeMessage",body:b});this.expand()};l.prototype.__SPI_onPrechatWelcomeMessage=function(b){a.listen_for_event({namespace:"box",type:"prechatWelcomeMessage",
callback:b})};l.prototype.__SPI_showMessageHistory=function(){var a=this;a.__SPI_whenRendered(function(){habla_window.config.vars.show_pre_chat?habla_window.theme.habla_offline_message_div.style.display="none":(window.olark.__legacy_shim.ignore_prechat_status=!1,a.__toggle_divs_by_id({show:["habla_chatform_form","habla_conversation_div"],hide:["olark-api-panel","habla_pre_chat_div","habla_offline_message_div"]}))})};l.prototype.__SPI_getLegacyState=function(a){var b=this.__keystore.get({key:"__box.legacyState"})||
{box_open:!1,box_visible:!0};a(b)};l.prototype.__SPI_setLegacyState=function(a){this.__keystore.set({key:"__box.legacyState",value:a,link_to_conversation:!0})};l.prototype.__hide_dom=function(a){typeof a=="string"&&(a=document.getElementById(a));if(typeof a=="object"&&a!==null)return a.style.display="none",!0;return!1};l.prototype.__show_dom=function(a){typeof a=="string"&&(a=document.getElementById(a));if(typeof a=="object"&&a!==null)return a.style.display="block",!0;return!1};l.prototype.__toggle_divs_by_id=
function(a){var b=a.show;a=a.hide;for(var c in b)typeof b[c]!="function"&&this.__show_dom(document.getElementById(b[c]));for(var e in a)typeof a[e]!="function"&&this.__hide_dom(document.getElementById(a[e]))};l.prototype.__SPI_whenRendered=function(a){olark("api.chat.onReady",a)};l.prototype.__SPI_hideForDuration=function(b){this.hide();a.trigger_event({namespace:"box",type:"hideForDuration",duration:b})};l.prototype.__SPI_onHideForDuration=function(b){a.listen_for_event({namespace:"box",type:"hideForDuration",
callback:b})};l.prototype.__SPI_hideBoxForThisPageOnly=function(){this.__SPI_whenRendered(function(){a.run_legacy_code(function(a){try{a.habla_window.theme.habla_window_div.style.visibility="hidden"}catch(c){b.warn("[olark] unable to hide the chatbox for this page",c)}})})};l.prototype.__SPI_setThemeTextField=function(b,c){c&&olark("api.chat.onReady",function(){a.run_legacy_code(function(a){a=a.habla_window.theme[b];a.has_typed=!0;a.value=c})})};l.prototype.__setup_popout_behavior=function(){var b=
this;window.onbeforeunload=function(){return!1};var c=function(){var c=300,e=500;if(parseInt(navigator.appVersion,10)>3)navigator.appName.indexOf("Microsoft")!=-1?(c=document.body.offsetWidth,e=document.body.offsetHeight):(c=window.innerWidth,e=window.innerHeight);c&&e&&b.__SPI_whenRendered(function(){a.run_legacy_code(function(a){a.habla_window.config.setHeight(parseInt(e,10)-85);a.habla_window.setHeight(parseInt(e,10)-85);a.habla_window.setWidth(parseInt(c,10))})})};c();window.onresize=c};l.prototype.__initialize_legacy_event_handlers=
function(){if(!j){j=!0;var b=function(){habla_window.theme.habla_wcsend_input.disabled=!0;habla_window.theme.habla_wcsend_input.style.display="none"};this.__chat_api.onOperatorsAway(b);this.__chat_api.onOperatorsBusy(b);this.__chat_api.onOperatorsAvailable(function(){habla_window.theme.habla_wcsend_input.disabled=!1;habla_window.theme.habla_wcsend_input.style.display="block"});this.__SPI_whenRendered(function(){olark._.P("box")});hbl.eventmgr.register("chat_loaded",function(){g=!0},0);hbl.eventmgr.register("olark_link_clicked",
function(){a.trigger_event({namespace:"box",type:"olark_link_clicked"})});hbl.eventmgr.register("habla_window_changed",function(b){if(g)switch(b.type){case "popout":a.trigger_event({namespace:"box",type:"popout"});break;case "endpop_out":a.trigger_event({namespace:"box",type:"popin"});break;case "show":c||(c=!0,a.trigger_event({namespace:"box",type:"show"}));break;case "hide":c=!1;a.trigger_event({namespace:"box",type:"hide"});break;case "compress":e=!1;a.trigger_event({namespace:"box",type:"shrink"});
break;case "expand":e||(e=!0,a.trigger_event({namespace:"box",type:"expand"}))}},0);hbl.eventmgr.register("habla_closebutton_a_onclick",function(){a.trigger_event({namespace:"box",type:"dismiss"})},0)}};l.prototype.__populate_message_history_from_chat_api=function(){var b=this;b.__SPI_whenRendered(function(){var c=b.__chat_api.__SPI_getMessageHistory(),e=0;for(c.length>0&&a.run_legacy_code(function(a){a.habla_window.theme.setBody("")});e<c.length;){var g=c[e++],j=g.nickname||"you",l=g.body;a.run_legacy_code(function(a){/^\s+$/.test(l)||
a.habla_window.theme.appendNiceMessage(j,l,!0,!0)})}var h=function(){var a=window.habla_window.theme.habla_conversation_div;a.scrollHeight?a.scrollTop=a.scrollHeight:setTimeout(h,100)};h()})};l.prototype.__setup_chat_history_handling=function(){var b=this;m||(m=!0,b.__chat_api.onReady(function(){b.__populate_message_history_from_chat_api();b.__chat_api.__SPI_populatedLocalChatHistoryFromRpcServer()&&b.expand()}),b.__chat_api.__SPI_onDeliveryOfMessageFromVisitor(function(b){a.run_legacy_code(function(a){a.habla_window.theme.appendNiceMessage(a.hbl.config.vars.myname||
"you",b.message.body,!0,!0)})}),b.__chat_api.__SPI_onDeliveryOfMessageFromOperator(function(b){a.run_legacy_code(function(a){a.habla_window.theme.appendNiceMessage(b.message.nickname,b.message.body,!0,!0)})}))};olark.declare({name:"__BoxApiHelper",startup:function(b,c){var e=b.data.getConversationObject({key:"visible",initialValue:c.box.start_hidden?!1:null}),g=b.data.getConversationObject({key:"state",initialValue:null}),j=b.data.getConversationObject({key:"close_hides_window",initialValue:!1}),
l=b.data.getConversationObject({key:"hidden_for_visit",initialValue:!1}),h=b.data.getVisitorObject({key:"hidden_for_visitor",initialValue:!1}),q=b.data.getConversationObject({key:"auto_messages",initialValue:[]}),k=function(){window.olark.__legacy_shim.box_visible=e.get();window.olark.__legacy_shim.box_state=g.get()};if(c.system.hide_not_available&&!c.system.offline_msg_mode)b.chat.onOperatorsAway(function(){b.visitor.getDetails(function(a){a.isConversing||b.box.hide()})});if(j.get()===!0&&g.get()===
"closed"||l.get()===!0||h.get()===!0)b.box.hide(),k();b.chat.onReady(function(){a.run_legacy_code(function(a){a.hbl.config.vars.close_hides_window?j.set(!0):j.set(!1)})});b.box.onDismiss(function(){e.set(!1);g.set("closed");k()});b.box.onExpand(function(){e.set(!0);g.set("expanded");k()});b.box.onShrink(function(){e.set(!0);g.set("compressed");k()});b.box.onOverlay(function(){e.set(!0);k()});b.box.onPopout(function(){e.set(!1);g.set("closed");k()});b.box.onHide(function(){e.set(!1);k()});b.chat.onOperatorsAway(function(){c.system.hide_when_offline&&
b.box.hide()});b.chat.onOperatorsAvailable(function(){c.system.hide_when_offline&&b.box.show()});b.box.__SPI_onInline(function(){e.set(!0);k()});b.box.__SPI_onHideForDuration(function(a){a=a.duration;a.forVisit?l.set(!0):a.forVisitor&&h.set(!0);e.set(!1);g.set("closed");k()});var f=function(){l.set(!1);h.set(!1)};b.box.__SPI_whenRendered(function(){b.box.onShow(f);b.box.onExpand(f);b.box.onPopout(f);b.box.onOverlay(f)});k();b.chat.onMessageToVisitor(function(){b.box.expand()});b.chat.onOperatorsAvailable(function(){b.box.__SPI_showMessageHistory()});
window.olark.__legacy_shim.populate_message_history_from_chat_api=function(){b.box.__populate_message_history_from_chat_api()};b.box.__SPI_onPrechatWelcomeMessage(function(a){var b=q.get();b.push(a.body);q.set(b)});b.chat.onBeginConversation(function(){var a=q.get().slice(0);a.length>0&&b.chat.sendNotificationToOperator({body:["visitor is replying to these automated messages:","  >> "+a.join("\n  >> ")].join("\n")})})}});olark.extend("__BoxApiHelper");a.box={BoxApi:l}})})(window.olark.__core,window.olark.__core.logger);
(function(a,b){a.wait_for(function(){return a.framestorewithjson&&a.data&&window.olark.__legacy_shim.legacy_post_stub_is_loaded},function(){function e(a){return function(a){var b=typeof a;b==="object"&&(a?typeof a.length==="number"&&!a.propertyIsEnumerable("length")&&typeof a.splice==="function"&&(b="array"):b="null");return b}(a)=="array"}var c=/^\s*\!\s*([^\s]+)\s*((.*)\s*)?/,g=["VisitorImportance","Shopify","CartSaver"],j=!1,m=!1,l=!1,d=null,i=!1,t=!1,r=!1,s=!1,o={},h=function(){this.__message_sending_failsafe_timeout=
null;this.__status_update_pending=this.__nickname_update_pending=!1;this.__message_queue=[];this.__notification_queue=[];this.__keystore=new a.data.StorejsKeyStore;this.__connection_wrapper=null;this.__all_extensions_have_run_their_startup_method=!1;this.__sync_pipeline=[];this.__sync_pipeline_is_draining=!1};(function(c){var d=null;h.get_instance=function(){d||(d=new h);return d};var e=!1,i=function(b){e?b():a.listen_for_event({namespace:"SessionConnection",type:"afterReady",callback:function(){e=
!0;b()}})};c.get_local_data=function(a){return this.__local_get(a)};c.put_local_data=function(a){return this.__local_set(a)};c.send_message=function(b){var c=this;if(typeof b.body=="undefined")throw Error("[olark] 'body' required");c.__message_queue.push(b.body);c.__message_queue.length==1&&a.do_async_call({delay:270},function(){c.__synchronize_with_jabber()})};c.send_notification=function(b){var c=this;if(typeof b.body=="undefined")throw Error("[olark] 'body' required");c.__notification_queue.push(b.body);
c.__notification_queue.length==1&&a.do_async_call({delay:300},function(){c.__synchronize_with_jabber()})};c.update_nickname_for_extension=function(a){if(typeof a.extension_name=="undefined")throw Error("[olark] 'extension_name' required");if(typeof a.snippet=="undefined")throw Error("[olark] 'snippet' required");var b=a.extension_name,c=a.snippet,f=a.hides_default_nickname,d=this.__local_get({key:"nickname_lookup"})||{};d[b]={snippet:c,hides_default_nickname:f,secureTimestamp:a.secureTimestamp,secureSignature:a.secureSignature};
this.__local_set({key:"nickname_lookup",value:d});this.__mark_nickname_update_pending()};c.__mark_nickname_update_pending=function(b){var c=this;if(!c.__nickname_update_pending)c.__nickname_update_pending=!0,a.do_async_call({delay:250},function(){c.__synchronize_with_jabber(b)});c.__mark_status_update_pending(!0)};c.update_status_for_extension=function(a){if(typeof a.extension_name=="undefined")throw Error("[olark] 'extension_name' required");if(typeof a.snippet=="undefined")throw Error("[olark] 'snippet' required");
var b=this.__local_get({key:"status_lookup"})||{};b[a.extension_name]={snippet:a.snippet,secureTimestamp:a.secureTimestamp,secureSignature:a.secureSignature};this.__local_set({key:"status_lookup",value:b});this.__mark_status_update_pending()};c.__mark_status_update_pending=function(b){var c=this;if(!c.__status_update_pending)c.__status_update_pending=!0,a.do_async_call({delay:260},function(){c.__synchronize_with_jabber(void 0,b)})};c.disconnect=function(){var b=this;a.run_legacy_code(function(a){a.hbl.client.sendcommand&&
a.hbl.client.sendcommand("disconnectchat",b.__enableMessageToBeRoutedToGroupIfNecessary(""))})};c.getGroupForThisPage=function(){return this.__groupIdString};c.lockToGroupForThisPage=function(a){olark.__legacy_shim.currentGroupIdstring=this.__groupIdString=a};c.unlockFromGroupForThisPage=function(){olark.__legacy_shim.currentGroupIdstring=this.__groupIdString={}.undefinedValue};c.__TMP_set_connection_wrapper=function(a){var b=this;b.__connection_wrapper=a;b.__with_open_connection(function(){b.__all_extensions_have_run_their_startup_method=
!0;b.__synchronize_with_jabber()})};c.__TMP_get_current_combined_nickname=function(){var b=this.__local_get({key:"nickname_lookup"})||{},c=[],f=!0,d=function(a){return{v:a.snippet,t:a.secureTimestamp,s:a.secureSignature}};a.for_each_extension_name_starting_with_most_recent(function(a){var e=b[a];e&&typeof e!="function"&&e.snippet&&e.snippet.length>0&&(e.hides_default_nickname&&(f=!1),function(b){var f;a:{for(f=0;f<g.length;f++)if(g[f]==a){f=!0;break a}f=!1}f?c.unshift(b):c.push(b)}(d(e)))});(f||c.length===
0)&&c.push(d({snippet:this.__get_default_nickname_snippet()}));return a.framestorewithjson.json.encode(c)};c.__TMP_get_current_combined_status=function(){var c=this.__local_get({key:"status_lookup"})||{},f=[];a.for_each_extension_name_starting_with_most_recent(function(a){try{var d=c[a];d&&typeof d!="function"&&f.unshift({v:d.snippet,t:d.secureTimestamp,s:d.secureSignature})}catch(e){b.error("[olark] problem setting status: "+e.toString()),b.showErrorBacktrace(e)}});f.length===0&&(f=[{v:"There is no status information available right now.\n Add custom information using the Javascript API (www.olark.com/docs)."}]);
f.unshift({v:"{{nickname}}"});return a.framestorewithjson.json.encode(f)};c.__enableMessageToBeRoutedToGroupIfNecessary=function(a){if(typeof a!="string")throw Error("[olark] message must be a string");return a};c.__get_default_nickname_snippet=function(){var a=this.__local_get({key:"default_nickname"})||null;a||(a="{{geolocation}} #"+Math.floor(Math.random()*1E4).toString(),this.__local_set({key:"default_nickname",value:a}));return a};c.__local_get=function(a){if(typeof a.key=="undefined")throw Error("'key' required");
return(this.__keystore.get({key:"sessconn"})||{})[a.key]||null};c.__local_set=function(a){if(typeof a.key=="undefined")throw Error("'key' required");var b=this.__keystore.get({key:"sessconn"})||{};b[a.key]=a.value;this.__keystore.set({key:"sessconn",value:b,link_to_conversation:!0})};c.__update_nickname_in_jabber=function(b){var c=this;i(function(){c.__local_set({key:"has_sent_initial_nickname",value:!0});c.__nickname_update_pending=!1;var f=c.__TMP_get_current_combined_nickname(),d=c.__local_get({key:"previous_nickname"})!=
f;c.__local_set({key:"previous_nickname",value:f});(d||b)&&a.run_legacy_code(function(a){a.hbl.client.setnickname(c.__enableMessageToBeRoutedToGroupIfNecessary(f))})})};c.__update_status_in_jabber=function(b){var c=this;i(function(){c.__local_set({key:"has_sent_initial_status",value:!0});c.__status_update_pending=!1;var f=c.__TMP_get_current_combined_status(),d=c.__local_get({key:"previous_status"})!=f;c.__local_set({key:"previous_status",value:f});(d||b)&&a.run_legacy_code(function(a){a.hbl.client.sendpresence(c.__enableMessageToBeRoutedToGroupIfNecessary(f),
"chat")})})};var k=function(a){if(typeof a.list=="undefined")throw Error("'list' required");var b={};a=a.list;for(var c=[],f=0;f<a.length;f++){var d=a[f];b[d]||(b[d]=!0,c.push(d))}return c};c.__dequeue_messages_into_jabber=function(){var c=this;i(function(){var f=c.__message_queue;c.__message_queue=[];var d=k({list:f});d.length!=f.length&&b.warn("[olark] message batch contains",f.length-d.length,"duplicate messages");var e=null;f.length>0&&(e=a.join_string_list({list:d,separator:"\n"}));e&&c.__sendmessage(e,
!1)})};c.__dequeue_notifications_into_jabber=function(){var c=this,f=c.__notification_queue;c.__notification_queue=[];a.run_legacy_code(function(){var d=k({list:f});d.length!=f.length&&b.warn("[olark] notification batch contains",f.length-d.length,"duplicate notifications");var e=null;f.length>1?e="[info]\n  - "+a.join_string_list({list:d,separator:"\n  - "}):f.length==1&&(e="[info] "+f[0]);e&&c.__sendmessage(e,!0)})};c.__sendmessage=function(b,c){var f=this,d=f.__local_get({key:"sentmessage"})?!1:
!0;a.run_legacy_code(function(a){a.hbl.client.sendmessage(f.__enableMessageToBeRoutedToGroupIfNecessary(b),c?!0:!1,c?!0:{}.undefinedValue,d,f.__TMP_get_current_combined_nickname(),f.__TMP_get_current_combined_status())});f.__local_set({key:"sentmessage",value:!0})};c.__synchronize_with_jabber=function(a,b){var c=this,f=c.__nickname_update_pending,d=c.__status_update_pending,e=c.__notification_queue.length>0?!0:!1,h=c.__message_queue.length>0?!0:!1,n=c.__local_get({key:"has_sent_initial_nickname"}),
i=c.__local_get({key:"has_sent_initial_status"});c.__all_extensions_have_run_their_startup_method&&(n||(f=!0),i||(d=!0));c.__force_nickname_update=c.__force_nickname_update||a;c.__force_status_update=c.__force_status_update||b;var k=c.__sync_pipeline;if(f&&!c.__nickname_update_queued)n=!0,c.__nickname_update_queued=!0,k.push(function(){var a=c.__force_nickname_update;c.__nickname_update_queued=!1;c.__force_nickname_update=!1;c.__update_nickname_in_jabber(a)});if(d&&!c.__status_update_queued)n?(i=
!0,c.__status_update_queued=!0,k.push(function(){var a=c.__force_status_update;c.__status_update_queued=!1;c.__force_status_update=!1;c.__update_status_in_jabber(a)})):c.__trigger_message_sending_failsafe();e&&(i?k.push(function(){c.__dequeue_notifications_into_jabber()}):c.__trigger_message_sending_failsafe());h&&(i?k.push(function(){c.__dequeue_messages_into_jabber()}):c.__trigger_message_sending_failsafe());c.__drain_sync_pipeline()};c.__drain_sync_pipeline=function(){var c=this,f=c.__sync_pipeline,
d=function(){if(f.length>0){var e=f.shift();a.try_and_optionally_catch(function(){e()},function(a){b.error("[olark] problem servicing SessionConnection pipeline: "+a.toString());b.showErrorBacktrace(a)})}f.length>0?a.do_async_call({delay:1E3},d):c.__sync_pipeline_is_draining=!1};if(c.__sync_pipeline_is_draining===!1)c.__sync_pipeline_is_draining=!0,d()};c.__with_open_connection=function(a){this.__connection_wrapper(a)};c.__trigger_message_sending_failsafe=function(){var b=this,c=b.__local_get({key:"has_sent_initial_nickname"}),
f=b.__local_get({key:"has_sent_initial_status"});if(!b.__message_sending_failsafe_timeout)b.__message_sending_failsafe_timeout=a.do_async_call({delay:3E3},function(){if(!c||!f)f=c=!0,b.__synchronize_with_jabber()})}})(h.prototype);var q=function(a){var c=this;c.__legacy_message_tuple=a.legacy_message_tuple;if(typeof c.__legacy_message_tuple=="undefined")throw Error("'legacy_message_tuple' required");if(typeof a.send_event_type=="undefined")throw Error("'send_event_type' required");if(typeof a.deliver_event_type==
"undefined")throw Error("'send_event_type' required");if(typeof a.final_delivery_action=="undefined")throw Error("'final_delivery_action' required");c.__send_event_type=a.send_event_type;c.__deliver_event_type=a.deliver_event_type;c.__final_delivery_action=a.final_delivery_action;c.__delivered=!1;c.__predelivery_actions=[];c.__new_body=null;c.__SPI_notification=a.__SPI_notification;c.__message_event={namespace:"chat",type:c.__send_event_type,automated:a.is_automated?!0:!1,__SPI_notification:a.__SPI_notification,
nickname:c.__legacy_message_tuple[0],body:c.__legacy_message_tuple[1],__legacy_sequence_id:parseFloat(c.__legacy_message_tuple[2]),__SPI_deferMessageDelivery:function(a){c.__predelivery_actions.push(a)},updateBody:function(a){c.__new_body&&b.warn("[olark] two handlers tried to modify the body of the same message, allowing the second one to override");c.__new_body=a}};c.__original_body=window.olark.__core.clone_object(c.__message_event.body)};(function(c){c.get_processed_body=function(){return this.__new_body||
this.__message_event.body};c.send=function(){a.trigger_event(this.__message_event)};c.deliver=function(){for(var b=this,c=[],f=function(){c[d]=!0;for(var a=c.length,f=!0;a--;)c[a]||(f=!1);f&&b.__trigger_delivery()},d=b.__predelivery_actions.length;d--;)c.push(!1);d=b.__predelivery_actions.length;for(a.listen_for_event({namespace:"chat::Message",type:"doneDeferringMessageDelivery",callback:f});d--;)(function(b,f){f({deliverMessage:function(){c[b]=!0;a.trigger_event({namespace:"chat::Message",type:"doneDeferringMessageDelivery"})}})})(d,
b.__predelivery_actions[d]);f()};c.__trigger_delivery=function(){if(!this.__delivered)this.__delivered=!0,this.__original_body!=this.__message_event.body&&b.warn("[olark] you cannot modify the 'body' attribute of messages directly, please use message.updateBody() to modify the body"),a.trigger_event({namespace:"chat",type:this.__deliver_event_type,automated:this.__message_event.automated,nickname:this.__message_event.nickname,body:this.get_processed_body(),__legacy_sequence_id:parseFloat(this.__message_event.__legacy_sequence_id)}),
this.__final_delivery_action()}})(q.prototype);var k=function(a){function b(a){return a=="true"?!0:!1}function c(a){return a=="null"?null:a}var d=this;d.__conf=a.conf;if(typeof d.__conf=="undefined")throw Error("'conf' required");d.__extension_name=a.extension_name;if(typeof d.__extension_name=="undefined")throw Error("'extension_name' required");d.__data=new window.olark.__core.data.DataApi({namespace:"__chatd"});d.__last_incr_seq_id=d.__data.getConversationObject({key:"last_incr_seq_id",initialValue:0,
backup:"cd1",backupTransform:parseFloat});d.__last_leg_seq_id=d.__data.getConversationObject({key:"last_leg_seq_id",initialValue:0,backup:"cd2",backupTransform:parseFloat});d.__is_conversing=d.__data.getConversationObject({key:"is_conversing",initialValue:!1,backup:"cd3",backupTransform:b});d.__hasconnected=d.__data.getConversationObject({key:"hasconnected",initialValue:!1,backup:"cd4",backupTransform:b});d.__data_history=d.__data.getConversationObject({key:"data_history",initialValue:!1});d.__last_op_presence=
d.__data.getConversationObject({key:"last_op_presence",initialValue:"away",backup:"cd5",backupTransform:c});d.__last_cmd_seq_id=d.__data.getConversationObject({key:"last_cmd_seq_id",initialValue:0,backup:"cd6",backupTransform:parseFloat});d.__last_presence=d.__data.getConversationObject({key:"last_presence",initialValue:"chat",backup:"cd8",backupTransform:c});d.__is_connection_upgraded=d.__data.getConversationObject({key:"is_connection_upgraded",initialValue:!1});d.__is_ended=d.__data.getConversationObject({key:"is_ended",
initialValue:!1});d.__next_conversation_id=d.__data.getConversationObject({key:"next_conversation_id",initialValue:null});d.__needsToDoPrechat=d.__data.getConversationObject({key:"needs_prechat",initialValue:null});d.__SPI_onPrechatInfoReceived(function(){d.__needsToDoPrechat.set(!1)});d.onReady(function(){d.__needsToDoPrechat.get()===null&&d.__needsToDoPrechat.set(hbl.config.vars.show_pre_chat?!0:!1)});d.onBeginConversation(function(){d.__needsToDoPrechat.set(!1)});d.__initialize_legacy_connection_and_messaging_handlers();
d.__initialize_legacy_history_tracking();d.__initialize_conversation_tracking();d.__has_local_history=!0;d.__conversation_message_history=[];d.__session_connection=h.get_instance();d.__session_connection.__TMP_set_connection_wrapper(function(a){d.__wait_for_chat_to_connect(a)})};(function(){var c=k.prototype;k.prototype.listen=function(c,d){var f=string.charAt(0).toUpperCase()+string.slice(1);b.warn("[olark] api.chat.listen is deprecated, please use api.chat.on"+f+" instead");a.listen_for_event({namespace:"chat",
type:c,callback:d})};c.onMessageFromVisitor=function(a){b.warn("[olark] api.chat.onMessageFromVisitor is deprecated, please use api.chat.onMessageToOperator instead");return this.onMessageToOperator(a)};c.onMessageFromOperator=function(a){b.warn("[olark] api.chat.onMessageFromOperator is deprecated, please use api.chat.onMessageToVisitor instead");return this.onMessageToVisitor(a)};c.getNickname=function(){b.warn("[olark] api.chat.getNickname is deprecated, please use api.chat.getVisitorNickname instead");
return this.getVisitorNickname()};c.sendAutomatedMessageToVisitor=function(a){b.warn("[olark] api.chat.sendAutomatedMessageToVisitor is deprecated, please use api.chat.sendMessageToVisitor instead");return this.sendMessageToVisitor(a)};c.updateNickname=function(a){b.warn("[olark] api.chat.updateNickname is deprecated, please use api.chat.updateVisitorNickname instead");return this.updateVisitorNickname(a)};c.onConnectComplete=function(a){b.warn("[olark] api.chat.onConnectComplete is deprecated, please use api.chat.onReady instead");
return this.onReady(a)}})();k.prototype.updateVisitorNickname=function(a){a=a||{};if(a.nickname)a.snippet=a.nickname,b.warn("[olark] giving 'nickname' as an argument to updateVisitorNickname is now deprecated, use 'snippet' instead");typeof a=="string"&&(a={snippet:a});if(typeof a.snippet=="undefined")return b.warn("[olark] 'snippet' required"),!1;if(e(a.snippet))if(a.secureTimestamp||a.secureSignature)throw Error("[olark] you cannot give a list of snippets and also security information, please join the snippets yourself before signing them");
else a.snippet=a.snippet.join(" | ");this.__session_connection.update_nickname_for_extension({extension_name:a.source||this.__extension_name,snippet:a.snippet,hides_default_nickname:a.hidesDefault?!0:!1,secureTimestamp:a.secureTimestamp,secureSignature:a.secureSignature})};k.prototype.getVisitorNickname=function(c){c=c||{};c.other&&b.warn("[olark] giving 'other' as an argument to getVisitorNickname is now deprecated, this method only returns the entire nickname");c.combined&&b.warn("[olark] giving 'combined' as an argument to getVisitorNickname is now deprecated, this method only returns the entire nickname");
c=this.__session_connection.__TMP_get_current_combined_nickname();c=a.framestorewithjson.json.decode(c);for(var d=[],e=0;e<c.length;e++)d.push(c[e].v);return d.length?d.join(" | "):null};k.prototype.updateVisitorStatus=function(a){a=a||{};if(a.status)a.snippet=a.status,b.warn("[olark] giving 'status' as an argument to updateVisitorStatus is now deprecated, use 'snippet' instead");typeof a=="string"&&(a={snippet:a});if(typeof a.snippet=="undefined")throw Error("[olark] 'snippet' required");if(e(a.snippet))if(a.secureTimestamp||
a.secureSignature)throw Error("[olark] you cannot give a list of snippets and also security information, please join the snippets yourself before signing them");else a.snippet=a.snippet.join("\n| ");this.__session_connection.update_status_for_extension({extension_name:this.__extension_name,snippet:a.snippet,secureTimestamp:a.secureTimestamp,secureSignature:a.secureSignature})};k.prototype.getVisitorStatus=function(c){c=c||{};c.other&&b.warn("[olark] giving 'other' as an argument to getVisitorStatus is now deprecated, this method only returns the entire status");
c.combined&&b.warn("[olark] giving 'combined' as an argument to getVisitorStatus is now deprecated, this method only returns the entire status");c=this.__session_connection.__TMP_get_current_combined_status();c=a.framestorewithjson.json.decode(c);for(var d=[],e=0;e<c.length;e++)d.push(c[e].v);return d.length?d.join("\n| "):null};k.prototype.sendNotificationToOperator=function(b){var c=this,d=null;d=typeof b=="string"?b:b.body;if(!d)throw Error("body required");c.__wait_for_chat_to_connect(function(){a.trigger_event({namespace:"chat",
type:"notificationToOperator",body:d,after:function(){c.__session_connection.send_notification({body:d})}})})};k.prototype.sendMessageFromVisitor=function(b){var c=this,d=null;d=typeof b=="string"?b:b.body;if(!d)throw Error("body required");c.__wait_for_chat_to_connect(function(){a.trigger_event({namespace:"chat",type:"messageFromVisitor",body:d,after:function(){c.__session_connection.send_message({body:d})}})})};k.prototype.onNotificationToOperator=function(b){a.listen_for_event({namespace:"chat",
type:"notificationToOperator",callback:function(a){b({notification:{body:a.body}})}})};k.prototype.sendNotificationToVisitor=function(a){this.sendMessageToVisitor({nickname:"INTERNAL_NOTIFICATION",body:a.body,__SPI_notification:!0})};k.prototype.__SPI_sendInterfaceElementToVisitor=function(a){this.sendMessageToVisitor({nickname:"INTERNAL_NOTIFICATION-"+this.__extension_name+"-"+a.key,body:"...",__SPI_notification:!0})};k.prototype.__SPI_onInterfaceElementReady=function(b){var c=this;a.listen_for_event({namespace:"chat",
type:"interfaceElementReady",callback:function(a){a.extensionName===c.__extension_name&&b({key:a.key,dom:a.dom})}})};k.prototype.__get_next_message_sequence_id_that_is_server_safe=function(){var a=this.__last_leg_seq_id.get(),b=parseFloat(a),c=this.__last_incr_seq_id.get(),d=parseFloat(c),e=null;a!=b&&(olark._.hlog("last_legacy_sequence_id was not a float:",a,"#non_int_legseq_id #warn"),a=b||0);c!=d&&(olark._.hlog("last_incremented_sequence_id was not a float:",c,"#non_int_incrseq_id #warn"),c=d||
0);e=c<=a?a+0.25:c+0.25;this.__last_incr_seq_id.set(e);return e};k.prototype.onNotificationToVisitor=function(b){a.listen_for_event({namespace:"chat",type:"messageFromOperator",callback:function(a){a.nickname=="INTERNAL_NOTIFICATION"&&b({notification:{body:a.body}})}})};k.prototype.sendMessageToVisitor=function(b){var c=this,d=b.nickname,e=b.body,h=b.skipPrechatSurvey?!0:!1;if(!e)throw Error("body required");var i=b.automated===!1?!1:!0;!h&&c.__needsToDoPrechat.get()===!0?olark("api.box.__SPI_setPrechatWelcomeMessage",
e):c.__wait_for_chat_to_connect(function(){a.run_legacy_code(function(a){d||(d=a.hbl.client.current_operator()||" ");c.__send_and_deliver_message_from_operator({legacy_message_tuple:[d,e,c.__get_next_message_sequence_id_that_is_server_safe()],is_automated:i,__SPI_notification:b.__SPI_notification})})})};k.prototype.onMessageToVisitor=function(b){a.listen_for_event({namespace:"chat",type:"messageFromOperator",callback:function(a){b({message:{nickname:a.nickname,body:a.body,updateBody:function(b){a.updateBody(b)},
__SPI_deferMessageDelivery:function(b){a.__SPI_deferMessageDelivery(b)},automated:a.automated,__SPI_notification:a.__SPI_notification}})}})};k.prototype.onMessageToOperator=function(b){a.listen_for_event({namespace:"chat",type:"messageFromVisitor",callback:function(a){b({message:{nickname:a.nickname,body:a.body,updateBody:function(b){a.updateBody(b)},__SPI_deferMessageDelivery:function(b){a.__SPI_deferMessageDelivery(b)}}})}})};k.prototype.onOfflineMessageToOperator=function(b){a.listen_for_event({namespace:"chat",
type:"offlineMessageToOperator",callback:function(a){b({message:{nickname:a.message.nickname,body:a.message.body}})}})};k.prototype.onCommandFromOperator=function(b){a.listen_for_event({namespace:"chat",type:"commandFromOperator",callback:function(a){b({command:{name:a.name,body:a.body,nickname:a.nickname}})}})};k.prototype.__SPI_onDeliveryOfMessageFromVisitor=function(b){a.listen_for_event({namespace:"chat",type:"deliveryOfMessageFromVisitor",callback:function(a){b({__legacy_sequence_id:parseFloat(a.__legacy_sequence_id),
message:{nickname:a.nickname,body:a.body}})}})};k.prototype.__SPI_onDeliveryOfMessageFromOperator=function(b){a.listen_for_event({namespace:"chat",type:"deliveryOfMessageFromOperator",callback:function(a){b({__legacy_sequence_id:parseFloat(a.__legacy_sequence_id),message:{nickname:a.nickname,body:a.body}})}})};k.prototype.operatorsAreAvailable=function(){return d=="available"};k.prototype.onOperatorsAvailable=function(b){a.listen_for_event({namespace:"chat",type:"operatorsAvailable",callback:b})};
k.prototype.operatorsAreBusy=function(){return d=="busy"};k.prototype.onOperatorsBusy=function(b){a.listen_for_event({namespace:"chat",type:"operatorsBusy",callback:b})};k.prototype.operatorsAreAway=function(){return d=="away"};k.prototype.onOperatorsAway=function(b){a.listen_for_event({namespace:"chat",type:"operatorsAway",callback:b})};k.prototype.__SPI_onConnectBegin=function(b){a.listen_for_event({namespace:"chat",type:"connectBegin",callback:b})};k.prototype.setOperatorGroup=function(b){this.__SPI_lockToOperatorGroup(b.group||
b);a.trigger_event({namespace:"chat",type:"operatorGroupChanging"});hbl.client.eventmgr.register("handled_nrpc_response",function(){a.trigger_event({namespace:"chat",type:"operatorGroupChanged"});hbl.client.eventmgr.unregister_all("handled_nrpc_response")});hbl.client.sendcommand("return_long_poll_now","")};k.prototype.__SPI_onOperatorGroupChanging=function(b){a.listen_for_event({namespace:"chat",type:"operatorGroupChanging",callback:b})};k.prototype.__SPI_onOperatorGroupChanged=function(b){a.listen_for_event({namespace:"chat",
type:"operatorGroupChanged",callback:b})};k.prototype.__SPI_lockToOperatorGroup=function(a){olark._.cookieManager.setAllowingNullAndUndefinedAndEmptyString("_okgid",a);this.__session_connection.lockToGroupForThisPage(a)};k.prototype.__SPI_lockToExistingOperatorGroupIfGiven=function(a){var b=olark._.cookieManager.getAllowingNullAndUndefinedAndEmptyString("_okgid");b||b===null?this.__session_connection.lockToGroupForThisPage(b):this.__session_connection.lockToGroupForThisPage(a)};k.prototype.__SPI_unlockFromCurrentGroup=
function(){olark._.cookieManager.erase("_okgid");this.__session_connection.unlockFromGroupForThisPage()};k.prototype.onReady=function(a){this.__wait_for_chat_to_connect(a)};k.prototype.whenDataReady=function(b){i?b():a.listen_for_event({namespace:"chat",type:"dataReady",callback:b})};k.prototype.connect=function(){this.__SPI_connectToRpcServers()};k.prototype.__SPI_onConnectFailure=function(b){a.listen_for_event({namespace:"chat",type:"connectFailure",callback:b})};k.prototype.__wait_for_chat_to_connect=
function(b){m?b():(b=a.create_idempotent_callback(b),a.listen_for_event({namespace:"chat",type:"onReady",callback:b}))};k.prototype.__SPI_visitorIsAvailable=function(){return this.__last_presence.get()=="chat"};k.prototype.__SPI_visitorIsBusy=function(){return this.__last_presence.get()=="dnd"};k.prototype.__SPI_visitorIsAway=function(){return this.__last_presence.get()=="away"};k.prototype.__SPI_isConversing=function(){return this.__is_conversing.get()===!0?!0:!1};k.prototype.__SPI_beginConversation=
function(){this.__is_conversing.get()!==!0&&(this.__is_conversing.set(!0),a.trigger_event({namespace:"chat",type:"beginConversation"}))};k.prototype.__SPI_onConversationBegin=function(b){a.listen_for_event({namespace:"chat",type:"beginConversation",callback:b})};k.prototype.__SPI_endConversation=function(){this.__is_conversing.set(!1)};k.prototype.__SPI_onConversationEnd=function(b){a.listen_for_event({namespace:"chat",type:"endConversation",callback:b})};k.prototype.__SPI_onEndedStateChanged=function(b){var c=
this;a.listen_for_event({namespace:"chat",type:"endedStateChange",callback:function(){c.__SPI_getEndedState(b)}})};k.prototype.__SPI_getEndedState=function(a){a({is_ended:this.__is_ended.get(),next_conversation_id:this.__next_conversation_id.get(),is_conversing:this.__SPI_isConversing()})};k.prototype.onBeginConversation=function(b){a.listen_for_event({namespace:"chat",type:"beginConversation",callback:b})};k.prototype.__initialize_conversation_tracking=function(){var a=this;a.onMessageToOperator(function(b){b.message.__SPI_notification!==
!0&&a.__SPI_beginConversation()});a.onMessageToVisitor(function(b){b.message.__SPI_notification!==!0&&a.__SPI_beginConversation()})};k.prototype.__SPI_getConversationUUID=function(){return olark._.identityManager.getConversationId()};k.prototype.__SPI_getVisitorUUID=function(){return olark._.identityManager.getVisitorId()};k.prototype.__SPI_getLegacyConfig=function(){return a.run_legacy_code(function(a){return a.hbl.config})};k.prototype.__SPI_queryCurrentGroup=function(a){a({group:this.__session_connection.getGroupForThisPage()})};
k.prototype.__SPI_disableEventConnection=function(){s=!0};k.prototype.__SPI_enableEventConnection=function(){s=!1};k.prototype.__SPI_getLegacySiteId=function(){return olark._.identityManager.getSiteId()};k.prototype.__SPI_sendRawMessageToVisitor=function(b){var c=[b.nickname,b.body,this.__get_next_message_sequence_id_that_is_server_safe()];a.run_legacy_code(function(a){a.hbl.client.incoming_pipeline.run(c)})};k.prototype.__SPI_sendRawMessageToOperator=function(a){this.__send_and_deliver_message_from_visitor({legacy_message_tuple:[null,
a.body,0]})};k.prototype.__handleHighTrafficConfiguration=function(a){var b=this;if(b.__is_connection_upgraded.get()!==!0&&a.system&&a.system.forced_polling_in_seconds_when_online_but_not_chatting){a=a.system.forced_polling_in_seconds_when_online_but_not_chatting;var c=hbl.client.pollingmanager.getMinAvailablePollTime();hbl.client.pollingmanager.setMinAvailablePollTime(a*1E3);var d=function(){b.__is_connection_upgraded.get()||(b.__is_connection_upgraded.set(!0),hbl.client.pollingmanager.setMinAvailablePollTime(c),
hbl.client.pollingmanager.startNextPollNow())};hbl.eventmgr.register("habla_window_changed",function(a){a.type==="expand"&&d()});olark("api.box.onExpand",d)}};k.prototype.__SPI_connectToRpcServers=function(a){a=a||{};var c=this,d=c.__conf;if(l!==!0&&(l=!0,c.__hasconnected.set(!0),olark._.P("getconnection"),c.onReady(function(){olark._.P("connection")}),!s)){window.hblJavaScriptVersion="api-1.2.1";window.hbl_hostname=d.system.legacy_rpc_server||window.hbl_hostname||"olark.com/rpc";window.hbl.config=
window.wc_config();var e=window.hbl.config;e.vars.no_system_messages=!0;e.vars.disable_rpc_state=!0;if(d.system.show_in_buddy_list=="chatting"&&typeof d.system.forced_polling_in_seconds_when_online_but_not_chatting==="undefined")d.system.forced_polling_in_seconds_when_online_but_not_chatting=300;c.__handleHighTrafficConfiguration(d);if(d.system.path)e.vars.cookie_path=d.system.path,e.vars.hbl_cookie_path=d.system.path;d.system.disable_offline_messaging_fallback&&olark._.hlog("used #disable_offline_messaging_fallback flag");
for(var h in d.system)typeof d.system[h]!="function"&&(e.vars[h]=d.system[h]);for(var i in d.box)typeof d.box[i]!="function"&&(e.vars[i]=d.box[i]);if(/AppleWebKit/.test(navigator.appVersion)){h=document.getElementsByTagName("object");for(i=0;i<h.length;i++)if(/\.swf/.test(h[i].data||"")){e.vars.disable_expand_text_input=!0;break}}h=function(a,b){return typeof a=="undefined"?b:a};e.vars.top_margin=h(d.box.vertical_offset,e.vars.top_margin);e.vars.bottom_margin=h(d.box.vertical_offset,e.vars.bottom_margin);
e.vars.right_margin=h(d.box.horizontal_offset,e.vars.right_margin);e.vars.left_margin=h(d.box.horizontal_offset,e.vars.left_margin);h=function(a,b){e.vars[a]=b||d.system[a]};h("before_chat_text",d.locale.welcome_title||d.box.welcome_title);h("in_chat_text",d.locale.chatting_title);h("not_available_text",d.locale.unavailable_title||d.box.unavailable_title);h("busy_text",d.locale.busy_title);h("away_text",d.locale.unavailable_title);h("offline_message",d.locale.away_message);h("welcome_msg",d.locale.welcome_message||
d.box.welcome_message);h("busy_message",d.locale.busy_message);h("say_text",d.locale.chat_input_text);h("habla_name_input_text",d.locale.name_input_text||d.system.field_text_for_name);h("habla_offline_email_text",d.locale.email_input_text||d.system.field_text_for_email);h("habla_offline_phone_text",d.locale.phone_input_text);h("habla_offline_body_text",d.locale.offline_note_message||d.system.field_for_offline_message_body||d.system.information_text_when_offline);h("habla_offline_submit_value",d.locale.send_button_text||
d.system.button_text_for_send);h("habla_offline_sent_text",d.locale.offline_note_thankyou_text||d.system.offline_message_thankyou_text);h("email_body_error_text",d.locale.offline_note_error_text||d.system.offline_message_validation_error_text);h("sending_text",d.locale.offline_note_sending_text||d.system.offline_message_sending_text);h("operator_is_typing_text",d.locale.operator_is_typing_text);h("operator_has_stopped_typing_text",d.locale.operator_has_stopped_typing_text);h("pre_chat_error_text",
d.locale.introduction_error_text);h("pre_chat_message",d.locale.introduction_messages);h("pre_chat_submit",d.locale.introduction_submit_button_text);h("check_for_status",d.locale.loading_title);h("send_text",d.locale.send_button_text);if(d.system.always_create_new_session)e.vars.disable_set_cookies=!0,e.vars.disable_get_cookies=!0;e.vars.start_passive&&b.warn("[olark] start_passive mode is not enabled in the new Javascript");e.vars.max_milliseconds_conversation_can_be_idle=e.vars.max_milliseconds_conversation_can_be_idle||
olark._.maxMillisecondsConversationCanBeIdle;if(d.box.inline&&(e.setInline(1),e.vars.start_expanded=typeof d.box.start_expanded=="undefined"?1:d.box.start_expanded,e.vars.enable_buttons=!1,h=document.getElementById("olark-box-container")))h.id="habla_window_div";var k=function(){var b=a.__legacy_site_id||c.__conf.system.olark_key;window.hblHasinit=1;window.hbl.post_started=void 0;b&&olark._.identityManager.setSiteId(b);window.hbl.config=window.hbl.config||window.wc_config();b=["expand_on_receive_message"];
d.Notify&&b.push("incoming_notification");(d.StatusElements||d.CalloutBubble)&&b.push("away_div_handler");(function(){var a=olark._.identityManager.getSiteId(),b=olark._.cookieManager.get("_ok"),e=c.__SPI_isConversing(),h=d.system.high_priority_site?!0:!1;if(b){if(b!=a&&(!e||h))window.hbl.config.vars.disable_get_cookies=!0,olark._.cookieManager.set("_ok",a)}else olark._.cookieManager.set("_ok",a)})();window.wc_init_post(b);(function(a,b){d.locale[a]=d.locale[a]||b})("ended_chat_message",e.vars.ended_chat_message)};
if(c.__conf.system.disable_visitor_composing)olark.__legacy_shim.disableComposing=!0;j||m?c.__wait_for_chat_to_connect(function(){c.__SPI_disconnect();k()}):k()}};k.prototype.__get_message_history=function(){return this.__data_history.get()||this.__conversation_message_history};k.prototype.__SPI_setMessageHistory=function(b){this.__conversation_message_history=b;a.run_legacy_code(function(a){if(a.hbl.client.buffer.length===0)a.hbl.client.buffer=[[null,"",0.2]]});this.__data_history.set(b)};k.prototype.__SPI_disableChatConnection=
function(){hbl.util.append_script=function(){};hbl.client.jsonproxy.prototype.do_nrpc_call=function(){}};k.prototype.__SPI_disconnect=function(){this.__session_connection.disconnect();this.__SPI_setMessageHistory([]);window.hblHasinit=void 0;window.hbl.client.messageq=[];window.hbl.client.jsonthrottle_locked=!1;olark._.identityManager.deleteConversationId();window.hbl.client.pollingmanager.stop();window.hbl.client.pollingmanager.reset();window.hbl.config=window.wc_config();window.hbl.config.merge({vars:{habla_sizebutton_text_expanded:"_",
habla_sizebutton_text_compressed:"^",habla_closebutton_text:"x",habla_popout_text:">",habla_end_popout_text:"&lt;&lt;",corner_position:"BR",bottom_margin:10,right_margin:10,left_margin:10,top_margin:10}});window.hbl.config.vars.poll=!0;window.habla_window.config=hbl.config;window.habla_window.theme.config=hbl.config;m=j=!1;a.trigger_event({namespace:"chat",type:"disconnect"})};k.prototype.__SPI_getVisitorGeolocation=function(){return o.geolocation||null};k.prototype.__SPI_getVisitorIP=function(){return o.browser_ip||
null};k.prototype.__SPI_isPremiumUser=function(){return hbl.client.ssl?!0:!1};k.prototype.__SPI_hasConnectedAlready=function(){return this.__hasconnected.get()?!0:!1};k.prototype.__SPI_getLastOperatorPresence=function(a){var b=this;b.whenDataReady(function(){var c=b.__last_op_presence.get();a(c)})};k.prototype.__send_and_deliver_message_from_visitor=function(a){var b=this;a=a.legacy_message_tuple;if(typeof a=="undefined")throw Error("'legacy_message_tuple' required");a[2]=a[2]||b.__get_next_message_sequence_id_that_is_server_safe();
var c=new q({legacy_message_tuple:a,send_event_type:"messageFromVisitor",deliver_event_type:"deliveryOfMessageFromVisitor",final_delivery_action:function(){b.__session_connection.send_message({body:c.get_processed_body()})}});c.send();c.deliver()};k.prototype.__send_and_deliver_message_from_operator=function(b){var c=b.legacy_message_tuple,d=b.is_automated,e=c&&c[1]&&/^\s*$/.test(c[1])?!0:!1;if(typeof c=="undefined")throw Error("'legacy_message_tuple' required");if(typeof d=="undefined")throw Error("'is_automated' required");
if(!e){c[2]=c[2]||this.__get_next_message_sequence_id_that_is_server_safe();var h=new q({legacy_message_tuple:c,is_automated:d,__SPI_notification:b.__SPI_notification,send_event_type:"messageFromOperator",deliver_event_type:"deliveryOfMessageFromOperator",final_delivery_action:function(){a.run_legacy_code(function(a){var b=[c[0],h.get_processed_body(),c[2]];a.hbl.client.append([b])})}});h.send();h.deliver()}};k.prototype.__determine_presence_from_nrpc_event=function(a){var b=null;if(a.opavailable)switch(a.status){case "available":case "chat":b=
"available";break;default:b="away"}else b="away";return b};k.prototype.__initialize_legacy_connection_and_messaging_handlers=function(){var b=this;if(!r){d=b.__last_op_presence.get()||"away";r=!0;hbl.eventmgr.register("chat_started",function(b){j=!0;a.trigger_event({namespace:"chat",type:"connectBegin"});o={browser_ip:b.browser_ip,geolocation:b.geolocation}},0);hbl.eventmgr.register("resend_nickname",function(){b.__session_connection.__mark_nickname_update_pending(!0)},0);hbl.eventmgr.register("resend_status",
function(){b.__session_connection.__mark_status_update_pending(!0)},0);hbl.eventmgr.register("offlineMessageToOperator",function(b){a.trigger_event({namespace:"chat",type:"offlineMessageToOperator",message:b})});var e=b.__is_ended.get();hbl.eventmgr.register("conversation_ended",function(c){e||(e=!0,b.__is_ended.set(!0),b.__next_conversation_id.set(c.next_conversation_id),a.trigger_event({namespace:"chat",type:"endedStateChange"}))},0);hbl.eventmgr.register("operator_composing",function(a){function c(a){this.composingMessage&&
d();var b=document.createElement("p");b.className="habla_conversation_p_item hbl_pal_main_fg";b.innerHTML='<span class="olark-composing-message habla_conversation_person2 hbl_pal_local_fg">'+a+"</span>";if(b.children)b.children[0].style.color="rgb(200,200,200)",this.composingMessage=b,e.appendChild(this.composingMessage);e.scrollTop=e.scrollHeight}function d(){if(this.composingMessage){clearTimeout(this.composingMessageRemovalTimeout);var a=this.composingMessage.parentNode||this.composingMessage.parent;
a&&a.removeChild(this.composingMessage);this.composingMessage=!1}}var e=document.getElementById("habla_conversation_div");this.composingMessage=this.composingMessage||!1;if(!this.composingMessageRemovalHandlerSet)b.__SPI_onDeliveryOfMessageFromOperator(function(){d()}),this.composingMessageRemovalHandlerSet=!0;b.__SPI_onEndedStateChanged(function(a){a.is_ended&&d()});var h=hbl.config.vars.local_name_override||a.operator_nickname||"operator",i={active:function(){d()},composing:function(){c(h+" "+hbl.config.vars.operator_is_typing_text)},
paused:function(){c(h+" "+hbl.config.vars.operator_has_stopped_typing_text);this.composingMessageRemovalTimeout=setTimeout(d,3E4)}};i.hasOwnProperty(a.composing_type)&&(clearTimeout(this.composingMessageRemovalTimeout),i[a.composing_type]())});hbl.eventmgr.register("nrpc_data_ready",function(c){c=b.__determine_presence_from_nrpc_event(c);b.__last_op_presence.set(c);i=!0;a.trigger_event({namespace:"chat",type:"dataReady"})});hbl.eventmgr.register("operator_status_change",function(c){c=b.__determine_presence_from_nrpc_event(c);
switch(c){case "available":a.trigger_event({namespace:"chat",type:"operatorsAvailable",previously:d});break;case "away":a.trigger_event({namespace:"chat",type:"operatorsAway",previously:d})}d=c;b.__last_op_presence.set(d);m||(j=!1,m=!0,a.trigger_event({namespace:"chat",type:"onReady",after:function(){a.trigger_event({namespace:"SessionConnection",type:"afterReady"})}}))},9999);b.__wait_for_chat_to_connect(function(){a.run_legacy_code(function(){window.habla_window.send_pipeline.add(function(a){b.__send_and_deliver_message_from_visitor({legacy_message_tuple:[null,
a,null]})},1001)})});window.olark.__legacy_shim.pipeline_disabler=function(){};b.__wait_for_chat_to_connect(function(){window.hbl.client.incoming_pipeline.add(function(d){var e=d[0],h=d[1],i=parseFloat(d[2]||-1),k=b.__last_cmd_seq_id.get();(h=c.exec(h))?(parseFloat(k)!=k&&(olark._.hlog("resetting last_command_index to 0, found a string instead #reset_string_command_index #warn"),k=0,b.__last_cmd_seq_id.set(k)),i>k?(b.__last_cmd_seq_id.set(i),i=h[1],(k=h[2])&&k.length===0&&(k=null),a.trigger_event({namespace:"chat",
type:"commandFromOperator",nickname:e,name:i,body:k})):olark._.hlog("dropping command",h[1],"due to sequence ID mismatch",i,"<=",k,"#warn #dropped_command")):b.__send_and_deliver_message_from_operator({legacy_message_tuple:d,is_automated:!1});return d},1001)})}};k.prototype.__SPI_getMessageHistory=function(a){var b=this.__get_message_history();a&&a(b);return b};k.prototype.__SPI_populatedLocalChatHistoryFromRpcServer=function(){return!this.__has_local_history};k.prototype.__SPI_onPrechatInfoReceived=
function(b){a.listen_for_event({namespace:"chat",type:"prechatInfoReceived",callback:b})};k.prototype.__initialize_legacy_history_tracking=function(){var d=this;if(!t){t=!0;var h=function(a){var h=parseFloat(d.__last_leg_seq_id.get());if(!a.__legacy_sequence_id)a.__legacy_sequence_id=d.__get_next_message_sequence_id_that_is_server_safe();if(h<a.__legacy_sequence_id){d.__last_leg_seq_id.set(a.__legacy_sequence_id);var i=d.__get_message_history();e(i)||(b.error("[olark] expected message_history to be a list:",
i),i=[]);c.test(a.message.body)||i.push({nickname:a.message.nickname,body:a.message.body});var k=function(){i=i.slice(1,i.length);b.warn("[olark] trying to shrink message history, now has",i.length,"entries");i.length>0?d.__SPI_setMessageHistory(i,k):d.__SPI_setMessageHistory([])};d.__SPI_setMessageHistory(i,k)}};d.__SPI_onDeliveryOfMessageFromOperator(h);d.__SPI_onDeliveryOfMessageFromVisitor(h);hbl.eventmgr.register("chat_loaded",a.create_idempotent_callback(function(){a.trigger_event({namespace:"chat",
type:"legacyChatLoaded"})}));window.olark.__legacy_shim.load_missed_messages=a.create_idempotent_callback(function(a){d.__has_local_history=a.length!==0&&d.__last_leg_seq_id.get();for(var b=0;b<a.length;){var e=a[b],i=e[0],k=e[1],g=e[2],j=d.__last_leg_seq_id.get();c.test(e[1])||(d.__has_local_history?g>j&&d.__send_and_deliver_message_from_operator({legacy_message_tuple:e,is_automated:!1}):h({__legacy_sequence_id:parseFloat(g),message:{nickname:i,body:k}}));b++}});var i=d.__SPI_getMessageHistory();
window.olark.__legacy_shim.has_messages_in_history=i&&i.length>0?!0:!1}};olark.declare({name:"__ChatApiHelper",startup:function(b,c){function d(){setTimeout(function(){try{var a=window.hbl.client.buffer.length>0,b=habla_window.getHeader()==c.system.before_chat_text;a&&b&&habla_window.setHeader(c.system.in_chat_text)}catch(d){}},900)}var e=!1;window.olark.__legacy_shim.send_prechat_info=function(c){if(!e){e=!0;var d="";c.name&&c.name.length&&c.name!="undefined"&&(b.visitor.addFullName(c.name),d+="\n    name: "+
c.name);c.email&&c.email.length&&c.email!="undefined"&&(b.visitor.addEmailAddress(c.email),d+="\n    email: "+c.email);c.phone&&c.phone.length&&c.phone!="undefined"&&(b.visitor.updatePhoneNumber(c.phone),d+="\n    phone: "+c.phone);d||(d="Prechat survey left blank.");b.chat.sendNotificationToOperator({body:d});a.trigger_event({namespace:"chat",type:"prechatInfoReceived"})}};b.chat.onMessageToVisitor(d);b.chat.onMessageToOperator(d);var h=b.data.getConversationObject({key:"lock",initialValue:!1}),
i=null,k=null,g=b.data.getConversationObject({key:"isFirstBusyCommand",initialValue:!0}),j=function(){i||(i=setInterval(function(){q()},12E4),k=setInterval(function(){b.chat.sendNotificationToOperator({body:"this visitor is still locked into chat, to unlock this visitor type !unlock"})},6E5))},l=function(){i&&(clearInterval(i),clearInterval(k),k=i=null)},q=function(){a.run_legacy_code(function(a){a.hbl.client.sendcommand("return_long_poll_now","")})};b.chat.onReady(function(){h.get()===!0?j():l()});
b.chat.onCommandFromOperator(function(d){switch(d.command.name){case "lock":h.set(!0);b.chat.sendNotificationToOperator({body:"visitor has been locked into this chat, to unlock this visitor type !unlock"});j();break;case "unlock":h.set(!1);b.chat.sendNotificationToOperator({body:"visitor has been unlocked from this chat"});l();break;case "end":b.chat.sendNotificationToVisitor({body:c.locale.ended_chat_message});a.trigger_event({namespace:"chat",type:"endConversation"});break;case "busy":var e=c.locale.operator_busy_message_update||
"Just checking in - I'm still busy chatting with {{ active_conversation_count }} other customers. I'll be with you as soon as I can.";g.get()&&(e=c.locale.operator_busy_message||"Sorry, I'm currently a bit busy at the moment with {{ active_conversation_count }} other customers. I'll be with you as soon as I can.",b.chat.sendNotificationToOperator({body:"Visitor has been queued. Simply send a message to start chatting and remove them from the queue."}),g.set(!1));d=parseInt(d.command.body);b.chat.sendNotificationToVisitor({body:e.replace(/\{\{\s*active_conversation_count\s*\}\}/g,
d)});a.trigger_event({namespace:"chat",type:"operatorIsBusy"})}});b.chat.onCommandFromOperator(function(a){switch(a.command.name){case "transfer":b.chat.__SPI_unlockFromCurrentGroup();break;case "name":a=a.command.body;b.visitor.updateFullName({fullName:a});b.chat.sendNotificationToOperator({body:"remembering visitor name as "+a});break;case "email":a=a.command.body;b.visitor.updateEmailAddress({emailAddress:a});b.chat.sendNotificationToOperator({body:"remembering visitor email as "+a});break;case "phone":a=
a.command.body,b.visitor.updatePhoneNumber({phoneNumber:a}),b.chat.sendNotificationToOperator({body:"remembering visitor phone number as "+a})}});b.chat.onCommandFromOperator(function(a){a.command.name=="help"&&b.chat.sendNotificationToOperator({body:"quick reference for the commands you can type at any time...\n\n!tag\n     tag this conversation, like '!tag followup' or '!tag important'\n\n!transfer\n     transfer this visitor to another operator.  Optionally give a note, like '!transfer This guy needs help with billing'\n\n!unfollow\n     stop receiving page-change notifications for this visitor\n\n!push\n     push this visitor to a URL, like '!push www.google.com'\n\n!block\n     block this visitor\nFor more commands, check out http://www.olark.com/help/olark-commands\n"})});
b.box.onDismiss(function(){b.chat.__SPI_endConversation()});b.chat.onBeginConversation(function(){b.chat.__SPI_lockToOperatorGroup(c.system.group||c.system.olark_group||null)});b.chat.__SPI_lockToExistingOperatorGroupIfGiven(c.system.group||c.system.olark_group||null);if(c.system.forced_rpc_server)window.hbl_hostname=c.system.forced_rpc_server,window.hblrpcTrick=0}});olark.extend("__ChatApiHelper");a.chat={ChatApi:k,SessionConnection:h}})})(window.olark.__core,window.olark.__core.logger);
(function(a){a.wait_for(function(){return!0},function(){var b={},e=function(a){this.__namespace=a.namespace;if(typeof this.__namespace=="undefined")throw Error("'namespace' required");this.__methods=b[this.__namespace]={}};e.prototype.exportMethods=function(a){a(this.__methods)};e.prototype.importMethods=function(c,e){if(!a.is_extension_required({extension_name:c}))throw Error("extension '"+c+"' is required for "+this.__namespace);var j=b[c];if(j)e(j);else{var m=!1;a.listen_for_event({namespace:"Extension",
type:"extensionActivated",callback:function(){if((j=b[c])&&!m)m=!0,e(j)}})}};a.extensions={ExtensionsApi:e}})})(window.olark.__core,window.olark.__core.logger);
(function(a){a.wait_for(function(){return a.chat},function(){var b={encode:function(a){a=a.replace(/\r\n/g,"\n");for(var b="",c=0;c<a.length;c++){var e=a.charCodeAt(c);e<128?b+=String.fromCharCode(e):(e>127&&e<2048?b+=String.fromCharCode(e>>6|192):(b+=String.fromCharCode(e>>12|224),b+=String.fromCharCode(e>>6&63|128)),b+=String.fromCharCode(e&63|128))}return b},decode:function(a){for(var b="",c=0,e=c1=c2=0;c<a.length;)e=a.charCodeAt(c),e<128?(b+=String.fromCharCode(e),c++):e>191&&e<224?(c2=a.charCodeAt(c+
1),b+=String.fromCharCode((e&31)<<6|c2&63),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((e&15)<<12|(c2&63)<<6|c3&63),c+=3);return b}},e=!1,c=function(b){var c=this;c.__namespace=b.namespace;c.__conf=b.conf;if(typeof c.__namespace=="undefined")throw Error("'namespace' required");c.__session_connection=a.chat.SessionConnection.get_instance();b=function(){var b=c.__session_connection.get_local_data({key:"BrowserApi::last_page_visited"}),d=olark._.overrideWindowHref||document.location.href.toString();
b!==d&&(a.trigger_event({namespace:"BrowserApi",type:"locationChange",previousUrl:b,currentUrl:d}),c.__session_connection.put_local_data({key:"BrowserApi::last_page_visited",value:d}))};if(!e){e=!0;a.after_extensions_are_activated(b);if(c.__conf.system.hashchange_events_trigger_page_change)try{a.listen_for_browser_event(window,"hashchange",b)}catch(m){}var l=window.history&&window.history.pushState;if(c.__conf.system.history_events_trigger_page_change!==!1&&l)try{var d=window.history.pushState;window.history.pushState=
function(){d.apply(window.history,arguments);a.trigger_event({namespace:"BrowserApi",type:"pushstateChanged"})};var i=window.history.replaceState;window.history.replaceState=function(){i.apply(window.history,arguments);a.trigger_event({namespace:"BrowserApi",type:"pushstateChanged"})};a.listen_for_event({namespace:"BrowserApi",type:"pushstateChanged",callback:b});a.listen_for_browser_event(window.history,"popstate",b)}catch(t){}}};c.prototype.onPageChange=function(b){a.listen_for_event({namespace:"BrowserApi",
type:"locationChange",callback:function(a){b({newPage:a.currentUrl,oldPage:a.previousUrl})}})};c.prototype.__SPI_getSafeUrl=function(a){/webkit/.test(navigator.userAgent.toString().toLowerCase())&&(a=b.decode(unescape(a)));return a.replace(/ /g,"%20")};a.browser={BrowserApi:c}})})(window.olark.__core,window.olark.__core.logger);
(function(a,b){a.wait_for(function(){return a.data},function(){function e(a){a=a||function(){};var b="olark_"+Math.random().toString().replace(".","");window[b]=function(c){a(c);window[b]=void 0;try{delete window[b]}catch(e){}};return b}function c(a){try{var b=/(q|p|query|queryTerms?)\=([^&\#]+)/i.exec(a)[2],c=decodeURIComponent(b).replace(/\+/g," ");a=/(?:\((.+?)\)|"(.+?)"|'(.+?)'|([^\s]+))/g;b=[];for(var e;e=a.exec(c);)b.push(e[2]||e[3]||e[4]);return{text:/^\s*$/.test(c)?null:c,terms:b}}catch(g){return{text:null,
terms:[]}}}function g(a){try{for(var b={},c;c=rawQuery.exec(a);)try{b[c[1]]=decodeURIComponent(c[2]).replace(/\+/g," ")}catch(e){}return b}catch(g){return{}}}var j=!1,m=function(a){var b=this;b.__namespace=a.namespace;if(typeof b.__namespace=="undefined")throw Error("'namespace' required");var c=a.data;a=a.browser;b.__fullNameObject=c.getVisitorObject({key:"visFullName",initialValue:null,__SPI_forceNamespace:"__api"});b.__emailAddressObject=c.getVisitorObject({key:"visEmailAddress",initialValue:null,
__SPI_forceNamespace:"__api"});b.__phoneNumberObject=c.getVisitorObject({key:"visPhoneNumber",initialValue:null,__SPI_forceNamespace:"__api"});b.__recentPageHistory=c.getVisitorObject({key:"rph",initialValue:[],__SPI_forceNamespace:"__vis"});b.__visitHistory=c.getVisitorObject({key:"vh",initialValue:[],__SPI_forceNamespace:"__vis"});b.__isNewVisit=c.getConversationObject({key:"inv",initialValue:!0,__SPI_forceNamespace:"__vis"});b.__importance=c.getVisitorObject({key:"imp",initialValue:0,__SPI_forceNamespace:"__vis"});
b.__notes=c.getVisitorObject({key:"nts",initialValue:[],__SPI_forceNamespace:"__vis"});b.__mostRecentMessage=c.getConversationObject({key:"mrcm",initialValue:void 0,__SPI_forceNamespace:"__vis"});b.__mostRecentNotificationToOperator=c.getConversationObject({key:"mrno",initialValue:void 0,__SPI_forceNamespace:"__vis"});b.__mostRecentMessageToOperator=c.getConversationObject({key:"mrcmo",initialValue:void 0,__SPI_forceNamespace:"__vis"});b.__mostRecentMessageToVisitor=c.getConversationObject({key:"mrcmv",
initialValue:void 0,__SPI_forceNamespace:"__vis"});b.__visitFields=c.getConversationObject({key:"vf",initialValue:{},__SPI_forceNamespace:"__vis"});b.__didSyncName=c.getConversationObject({key:"dsn",initialValue:!1,__SPI_forceNamespace:"__vis"});b.__didSyncEmail=c.getConversationObject({key:"dse",initialValue:!1,__SPI_forceNamespace:"__vis"});b.__didSyncPhone=c.getConversationObject({key:"dsp",initialValue:!1,__SPI_forceNamespace:"__vis"});b.__conversationBeginPage=c.getConversationObject({key:"cbp",
initialValue:void 0,__SPI_forceNamespace:"__vis"});b.__landedOnPageTimestamp=+new Date;a.onPageChange(function(){b.__landedOnPageTimestamp=+new Date});if(!j){j=!0;var e=b.__recentPageHistory.get();c=function(){var a=e[e.length-1];a=a?a.url:null;if(e.length===0||document.location.href!==a)e.push({title:document.title.length?document.title:null,url:document.location.href,timestamp:+new Date}),e.length>10&&(e=e.slice(e.length-10)),b.__recentPageHistory.set(e)};c();a.onPageChange(c);c=b.__visitHistory.get().length===
0;if((a=b.__isNewVisit.get())||c)a||olark._.hlog("got #empty_history, treating as new visit for visit history"),b.__isNewVisit.set(!1),c=b.__visitHistory.get(),c.push({didChat:!1,pageCount:0,messageCount:0,referrer:document.referrer.toString(),createdAt:+new Date,updatedAt:+new Date}),b.__visitHistory.set(c);var g=function(){b.__SPI_bumpVisitHistoryTimestamp();setTimeout(g,9E3)};g();c=b.__visitHistory.get();c=b.__updateMostRecentTimestampOnHistory(c);c[c.length-1].pageCount+=1;b.__visitHistory.set(c);
olark("api.chat.onBeginConversation",function(){var a=b.__visitHistory.get(),c=a[a.length-1];if(c&&c.didChat!==!0)c.didChat=!0,b.__visitHistory.set(a),b.__conversationBeginPage.set(document.location.href)});var l=function(){var a=b.__visitHistory.get(),c=a[a.length-1]||{};c.messageCount=c.messageCount||0;c.messageCount++;b.__visitHistory.set(a)};olark("api.chat.onMessageToOperator",function(){b.__mostRecentMessage.set(+new Date);b.__mostRecentMessageToOperator.set(+new Date);l()});olark("api.chat.onMessageToVisitor",
function(){b.__mostRecentMessage.set(+new Date);b.__mostRecentMessageToVisitor.set(+new Date);l()});olark("api.chat.onNotificationToOperator",function(){b.__mostRecentNotificationToOperator.set(+new Date)});b.__SPI_prepopulateEmailFields();b.__SPI_prepopulateFullNameFields();b.__SPI_prepopulatePhoneNumberFields();b.__SPI_prepopulateChatNicknameFromBestVisitorInformation();this.__emailAddressObject.__SPI_onChange(function(){b.__SPI_prepopulateEmailFields();b.__SPI_prepopulateChatNicknameFromBestVisitorInformation();
b.__didSyncEmail.set(!1);b.__ensureVisitorDataSynced({emailAddress:!0})});this.__fullNameObject.__SPI_onChange(function(){b.__SPI_prepopulateFullNameFields();b.__SPI_prepopulateChatNicknameFromBestVisitorInformation();b.__didSyncName.set(!1);b.__ensureVisitorDataSynced({fullName:!0})});this.__phoneNumberObject.__SPI_onChange(function(){b.__SPI_prepopulatePhoneNumberFields();b.__didSyncPhone.set(!1);b.__ensureVisitorDataSynced({phoneNumber:!0})});b.__ensureVisitorDataSynced({fullName:!0,emailAddress:!0,
phoneNumber:!0})}};(function(d){function i(a,b){var c=olark;m?b&&b(m[a]):c("api.chat.whenDataReady",function(){m=olark._.geoip;b&&b((m||{})[a])});return(m||{})[a]}function j(a,b){var c=b();a&&a(c);return c}var m=null,s=0,o=null;d.__ensureVisitorDataSynced=function(b){var c=this,d=!1;if(!(b.retry&&s>=3)){var f=function(b,c,h,f){!c.get()&&b.get()&&(b=["site_id="+encodeURIComponent(olark._.identityManager.getSiteId()),"visitor_id="+encodeURIComponent(olark._.identityManager.getVisitorId()),h+"="+encodeURIComponent(b.get()),
"cache="+encodeURIComponent(Math.random()),"jsonp="+e(function(a){a.success&&(s=0,c.set(!0))})],d=!0,c.set(!1),a.async_script_load({url:olark._.apiHost+"/1.0/visitor/"+f+"?"+b.join("&")}))};b.fullName&&f(c.__fullNameObject,c.__didSyncName,"full_name","addFullName");b.emailAddress&&f(c.__emailAddressObject,c.__didSyncEmail,"email_address","addEmailAddress");b.phoneNumber&&f(c.__phoneNumberObject,c.__didSyncPhone,"phone_number","addPhoneNumber");if(d)for(var i in b.retry&&s++,o||(o={},a.do_async_call({delay:1E4},
function(){var a=o;a.retry=!0;o=null;c.__ensureVisitorDataSynced(a)})),b)b.hasOwnProperty(i)&&(o[i]=b[i])}};d.__SPI_getBrowser=function(){var a=l.parse(window.navigator.userAgent);return a.family+" "+a.toVersionString()};d.__SPI_getOs=function(){var a=navigator.platform;if(/Mac/.test(a))return"Mac OSX";else if(/Linux/.test(a))return"Linux";else if(/Win/.test(a))return"Windows"};d.__SPI_getIp=function(){return olark._.ipaddress};d.__SPI_getRecentPageHistory=function(){return this.__recentPageHistory.get()||
[]};d.__SPI_prepopulateEmailFields=function(){var a=this.__emailAddressObject.get();olark("api.box.__SPI_setThemeTextField","habla_pre_chat_email_input",a);olark("api.box.__SPI_setThemeTextField","habla_offline_email_input",a)};d.__SPI_prepopulateFullNameFields=function(){var a=this.__fullNameObject.get();olark("api.box.__SPI_setThemeTextField","habla_pre_chat_name_input",a);olark("api.box.__SPI_setThemeTextField","habla_name_input",a)};d.__SPI_prepopulatePhoneNumberFields=function(){var a=this.__phoneNumberObject.get();
olark("api.box.__SPI_setThemeTextField","habla_pre_chat_phone_input",a);olark("api.box.__SPI_setThemeTextField","habla_offline_phone_input",a)};d.__SPI_prepopulateChatNicknameFromBestVisitorInformation=function(){var a=this.__fullNameObject.get(),b=this.__emailAddressObject.get(),c;a&&b?c=a+" ("+b+")":a?c=a:b&&(c=b);c&&olark("api.chat.updateVisitorNickname",{snippet:c,hidesDefault:!0})};d.__SPI_getIsInspecting=function(a){return j(a,function(){return olark._.cookieManager.get("_okinspect")?!0:!1})};
d.__SPI_setIsInspecting=function(a){a?olark._.cookieManager.set("_okinspect",a):olark._.cookieManager.erase("_okinspect")};d.__SPI_bumpVisitHistoryTimestamp=function(){var a=this.__visitHistory.get();a=this.__updateMostRecentTimestampOnHistory(a);this.__visitHistory.set(a)};d.__updateMostRecentTimestampOnHistory=function(a){var b=a[a.length-1];if(b)b.updatedAt=+new Date;return a};d.addEmailAddress=function(a){this.updateEmailAddress(a)};d.updateEmailAddress=function(a){a=a.emailAddress||a;if(typeof a!=
"string")throw Error("[olark] emailAddress string expected");a=hbl.util.strip_whitespace(hbl.util.decode_html_entities(a));a=a.split(" ")[0];if(hbl.util.is_valid_email(a))this.__emailAddressObject.set(a);else throw Error("[olark] invalid email address: '"+a+"'");};d.addFullName=function(a){this.updateFullName(a)};d.updateFullName=function(a){a=a.fullName||a;if(typeof a!="string")throw Error("[olark] fullName string expected");a=hbl.util.strip_whitespace(hbl.util.decode_html_entities(a));this.__fullNameObject.set(a)};
d.updatePhoneNumber=function(a){a=a.phoneNumber||a;if(typeof a!="string")throw Error("[olark] phoneNumber string expected");a=hbl.util.strip_whitespace(hbl.util.decode_html_entities(a));this.__phoneNumberObject.set(a)};d.getFullName=function(a){var b=this;return j(a,function(){return b.__fullNameObject.get()})};d.getEmailAddress=function(a){var b=this;return j(a,function(){return b.__emailAddressObject.get()})};d.getPhoneNumber=function(a){var b=this;return j(a,function(){return b.__phoneNumberObject.get()})};
d.onChange=function(a){this.__fullNameObject.__SPI_onChange(a);this.__emailAddressObject.__SPI_onChange(a);this.__phoneNumberObject.__SPI_onChange(a);this.__visitHistory.__SPI_onChange(a);this.__recentPageHistory.__SPI_onChange(a);this.__importance.__SPI_onChange(a);this.__notes.__SPI_onChange(a)};d.getCity=function(a){return i("city",a)};d.getRegion=function(a){return i("state",a)};d.getCountry=function(a){return i("country",a)};d.getCountryCode=function(a){return i("country_code",a)};d.getOrganization=
function(a){var b;i("isp",function(c){i("organization",function(d){b=c!=d?d:{}.undefinedValue;a&&a(b)})});return b};d.updateImportance=function(a){try{var b=parseInt(a.value||a)}catch(c){b=-1}if(b<0||b>3)throw Error("[olark] visitor importance must be an integer between 0-3");else this.__importance.set(b)};d.addNote=function(a){a=a.body||a;var b=this.__notes.get();if(typeof a!="string")throw Error("[olark] visitor notes must be strings");for(var c=!1,d=0;d<b.length;d++)if(b[d]==a){c=!0;break}c||(b.push(a),
this.__notes.set(b))};d.updateCustomFields=function(b){var c=a.framestorewithjson.json,d=c.encode(this.__visitFields.get());c=c.encode(b);d!=c&&(this.__visitFields.set(b),b=["conversation_id="+encodeURIComponent(olark._.identityManager.getConversationId()),"site_id="+encodeURIComponent(olark._.identityManager.getSiteId()),"custom_fields_json="+encodeURIComponent(c),"cache="+encodeURIComponent(Math.random()),"jsonp="+e()],a.async_script_load({url:olark._.apiHost+"/1.0/visitor/updateDetailsForThisVisit?"+
b.join("&")}))};d.updateDetailsForThisVisit=function(a){this.updateCustomFields(a)};d.getDetailsForThisVisit=function(a){a(this.__visitFields.get())};d.trackConversion=function(){var b=["conversation_id="+encodeURIComponent(olark._.identityManager.getConversationId()),"site_id="+encodeURIComponent(olark._.identityManager.getSiteId()),"cache="+encodeURIComponent(Math.random()),"jsonp="+e()];a.async_script_load({url:olark._.apiHost+"/1.0/visitor/trackConversion?"+b.join("&")})};d.getDetails=function(a){var d=
this,e=null;d.getCity(function(f){try{var j=d.getRegion(),l=d.getCountry(),m=d.getCountryCode(),o=d.getOrganization(),v=function(){var a=i("domain"),b=d.getOrganization();return/(gov|edu|ibm|microsoft)/i.test(a)||b?a:void 0}(),t=d.__recentPageHistory.get(),p=d.__visitHistory.get(),r=d.__conversationBeginPage.get();p.length==0&&(p.push({}),olark._.hlog("#history_is_empty in getDetails"));t.length==0&&(t.push({}),olark._.hlog("#page_history_is_empty in getDetails"));var s=p[p.length-1].referrer;s&&
s.indexOf(" ")>0&&(s=encodeURI(s));for(var A=0,J=0,K=0,L=0,D=!1,E=!1,F=!1,I=!1,H="",G=[],B=0;B<p.length;B++){var O=B==p.length-1;A+=p[B].pageCount;J+=p[B].messageCount||0;p[B].didChat&&K++;L+=p[B].updatedAt-p[B].createdAt;var P=g(p[B].referrer);P.campaign&&(F=!0,O&&(I=!0));var V=/(cpc|ppc)/i.test(P.medium||""),W=P.term,R=/gclid\=/.test(p[B].referrer);if(W||R||V)D=!0,O&&(E=!0);var Q=c(p[B].referrer);if(Q.text)O?H=Q.text:G.push(Q.text)}B=function(a){return a?(+new Date-a)/1E3:{}.undefinedValue};var N;
try{N=d.__visitFields.get()}catch(X){N={}}e={recentPageHistory:t,currentPage:t[t.length-1],conversationBeginPage:r,referrer:s,referredByPaidAdvertisingEver:D,referredByPaidAdvertisingThisVisit:E,referredByCampaignEver:F,referredByCampaignThisVisit:I,searchTextForThisVisit:H,searchTextForPreviousVisits:G,pageCountForThisVisit:p[p.length-1].pageCount,pageCountAcrossAllVisits:A,messageCountForThisVisit:p[p.length-1].messageCount||0,messageCountAcrossAllVisits:J,visitCount:p.length,conversationCount:K,
isConversing:p[p.length-1].didChat,secondsSpentOnCurrentPage:Math.round((+new Date-d.__landedOnPageTimestamp)/1E3),secondsSpentForThisVisit:Math.round((+new Date-p[p.length-1].createdAt)/1E3),secondsSpentAcrossAllVisits:Math.round(L/1E3),city:f,region:j,country:l,countryCode:m,organization:o,domain:v,fullName:d.getFullName(),emailAddress:d.getEmailAddress(),phoneNumber:d.getPhoneNumber(),importance:d.__importance.get(),notes:d.__notes.get(),browser:d.__SPI_getBrowser(),operatingSystem:d.__SPI_getOs(),
ip:d.__SPI_getIp(),secondsSinceLastMessage:B(d.__mostRecentMessage.get()),secondsSinceLastNotificationToOperator:B(d.__mostRecentNotificationToOperator.get()),secondsSinceLastMessageToOperator:B(d.__mostRecentMessageToOperator.get()),secondsSinceLastMessageToVisitor:B(d.__mostRecentMessageToVisitor.get()),customFields:N}}catch(S){b.error("#error - getDetails",S.message),e={}}a&&a(e)});return e};d.__SPI_getNotes=function(a){var b=this;return j(a,function(){return b.__notes.get()})};d.__SPI_getVisitHistory=
function(a){var b=this;return j(a,function(){return b.__visitHistory.get()})}})(m.prototype);var l=function(){function a(b){this.family=b||"Other"}var b=[{p:"^(Opera)/(\\d+)\\.(\\d+) \\(Nintendo Wii",f:"Wii"},{p:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?)",f:"Firefox ($1)"},{p:"(Namoroka|Shiretoko|Minefield)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)?",f:"Firefox ($1)"},{p:"(SeaMonkey|Fennec|Camino)/(\\d+)\\.(\\d+)([ab]?\\d+[a-z]*)"},{p:"(Flock)/(\\d+)\\.(\\d+)(b\\d+?)"},{p:"(Fennec)/(\\d+)\\.(\\d+)(pre)"},
{p:"(Navigator)/(\\d+)\\.(\\d+)\\.(\\d+)",f:"Netscape"},{p:"(Navigator)/(\\d+)\\.(\\d+)([ab]\\d+)",f:"Netscape"},{p:"(Netscape6)/(\\d+)\\.(\\d+)\\.(\\d+)",f:"Netscape"},{p:"(MyIBrow)/(\\d+)\\.(\\d+)",f:"My Internet Browser"},{p:"(Firefox).*Tablet browser (\\d+)\\.(\\d+)\\.(\\d+)",f:"MicroB"},{p:"(Opera)/9.80.*Version\\/(\\d+)\\.(\\d+)(?:\\.(\\d+))?"},{p:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+(?:pre)?) \\(Swiftfox\\)",f:"Swiftfox"},{p:"(Firefox)/(\\d+)\\.(\\d+)([ab]\\d+[a-z]*)? \\(Swiftfox\\)",f:"Swiftfox"},
{p:"(konqueror)/(\\d+)\\.(\\d+)\\.(\\d+)",f:"Konqueror"},{p:"(Jasmine|ANTGalio|Midori|Fresco|Lobo|Maxthon|Lynx|OmniWeb|Dillo|Camino|Demeter|Fluid|Fennec|Shiira|Sunrise|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Vodafone|NetFront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|Opera Mini|iCab|NetNewsWire|Iron|Iris)/(\\d+)\\.(\\d+)\\.(\\d+)"},{p:"(Bolt|Jasmine|Maxthon|Lynx|Arora|IBrowse|Dillo|Camino|Shiira|Fennec|Phoenix|Chrome|Flock|Netscape|Lunascape|Epiphany|WebPilot|Opera Mini|Opera|Vodafone|NetFront|Konqueror|SeaMonkey|Kazehakase|Vienna|Iceape|Iceweasel|IceWeasel|Iron|K-Meleon|Sleipnir|Galeon|GranParadiso|iCab|NetNewsWire|Iron|Space Bison|Stainless|Orca)/(\\d+)\\.(\\d+)"},
{p:"(iRider|Crazy Browser|SkipStone|iCab|Lunascape|Sleipnir|Maemo Browser) (\\d+)\\.(\\d+)\\.(\\d+)"},{p:"(iCab|Lunascape|Opera|Android) (\\d+)\\.(\\d+)"},{p:"(IEMobile) (\\d+)\\.(\\d+)",f:"IE Mobile"},{p:"(Firefox)/(\\d+)\\.(\\d+)\\.(\\d+)"},{p:"(Firefox)/(\\d+)\\.(\\d+)(pre|[ab]\\d+[a-z]*)?"},{p:"(Obigo|OBIGO)[^\\d]*(\\d+)(?:.(\\d+))?",f:"Obigo"},{p:"(MAXTHON|Maxthon) (\\d+)\\.(\\d+)",f:"Maxthon"},{p:"(Maxthon|MyIE2|Uzbl|Shiira)",r:"0"},{p:"(PLAYSTATION) (\\d+)",f:"PlayStation"},{p:"(PlayStation Portable)[^\\d]+(\\d+).(\\d+)"},
{p:"(BrowseX) \\((\\d+)\\.(\\d+)\\.(\\d+)"},{p:"(Opera)/(\\d+)\\.(\\d+).*Opera Mobi",f:"Opera Mobile"},{p:"(POLARIS)/(\\d+)\\.(\\d+)",f:"Polaris"},{p:"(BonEcho)/(\\d+)\\.(\\d+)\\.(\\d+)",f:"Bon Echo"},{p:"(iPhone) OS (\\d+)_(\\d+)(?:_(\\d+))?"},{p:"(Avant)",r:"1"},{p:"(Nokia)[EN]?(\\d+)"},{p:"(Black[bB]erry)(\\d+)",f:"Blackberry"},{p:"(OmniWeb)/v(\\d+)\\.(\\d+)"},{p:"(Blazer)/(\\d+)\\.(\\d+)",f:"Palm Blazer"},{p:"(Pre)/(\\d+)\\.(\\d+)",f:"Palm Pre"},{p:"(Links) \\((\\d+)\\.(\\d+)"},{p:"(QtWeb) Internet Browser/(\\d+)\\.(\\d+)"},
{p:"(Version)/(\\d+)\\.(\\d+)(?:\\.(\\d+))?.*Safari/",f:"Safari"},{p:"(OLPC)/Update(\\d+)\\.(\\d+)"},{p:"(OLPC)/Update()\\.(\\d+)",r:"0"},{p:"(SamsungSGHi560)",f:"Samsung SGHi560"},{p:"^(SonyEricssonK800i)",f:"Sony Ericsson K800i"},{p:"(Teleca Q7)"},{p:"(MSIE) (\\d+)\\.(\\d+)",f:"Internet Explorer"}],c=[],e;for(e=0;e<b.length;e++)(function(b){var e=RegExp(b.p),h=b.f||null,i=b.r||null;c.push(function(b){b=b.match(e);var c;if(!b)return null;c=h?h.replace("$1",b[1]):b[1];c=new a(c);c.major=parseInt(i?
i:b[2]);c.minor=b[3]?parseInt(b[3]):null;c.patch=b[4]?parseInt(b[4]):null;return c})})(b[e]);a.prototype.toVersionString=function(){var a="";this.major!=null&&(a+=this.major,this.minor!=null&&(a+="."+this.minor,this.patch!=null&&(a+="."+this.patch)));return a};a.prototype.toString=function(){var a=this.toVersionString();a&&(a=" "+a);return this.family+a};return{parse:function(b){var e,h;for(e=0;e<c.length;e++)if(h=c[e](b))return h;return new a}}}();a.visitor={VisitorApi:m}})})(window.olark.__core,
window.olark.__core.logger);
(function(a){a.wait_for(function(){return a.data},function(){var b=900,e=function(a){var b=a.data;this.__browserApi=a.browser;this.__didActionForVisitor=b.getVisitorObject({key:"dafv",initialValue:{},__SPI_forceNamespace:"__rul"});this.__didActionForConversation=b.getConversationObject({key:"dafc",initialValue:{},__SPI_forceNamespace:"__rul"})};(function(a){function e(a){var b=function(a,c){c(a);if(a.clauses)for(var d=0;d<a.clauses.length;d++)b(clauses[d],c);a.left&&b(a.left,c);a.right&&b(a.right,
c)},c=olark._.rulesLookup[a];if(c){var i={},g=[],j=[];b(c.clause,function(a){a.kind==="VariableClause"&&(a=a.varname.replace("visitor.",""),a=a.replace(/\./g,"_"),i[a]||(g.push(a),i[a]=!0))});for(var s=0;s<c.actions.length;s++){var o=c.actions[s].method.replace("api.","");o=o.replace(/\./g,"_");j.push(o)}olark._.hlog("rule "+a,"#triggered_rule_action."+j.join(","),"#used_rule_variables."+g.join(","))}else olark._.hlog("rule "+a+" #triggered_rule_action on site")}function j(a,b,c,i){function j(){i.set(!0);
c();try{e(a)}catch(b){}}i.get()!==!0&&b(j)}a.defineRule=function(a){function c(){k===0?j(e,g,r,q):f||(f=setTimeout(function(){f=null;j(e,g,r,q)},b))}var d=this,e=a.id,g=a.condition,r=a.action,s=a.perVisit,o=a.perVisitor,h=a.perPage,q={get:function(){return s||o?(s?d.__didActionForConversation:d.__didActionForVisitor).get()[e]:h?q.value:!1},set:function(a){if(s||o){var b=s?d.__didActionForConversation:d.__didActionForVisitor,c=b.get();c[e]=a;b.set(c)}else if(h)q.value=a}},k=0,f=null;olark("api.boot.onIdentityReady",
c);olark("api.visitor.onChange",c);olark("api.chat.onReady",c);olark("api.chat.onOperatorsAway",c);olark("api.chat.onOperatorsBusy",c);olark("api.chat.onOperatorsAvailable",c);d.__browserApi.onPageChange(function(){h&&q.set(!1);c()})}})(e.prototype);a.rules={RulesApi:e}})})(window.olark.__core,window.olark.__core.logger);
(function(a,b){a.wait_for(function(){return!0},function(){var e=["callback"],c=["jsonp","callback","cb"],g=function(a){for(var c="",e=0;e<a.length;e++){var g=a.charAt(e);g==" "?c+="+":"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_.!~*'()".indexOf(g)!=-1?c+=g:(g=g.charCodeAt(0),g>255?(b.error("[olark] unicode character cannot be URL encoded, attempting to substitute plus sign"),c+="+"):(c+="%",c+="0123456789ABCDEF".charAt(g>>4&15),c+="0123456789ABCDEF".charAt(g&15)))}return c},j=
function(a){for(var d=c.length;d--;){var e=c[d];if(typeof a[e]=="function")return{name:e,callback:a[e]}}var g=function(){b.warn("[olark] no callback handler given for JSONP request")},j=null,m;for(m in kwargs)typeof kwargs[m]=="function"&&function(a,c){j=a;g=function(){b.warn("[olark] you may be using a nonstandard jsonp callback '",a,"'");c.apply(c,arguments)}}(m,kwargs[m]);return{name:j,callback:g}},m=function(){};m.prototype.requestJson=function(a,b){var c=a.url;if(typeof c!="string")throw Error("[olark] string 'url' is required");
var m=a.params;if(typeof m!="object")throw Error("[olark] dictionary 'params' is required");var r=e,s=b;if(typeof s=="undefined"){var o=j(m);r=o.name;s=o.callback}var h="cb"+Math.floor(Math.random()*1E6);m[r]=h;r="";o=!0;for(var q in m)if(typeof m[q]!="function"){var k=m[q];o||(r+="&");r+=q+"="+g(k);o=!1}c=c.replace("http://","");c=c.replace("https://","");c+="?"+r;c=("https:"==document.location.protocol?"https://":"http://")+c;var f=document.createElement("script");f.type="text/javascript";f.src=
c;var x=document.getElementsByTagName("head")[0]||document.documentElement;window[h]=function(){s.apply(s,arguments);window[h]=void 0;try{delete window[h]}catch(a){}x.removeChild(f)};this.withConnectionCompatibility(function(){x.insertBefore(f,x.firstChild)})};m.prototype.withConnectionCompatibility=function(b){a.run_legacy_code(function(a){a.hbl.client.sendcommand("return_long_poll_now","");b()})};a.remote={RemoteApi:m}})})(window.olark.__core,window.olark.__core.logger);
(function(a,b){a.wait_for(function(){return window.olark.__core.box&&window.olark.__core.chat&&window.olark.__core.data&&window.olark.__core.visitor&&window.olark.__core.rules&&window.olark.__core.extensions&&window.olark.__core.browser&&window.olark.__core.remote},function(){a.api={ApiInstance:function(a){a=a||{};var c=a.namespace;if(typeof c=="undefined")throw Error("'namespace' is required");var g=a.conf;if(typeof g=="undefined")throw Error("'conf' is required");a=a.extension_name;if(typeof a==
"undefined")throw Error("'extension_name' is required");this.__SPI_browser=new window.olark.__core.browser.BrowserApi({namespace:c,conf:g});this.__SPI_extensions=new window.olark.__core.extensions.ExtensionsApi({namespace:c});this.chat=new window.olark.__core.chat.ChatApi({conf:g,extension_name:a});this.box=new window.olark.__core.box.BoxApi({conf:g,chat_api:this.chat});this.data=new window.olark.__core.data.DataApi({namespace:c});this.visitor=new window.olark.__core.visitor.VisitorApi({namespace:c,
data:this.data,browser:this.__SPI_browser});this.rules=new window.olark.__core.rules.RulesApi({data:this.data,browser:this.__SPI_browser});this.logger=b;this.__SPI_remote=new window.olark.__core.remote.RemoteApi;this.boot={onIdentityReady:function(a){olark._.identityManager.triggerIfIdentityIsReady(a)},onWindowLoad:function(a){a()}}}}})})(window.olark.__core,window.olark.__core.logger);
olark("api.boot.onIdentityReady",function(){function a(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c}function b(){var a=document.location.href,b=a.split("#"),c="__olarkpg__="+Math.random(),e=/__olarkpg__=[^&]+/;return e.test(a)?a.replace(e,c):/\?/.test(a)?b[0]+"&"+c+(b[1]||""):b[0]+"?"+c+(b[1]||"")}function e(b){var c=document.createElement("a");c.style.display="block";c.id="olark-inspector-"+b.id;c.href=b.href||"#";a(c,"click",b.onclick);c.innerHTML=
b.content;return c}function c(a,b){var c=document.createElement("div");c.id="olark-inspector-"+a;c.innerHTML=b;return c}function g(){if(!j){j=document.createElement("div");var g=document.createElement("ul"),l=function(){d(function(b){g.innerHTML="";for(var c=0;c<b.length;c++)g.appendChild(b[c]);b=document.createElement("a");b.innerHTML="close";(function(a){a.display="block";a.position="absolute";a.top="0px";a.right="0px";a["text-decoration"]="none";a.color="#ccc"})(b.style);b.href="#";a(b,"click",
function(){olark("api.visitor.__SPI_setIsInspecting",!1);j.style.display="none";j=null;return!1});g.appendChild(b)})},d=function(a){olark("api.visitor.getDetails",function(d){a([c("olark-header","<strong style='color: #aaa'>OLARK INSPECTOR</strong>"),c("olark-page-count",["visitor from <strong>"+d.city+", "+d.region+", "+d.country+"</strong>","viewed <strong>"+d.pageCountForThisVisit+"</strong> pages","in <strong>"+d.secondsSpentForThisVisit+"</strong> seconds,","and has chatted <strong>"+d.conversationCount+
"</strong> times in the past,","and <strong>"+(d.isConversing?"is conversing now":"has not conversed")+"</strong>"].join(" ")),e({id:"start-new-visitor",content:"pretend to be a brand-new visitor",href:b(),onclick:function(){olark._.cookieManager.erase("hblid");olark._.cookieManager.erase("olfsk");olark._.cookieManager.erase("wcsid");olark._.cookieManager.erase("_okgid")}}),e({id:"start-new-conversation",content:"pretend this is a new visit to the site",href:b(),onclick:function(){olark._.cookieManager.erase("wcsid");
olark._.cookieManager.erase("_okgid")}}),e({id:"visit-another-page",content:"pretend to change pages",href:b()})])})};(function(a){a.position="relative";a.width="400px";a.margin="0px";a.marginLeft=a.marginRight="auto";a.padding="10px";a.fontFamily="monospace";a.color="black";a.background="white";a.opacity="0.90";a["list-style-type"]="none";a["-moz-box-shadow"]=a["-webkit-box-shadow"]=a["box-shadow"]="0px 2px 25px #999"})(g.style);(function(a){a.position="fixed";a.bottom="0px";a.width="98%"})(j.style);
j.appendChild(g);document.body.appendChild(j);l();olark("api.visitor.onChange",l)}}var j=null;olark("api.visitor.__SPI_getIsInspecting",function(a){a?g():olark("api.chat.onCommandFromOperator",function(a){a.command.name=="develop"&&(olark("api.visitor.__SPI_setIsInspecting",!0),g())})})});
olark.declare({name:"GoogleAnalytics",version:"1.1",startup:function(a,b){function e(a,b){if(C&&window.console&&window.console[a])window.console[a](b)}function c(a){return a.replace(/[^\w\)\(\d]/g,"_").replace(/\_[\_]*/,"_")}function g(a,b){e("log",arguments);if(y){if(a=="send")if(b=="pageview")j([D+"_trackPageview"]);else if(b=="event"){var c=[D+"_trackEvent"].concat(Array.prototype.slice.call(arguments,2));j(c)}else e("log","unknown command: "+event_type)}else w.apply(w,arguments)}function j(a){e("log",
a);try{window._gaq.push(a)}catch(b){}}function m(a){window._gaq=window._gaq||[];a&&(j([D+"_setAccount",a]),q!=null&&j([D+"_setAllowLinker",q]),k!=null&&j([D+"_setAllowHash",k]),f!=null&&j([D+"_setDomainName",f]),x!=null&&j(x))}function l(a){if(a._getAccount)return a._getAccount();var b=void 0,c;for(c in a)typeof a[c]=="string"&&a[c].match(/UA\-/)&&(b=a[c]);return b}function d(){var a=window._gat&&window._gat._getTrackerByName,b=window.pageTracker,c=!a&&window._gaq,d=r&&!a&&!c&&y;t&&(D="olark.");if(d)h?
(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}(),m(h),j([D+"_trackPageview"])):e("error","Cannot load Google Analytics Tracking without Tracking ID");else if(y)if(t)h?m(h):e("error","Cannot create Custom Google Analytics Tracker without Tracking ID");else if(b)a=
l(window.pageTracker),a!="UA-XXXXX-X"&&a&&s?m(a):e("error","Cannot determine Tracking ID for Google Analytics legacy tracker id is: "+a);else if(a)l(window._gat._getTrackerByName())=="UA-XXXXX-X"&&e("error","Cannot determine Tracking ID for Google Analytics, _gat is loaded");else if(c){a=!1;for(b=0;b<window._gaq.length;b++)if((c=window._gaq[b])&&c[0]=="_setAccount"){a=c[1];break}a||e("error","Cannot determine Tracking ID for Google Analytics _gaq")}else window.console&&window.console.warn&&window.console.warn("Olark Google Analytics Integration is unable to detect Google Analytics on this page");
else e("log","using new analytics.js api")}function i(){var a=B.get(),b=F.get(),d=I.get(),e=b>d?!0:!1,h=H.get()=="automated",f="";f=e?a+" initiated":h?"Olark Targeted Chat initiated":"Visitor initiated with "+a;v&&(y?(z!=null&&j([D+"_setCustomVar",z,c(c(E)+":(Visitor) Had Conversation"),c(f),A]),u!=null&&j([D+"_setCustomVar",u,c(c(E)+":(Session)_Had_Conversation"),c(f),J]),p!=null&&j([D+"_setCustomVar",p,c(c(E)+":(Page) Had Conversation"),c(f),K]),o&&g("send","pageview")):window.console&&window.console.warn&&
window.console.warn("Olark: Google Analytics Custom variables are not supported when using analytics.js"));a=e||h?Math.floor((b-d)/1E3):Math.floor((d-b)/1E3);if(a<0||a>L)a=0;g("send","event",c(c(E)),"Conversation",c(f),n?a:0)}var t=b.GoogleAnalytics.create_custom_tracker||null,r=b.GoogleAnalytics.load_ga_if_missing||null,s=b.GoogleAnalytics.legacy_compatibility===void 0?!0:b.GoogleAnalytics.legacy_compatibility,o=b.GoogleAnalytics.track_chat_start_page||null,h=b.GoogleAnalytics.tracking_id||null,
q=b.GoogleAnalytics.allow_linker||null,k=b.GoogleAnalytics.allow_hash||null,f=b.GoogleAnalytics.domain||null,x=b.GoogleAnalytics.custom_config||null,n=b.GoogleAnalytics.track_message_delays||null,w=b.GoogleAnalytics.google_analytics_object||window.ga,y=b.GoogleAnalytics.force_legacy_mode||!1||!w,v=b.GoogleAnalytics.enable_custom_variables||null,u=b.GoogleAnalytics.had_conversation_session_slot_number||null,p=b.GoogleAnalytics.had_conversation_page_slot_number||null,z=b.GoogleAnalytics.had_conversation_visitor_slot_number||
null,C=b.GoogleAnalytics.debug||document.location.toString().match(/__debug_ga/)||null,A=1,J=2,K=3,L=1200,D="",E=window.hblName||"Olark",F=a.data.getConversationObject({key:"lastMessageToOperatorSent",initialValue:null}),I=a.data.getConversationObject({key:"lastMessageToVisitorSent",initialValue:null}),H=a.data.getConversationObject({key:"lastMessageSent",initialValue:null}),G=a.data.getConversationObject({key:"isConversation",initialValue:null}),B=a.data.getConversationObject({key:"lastOperatorNickname",
initialValue:""});if(C)window.olark._.ga_debug=this;a.chat.onReady(function(){d();a.chat.onMessageToVisitor(function(a){var b=F.get(),d=a.message.nickname;a=a.message.automated;if(H.get()=="visitor"||I.get()==null){var e=0;if(F.get()&&(e=Math.floor((+new Date-F.get())/1E3),e<0||e>L))e=0;a?g("send","event",c(E),c("Olark Targeted Chat Sent a Message"),c("Targeted"),n?e:0):g("send","event",c(E),c("Operator Sent a Message"),c(d),n?e:0);I.set(+new Date)}I.get()==null&&I.set(+new Date);B.set(d);b&&!G.get()&&
i();G.set(b);a?H.set("automated"):H.set("operator")});a.chat.onMessageToOperator(function(){var a=I.get();if(H.get()=="operator"||H.get()=="automated"||F.get()==null){var b=0;if(F.get()&&(b=Math.floor((+new Date-F.get())/1E3),b<0||b>L))b=0;g("send","event",c(E),c("Visitor Sent a Message"),c("true"),n?b:0);F.set(+new Date)}F.get()==null&&F.set(+new Date);a&&!G.get()&&i();G.set(a);H.set("visitor")});olark("api.chat.onOfflineMessageToOperator",function(){g("send","event",c(E),c("Visitor Sent an Offline Message"),
c("true"),0)})})}});
olark.declare({name:"VisitorInsight",version:"1.0",startup:function(a,b){function e(a){return a=="true"?!0:!1}var c=function(b){return b?a.__SPI_browser.__SPI_getSafeUrl(b):null},g=function(a){return(b.VisitorInsight||{})[a]||b.system[a]},j=b.chat.visitor_nickname||b.system.force_nickname||null,m=!0;if(g("prechat_contains_referrer")===!1||b.chat.notify_operator_of_referrer===!1)m=!1;var l=!0;if(g("prechat_contains_location")===!1||b.chat.notify_operator_of_location===!1)l=!1;var d=g("disable_default_visitor_information")?
!0:!1,i=g("status_contains_referrer")===!1?!1:!0,t=g("status_contains_location")===!1?!1:!0,r=g("give_location_to_operator")===!1?!1:!0,s=g("max_location_notifs_when_not_conversing")||2,o=g("max_idle_milliseconds_for_location_notifs")||6E4,h=g("custom_visitor_ip")||null,q=typeof g("clickpath_entries")=="undefined"?5:g("clickpath_entries"),k=b.system.disable_time_based_status_updates?!0:!1,f=null,x=+new Date,n=a.data.getConversationObject({key:"didGivePrechatInsight",initialValue:!1,backup:"vi1",backupTransform:e}),
w=a.data.getConversationObject({key:"isConversation",initialValue:!1,backup:"vi2",backupTransform:e}),y=a.data.getConversationObject({key:"referrer",initialValue:document.referrer&&document.referrer!==""?document.referrer:null}),v=a.data.getConversationObject({key:"locationNotificationState",initialValue:"active",backup:"vi3",backupTransform:e}),u=a.data.getConversationObject({key:"locationNotifsWithoutConversing",initialValue:0}),p=a.data.getConversationObject({key:"timestampOfLastActivity",initialValue:(new Date).getTime(),
backup:"vi4",backupTransform:parseInt}),z=a.data.getConversationObject({key:"pagesCount",initialValue:0}),C=a.data.getVisitorObject({key:"visitCount",initialValue:0}),A=a.data.getConversationObject({key:"visitorMessageCount",initialValue:0}),J=a.data.getConversationObject({key:"operatorMessageCount",initialValue:0}),K=a.data.getConversationObject({key:"operatorNotificationCount",initialValue:0,backup:"vi5",backupTransform:parseInt}),L=a.data.getConversationObject({key:"initialArrivalTimestamp",initialValue:(new Date).getTime()});
j&&a.chat.updateVisitorNickname({snippet:j,hidesDefault:!0});(function(){a.chat.onMessageToOperator(function(){A.set(A.get()+1)});a.chat.onMessageToVisitor(function(){J.set(J.get()+1)});a.chat.onNotificationToOperator(function(){K.set(K.get()+1)});a.__SPI_browser.onPageChange(function(){z.set(z.get()+1)});z.__SPI_onChange(function(a){a.newValue==1&&C.set(C.get()+1)})})();(function(){var a=function(){A.get()>0&&J.get()>0&&w.set(!0)};A.__SPI_onChange(a);J.__SPI_onChange(a)})();(function(){var b=function(){p.set((new Date).getTime());
u.set(0);v.get()!="disabled"&&v.set("active")};a.chat.onMessageToVisitor(function(){b()});a.chat.onMessageToOperator(function(){b()});u.__SPI_onChange(function(a){a.newValue>=s&&v.set("inactive")});a.box.onDismiss(function(){v.set("inactive")});a.chat.onCommandFromOperator(function(a){a=a.command;if(a.name=="unfollow"||a.name=="nofollow")v.set("disabled"),olark("api.chat.sendNotificationToOperator",{body:"turned off URL notifications from this visitor"});a.name==="end"&&v.set("inactive")})})();(function(){var b=
function(){var b=c(olark._.overrideWindowHref||document.location.href);a.chat.sendNotificationToOperator({body:"looking at "+b})},e=function(){if(n.get()===!1&&!d){n.set(!0);var e=a.chat.getVisitorNickname();a.chat.sendNotificationToOperator({body:"talking to "+e});l&&b();if(m){var f=c(y.get());f&&a.chat.sendNotificationToOperator({body:"referred from "+f})}/{\s*geolocation\s*}/.test(e)||a.chat.sendNotificationToOperator({body:"located in {{geolocation}}"});if(e=D())for(f=0;f<e.length;f++)a.chat.sendNotificationToOperator({body:e[f]});
a.chat.sendNotificationToOperator({body:"to see additional options, simply type !help"})}};a.__SPI_browser.onPageChange(function(){n.get()===!0&&r&&!((new Date).getTime()-p.get()>o)&&v.get()=="active"&&(b(),u.set(u.get()+1))});A.__SPI_onChange(function(a){a.newValue==1&&e()});K.__SPI_onChange(function(a){a.newValue==1&&e()})})();var D=function(){var b=[],c=a.visitor.getOrganization();c&&b.push("might be affiliated with "+c);return b},E=function(){if(!(+new Date-x>18E5)){var b=function(a){return a>=
864E5?"one day":a>=36E5?Math.floor(a/36E5)+" hours":a>=6E4?Math.floor(a/6E4)+" minutes":a>=1E3?Math.floor(a/1E3)+" seconds":null},d=c(document.location.href.toString()),e=c(y.get()),g=z.get(),j=C.get(),n=h||a.visitor.__SPI_getIp()||"{{ipaddress}}",l=(new Date).getTime()-L.get(),m=b(l),w=a.visitor.getFullName(),v=a.visitor.getEmailAddress(),p=a.visitor.getPhoneNumber(),o=a.visitor.__SPI_getNotes(),u=a.visitor.__SPI_getRecentPageHistory();f=o;o=o.slice(0)||[];w&&o.push("speaking with "+w);v&&o.push(v);
p&&o.push("phone number is "+p);d&&t&&o.push("looking at "+d);if(u&&u.length>1){w=u.length-1;d=u.length-1-q;d<1&&(d=1);for(o.push("already looked at:");w>=d;w--)v=u[w],v.url?o.push("  "+c(v.url)):v.title&&o.push("  "+v.title)}e&&i&&o.push("referred from "+e);o.push("located in {{geolocation}}");o.push("{num_pages} pages viewed".replace(/{num_pages}/,g));j>1?o.push(j+" visits"):o.push("first visit");G>1?o.push("has had "+G+" conversations"):G==1&&o.push("first conversation");o.push("using "+a.visitor.__SPI_getBrowser()+
" on "+a.visitor.__SPI_getOs());n&&o.push(n);m&&l>3E4?o.push("spent at least "+m+" so far"):(b=b(3E4))&&o.push("arrived within the last "+b);if(b=D())for(e=0;e<b.length;e++)o.push(b[e]);a.chat.updateVisitorStatus({snippet:o});l*=2;l<3E4&&(l=3E4);a.chat.__SPI_isConversing()||k||setTimeout(E,l)}};a.chat.onReady(E);a.__SPI_browser.onPageChange(function(){setTimeout(E,100)});var F,I,H,G;a.visitor.getDetails(function(a){F=a.fullName;I=a.emailAddress;H=a.phoneNumber;G=a.conversationCount});a.visitor.onChange(function(){a.visitor.getDetails(function(a){var b=
!1;if(F!==a.fullName)F=a.fullName,b=!0;if(I!==a.emailAddress)I=a.emailAddress,b=!0;if(H!==a.phoneNumber)H=a.phoneNumber,b=!0;if(G!==a.conversationCount)G=a.conversationCount,b=!0;b&&E()})});a.visitor.onChange(function(){f!==null&&a.visitor.__SPI_getNotes().join("")!=f.join("")&&E()})}});
olark.declare({name:"VisitorImportance",version:"1.0",startup:function(a,b){function e(){olark("api.visitor.getDetails",function(b){for(var c="",d=0;d<3;d++)c+=b.importance>d?g:j;a.chat.updateVisitorNickname({snippet:c})})}var c=b.system.show_importance_in_nickname==!0?!0:!1,g=b.system.filled_icon||String.fromCharCode(9733),j=b.system.unfilled_icon||String.fromCharCode(9734);c&&(olark("api.visitor.onChange",e),e())}});
olark.declare({name:"Mixpanel",version:"1.0",startup:function(a,b){function e(a){try{var b=0,c=olark._.identityManager.getConversationId(),d;for(d in c)c.hasOwnProperty(d)&&(b+=c.charCodeAt(d));return b%10<=parseInt(a/10)}catch(e){return!1}}function c(a,c){s(function(d){c=c||{};c.linkType=d.type;d.free||(b.system.show_in_buddy_list==="chatting"&&e(20)||e(60))&&g(a,c)})}function g(c,e){function g(){r||(r=!0,ompq.push(["identify",a.chat.__SPI_getConversationUUID()]));ompq.push(["track",c,e])}var k=
(new Date).getTime()-d.get();if(!t[c])t[c]=!0,i.set(t),e=e||{},e.bucket=b.system.olark_key,e.site_id=b.system.olark_key,e.template=b.system.template,k>l?g():setTimeout(g,l-k)}function j(){var a;if(typeof ompq!="undefined"&&ompq&&ompq[0]&&ompq[0][0]=="init"){ompq.metrics=new function(a,b){var c={},d=!1;c.config={cross_subdomain_cookie:!1,cookie_name:"omp__super_properties",test:!1,store_google:!1,debug:!1};c.super_properties={all:{},events:{},funnels:{}};c.funnels={};c.send_request=function(a,b){var d=
c.callback_fn;a+=a.indexOf("?")>-1?"&callback=":"?callback=";a+=d+"&";b&&(a+=c.http_build_query(b));c.config.test&&(a+="&test=1");a+="&_="+(new Date).getTime().toString();d=document.createElement("script");d.setAttribute("src",a);d.setAttribute("type","text/javascript");var e=document.getElementsByTagName("head")[0]||document.documentElement;e.insertBefore(d,e.firstChild)};c.track_funnel=function(a,b,d,e,f){e||(e={});e.funnel=a;e.step=parseInt(b,10);e.goal=d;e.step==1&&document.referrer.search("http://(.*)google.com")===
0&&(a=c.get_query_param(document.referrer,"q"),a.length&&c.register({mp_keyword:a},"funnels"));c.track("mp_funnel",e,f,"funnels")};c.get_query_param=function(a,b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c=RegExp("[\\?&]"+b+"=([^&#]*)").exec(a);return c===null||c&&typeof c[1]!="string"&&c[1].length?"":unescape(c[1]).replace(/\+/g," ")};c.track=function(a,b,d,e){c.load_super_once();e||(e="events");b||(b={});if(!b.token)b.token=c.token;if(d)c.callback=d;b.time=c.get_unixtime();c.save_campaign_params();
var f;if(e!="all")for(f in c.super_properties[e])b[f]||(b[f]=c.super_properties[e][f]);if(c.super_properties.all)for(f in c.super_properties.all)b[f]||(b[f]=c.super_properties.all[f]);d={event:a,properties:b};e=c.base64_encode(c.json_encode(d));c.config.debug&&window.console&&(window.console.log("-------------- REQUEST --------------"),window.console.log(d));c.send_request(c.api_host+"/track/",{data:e,ip:1});c.track_predefined_funnels(a,b)};c.identify=function(a){c.register_once({distinct_id:a},"all",
null,30)};c.register_once=function(a,b,d,e){c.load_super_once();if(!b||!c.super_properties[b])b="all";d||(d="None");e||(e=7);if(a)for(var f in a)if(a.hasOwnProperty(f)&&(!c.super_properties[b][f]||c.super_properties[b][f]==d))c.super_properties[b][f]=a[f];c.config.cross_subdomain_cookie&&c.clear_old_cookie();c.set_cookie(c.config.cookie_name,c.json_encode(c.super_properties),e,c.config.cross_subdomain_cookie)};c.register=function(a,b,d){c.load_super_once();if(!b||!c.super_properties[b])b="all";d||
(d=7);if(a)for(var e in a)a.hasOwnProperty(e)&&(c.super_properties[b][e]=a[e]);c.config.cross_subdomain_cookie&&c.clear_old_cookie();c.set_cookie(c.config.cookie_name,c.json_encode(c.super_properties),d,c.config.cross_subdomain_cookie)};c.http_build_query=function(a,b){var c,d,e,f=0,g=[];b||(b="&");for(c in a)c&&(d=encodeURIComponent(a[c].toString()),e=encodeURIComponent(c),g[f++]=e+"="+d);return g.join(b)};c.get_unixtime=function(){return parseInt((new Date).getTime().toString().substring(0,10),
10)};c.jsonp_callback=function(a){if(c.callback)c.callback(a),c.callback=!1};c.json_encode=function(a){var b=function(a){var b=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};b.lastIndex=0;return b.test(a)?'"'+a.replace(b,function(a){var b=c[a];return typeof b==="string"?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+
a+'"'},c=function(a,d){var e="",f=0,g=f="";g=0;var h=e,i=[],j=d[a];j&&typeof j==="object"&&typeof j.toJSON==="function"&&(j=j.toJSON(a));switch(typeof j){case "string":return b(j);case "number":return isFinite(j)?String(j):"null";case "boolean":case "null":return String(j);case "object":if(!j)return"null";e+="    ";i=[];if(Object.prototype.toString.apply(j)==="[object Array]"){g=j.length;for(f=0;f<g;f+=1)i[f]=c(f,j)||"null";return g=i.length===0?"[]":e?"[\n"+e+i.join(",\n"+e)+"\n"+h+"]":"["+i.join(",")+
"]"}for(f in j)Object.hasOwnProperty.call(j,f)&&(g=c(f,j))&&i.push(b(f)+(e?": ":":")+g);return g=i.length===0?"{}":e?"{"+i.join(",")+""+h+"}":"{"+i.join(",")+"}"}};return c("",{"":a})};c.base64_encode=function(a){var b,d,e,f,g=0,h=0,j="";j=[];if(!a)return a;a=c.utf8_encode(a+"");do b=a.charCodeAt(g++),d=a.charCodeAt(g++),e=a.charCodeAt(g++),f=b<<16|d<<8|e,b=f>>18&63,d=f>>12&63,e=f>>6&63,f&=63,j[h++]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(b)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d)+
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(e)+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(f);while(g<a.length);j=j.join("");switch(a.length%3){case 1:j=j.slice(0,-2)+"==";break;case 2:j=j.slice(0,-1)+"="}return j};c.utf8_encode=function(a){a=(a+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n");var b="",c,d,e=0;c=d=0;e=a.length;for(var f=0;f<e;f++){var g=a.charCodeAt(f),h=null;g<128?d++:h=g>127&&g<2048?String.fromCharCode(g>>6|192)+String.fromCharCode(g&
63|128):String.fromCharCode(g>>12|224)+String.fromCharCode(g>>6&63|128)+String.fromCharCode(g&63|128);h!==null&&(d>c&&(b+=a.substring(c,d)),b+=h,c=d=f+1)}d>c&&(b+=a.substring(c,a.length));return b};c.set_cookie=function(a,b,c){c&&c>0&&(c*=864E5);olark._.cookieManager.set(a,b,c)};c.get_cookie=function(a){return(a=olark._.cookieManager.get(a))?a:""};c.delete_cookie=function(a,b){c.set_cookie(a,"",-1,b)};c.get_super=function(){var a=eval("("+c.get_cookie(c.config.cookie_name)+")");if(a)for(var b in a)a.hasOwnProperty(b)&&
(c.super_properties[b]=a[b]);return c.super_properties};c.load_super_once=function(){if(!d)try{c.get_super(),d=!0}catch(a){}};c.register_funnel=function(a,b){c.funnels[a]=b};c.track_predefined_funnels=function(a,b){if(a&&c.funnels)for(var d in c.funnels)if(c.funnels.hasOwnProperty(d))for(var e=0;e<c.funnels[d].length;++e)c.funnels[d][e]&&c.funnels[d][e]==a&&c.track_funnel(d,e+1,a,b)};c.save_campaign_params=function(){c.campaign_params_saved=c.campaign_params_saved||!1;if(c.config.store_google&&!c.campaign_params_saved){for(var a=
["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],b="",d={},e=0;e<a.length;e++)b=c.get_query_param(document.URL,a[e]),b.length&&(d[a[e]]=b);c.register_once(d);c.campaign_params_saved=!0}};c.clear_old_cookie=function(){c.delete_cookie(c.config.cookie_name,!1);c.set_cookie(c.config.cookie_name,c.json_encode(c.super_properties),7,!0)};c.set_config=function(a){for(var b in a)a.hasOwnProperty(b)&&(c.config[b]=a[b])};var e="https:"==document.location.protocol?"https://":"http://";c.token=
a;c.api_host=e+"stats.olark.com";c.callback_fn=b?b+".jsonp_callback":"mmetrics.jsonp_callback";return c}(ompq[0][1],"ompq.metrics");ompq.push=function(a){if(a)if(typeof a=="function")a();else if(a.constructor==Array){var b=ompq.metrics[a[0]];typeof b=="function"&&b.apply(ompq.metrics,a.slice(1))}};for(a=1;a<ompq.length;a++)ompq.push(ompq[a]);ompq.length=0}}function m(){j();c("visitorAvailable");a.chat.__SPI_getLastOperatorPresence(function(a){a==="available"&&c("operatorsAvailable")})}if(!b.system.disable_analytics){var l=
6E3,d=a.data.getConversationObject({key:"initialLandingTimestamp",initialValue:(new Date).getTime()}),i=a.data.getConversationObject({key:"sentEvents",initialValue:{}}),t=i.get(),r=!1;window.ompq=window.ompq||[];ompq.push(["init","0908d20dfe9d3ea7c81e64bb4ffd7d36"]);a.box.onShow(m);a.box.onExpand(m);a.box.onShrink(m);if(b.system.visitor_available_with_hidden_ui)a.chat.onReady(m);a.chat.onMessageToVisitor(function(a){c("messageToVisitor",{operator:a.nickname})});a.box.__SPI__onOlarkLinkClicked(function(){c("olarkLinkClicked")});
var s=function(a){olark("api.box.__SPI_whenRendered",function(){var b=window.habla_window.theme.habla_link_div.innerHTML,c={};if(b.match(/hblink99/)){var d=b.match(/utm_campaign=([^\&]+)/);c.type=d?d[1]:"unknown"}else c.type="whitelabel";if(/[Ff]ree/.test(b))c.free=!0;a(c)})}}}});
olark.declare({name:"OfflineWarning",version:"1.0",startup:function(a,b){var e=b.system.offlineResponse||"Operator has gone away try again later";a.chat.onMessageToOperator(function(){setTimeout(function(){hbl.client.opavailable||olark("api.chat.sendMessageToVisitor",{body:e,nickname:" "})},1)})}});
olark.declare({name:"EndConversation",version:"1.0",startup:function(a,b){function e(){olark._.identityManager.deleteConversationId();setTimeout(function(){window.location.reload()},1)}function c(b){if(b.is_ended)if(b.is_conversing){b=document.getElementById("habla_end_convo_div");if(!b){var c=document.getElementById("habla_conversation_div");b=document.createElement("div");b.id="habla_end_convo_div";c.appendChild(b)}c=document.createElement("p");var l=document.createElement("em");l.innerText=g.end_conversation_placeholder;
c.appendChild(l);l=document.createElement("hr");var d=document.createElement("div"),i=g.restart_conversation_input_text,t=e,r=document.createElement("input");r.type="submit";r.value=i;r.onclick=t;r.className="habla_offline_submit_input";d.id="habla_pre_chat_div";b.className="hbl_panel habla_offline_message_div hbl_pal_control_border hbl_pal_main_fg";d.appendChild(r);b.appendChild(c);b.appendChild(l);b.appendChild(d);b.style.clear="both";b.style.display="block";olark._.identityManager.keepConversationIdAlive()}else olark._.identityManager.deleteConversationId(),
a.box.hide(),olark._.hlog("disabling chatbox due to #convo_ended_before_begin"),window.console&&console.warn&&window.console.warn("[olark] conversation expired, disabling chatbox"),a.box.__SPI_disableUserInterface(),a.chat.__SPI_disableChatConnection();else if(b=document.getElementById("habla_end_convo_div"))b.style.display="none"}var g={end_conversation_placeholder:b.locale.end_conversation_placeholder||"Conversation ended",restart_conversation_input_text:b.locale.restart_conversation_input_text||
"Start a new chat"};if(b.system.allow_end_conversation)a.chat.onReady(function(){setTimeout(function(){a.chat.__SPI_getEndedState(function(b){b.is_ended?c(b):a.chat.__SPI_onEndedStateChanged(c)})})})}});
