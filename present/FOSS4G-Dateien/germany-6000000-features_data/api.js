/*
 * GIS Cloud JavaScript API
 *
 * web: http://www.giscloud.com/
 * dev: http://dev.giscloud.com/
 *
 * copyright GIS Cloud ltd. 2013.
 *
 *
 * Included in this lib are also:
 *     json2 - http://json.org
 *     jQuery - http://jquery.com
 *     jQuery UI - http://jquery.com
 *     jQuery Address - http://www.asual.com/jquery/address/
 *     jstree - http://jstree.com
 *     easyXDM - http://easyxdm.net
 */

giscloud_config = {
    restHost : function () {  return "https://api.giscloud.com"; },
    apiHost : function () {
        if (document.location.protocol === "https:")
            return "https://api.giscloud.com";
        else
            return "http://api.giscloud.com";
    },
    apiHostname : function () {  return "api.giscloud.com"; },
    authHost : function () {  return "https://www.giscloud.com"; },
    liveSite : function () {  return "http://www.giscloud.com/"; },
    appSite : function () {  return "http://www.giscloud.com/"; },
    leafletScript : function () { return "leaflet.js"; },
    nch : "b20b1e0ccd9e96dd8cb7b06532aaa5c27a4d2fb2",
    tileSite : function () {
        if (document && document.location && document.location.host &&
            document.location.host !== "dev.giscloud.com" &&
            document.location.host.match(/\S+\.giscloud\.(?:com|staging)/i)) {

            return document.location.protocol + "//" + document.location.host + "/";
        }

        return "http://www.giscloud.com/";
    }
};
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());
/*! jQuery v1.8.3 jquery.com | jquery.org/license */
(function(e,t){function _(e){var t=M[e]={};return v.each(e.split(y),function(e,n){t[n]=!0}),t}function H(e,n,r){if(r===t&&e.nodeType===1){var i="data-"+n.replace(P,"-$1").toLowerCase();r=e.getAttribute(i);if(typeof r=="string"){try{r=r==="true"?!0:r==="false"?!1:r==="null"?null:+r+""===r?+r:D.test(r)?v.parseJSON(r):r}catch(s){}v.data(e,n,r)}else{r=t}}return r}function B(e){var t;for(t in e){if(t==="data"&&v.isEmptyObject(e[t])){continue}if(t!=="toJSON"){return !1}}return !0}function et(){return !1}function tt(){return !0}function ut(e){return !e||!e.parentNode||e.parentNode.nodeType===11}function at(e,t){do{e=e[t]}while(e&&e.nodeType!==1);return e}function ft(e,t,n){t=t||0;if(v.isFunction(t)){return v.grep(e,function(e,r){var i=!!t.call(e,r,e);return i===n})}if(t.nodeType){return v.grep(e,function(e,r){return e===t===n})}if(typeof t=="string"){var r=v.grep(e,function(e){return e.nodeType===1});if(it.test(t)){return v.filter(t,r,!n)}t=v.filter(t,r)}return v.grep(e,function(e,r){return v.inArray(e,t)>=0===n})}function lt(e){var t=ct.split("|"),n=e.createDocumentFragment();if(n.createElement){while(t.length){n.createElement(t.pop())}}return n}function Lt(e,t){return e.getElementsByTagName(t)[0]||e.appendChild(e.ownerDocument.createElement(t))}function At(e,t){if(t.nodeType!==1||!v.hasData(e)){return}var n,r,i,s=v._data(e),o=v._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u){for(r=0,i=u[n].length;r<i;r++){v.event.add(t,n,u[n][r])}}}o.data&&(o.data=v.extend({},o.data))}function Ot(e,t){var n;if(t.nodeType!==1){return}t.clearAttributes&&t.clearAttributes(),t.mergeAttributes&&t.mergeAttributes(e),n=t.nodeName.toLowerCase(),n==="object"?(t.parentNode&&(t.outerHTML=e.outerHTML),v.support.html5Clone&&e.innerHTML&&!v.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):n==="input"&&Et.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):n==="option"?t.selected=e.defaultSelected:n==="input"||n==="textarea"?t.defaultValue=e.defaultValue:n==="script"&&t.text!==e.text&&(t.text=e.text),t.removeAttribute(v.expando)}function Mt(e){return typeof e.getElementsByTagName!="undefined"?e.getElementsByTagName("*"):typeof e.querySelectorAll!="undefined"?e.querySelectorAll("*"):[]}function _t(e){Et.test(e.type)&&(e.defaultChecked=e.checked)}function Qt(e,t){if(t in e){return t}var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Jt.length;while(i--){t=Jt[i]+n;if(t in e){return t}}return r}function Gt(e,t){return e=t||e,v.css(e,"display")==="none"||!v.contains(e.ownerDocument,e)}function Yt(e,t){var n,r,i=[],s=0,o=e.length;for(;s<o;s++){n=e[s];if(!n.style){continue}i[s]=v._data(n,"olddisplay"),t?(!i[s]&&n.style.display==="none"&&(n.style.display=""),n.style.display===""&&Gt(n)&&(i[s]=v._data(n,"olddisplay",nn(n.nodeName)))):(r=Dt(n,"display"),!i[s]&&r!=="none"&&v._data(n,"olddisplay",r))}for(s=0;s<o;s++){n=e[s];if(!n.style){continue}if(!t||n.style.display==="none"||n.style.display===""){n.style.display=t?i[s]||"":"none"}}return e}function Zt(e,t,n){var r=Rt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function en(e,t,n,r){var i=n===(r?"border":"content")?4:t==="width"?1:0,s=0;for(;i<4;i+=2){n==="margin"&&(s+=v.css(e,n+$t[i],!0)),r?(n==="content"&&(s-=parseFloat(Dt(e,"padding"+$t[i]))||0),n!=="margin"&&(s-=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0)):(s+=parseFloat(Dt(e,"padding"+$t[i]))||0,n!=="padding"&&(s+=parseFloat(Dt(e,"border"+$t[i]+"Width"))||0))}return s}function tn(e,t,n){var r=t==="width"?e.offsetWidth:e.offsetHeight,i=!0,s=v.support.boxSizing&&v.css(e,"boxSizing")==="border-box";if(r<=0||r==null){r=Dt(e,t);if(r<0||r==null){r=e.style[t]}if(Ut.test(r)){return r}i=s&&(v.support.boxSizingReliable||r===e.style[t]),r=parseFloat(r)||0}return r+en(e,t,n||(s?"border":"content"),i)+"px"}function nn(e){if(Wt[e]){return Wt[e]}var t=v("<"+e+">").appendTo(i.body),n=t.css("display");t.remove();if(n==="none"||n===""){Pt=i.body.appendChild(Pt||v.extend(i.createElement("iframe"),{frameBorder:0,width:0,height:0}));if(!Ht||!Pt.createElement){Ht=(Pt.contentWindow||Pt.contentDocument).document,Ht.write("<!doctype html><html><body>"),Ht.close()}t=Ht.body.appendChild(Ht.createElement(e)),n=Dt(t,"display"),i.body.removeChild(Pt)}return Wt[e]=n,n}function fn(e,t,n,r){var i;if(v.isArray(t)){v.each(t,function(t,i){n||sn.test(e)?r(e,i):fn(e+"["+(typeof i=="object"?t:"")+"]",i,n,r)})}else{if(!n&&v.type(t)==="object"){for(i in t){fn(e+"["+i+"]",t[i],n,r)}}else{r(e,t)}}}function Cn(e){return function(t,n){typeof t!="string"&&(n=t,t="*");var r,i,s,o=t.toLowerCase().split(y),u=0,a=o.length;if(v.isFunction(n)){for(;u<a;u++){r=o[u],s=/^\+/.test(r),s&&(r=r.substr(1)||"*"),i=e[r]=e[r]||[],i[s?"unshift":"push"](n)}}}}function kn(e,n,r,i,s,o){s=s||n.dataTypes[0],o=o||{},o[s]=!0;var u,a=e[s],f=0,l=a?a.length:0,c=e===Sn;for(;f<l&&(c||!u);f++){u=a[f](n,r,i),typeof u=="string"&&(!c||o[u]?u=t:(n.dataTypes.unshift(u),u=kn(e,n,r,i,u,o)))}return(c||!u)&&!o["*"]&&(u=kn(e,n,r,i,"*",o)),u}function Ln(e,n){var r,i,s=v.ajaxSettings.flatOptions||{};for(r in n){n[r]!==t&&((s[r]?e:i||(i={}))[r]=n[r])}i&&v.extend(!0,e,i)}function An(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes,l=e.responseFields;for(s in l){s in r&&(n[l[s]]=r[s])}while(f[0]==="*"){f.shift(),i===t&&(i=e.mimeType||n.getResponseHeader("content-type"))}if(i){for(s in a){if(a[s]&&a[s].test(i)){f.unshift(s);break}}}if(f[0] in r){o=f[0]}else{for(s in r){if(!f[0]||e.converters[s+" "+f[0]]){o=s;break}u||(u=s)}o=o||u}if(o){return o!==f[0]&&f.unshift(o),r[o]}}function On(e,t){var n,r,i,s,o=e.dataTypes.slice(),u=o[0],a={},f=0;e.dataFilter&&(t=e.dataFilter(t,e.dataType));if(o[1]){for(n in e.converters){a[n.toLowerCase()]=e.converters[n]}}for(;i=o[++f];){if(i!=="*"){if(u!=="*"&&u!==i){n=a[u+" "+i]||a["* "+i];if(!n){for(r in a){s=r.split(" ");if(s[1]===i){n=a[u+" "+s[0]]||a["* "+s[0]];if(n){n===!0?n=a[r]:a[r]!==!0&&(i=s[0],o.splice(f--,0,i));break}}}}if(n!==!0){if(n&&e["throws"]){t=n(t)}else{try{t=n(t)}catch(l){return{state:"parsererror",error:n?l:"No conversion from "+u+" to "+i}}}}}u=i}}return{state:"success",data:t}}function Fn(){try{return new e.XMLHttpRequest}catch(t){}}function In(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function $n(){return setTimeout(function(){qn=t},0),qn=v.now()}function Jn(e,t){v.each(t,function(t,n){var r=(Vn[t]||[]).concat(Vn["*"]),i=0,s=r.length;for(;i<s;i++){if(r[i].call(e,t,n)){return}}})}function Kn(e,t,n){var r,i=0,s=0,o=Xn.length,u=v.Deferred().always(function(){delete a.elem}),a=function(){var t=qn||$n(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,i=1-r,s=0,o=f.tweens.length;for(;s<o;s++){f.tweens[s].run(i)}return u.notifyWith(e,[f,i,n]),i<1&&o?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:v.extend({},t),opts:v.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:qn||$n(),duration:n.duration,tweens:[],createTween:function(t,n,r){var i=v.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(i),i},stop:function(t){var n=0,r=t?f.tweens.length:0;for(;n<r;n++){f.tweens[n].run(1)}return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;Qn(l,f.opts.specialEasing);for(;i<o;i++){r=Xn[i].call(f,e,l,f.opts);if(r){return r}}return Jn(f,l),v.isFunction(f.opts.start)&&f.opts.start.call(e,f),v.fx.timer(v.extend(a,{anim:f,queue:f.opts.queue,elem:e})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Qn(e,t){var n,r,i,s,o;for(n in e){r=v.camelCase(n),i=t[r],s=e[n],v.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=v.cssHooks[r];if(o&&"expand" in o){s=o.expand(s),delete e[r];for(n in s){n in e||(e[n]=s[n],t[n]=i)}}else{t[r]=i}}}function Gn(e,t,n){var r,i,s,o,u,a,f,l,c,h=this,p=e.style,d={},m=[],g=e.nodeType&&Gt(e);n.queue||(l=v._queueHooks(e,"fx"),l.unqueued==null&&(l.unqueued=0,c=l.empty.fire,l.empty.fire=function(){l.unqueued||c()}),l.unqueued++,h.always(function(){h.always(function(){l.unqueued--,v.queue(e,"fx").length||l.empty.fire()})})),e.nodeType===1&&("height" in t||"width" in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],v.css(e,"display")==="inline"&&v.css(e,"float")==="none"&&(!v.support.inlineBlockNeedsLayout||nn(e.nodeName)==="inline"?p.display="inline-block":p.zoom=1)),n.overflow&&(p.overflow="hidden",v.support.shrinkWrapBlocks||h.done(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]}));for(r in t){s=t[r];if(Un.exec(s)){delete t[r],a=a||s==="toggle";if(s===(g?"hide":"show")){continue}m.push(r)}}o=m.length;if(o){u=v._data(e,"fxshow")||v._data(e,"fxshow",{}),"hidden" in u&&(g=u.hidden),a&&(u.hidden=!g),g?v(e).show():h.done(function(){v(e).hide()}),h.done(function(){var t;v.removeData(e,"fxshow",!0);for(t in d){v.style(e,t,d[t])}});for(r=0;r<o;r++){i=m[r],f=h.createTween(i,g?u[i]:0),d[i]=u[i]||v.style(e,i),i in u||(u[i]=f.start,g&&(f.end=f.start,f.start=i==="width"||i==="height"?1:0))}}}function Yn(e,t,n,r,i){return new Yn.prototype.init(e,t,n,r,i)}function Zn(e,t){var n,r={height:e},i=0;t=t?1:0;for(;i<4;i+=2-t){n=$t[i],r["margin"+n]=r["padding"+n]=e}return t&&(r.opacity=r.width=e),r}function tr(e){return v.isWindow(e)?e:e.nodeType===9?e.defaultView||e.parentWindow:!1}var n,r,i=e.document,s=e.location,o=e.navigator,u=e.jQuery,a=e.$,f=Array.prototype.push,l=Array.prototype.slice,c=Array.prototype.indexOf,h=Object.prototype.toString,p=Object.prototype.hasOwnProperty,d=String.prototype.trim,v=function(e,t){return new v.fn.init(e,t,n)},m=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,g=/\S/,y=/\s+/,b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,w=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,E=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,S=/^[\],:{}\s]*$/,x=/(?:^|:|,)(?:\s*\[)+/g,T=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,N=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,C=/^-ms-/,k=/-([\da-z])/gi,L=function(e,t){return(t+"").toUpperCase()},A=function(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",A,!1),v.ready()):i.readyState==="complete"&&(i.detachEvent("onreadystatechange",A),v.ready())},O={};v.fn=v.prototype={constructor:v,init:function(e,n,r){var s,o,u,a;if(!e){return this}if(e.nodeType){return this.context=this[0]=e,this.length=1,this}if(typeof e=="string"){e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3?s=[null,e,null]:s=w.exec(e);if(s&&(s[1]||!n)){if(s[1]){return n=n instanceof v?n[0]:n,a=n&&n.nodeType?n.ownerDocument||n:i,e=v.parseHTML(s[1],a,!0),E.test(s[1])&&v.isPlainObject(n)&&this.attr.call(e,n,!0),v.merge(this,e)}o=i.getElementById(s[2]);if(o&&o.parentNode){if(o.id!==s[2]){return r.find(e)}this.length=1,this[0]=o}return this.context=i,this.selector=e,this}return !n||n.jquery?(n||r).find(e):this.constructor(n).find(e)}return v.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),v.makeArray(e,this))},selector:"",jquery:"1.8.3",length:0,size:function(){return this.length},toArray:function(){return l.call(this)},get:function(e){return e==null?this.toArray():e<0?this[this.length+e]:this[e]},pushStack:function(e,t,n){var r=v.merge(this.constructor(),e);return r.prevObject=this,r.context=this.context,t==="find"?r.selector=this.selector+(this.selector?" ":"")+n:t&&(r.selector=this.selector+"."+t+"("+n+")"),r},each:function(e,t){return v.each(this,e,t)},ready:function(e){return v.ready.promise().done(e),this},eq:function(e){return e=+e,e===-1?this.slice(e):this.slice(e,e+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(l.apply(this,arguments),"slice",l.call(arguments).join(","))},map:function(e){return this.pushStack(v.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:[].sort,splice:[].splice},v.fn.init.prototype=v.fn,v.extend=v.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!v.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++){if((e=arguments[a])!=null){for(n in e){r=u[n],i=e[n];if(u===i){continue}l&&i&&(v.isPlainObject(i)||(s=v.isArray(i)))?(s?(s=!1,o=r&&v.isArray(r)?r:[]):o=r&&v.isPlainObject(r)?r:{},u[n]=v.extend(l,o,i)):i!==t&&(u[n]=i)}}}return u},v.extend({noConflict:function(t){return e.$===v&&(e.$=a),t&&e.jQuery===v&&(e.jQuery=u),v},isReady:!1,readyWait:1,holdReady:function(e){e?v.readyWait++:v.ready(!0)},ready:function(e){if(e===!0?--v.readyWait:v.isReady){return}if(!i.body){return setTimeout(v.ready,1)}v.isReady=!0;if(e!==!0&&--v.readyWait>0){return}r.resolveWith(i,[v]),v.fn.trigger&&v(i).trigger("ready").off("ready")},isFunction:function(e){return v.type(e)==="function"},isArray:Array.isArray||function(e){return v.type(e)==="array"},isWindow:function(e){return e!=null&&e==e.window},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return e==null?String(e):O[h.call(e)]||"object"},isPlainObject:function(e){if(!e||v.type(e)!=="object"||e.nodeType||v.isWindow(e)){return !1}try{if(e.constructor&&!p.call(e,"constructor")&&!p.call(e.constructor.prototype,"isPrototypeOf")){return !1}}catch(n){return !1}var r;for(r in e){}return r===t||p.call(e,r)},isEmptyObject:function(e){var t;for(t in e){return !1}return !0},error:function(e){throw new Error(e)},parseHTML:function(e,t,n){var r;return !e||typeof e!="string"?null:(typeof t=="boolean"&&(n=t,t=0),t=t||i,(r=E.exec(e))?[t.createElement(r[1])]:(r=v.buildFragment([e],t,n?null:[]),v.merge([],(r.cacheable?v.clone(r.fragment):r.fragment).childNodes)))},parseJSON:function(t){if(!t||typeof t!="string"){return null}t=v.trim(t);if(e.JSON&&e.JSON.parse){return e.JSON.parse(t)}if(S.test(t.replace(T,"@").replace(N,"]").replace(x,""))){return(new Function("return "+t))()}v.error("Invalid JSON: "+t)},parseXML:function(n){var r,i;if(!n||typeof n!="string"){return null}try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return(!r||!r.documentElement||r.getElementsByTagName("parsererror").length)&&v.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&g.test(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(C,"ms-").replace(k,L)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,n,r){var i,s=0,o=e.length,u=o===t||v.isFunction(e);if(r){if(u){for(i in e){if(n.apply(e[i],r)===!1){break}}}else{for(;s<o;){if(n.apply(e[s++],r)===!1){break}}}}else{if(u){for(i in e){if(n.call(e[i],i,e[i])===!1){break}}}else{for(;s<o;){if(n.call(e[s],s,e[s++])===!1){break}}}}return e},trim:d&&!d.call("\ufeff\u00a0")?function(e){return e==null?"":d.call(e)}:function(e){return e==null?"":(e+"").replace(b,"")},makeArray:function(e,t){var n,r=t||[];return e!=null&&(n=v.type(e),e.length==null||n==="string"||n==="function"||n==="regexp"||v.isWindow(e)?f.call(r,e):v.merge(r,e)),r},inArray:function(e,t,n){var r;if(t){if(c){return c.call(t,e,n)}r=t.length,n=n?n<0?Math.max(0,r+n):n:0;for(;n<r;n++){if(n in t&&t[n]===e){return n}}}return -1},merge:function(e,n){var r=n.length,i=e.length,s=0;if(typeof r=="number"){for(;s<r;s++){e[i++]=n[s]}}else{while(n[s]!==t){e[i++]=n[s++]}}return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;n=!!n;for(;s<o;s++){r=!!t(e[s],s),n!==r&&i.push(e[s])}return i},map:function(e,n,r){var i,s,o=[],u=0,a=e.length,f=e instanceof v||a!==t&&typeof a=="number"&&(a>0&&e[0]&&e[a-1]||a===0||v.isArray(e));if(f){for(;u<a;u++){i=n(e[u],u,r),i!=null&&(o[o.length]=i)}}else{for(s in e){i=n(e[s],s,r),i!=null&&(o[o.length]=i)}}return o.concat.apply([],o)},guid:1,proxy:function(e,n){var r,i,s;return typeof n=="string"&&(r=e[n],n=e,e=r),v.isFunction(e)?(i=l.call(arguments,2),s=function(){return e.apply(n,i.concat(l.call(arguments)))},s.guid=e.guid=e.guid||v.guid++,s):t},access:function(e,n,r,i,s,o,u){var a,f=r==null,l=0,c=e.length;if(r&&typeof r=="object"){for(l in r){v.access(e,n,l,r[l],1,o,i)}s=1}else{if(i!==t){a=u===t&&v.isFunction(i),f&&(a?(a=n,n=function(e,t,n){return a.call(v(e),n)}):(n.call(e,i),n=null));if(n){for(;l<c;l++){n(e[l],r,a?i.call(e[l],l,n(e[l],r)):i,u)}}s=1}}return s?e:f?n.call(e):c?n(e[0],r):o},now:function(){return(new Date).getTime()}}),v.ready.promise=function(t){if(!r){r=v.Deferred();if(i.readyState==="complete"){setTimeout(v.ready,1)}else{if(i.addEventListener){i.addEventListener("DOMContentLoaded",A,!1),e.addEventListener("load",v.ready,!1)}else{i.attachEvent("onreadystatechange",A),e.attachEvent("onload",v.ready);var n=!1;try{n=e.frameElement==null&&i.documentElement}catch(s){}n&&n.doScroll&&function o(){if(!v.isReady){try{n.doScroll("left")}catch(e){return setTimeout(o,50)}v.ready()}}()}}}return r.promise(t)},v.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(e,t){O["[object "+t+"]"]=t.toLowerCase()}),n=v(i);var M={};v.Callbacks=function(e){e=typeof e=="string"?M[e]||_(e):v.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){n=e.memory&&t,r=!0,u=s||0,s=0,o=a.length,i=!0;for(;a&&u<o;u++){if(a[u].apply(t[0],t[1])===!1&&e.stopOnFalse){n=!1;break}}i=!1,a&&(f?f.length&&l(f.shift()):n?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function r(t){v.each(t,function(t,n){var i=v.type(n);i==="function"?(!e.unique||!c.has(n))&&a.push(n):n&&n.length&&i!=="string"&&r(n)})})(arguments),i?o=a.length:n&&(s=t,l(n))}return this},remove:function(){return a&&v.each(arguments,function(e,t){var n;while((n=v.inArray(t,a,n))>-1){a.splice(n,1),i&&(n<=o&&o--,n<=u&&u--)}}),this},has:function(e){return v.inArray(e,a)>-1},empty:function(){return a=[],this},disable:function(){return a=f=n=t,this},disabled:function(){return !a},lock:function(){return f=t,n||c.disable(),this},locked:function(){return !f},fireWith:function(e,t){return t=t||[],t=[e,t.slice?t.slice():t],a&&(!r||f)&&(i?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return !!r}};return c},v.extend({Deferred:function(e){var t=[["resolve","done",v.Callbacks("once memory"),"resolved"],["reject","fail",v.Callbacks("once memory"),"rejected"],["notify","progress",v.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return v.Deferred(function(n){v.each(t,function(t,r){var s=r[0],o=e[t];i[r[1]](v.isFunction(o)?function(){var e=o.apply(this,arguments);e&&v.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[s+"With"](this===i?n:this,[e])}:n[s])}),e=null}).promise()},promise:function(e){return e!=null?v.extend(e,r):r}},i={};return r.pipe=r.then,v.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[e^1][2].disable,t[2][2].lock),i[s[0]]=o.fire,i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=l.call(arguments),r=n.length,i=r!==1||e&&v.isFunction(e.promise)?r:0,s=i===1?e:v.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?l.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1){u=new Array(r),a=new Array(r),f=new Array(r);for(;t<r;t++){n[t]&&v.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i}}return i||s.resolveWith(f,n),s.promise()}}),v.support=function(){var t,n,r,s,o,u,a,f,l,c,h,p=i.createElement("div");p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*"),r=p.getElementsByTagName("a")[0];if(!n||!r||!n.length){return{}}s=i.createElement("select"),o=s.appendChild(i.createElement("option")),u=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t={leadingWhitespace:p.firstChild.nodeType===3,tbody:!p.getElementsByTagName("tbody").length,htmlSerialize:!!p.getElementsByTagName("link").length,style:/top/.test(r.getAttribute("style")),hrefNormalized:r.getAttribute("href")==="/a",opacity:/^0.5/.test(r.style.opacity),cssFloat:!!r.style.cssFloat,checkOn:u.value==="on",optSelected:o.selected,getSetAttribute:p.className!=="t",enctype:!!i.createElement("form").enctype,html5Clone:i.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>",boxModel:i.compatMode==="CSS1Compat",submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,boxSizingReliable:!0,pixelPosition:!1},u.checked=!0,t.noCloneChecked=u.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!o.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}!p.addEventListener&&p.attachEvent&&p.fireEvent&&(p.attachEvent("onclick",h=function(){t.noCloneEvent=!1}),p.cloneNode(!0).fireEvent("onclick"),p.detachEvent("onclick",h)),u=i.createElement("input"),u.value="t",u.setAttribute("type","radio"),t.radioValue=u.value==="t",u.setAttribute("checked","checked"),u.setAttribute("name","t"),p.appendChild(u),a=i.createDocumentFragment(),a.appendChild(p.lastChild),t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,t.appendChecked=u.checked,a.removeChild(u),a.appendChild(p);if(p.attachEvent){for(l in {submit:!0,change:!0,focusin:!0}){f="on"+l,c=f in p,c||(p.setAttribute(f,"return;"),c=typeof p[f]=="function"),t[l+"Bubbles"]=c}}return v(function(){var n,r,s,o,u="padding:0;margin:0;border:0;display:block;overflow:hidden;",a=i.getElementsByTagName("body")[0];if(!a){return}n=i.createElement("div"),n.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px",a.insertBefore(n,a.firstChild),r=i.createElement("div"),n.appendChild(r),r.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=r.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=s[0].offsetHeight===0,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&s[0].offsetHeight===0,r.innerHTML="",r.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",t.boxSizing=r.offsetWidth===4,t.doesNotIncludeMarginInBodyOffset=a.offsetTop!==1,e.getComputedStyle&&(t.pixelPosition=(e.getComputedStyle(r,null)||{}).top!=="1%",t.boxSizingReliable=(e.getComputedStyle(r,null)||{width:"4px"}).width==="4px",o=i.createElement("div"),o.style.cssText=r.style.cssText=u,o.style.marginRight=o.style.width="0",r.style.width="1px",r.appendChild(o),t.reliableMarginRight=!parseFloat((e.getComputedStyle(o,null)||{}).marginRight)),typeof r.style.zoom!="undefined"&&(r.innerHTML="",r.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=r.offsetWidth===3,r.style.display="block",r.style.overflow="visible",r.innerHTML="<div></div>",r.firstChild.style.width="5px",t.shrinkWrapBlocks=r.offsetWidth!==3,n.style.zoom=1),a.removeChild(n),n=r=s=o=null}),a.removeChild(p),n=r=s=o=u=a=p=null,t}();var D=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;v.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(v.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(e){return e=e.nodeType?v.cache[e[v.expando]]:e[v.expando],!!e&&!B(e)},data:function(e,n,r,i){if(!v.acceptData(e)){return}var s,o,u=v.expando,a=typeof n=="string",f=e.nodeType,l=f?v.cache:e,c=f?e[u]:e[u]&&u;if((!c||!l[c]||!i&&!l[c].data)&&a&&r===t){return}c||(f?e[u]=c=v.deletedIds.pop()||v.guid++:c=u),l[c]||(l[c]={},f||(l[c].toJSON=v.noop));if(typeof n=="object"||typeof n=="function"){i?l[c]=v.extend(l[c],n):l[c].data=v.extend(l[c].data,n)}return s=l[c],i||(s.data||(s.data={}),s=s.data),r!==t&&(s[v.camelCase(n)]=r),a?(o=s[n],o==null&&(o=s[v.camelCase(n)])):o=s,o},removeData:function(e,t,n){if(!v.acceptData(e)){return}var r,i,s,o=e.nodeType,u=o?v.cache:e,a=o?e[v.expando]:v.expando;if(!u[a]){return}if(t){r=n?u[a]:u[a].data;if(r){v.isArray(t)||(t in r?t=[t]:(t=v.camelCase(t),t in r?t=[t]:t=t.split(" ")));for(i=0,s=t.length;i<s;i++){delete r[t[i]]}if(!(n?B:v.isEmptyObject)(r)){return}}}if(!n){delete u[a].data;if(!B(u[a])){return}}o?v.cleanData([e],!0):v.support.deleteExpando||u!=u.window?delete u[a]:u[a]=null},_data:function(e,t,n){return v.data(e,t,n,!0)},acceptData:function(e){var t=e.nodeName&&v.noData[e.nodeName.toLowerCase()];return !t||t!==!0&&e.getAttribute("classid")===t}}),v.fn.extend({data:function(e,n){var r,i,s,o,u,a=this[0],f=0,l=null;if(e===t){if(this.length){l=v.data(a);if(a.nodeType===1&&!v._data(a,"parsedAttrs")){s=a.attributes;for(u=s.length;f<u;f++){o=s[f].name,o.indexOf("data-")||(o=v.camelCase(o.substring(5)),H(a,o,l[o]))}v._data(a,"parsedAttrs",!0)}}return l}return typeof e=="object"?this.each(function(){v.data(this,e)}):(r=e.split(".",2),r[1]=r[1]?"."+r[1]:"",i=r[1]+"!",v.access(this,function(n){if(n===t){return l=this.triggerHandler("getData"+i,[r[0]]),l===t&&a&&(l=v.data(a,e),l=H(a,e,l)),l===t&&r[1]?this.data(r[0]):l}r[1]=n,this.each(function(){var t=v(this);t.triggerHandler("setData"+i,r),v.data(this,e,n),t.triggerHandler("changeData"+i,r)})},null,n,arguments.length>1,null,!1))},removeData:function(e){return this.each(function(){v.removeData(this,e)})}}),v.extend({queue:function(e,t,n){var r;if(e){return t=(t||"fx")+"queue",r=v._data(e,t),n&&(!r||v.isArray(n)?r=v._data(e,t,v.makeArray(n)):r.push(n)),r||[]}},dequeue:function(e,t){t=t||"fx";var n=v.queue(e,t),r=n.length,i=n.shift(),s=v._queueHooks(e,t),o=function(){v.dequeue(e,t)};i==="inprogress"&&(i=n.shift(),r--),i&&(t==="fx"&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return v._data(e,n)||v._data(e,n,{empty:v.Callbacks("once memory").add(function(){v.removeData(e,t+"queue",!0),v.removeData(e,n,!0)})})}}),v.fn.extend({queue:function(e,n){var r=2;return typeof e!="string"&&(n=e,e="fx",r--),arguments.length<r?v.queue(this[0],e):n===t?this:this.each(function(){var t=v.queue(this,e,n);v._queueHooks(this,e),e==="fx"&&t[0]!=="inprogress"&&v.dequeue(this,e)})},dequeue:function(e){return this.each(function(){v.dequeue(this,e)})},delay:function(e,t){return e=v.fx?v.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=v.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};typeof e!="string"&&(n=e,e=t),e=e||"fx";while(u--){r=v._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a))}return a(),s.promise(n)}});var j,F,I,q=/[\t\r\n]/g,R=/\r/g,U=/^(?:button|input)$/i,z=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea|)$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,V=v.support.getSetAttribute;v.fn.extend({attr:function(e,t){return v.access(this,v.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){v.removeAttr(this,e)})},prop:function(e,t){return v.access(this,v.prop,e,t,arguments.length>1)},removeProp:function(e){return e=v.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o,u;if(v.isFunction(e)){return this.each(function(t){v(this).addClass(e.call(this,t,this.className))})}if(e&&typeof e=="string"){t=e.split(y);for(n=0,r=this.length;n<r;n++){i=this[n];if(i.nodeType===1){if(!i.className&&t.length===1){i.className=e}else{s=" "+i.className+" ";for(o=0,u=t.length;o<u;o++){s.indexOf(" "+t[o]+" ")<0&&(s+=t[o]+" ")}i.className=v.trim(s)}}}}return this},removeClass:function(e){var n,r,i,s,o,u,a;if(v.isFunction(e)){return this.each(function(t){v(this).removeClass(e.call(this,t,this.className))})}if(e&&typeof e=="string"||e===t){n=(e||"").split(y);for(u=0,a=this.length;u<a;u++){i=this[u];if(i.nodeType===1&&i.className){r=(" "+i.className+" ").replace(q," ");for(s=0,o=n.length;s<o;s++){while(r.indexOf(" "+n[s]+" ")>=0){r=r.replace(" "+n[s]+" "," ")}}i.className=e?v.trim(r):""}}}return this},toggleClass:function(e,t){var n=typeof e,r=typeof t=="boolean";return v.isFunction(e)?this.each(function(n){v(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if(n==="string"){var i,s=0,o=v(this),u=t,a=e.split(y);while(i=a[s++]){u=r?u:!o.hasClass(i),o[u?"addClass":"removeClass"](i)}}else{if(n==="undefined"||n==="boolean"){this.className&&v._data(this,"__className__",this.className),this.className=this.className||e===!1?"":v._data(this,"__className__")||""}}})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;n<r;n++){if(this[n].nodeType===1&&(" "+this[n].className+" ").replace(q," ").indexOf(t)>=0){return !0}}return !1},val:function(e){var n,r,i,s=this[0];if(!arguments.length){if(s){return n=v.valHooks[s.type]||v.valHooks[s.nodeName.toLowerCase()],n&&"get" in n&&(r=n.get(s,"value"))!==t?r:(r=s.value,typeof r=="string"?r.replace(R,""):r==null?"":r)}return}return i=v.isFunction(e),this.each(function(r){var s,o=v(this);if(this.nodeType!==1){return}i?s=e.call(this,r,o.val()):s=e,s==null?s="":typeof s=="number"?s+="":v.isArray(s)&&(s=v.map(s,function(e){return e==null?"":e+""})),n=v.valHooks[this.type]||v.valHooks[this.nodeName.toLowerCase()];if(!n||!("set" in n)||n.set(this,s,"value")===t){this.value=s}})}}),v.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return !t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s=e.type==="select-one"||i<0,o=s?null:[],u=s?i+1:r.length,a=i<0?u:s?i:0;for(;a<u;a++){n=r[a];if((n.selected||a===i)&&(v.support.optDisabled?!n.disabled:n.getAttribute("disabled")===null)&&(!n.parentNode.disabled||!v.nodeName(n.parentNode,"optgroup"))){t=v(n).val();if(s){return t}o.push(t)}}return o},set:function(e,t){var n=v.makeArray(t);return v(e).find("option").each(function(){this.selected=v.inArray(v(this).val(),n)>=0}),n.length||(e.selectedIndex=-1),n}}},attrFn:{},attr:function(e,n,r,i){var s,o,u,a=e.nodeType;if(!e||a===3||a===8||a===2){return}if(i&&v.isFunction(v.fn[n])){return v(e)[n](r)}if(typeof e.getAttribute=="undefined"){return v.prop(e,n,r)}u=a!==1||!v.isXMLDoc(e),u&&(n=n.toLowerCase(),o=v.attrHooks[n]||(X.test(n)?F:j));if(r!==t){if(r===null){v.removeAttr(e,n);return}return o&&"set" in o&&u&&(s=o.set(e,r,n))!==t?s:(e.setAttribute(n,r+""),r)}return o&&"get" in o&&u&&(s=o.get(e,n))!==null?s:(s=e.getAttribute(n),s===null?t:s)},removeAttr:function(e,t){var n,r,i,s,o=0;if(t&&e.nodeType===1){r=t.split(y);for(;o<r.length;o++){i=r[o],i&&(n=v.propFix[i]||i,s=X.test(i),s||v.attr(e,i,""),e.removeAttribute(V?i:n),s&&n in e&&(e[n]=!1))}}},attrHooks:{type:{set:function(e,t){if(U.test(e.nodeName)&&e.parentNode){v.error("type property can't be changed")}else{if(!v.support.radioValue&&t==="radio"&&v.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},value:{get:function(e,t){return j&&v.nodeName(e,"button")?j.get(e,t):t in e?e.value:null},set:function(e,t,n){if(j&&v.nodeName(e,"button")){return j.set(e,t,n)}e.value=t}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(!e||u===3||u===8||u===2){return}return o=u!==1||!v.isXMLDoc(e),o&&(n=v.propFix[n]||n,s=v.propHooks[n]),r!==t?s&&"set" in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get" in s&&(i=s.get(e,n))!==null?i:e[n]},propHooks:{tabIndex:{get:function(e){var n=e.getAttributeNode("tabindex");return n&&n.specified?parseInt(n.value,10):z.test(e.nodeName)||W.test(e.nodeName)&&e.href?0:t}}}}),F={get:function(e,n){var r,i=v.prop(e,n);return i===!0||typeof i!="boolean"&&(r=e.getAttributeNode(n))&&r.nodeValue!==!1?n.toLowerCase():t},set:function(e,t,n){var r;return t===!1?v.removeAttr(e,n):(r=v.propFix[n]||n,r in e&&(e[r]=!0),e.setAttribute(n,n.toLowerCase())),n}},V||(I={name:!0,id:!0,coords:!0},j=v.valHooks.button={get:function(e,n){var r;return r=e.getAttributeNode(n),r&&(I[n]?r.value!=="":r.specified)?r.value:t},set:function(e,t,n){var r=e.getAttributeNode(n);return r||(r=i.createAttribute(n),e.setAttributeNode(r)),r.value=t+""}},v.each(["width","height"],function(e,t){v.attrHooks[t]=v.extend(v.attrHooks[t],{set:function(e,n){if(n===""){return e.setAttribute(t,"auto"),n}}})}),v.attrHooks.contenteditable={get:j.get,set:function(e,t,n){t===""&&(t="false"),j.set(e,t,n)}}),v.support.hrefNormalized||v.each(["href","src","width","height"],function(e,n){v.attrHooks[n]=v.extend(v.attrHooks[n],{get:function(e){var r=e.getAttribute(n,2);return r===null?t:r}})}),v.support.style||(v.attrHooks.style={get:function(e){return e.style.cssText.toLowerCase()||t},set:function(e,t){return e.style.cssText=t+""}}),v.support.optSelected||(v.propHooks.selected=v.extend(v.propHooks.selected,{get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}})),v.support.enctype||(v.propFix.enctype="encoding"),v.support.checkOn||v.each(["radio","checkbox"],function(){v.valHooks[this]={get:function(e){return e.getAttribute("value")===null?"on":e.value}}}),v.each(["radio","checkbox"],function(){v.valHooks[this]=v.extend(v.valHooks[this],{set:function(e,t){if(v.isArray(t)){return e.checked=v.inArray(v(e).val(),t)>=0}}})});var $=/^(?:textarea|input|select)$/i,J=/^([^\.]*|)(?:\.(.+)|)$/,K=/(?:^|\s)hover(\.\S+|)\b/,Q=/^key/,G=/^(?:mouse|contextmenu)|click/,Y=/^(?:focusinfocus|focusoutblur)$/,Z=function(e){return v.event.special.hover?e:e.replace(K,"mouseenter$1 mouseleave$1")};v.event={add:function(e,n,r,i,s){var o,u,a,f,l,c,h,p,d,m,g;if(e.nodeType===3||e.nodeType===8||!n||!r||!(o=v._data(e))){return}r.handler&&(d=r,r=d.handler,s=d.selector),r.guid||(r.guid=v.guid++),a=o.events,a||(o.events=a={}),u=o.handle,u||(o.handle=u=function(e){return typeof v=="undefined"||!!e&&v.event.triggered===e.type?t:v.event.dispatch.apply(u.elem,arguments)},u.elem=e),n=v.trim(Z(n)).split(" ");for(f=0;f<n.length;f++){l=J.exec(n[f])||[],c=l[1],h=(l[2]||"").split(".").sort(),g=v.event.special[c]||{},c=(s?g.delegateType:g.bindType)||c,g=v.event.special[c]||{},p=v.extend({type:c,origType:l[1],data:i,handler:r,guid:r.guid,selector:s,needsContext:s&&v.expr.match.needsContext.test(s),namespace:h.join(".")},d),m=a[c];if(!m){m=a[c]=[],m.delegateCount=0;if(!g.setup||g.setup.call(e,i,h,u)===!1){e.addEventListener?e.addEventListener(c,u,!1):e.attachEvent&&e.attachEvent("on"+c,u)}}g.add&&(g.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),s?m.splice(m.delegateCount++,0,p):m.push(p),v.event.global[c]=!0}e=null},global:{},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,m,g=v.hasData(e)&&v._data(e);if(!g||!(h=g.events)){return}t=v.trim(Z(t||"")).split(" ");for(s=0;s<t.length;s++){o=J.exec(t[s])||[],u=a=o[1],f=o[2];if(!u){for(u in h){v.event.remove(e,u+t[s],n,r,!0)}continue}p=v.event.special[u]||{},u=(r?p.delegateType:p.bindType)||u,d=h[u]||[],l=d.length,f=f?new RegExp("(^|\\.)"+f.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;for(c=0;c<d.length;c++){m=d[c],(i||a===m.origType)&&(!n||n.guid===m.guid)&&(!f||f.test(m.namespace))&&(!r||r===m.selector||r==="**"&&m.selector)&&(d.splice(c--,1),m.selector&&d.delegateCount--,p.remove&&p.remove.call(e,m))}d.length===0&&l!==d.length&&((!p.teardown||p.teardown.call(e,f,g.handle)===!1)&&v.removeEvent(e,u,g.handle),delete h[u])}v.isEmptyObject(h)&&(delete g.handle,v.removeData(e,"events",!0))},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(n,r,s,o){if(!s||s.nodeType!==3&&s.nodeType!==8){var u,a,f,l,c,h,p,d,m,g,y=n.type||n,b=[];if(Y.test(y+v.event.triggered)){return}y.indexOf("!")>=0&&(y=y.slice(0,-1),a=!0),y.indexOf(".")>=0&&(b=y.split("."),y=b.shift(),b.sort());if((!s||v.event.customEvent[y])&&!v.event.global[y]){return}n=typeof n=="object"?n[v.expando]?n:new v.Event(y,n):new v.Event(y),n.type=y,n.isTrigger=!0,n.exclusive=a,n.namespace=b.join("."),n.namespace_re=n.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,h=y.indexOf(":")<0?"on"+y:"";if(!s){u=v.cache;for(f in u){u[f].events&&u[f].events[y]&&v.event.trigger(n,r,u[f].handle.elem,!0)}return}n.result=t,n.target||(n.target=s),r=r!=null?v.makeArray(r):[],r.unshift(n),p=v.event.special[y]||{};if(p.trigger&&p.trigger.apply(s,r)===!1){return}m=[[s,p.bindType||y]];if(!o&&!p.noBubble&&!v.isWindow(s)){g=p.delegateType||y,l=Y.test(g+y)?s:s.parentNode;for(c=s;l;l=l.parentNode){m.push([l,g]),c=l}c===(s.ownerDocument||i)&&m.push([c.defaultView||c.parentWindow||e,g])}for(f=0;f<m.length&&!n.isPropagationStopped();f++){l=m[f][0],n.type=m[f][1],d=(v._data(l,"events")||{})[n.type]&&v._data(l,"handle"),d&&d.apply(l,r),d=h&&l[h],d&&v.acceptData(l)&&d.apply&&d.apply(l,r)===!1&&n.preventDefault()}return n.type=y,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(s.ownerDocument,r)===!1)&&(y!=="click"||!v.nodeName(s,"a"))&&v.acceptData(s)&&h&&s[y]&&(y!=="focus"&&y!=="blur"||n.target.offsetWidth!==0)&&!v.isWindow(s)&&(c=s[h],c&&(s[h]=null),v.event.triggered=y,s[y](),v.event.triggered=t,c&&(s[h]=c)),n.result}return},dispatch:function(n){n=v.event.fix(n||e.event);var r,i,s,o,u,a,f,c,h,p,d=(v._data(this,"events")||{})[n.type]||[],m=d.delegateCount,g=l.call(arguments),y=!n.exclusive&&!n.namespace,b=v.event.special[n.type]||{},w=[];g[0]=n,n.delegateTarget=this;if(b.preDispatch&&b.preDispatch.call(this,n)===!1){return}if(m&&(!n.button||n.type!=="click")){for(s=n.target;s!=this;s=s.parentNode||this){if(s.disabled!==!0||n.type!=="click"){u={},f=[];for(r=0;r<m;r++){c=d[r],h=c.selector,u[h]===t&&(u[h]=c.needsContext?v(h,this).index(s)>=0:v.find(h,this,null,[s]).length),u[h]&&f.push(c)}f.length&&w.push({elem:s,matches:f})}}}d.length>m&&w.push({elem:this,matches:d.slice(m)});for(r=0;r<w.length&&!n.isPropagationStopped();r++){a=w[r],n.currentTarget=a.elem;for(i=0;i<a.matches.length&&!n.isImmediatePropagationStopped();i++){c=a.matches[i];if(y||!n.namespace&&!c.namespace||n.namespace_re&&n.namespace_re.test(c.namespace)){n.data=c.data,n.handleObj=c,o=((v.event.special[c.origType]||{}).handle||c.handler).apply(a.elem,g),o!==t&&(n.result=o,o===!1&&(n.preventDefault(),n.stopPropagation()))}}}return b.postDispatch&&b.postDispatch.call(this,n),n.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return e.which==null&&(e.which=t.charCode!=null?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,s,o,u=n.button,a=n.fromElement;return e.pageX==null&&n.clientX!=null&&(r=e.target.ownerDocument||i,s=r.documentElement,o=r.body,e.pageX=n.clientX+(s&&s.scrollLeft||o&&o.scrollLeft||0)-(s&&s.clientLeft||o&&o.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||o&&o.scrollTop||0)-(s&&s.clientTop||o&&o.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),!e.which&&u!==t&&(e.which=u&1?1:u&2?3:u&4?2:0),e}},fix:function(e){if(e[v.expando]){return e}var t,n,r=e,s=v.event.fixHooks[e.type]||{},o=s.props?this.props.concat(s.props):this.props;e=v.Event(r);for(t=o.length;t;){n=o[--t],e[n]=r[n]}return e.target||(e.target=r.srcElement||i),e.target.nodeType===3&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,r):e},special:{load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(e,t,n){v.isWindow(this)&&(this.onbeforeunload=n)},teardown:function(e,t){this.onbeforeunload===t&&(this.onbeforeunload=null)}}},simulate:function(e,t,n,r){var i=v.extend(new v.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?v.event.trigger(i,null,t):v.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},v.event.handle=v.event.dispatch,v.removeEvent=i.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]=="undefined"&&(e[r]=null),e.detachEvent(r,n))},v.Event=function(e,t){if(!(this instanceof v.Event)){return new v.Event(e,t)}e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?tt:et):this.type=e,t&&v.extend(this,t),this.timeStamp=e&&e.timeStamp||v.now(),this[v.expando]=!0},v.Event.prototype={preventDefault:function(){this.isDefaultPrevented=tt;var e=this.originalEvent;if(!e){return}e.preventDefault?e.preventDefault():e.returnValue=!1},stopPropagation:function(){this.isPropagationStopped=tt;var e=this.originalEvent;if(!e){return}e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=tt,this.stopPropagation()},isDefaultPrevented:et,isPropagationStopped:et,isImmediatePropagationStopped:et},v.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){v.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj,o=s.selector;if(!i||i!==r&&!v.contains(r,i)){e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t}return n}}}),v.support.submitBubbles||(v.event.special.submit={setup:function(){if(v.nodeName(this,"form")){return !1}v.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=v.nodeName(n,"input")||v.nodeName(n,"button")?n.form:t;r&&!v._data(r,"_submit_attached")&&(v.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),v._data(r,"_submit_attached",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&v.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(v.nodeName(this,"form")){return !1}v.event.remove(this,"._submit")}}),v.support.changeBubbles||(v.event.special.change={setup:function(){if($.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){v.event.add(this,"propertychange._change",function(e){e.originalEvent.propertyName==="checked"&&(this._just_changed=!0)}),v.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),v.event.simulate("change",this,e,!0)})}return !1}v.event.add(this,"beforeactivate._change",function(e){var t=e.target;$.test(t.nodeName)&&!v._data(t,"_change_attached")&&(v.event.add(t,"change._change",function(e){this.parentNode&&!e.isSimulated&&!e.isTrigger&&v.event.simulate("change",this.parentNode,e,!0)}),v._data(t,"_change_attached",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||t.type!=="radio"&&t.type!=="checkbox"){return e.handleObj.handler.apply(this,arguments)}},teardown:function(){return v.event.remove(this,"._change"),!$.test(this.nodeName)}}),v.support.focusinBubbles||v.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){v.event.simulate(t,e.target,v.event.fix(e),!0)};v.event.special[t]={setup:function(){n++===0&&i.addEventListener(e,r,!0)},teardown:function(){--n===0&&i.removeEventListener(e,r,!0)}}}),v.fn.extend({on:function(e,n,r,i,s){var o,u;if(typeof e=="object"){typeof n!="string"&&(r=r||n,n=t);for(u in e){this.on(u,n,r,e[u],s)}return this}r==null&&i==null?(i=n,r=n=t):i==null&&(typeof n=="string"?(i=r,r=t):(i=r,r=n,n=t));if(i===!1){i=et}else{if(!i){return this}}return s===1&&(o=i,i=function(e){return v().off(e),o.apply(this,arguments)},i.guid=o.guid||(o.guid=v.guid++)),this.each(function(){v.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj){return i=e.handleObj,v(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this}if(typeof e=="object"){for(s in e){this.off(s,n,e[s])}return this}if(n===!1||typeof n=="function"){r=n,n=t}return r===!1&&(r=et),this.each(function(){v.event.remove(this,e,r,n)})},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},live:function(e,t,n){return v(this.context).on(e,this.selector,t,n),this},die:function(e,t){return v(this.context).off(e,this.selector||"**",t),this},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return arguments.length===1?this.off(e,"**"):this.off(t,e||"**",n)},trigger:function(e,t){return this.each(function(){v.event.trigger(e,t,this)})},triggerHandler:function(e,t){if(this[0]){return v.event.trigger(e,t,this[0],!0)}},toggle:function(e){var t=arguments,n=e.guid||v.guid++,r=0,i=function(n){var i=(v._data(this,"lastToggle"+e.guid)||0)%r;return v._data(this,"lastToggle"+e.guid,i+1),n.preventDefault(),t[i].apply(this,arguments)||!1};i.guid=n;while(r<t.length){t[r++].guid=n}return this.click(i)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),v.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){v.fn[t]=function(e,n){return n==null&&(n=e,e=null),arguments.length>0?this.on(t,null,e,n):this.trigger(t)},Q.test(t)&&(v.event.fixHooks[t]=v.event.keyHooks),G.test(t)&&(v.event.fixHooks[t]=v.event.mouseHooks)}),function(e,t){function nt(e,t,n,r){n=n||[],t=t||g;var i,s,a,f,l=t.nodeType;if(!e||typeof e!="string"){return n}if(l!==1&&l!==9){return[]}a=o(t);if(!a&&!r){if(i=R.exec(e)){if(f=i[1]){if(l===9){s=t.getElementById(f);if(!s||!s.parentNode){return n}if(s.id===f){return n.push(s),n}}else{if(t.ownerDocument&&(s=t.ownerDocument.getElementById(f))&&u(t,s)&&s.id===f){return n.push(s),n}}}else{if(i[2]){return S.apply(n,x.call(t.getElementsByTagName(e),0)),n}if((f=i[3])&&Z&&t.getElementsByClassName){return S.apply(n,x.call(t.getElementsByClassName(f),0)),n}}}}return vt(e.replace(j,"$1"),t,n,r,a)}function rt(e){return function(t){var n=t.nodeName.toLowerCase();return n==="input"&&t.type===e}}function it(e){return function(t){var n=t.nodeName.toLowerCase();return(n==="input"||n==="button")&&t.type===e}}function st(e){return N(function(t){return t=+t,N(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--){n[i=s[o]]&&(n[i]=!(r[i]=n[i]))}})})}function ot(e,t,n){if(e===t){return n}var r=e.nextSibling;while(r){if(r===t){return -1}r=r.nextSibling}return 1}function ut(e,t){var n,r,s,o,u,a,f,l=L[d][e+" "];if(l){return t?0:l.slice(0)}u=e,a=[],f=i.preFilter;while(u){if(!n||(r=F.exec(u))){r&&(u=u.slice(r[0].length)||u),a.push(s=[])}n=!1;if(r=I.exec(u)){s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=r[0].replace(j," ")}for(o in i.filter){(r=J[o].exec(u))&&(!f[o]||(r=f[o](r)))&&(s.push(n=new m(r.shift())),u=u.slice(n.length),n.type=o,n.matches=r)}if(!n){break}}return t?u.length:u?nt.error(e):L(e,a).slice(0)}function at(e,t,r){var i=t.dir,s=r&&t.dir==="parentNode",o=w++;return t.first?function(t,n,r){while(t=t[i]){if(s||t.nodeType===1){return e(t,n,r)}}}:function(t,r,u){if(!u){var a,f=b+" "+o+" ",l=f+n;while(t=t[i]){if(s||t.nodeType===1){if((a=t[d])===l){return t.sizset}if(typeof a=="string"&&a.indexOf(f)===0){if(t.sizset){return t}}else{t[d]=l;if(e(t,r,u)){return t.sizset=!0,t}t.sizset=!1}}}}else{while(t=t[i]){if(s||t.nodeType===1){if(e(t,r,u)){return t}}}}}}function ft(e){return e.length>1?function(t,n,r){var i=e.length;while(i--){if(!e[i](t,n,r)){return !1}}return !0}:e[0]}function lt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=t!=null;for(;u<a;u++){if(s=e[u]){if(!n||n(s,r,i)){o.push(s),f&&t.push(u)}}}return o}function ct(e,t,n,r,i,s){return r&&!r[d]&&(r=ct(r)),i&&!i[d]&&(i=ct(i,s)),N(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||dt(t||"*",u.nodeType?[u]:u,[]),m=e&&(s||!t)?lt(v,h,e,u,a):v,g=n?i||(s?e:d||r)?[]:o:m;n&&n(m,g,u,a);if(r){f=lt(g,p),r(f,[],u,a),l=f.length;while(l--){if(c=f[l]){g[p[l]]=!(m[p[l]]=c)}}}if(s){if(i||e){if(i){f=[],l=g.length;while(l--){(c=g[l])&&f.push(m[l]=c)}i(null,g=[],f,a)}l=g.length;while(l--){(c=g[l])&&(f=i?T.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}}else{g=lt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):S.apply(o,g)}})}function ht(e){var t,n,r,s=e.length,o=i.relative[e[0].type],u=o||i.relative[" "],a=o?1:0,f=at(function(e){return e===t},u,!0),l=at(function(e){return T.call(t,e)>-1},u,!0),h=[function(e,n,r){return !o&&(r||n!==c)||((t=n).nodeType?f(e,n,r):l(e,n,r))}];for(;a<s;a++){if(n=i.relative[e[a].type]){h=[at(ft(h),n)]}else{n=i.filter[e[a].type].apply(null,e[a].matches);if(n[d]){r=++a;for(;r<s;r++){if(i.relative[e[r].type]){break}}return ct(a>1&&ft(h),a>1&&e.slice(0,a-1).join("").replace(j,"$1"),n,a<r&&ht(e.slice(a,r)),r<s&&ht(e=e.slice(r)),r<s&&e.join(""))}h.push(n)}}return ft(h)}function pt(e,t){var r=t.length>0,s=e.length>0,o=function(u,a,f,l,h){var p,d,v,m=[],y=0,w="0",x=u&&[],T=h!=null,N=c,C=u||s&&i.find.TAG("*",h&&a.parentNode||a),k=b+=N==null?1:Math.E;T&&(c=a!==g&&a,n=o.el);for(;(p=C[w])!=null;w++){if(s&&p){for(d=0;v=e[d];d++){if(v(p,a,f)){l.push(p);break}}T&&(b=k,n=++o.el)}r&&((p=!v&&p)&&y--,u&&x.push(p))}y+=w;if(r&&w!==y){for(d=0;v=t[d];d++){v(x,m,a,f)}if(u){if(y>0){while(w--){!x[w]&&!m[w]&&(m[w]=E.call(l))}}m=lt(m)}S.apply(l,m),T&&!u&&m.length>0&&y+t.length>1&&nt.uniqueSort(l)}return T&&(b=k,c=N),x};return o.el=0,r?N(o):o}function dt(e,t,n){var r=0,i=t.length;for(;r<i;r++){nt(e,t[r],n)}return n}function vt(e,t,n,r,s){var o,u,f,l,c,h=ut(e),p=h.length;if(!r&&h.length===1){u=h[0]=h[0].slice(0);if(u.length>2&&(f=u[0]).type==="ID"&&t.nodeType===9&&!s&&i.relative[u[1].type]){t=i.find.ID(f.matches[0].replace($,""),t,s)[0];if(!t){return n}e=e.slice(u.shift().length)}for(o=J.POS.test(e)?-1:u.length-1;o>=0;o--){f=u[o];if(i.relative[l=f.type]){break}if(c=i.find[l]){if(r=c(f.matches[0].replace($,""),z.test(u[0].type)&&t.parentNode||t,s)){u.splice(o,1),e=r.length&&u.join("");if(!e){return S.apply(n,x.call(r,0)),n}break}}}}return a(e,h)(r,t,s,n,z.test(e)),n}function mt(){}var n,r,i,s,o,u,a,f,l,c,h=!0,p="undefined",d=("sizcache"+Math.random()).replace(".",""),m=String,g=e.document,y=g.documentElement,b=0,w=0,E=[].pop,S=[].push,x=[].slice,T=[].indexOf||function(e){var t=0,n=this.length;for(;t<n;t++){if(this[t]===e){return t}}return -1},N=function(e,t){return e[d]=t==null||t,e},C=function(){var e={},t=[];return N(function(n,r){return t.push(n)>i.cacheLength&&delete e[t.shift()],e[n+" "]=r},e)},k=C(),L=C(),A=C(),O="[\\x20\\t\\r\\n\\f]",M="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",_=M.replace("w","w#"),D="([*^$|!~]?=)",P="\\["+O+"*("+M+")"+O+"*(?:"+D+O+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+_+")|)|)"+O+"*\\]",H=":("+M+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+P+")|[^:]|\\\\.)*|.*))\\)|)",B=":(even|odd|eq|gt|lt|nth|first|last)(?:\\("+O+"*((?:-\\d)?\\d*)"+O+"*\\)|)(?=[^-]|$)",j=new RegExp("^"+O+"+|((?:^|[^\\\\])(?:\\\\.)*)"+O+"+$","g"),F=new RegExp("^"+O+"*,"+O+"*"),I=new RegExp("^"+O+"*([\\x20\\t\\r\\n\\f>+~])"+O+"*"),q=new RegExp(H),R=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,U=/^:not/,z=/[\x20\t\r\n\f]*[+~]/,W=/:not\($/,X=/h\d/i,V=/input|select|textarea|button/i,$=/\\(?!\\)/g,J={ID:new RegExp("^#("+M+")"),CLASS:new RegExp("^\\.("+M+")"),NAME:new RegExp("^\\[name=['\"]?("+M+")['\"]?\\]"),TAG:new RegExp("^("+M.replace("w","w*")+")"),ATTR:new RegExp("^"+P),PSEUDO:new RegExp("^"+H),POS:new RegExp(B,"i"),CHILD:new RegExp("^:(only|nth|first|last)-child(?:\\("+O+"*(even|odd|(([+-]|)(\\d*)n|)"+O+"*(?:([+-]|)"+O+"*(\\d+)|))"+O+"*\\)|)","i"),needsContext:new RegExp("^"+O+"*[>+~]|"+B,"i")},K=function(e){var t=g.createElement("div");try{return e(t)}catch(n){return !1}finally{t=null}},Q=K(function(e){return e.appendChild(g.createComment("")),!e.getElementsByTagName("*").length}),G=K(function(e){return e.innerHTML="<a href='#'></a>",e.firstChild&&typeof e.firstChild.getAttribute!==p&&e.firstChild.getAttribute("href")==="#"}),Y=K(function(e){e.innerHTML="<select></select>";var t=typeof e.lastChild.getAttribute("multiple");return t!=="boolean"&&t!=="string"}),Z=K(function(e){return e.innerHTML="<div class='hidden e'></div><div class='hidden'></div>",!e.getElementsByClassName||!e.getElementsByClassName("e").length?!1:(e.lastChild.className="e",e.getElementsByClassName("e").length===2)}),et=K(function(e){e.id=d+0,e.innerHTML="<a name='"+d+"'></a><div name='"+d+"'></div>",y.insertBefore(e,y.firstChild);var t=g.getElementsByName&&g.getElementsByName(d).length===2+g.getElementsByName(d+0).length;return r=!g.getElementById(d),y.removeChild(e),t});try{x.call(y.childNodes,0)[0].nodeType}catch(tt){x=function(e){var t,n=[];for(;t=this[e];e++){n.push(t)}return n}}nt.matches=function(e,t){return nt(e,null,null,t)},nt.matchesSelector=function(e,t){return nt(t,null,null,[e]).length>0},s=nt.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(i===1||i===9||i===11){if(typeof e.textContent=="string"){return e.textContent}for(e=e.firstChild;e;e=e.nextSibling){n+=s(e)}}else{if(i===3||i===4){return e.nodeValue}}}else{for(;t=e[r];r++){n+=s(t)}}return n},o=nt.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?t.nodeName!=="HTML":!1},u=nt.contains=y.contains?function(e,t){var n=e.nodeType===9?e.documentElement:e,r=t&&t.parentNode;return e===r||!!(r&&r.nodeType===1&&n.contains&&n.contains(r))}:y.compareDocumentPosition?function(e,t){return t&&!!(e.compareDocumentPosition(t)&16)}:function(e,t){while(t=t.parentNode){if(t===e){return !0}}return !1},nt.attr=function(e,t){var n,r=o(e);return r||(t=t.toLowerCase()),(n=i.attrHandle[t])?n(e):r||Y?e.getAttribute(t):(n=e.getAttributeNode(t),n?typeof e[t]=="boolean"?e[t]?t:null:n.specified?n.value:null:null)},i=nt.selectors={cacheLength:50,createPseudo:N,match:J,attrHandle:G?{}:{href:function(e){return e.getAttribute("href",2)},type:function(e){return e.getAttribute("type")}},find:{ID:r?function(e,t,n){if(typeof t.getElementById!==p&&!n){var r=t.getElementById(e);return r&&r.parentNode?[r]:[]}}:function(e,n,r){if(typeof n.getElementById!==p&&!r){var i=n.getElementById(e);return i?i.id===e||typeof i.getAttributeNode!==p&&i.getAttributeNode("id").value===e?[i]:t:[]}},TAG:Q?function(e,t){if(typeof t.getElementsByTagName!==p){return t.getElementsByTagName(e)}}:function(e,t){var n=t.getElementsByTagName(e);if(e==="*"){var r,i=[],s=0;for(;r=n[s];s++){r.nodeType===1&&i.push(r)}return i}return n},NAME:et&&function(e,t){if(typeof t.getElementsByName!==p){return t.getElementsByName(name)}},CLASS:Z&&function(e,t,n){if(typeof t.getElementsByClassName!==p&&!n){return t.getElementsByClassName(e)}}},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace($,""),e[3]=(e[4]||e[5]||"").replace($,""),e[2]==="~="&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),e[1]==="nth"?(e[2]||nt.error(e[0]),e[3]=+(e[3]?e[4]+(e[5]||1):2*(e[2]==="even"||e[2]==="odd")),e[4]=+(e[6]+e[7]||e[2]==="odd")):e[2]&&nt.error(e[0]),e},PSEUDO:function(e){var t,n;if(J.CHILD.test(e[0])){return null}if(e[3]){e[2]=e[3]}else{if(t=e[4]){q.test(t)&&(n=ut(t,!0))&&(n=t.indexOf(")",t.length-n)-t.length)&&(t=t.slice(0,n),e[0]=e[0].slice(0,n)),e[2]=t}}return e.slice(0,3)}},filter:{ID:r?function(e){return e=e.replace($,""),function(t){return t.getAttribute("id")===e}}:function(e){return e=e.replace($,""),function(t){var n=typeof t.getAttributeNode!==p&&t.getAttributeNode("id");return n&&n.value===e}},TAG:function(e){return e==="*"?function(){return !0}:(e=e.replace($,"").toLowerCase(),function(t){return t.nodeName&&t.nodeName.toLowerCase()===e})},CLASS:function(e){var t=k[d][e+" "];return t||(t=new RegExp("(^|"+O+")"+e+"("+O+"|$)"))&&k(e,function(e){return t.test(e.className||typeof e.getAttribute!==p&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r,i){var s=nt.attr(r,e);return s==null?t==="!=":t?(s+="",t==="="?s===n:t==="!="?s!==n:t==="^="?n&&s.indexOf(n)===0:t==="*="?n&&s.indexOf(n)>-1:t==="$="?n&&s.substr(s.length-n.length)===n:t==="~="?(" "+s+" ").indexOf(n)>-1:t==="|="?s===n||s.substr(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r){return e==="nth"?function(e){var t,i,s=e.parentNode;if(n===1&&r===0){return !0}if(s){i=0;for(t=s.firstChild;t;t=t.nextSibling){if(t.nodeType===1){i++;if(e===t){break}}}}return i-=r,i===n||i%n===0&&i/n>=0}:function(t){var n=t;switch(e){case"only":case"first":while(n=n.previousSibling){if(n.nodeType===1){return !1}}if(e==="first"){return !0}n=t;case"last":while(n=n.nextSibling){if(n.nodeType===1){return !1}}return !0}}},PSEUDO:function(e,t){var n,r=i.pseudos[e]||i.setFilters[e.toLowerCase()]||nt.error("unsupported pseudo: "+e);return r[d]?r(t):r.length>1?(n=[e,e,"",t],i.setFilters.hasOwnProperty(e.toLowerCase())?N(function(e,n){var i,s=r(e,t),o=s.length;while(o--){i=T.call(e,s[o]),e[i]=!(n[i]=s[o])}}):function(e){return r(e,0,n)}):r}},pseudos:{not:N(function(e){var t=[],n=[],r=a(e.replace(j,"$1"));return r[d]?N(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--){if(s=o[u]){e[u]=!(t[u]=s)}}}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:N(function(e){return function(t){return nt(e,t).length>0}}),contains:N(function(e){return function(t){return(t.textContent||t.innerText||s(t)).indexOf(e)>-1}}),enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&!!e.checked||t==="option"&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},parent:function(e){return !i.pseudos.empty(e)},empty:function(e){var t;e=e.firstChild;while(e){if(e.nodeName>"@"||(t=e.nodeType)===3||t===4){return !1}e=e.nextSibling}return !0},header:function(e){return X.test(e.nodeName)},text:function(e){var t,n;return e.nodeName.toLowerCase()==="input"&&(t=e.type)==="text"&&((n=e.getAttribute("type"))==null||n.toLowerCase()===t)},radio:rt("radio"),checkbox:rt("checkbox"),file:rt("file"),password:rt("password"),image:rt("image"),submit:it("submit"),reset:it("reset"),button:function(e){var t=e.nodeName.toLowerCase();return t==="input"&&e.type==="button"||t==="button"},input:function(e){return V.test(e.nodeName)},focus:function(e){var t=e.ownerDocument;return e===t.activeElement&&(!t.hasFocus||t.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},active:function(e){return e===e.ownerDocument.activeElement},first:st(function(){return[0]}),last:st(function(e,t){return[t-1]}),eq:st(function(e,t,n){return[n<0?n+t:n]}),even:st(function(e,t){for(var n=0;n<t;n+=2){e.push(n)}return e}),odd:st(function(e,t){for(var n=1;n<t;n+=2){e.push(n)}return e}),lt:st(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;){e.push(r)}return e}),gt:st(function(e,t,n){for(var r=n<0?n+t:n;++r<t;){e.push(r)}return e})}},f=y.compareDocumentPosition?function(e,t){return e===t?(l=!0,0):(!e.compareDocumentPosition||!t.compareDocumentPosition?e.compareDocumentPosition:e.compareDocumentPosition(t)&4)?-1:1}:function(e,t){if(e===t){return l=!0,0}if(e.sourceIndex&&t.sourceIndex){return e.sourceIndex-t.sourceIndex}var n,r,i=[],s=[],o=e.parentNode,u=t.parentNode,a=o;if(o===u){return ot(e,t)}if(!o){return -1}if(!u){return 1}while(a){i.unshift(a),a=a.parentNode}a=u;while(a){s.unshift(a),a=a.parentNode}n=i.length,r=s.length;for(var f=0;f<n&&f<r;f++){if(i[f]!==s[f]){return ot(i[f],s[f])}}return f===n?ot(e,s[f],-1):ot(i[f],t,1)},[0,0].sort(f),h=!l,nt.uniqueSort=function(e){var t,n=[],r=1,i=0;l=h,e.sort(f);if(l){for(;t=e[r];r++){t===e[r-1]&&(i=n.push(r))}while(i--){e.splice(n[i],1)}}return e},nt.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},a=nt.compile=function(e,t){var n,r=[],i=[],s=A[d][e+" "];if(!s){t||(t=ut(e)),n=t.length;while(n--){s=ht(t[n]),s[d]?r.push(s):i.push(s)}s=A(e,pt(i,r))}return s},g.querySelectorAll&&function(){var e,t=vt,n=/'|\\/g,r=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,i=[":focus"],s=[":active"],u=y.matchesSelector||y.mozMatchesSelector||y.webkitMatchesSelector||y.oMatchesSelector||y.msMatchesSelector;K(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||i.push("\\["+O+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)"),e.querySelectorAll(":checked").length||i.push(":checked")}),K(function(e){e.innerHTML="<p test=''></p>",e.querySelectorAll("[test^='']").length&&i.push("[*^$]="+O+"*(?:\"\"|'')"),e.innerHTML="<input type='hidden'/>",e.querySelectorAll(":enabled").length||i.push(":enabled",":disabled")}),i=new RegExp(i.join("|")),vt=function(e,r,s,o,u){if(!o&&!u&&!i.test(e)){var a,f,l=!0,c=d,h=r,p=r.nodeType===9&&e;if(r.nodeType===1&&r.nodeName.toLowerCase()!=="object"){a=ut(e),(l=r.getAttribute("id"))?c=l.replace(n,"\\$&"):r.setAttribute("id",c),c="[id='"+c+"'] ",f=a.length;while(f--){a[f]=c+a[f].join("")}h=z.test(e)&&r.parentNode||r,p=a.join(",")}if(p){try{return S.apply(s,x.call(h.querySelectorAll(p),0)),s}catch(v){}finally{l||r.removeAttribute("id")}}}return t(e,r,s,o,u)},u&&(K(function(t){e=u.call(t,"div");try{u.call(t,"[test!='']:sizzle"),s.push("!=",H)}catch(n){}}),s=new RegExp(s.join("|")),nt.matchesSelector=function(t,n){n=n.replace(r,"='$1']");if(!o(t)&&!s.test(n)&&!i.test(n)){try{var a=u.call(t,n);if(a||e||t.document&&t.document.nodeType!==11){return a}}catch(f){}}return nt(n,null,null,[t]).length>0})}(),i.pseudos.nth=i.pseudos.eq,i.filters=mt.prototype=i.pseudos,i.setFilters=new mt,nt.attr=v.attr,v.find=nt,v.expr=nt.selectors,v.expr[":"]=v.expr.pseudos,v.unique=nt.uniqueSort,v.text=nt.getText,v.isXMLDoc=nt.isXML,v.contains=nt.contains}(e);var nt=/Until$/,rt=/^(?:parents|prev(?:Until|All))/,it=/^.[^:#\[\.,]*$/,st=v.expr.match.needsContext,ot={children:!0,contents:!0,next:!0,prev:!0};v.fn.extend({find:function(e){var t,n,r,i,s,o,u=this;if(typeof e!="string"){return v(e).filter(function(){for(t=0,n=u.length;t<n;t++){if(v.contains(u[t],this)){return !0}}})}o=this.pushStack("","find",e);for(t=0,n=this.length;t<n;t++){r=o.length,v.find(e,this[t],o);if(t>0){for(i=r;i<o.length;i++){for(s=0;s<r;s++){if(o[s]===o[i]){o.splice(i--,1);break}}}}}return o},has:function(e){var t,n=v(e,this),r=n.length;return this.filter(function(){for(t=0;t<r;t++){if(v.contains(this,n[t])){return !0}}})},not:function(e){return this.pushStack(ft(this,e,!1),"not",e)},filter:function(e){return this.pushStack(ft(this,e,!0),"filter",e)},is:function(e){return !!e&&(typeof e=="string"?st.test(e)?v(e,this.context).index(this[0])>=0:v.filter(e,this).length>0:this.filter(e).length>0)},closest:function(e,t){var n,r=0,i=this.length,s=[],o=st.test(e)||typeof e!="string"?v(e,t||this.context):0;for(;r<i;r++){n=this[r];while(n&&n.ownerDocument&&n!==t&&n.nodeType!==11){if(o?o.index(n)>-1:v.find.matchesSelector(n,e)){s.push(n);break}n=n.parentNode}}return s=s.length>1?v.unique(s):s,this.pushStack(s,"closest",e)},index:function(e){return e?typeof e=="string"?v.inArray(this[0],v(e)):v.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(e,t){var n=typeof e=="string"?v(e,t):v.makeArray(e&&e.nodeType?[e]:e),r=v.merge(this.get(),n);return this.pushStack(ut(n[0])||ut(r[0])?r:v.unique(r))},addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}}),v.fn.andSelf=v.fn.addBack,v.each({parent:function(e){var t=e.parentNode;return t&&t.nodeType!==11?t:null},parents:function(e){return v.dir(e,"parentNode")},parentsUntil:function(e,t,n){return v.dir(e,"parentNode",n)},next:function(e){return at(e,"nextSibling")},prev:function(e){return at(e,"previousSibling")},nextAll:function(e){return v.dir(e,"nextSibling")},prevAll:function(e){return v.dir(e,"previousSibling")},nextUntil:function(e,t,n){return v.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return v.dir(e,"previousSibling",n)},siblings:function(e){return v.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return v.sibling(e.firstChild)},contents:function(e){return v.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:v.merge([],e.childNodes)}},function(e,t){v.fn[e]=function(n,r){var i=v.map(this,t,n);return nt.test(e)||(r=n),r&&typeof r=="string"&&(i=v.filter(r,i)),i=this.length>1&&!ot[e]?v.unique(i):i,this.length>1&&rt.test(e)&&(i=i.reverse()),this.pushStack(i,e,l.call(arguments).join(","))}}),v.extend({filter:function(e,t,n){return n&&(e=":not("+e+")"),t.length===1?v.find.matchesSelector(t[0],e)?[t[0]]:[]:v.find.matches(e,t)},dir:function(e,n,r){var i=[],s=e[n];while(s&&s.nodeType!==9&&(r===t||s.nodeType!==1||!v(s).is(r))){s.nodeType===1&&i.push(s),s=s[n]}return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling){e.nodeType===1&&e!==t&&n.push(e)}return n}});var ct="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",ht=/ jQuery\d+="(?:null|\d+)"/g,pt=/^\s+/,dt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,vt=/<([\w:]+)/,mt=/<tbody/i,gt=/<|&#?\w+;/,yt=/<(?:script|style|link)/i,bt=/<(?:script|object|embed|option|style)/i,wt=new RegExp("<(?:"+ct+")[\\s/>]","i"),Et=/^(?:checkbox|radio)$/,St=/checked\s*(?:[^=]|=\s*.checked.)/i,xt=/\/(java|ecma)script/i,Tt=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,Nt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ct=lt(i),kt=Ct.appendChild(i.createElement("div"));Nt.optgroup=Nt.option,Nt.tbody=Nt.tfoot=Nt.colgroup=Nt.caption=Nt.thead,Nt.th=Nt.td,v.support.htmlSerialize||(Nt._default=[1,"X<div>","</div>"]),v.fn.extend({text:function(e){return v.access(this,function(e){return e===t?v.text(this):this.empty().append((this[0]&&this[0].ownerDocument||i).createTextNode(e))},null,e,arguments.length)},wrapAll:function(e){if(v.isFunction(e)){return this.each(function(t){v(this).wrapAll(e.call(this,t))})}if(this[0]){var t=v(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&e.firstChild.nodeType===1){e=e.firstChild}return e}).append(this)}return this},wrapInner:function(e){return v.isFunction(e)?this.each(function(t){v(this).wrapInner(e.call(this,t))}):this.each(function(){var t=v(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=v.isFunction(e);return this.each(function(n){v(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){v.nodeName(this,"body")||v(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.appendChild(e)})},prepend:function(){return this.domManip(arguments,!0,function(e){(this.nodeType===1||this.nodeType===11)&&this.insertBefore(e,this.firstChild)})},before:function(){if(!ut(this[0])){return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this)})}if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(e,this),"before",this.selector)}},after:function(){if(!ut(this[0])){return this.domManip(arguments,!1,function(e){this.parentNode.insertBefore(e,this.nextSibling)})}if(arguments.length){var e=v.clean(arguments);return this.pushStack(v.merge(this,e),"after",this.selector)}},remove:function(e,t){var n,r=0;for(;(n=this[r])!=null;r++){if(!e||v.filter(e,[n]).length){!t&&n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),v.cleanData([n])),n.parentNode&&n.parentNode.removeChild(n)}}return this},empty:function(){var e,t=0;for(;(e=this[t])!=null;t++){e.nodeType===1&&v.cleanData(e.getElementsByTagName("*"));while(e.firstChild){e.removeChild(e.firstChild)}}return this},clone:function(e,t){return e=e==null?!1:e,t=t==null?e:t,this.map(function(){return v.clone(this,e,t)})},html:function(e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t){return n.nodeType===1?n.innerHTML.replace(ht,""):t}if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++){n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e)}n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(e){return ut(this[0])?this.length?this.pushStack(v(v.isFunction(e)?e():e),"replaceWith",e):this:v.isFunction(e)?this.each(function(t){var n=v(this),r=n.html();n.replaceWith(e.call(this,t,r))}):(typeof e!="string"&&(e=v(e).detach()),this.each(function(){var t=this.nextSibling,n=this.parentNode;v(this).remove(),t?v(t).before(e):v(n).append(e)}))},detach:function(e){return this.remove(e,!0)},domManip:function(e,n,r){e=[].concat.apply([],e);var i,s,o,u,a=0,f=e[0],l=[],c=this.length;if(!v.support.checkClone&&c>1&&typeof f=="string"&&St.test(f)){return this.each(function(){v(this).domManip(e,n,r)})}if(v.isFunction(f)){return this.each(function(i){var s=v(this);e[0]=f.call(this,i,n?s.html():t),s.domManip(e,n,r)})}if(this[0]){i=v.buildFragment(e,this,l),o=i.fragment,s=o.firstChild,o.childNodes.length===1&&(o=s);if(s){n=n&&v.nodeName(s,"tr");for(u=i.cacheable||c-1;a<c;a++){r.call(n&&v.nodeName(this[a],"table")?Lt(this[a],"tbody"):this[a],a===u?o:v.clone(o,!0,!0))}}o=s=null,l.length&&v.each(l,function(e,t){t.src?v.ajax?v.ajax({url:t.src,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0}):v.error("no ajax"):v.globalEval((t.text||t.textContent||t.innerHTML||"").replace(Tt,"")),t.parentNode&&t.parentNode.removeChild(t)})}return this}}),v.buildFragment=function(e,n,r){var s,o,u,a=e[0];return n=n||i,n=!n.nodeType&&n[0]||n,n=n.ownerDocument||n,e.length===1&&typeof a=="string"&&a.length<512&&n===i&&a.charAt(0)==="<"&&!bt.test(a)&&(v.support.checkClone||!St.test(a))&&(v.support.html5Clone||!wt.test(a))&&(o=!0,s=v.fragments[a],u=s!==t),s||(s=n.createDocumentFragment(),v.clean(e,n,s,r),o&&(v.fragments[a]=u&&s)),{fragment:s,cacheable:o}},v.fragments={},v.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){v.fn[e]=function(n){var r,i=0,s=[],o=v(n),u=o.length,a=this.length===1&&this[0].parentNode;if((a==null||a&&a.nodeType===11&&a.childNodes.length===1)&&u===1){return o[t](this[0]),this}for(;i<u;i++){r=(i>0?this.clone(!0):this).get(),v(o[i])[t](r),s=s.concat(r)}return this.pushStack(s,e,o.selector)}}),v.extend({clone:function(e,t,n){var r,i,s,o;v.support.html5Clone||v.isXMLDoc(e)||!wt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(kt.innerHTML=e.outerHTML,kt.removeChild(o=kt.firstChild));if((!v.support.noCloneEvent||!v.support.noCloneChecked)&&(e.nodeType===1||e.nodeType===11)&&!v.isXMLDoc(e)){Ot(e,o),r=Mt(e),i=Mt(o);for(s=0;r[s];++s){i[s]&&Ot(r[s],i[s])}}if(t){At(e,o);if(n){r=Mt(e),i=Mt(o);for(s=0;r[s];++s){At(r[s],i[s])}}}return r=i=null,o},clean:function(e,t,n,r){var s,o,u,a,f,l,c,h,p,d,m,g,y=t===i&&Ct,b=[];if(!t||typeof t.createDocumentFragment=="undefined"){t=i}for(s=0;(u=e[s])!=null;s++){typeof u=="number"&&(u+="");if(!u){continue}if(typeof u=="string"){if(!gt.test(u)){u=t.createTextNode(u)}else{y=y||lt(t),c=t.createElement("div"),y.appendChild(c),u=u.replace(dt,"<$1></$2>"),a=(vt.exec(u)||["",""])[1].toLowerCase(),f=Nt[a]||Nt._default,l=f[0],c.innerHTML=f[1]+u+f[2];while(l--){c=c.lastChild}if(!v.support.tbody){h=mt.test(u),p=a==="table"&&!h?c.firstChild&&c.firstChild.childNodes:f[1]==="<table>"&&!h?c.childNodes:[];for(o=p.length-1;o>=0;--o){v.nodeName(p[o],"tbody")&&!p[o].childNodes.length&&p[o].parentNode.removeChild(p[o])}}!v.support.leadingWhitespace&&pt.test(u)&&c.insertBefore(t.createTextNode(pt.exec(u)[0]),c.firstChild),u=c.childNodes,c.parentNode.removeChild(c)}}u.nodeType?b.push(u):v.merge(b,u)}c&&(u=c=y=null);if(!v.support.appendChecked){for(s=0;(u=b[s])!=null;s++){v.nodeName(u,"input")?_t(u):typeof u.getElementsByTagName!="undefined"&&v.grep(u.getElementsByTagName("input"),_t)}}if(n){m=function(e){if(!e.type||xt.test(e.type)){return r?r.push(e.parentNode?e.parentNode.removeChild(e):e):n.appendChild(e)}};for(s=0;(u=b[s])!=null;s++){if(!v.nodeName(u,"script")||!m(u)){n.appendChild(u),typeof u.getElementsByTagName!="undefined"&&(g=v.grep(v.merge([],u.getElementsByTagName("script")),m),b.splice.apply(b,[s+1,0].concat(g)),s+=g.length)}}}return b},cleanData:function(e,t){var n,r,i,s,o=0,u=v.expando,a=v.cache,f=v.support.deleteExpando,l=v.event.special;for(;(i=e[o])!=null;o++){if(t||v.acceptData(i)){r=i[u],n=r&&a[r];if(n){if(n.events){for(s in n.events){l[s]?v.event.remove(i,s):v.removeEvent(i,s,n.handle)}}a[r]&&(delete a[r],f?delete i[u]:i.removeAttribute?i.removeAttribute(u):i[u]=null,v.deletedIds.push(r))}}}}}),function(){var e,t;v.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=v.uaMatch(o.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),v.browser=t,v.sub=function(){function e(t,n){return new e.fn.init(t,n)}v.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(r,i){return i&&i instanceof v&&!(i instanceof e)&&(i=e(i)),v.fn.init.call(this,r,i,t)},e.fn.init.prototype=e.fn;var t=e(i);return e}}();var Dt,Pt,Ht,Bt=/alpha\([^)]*\)/i,jt=/opacity=([^)]*)/,Ft=/^(top|right|bottom|left)$/,It=/^(none|table(?!-c[ea]).+)/,qt=/^margin/,Rt=new RegExp("^("+m+")(.*)$","i"),Ut=new RegExp("^("+m+")(?!px)[a-z%]+$","i"),zt=new RegExp("^([-+])=("+m+")","i"),Wt={BODY:"block"},Xt={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:0,fontWeight:400},$t=["Top","Right","Bottom","Left"],Jt=["Webkit","O","Moz","ms"],Kt=v.fn.toggle;v.fn.extend({css:function(e,n){return v.access(this,function(e,n,r){return r!==t?v.style(e,n,r):v.css(e,n)},e,n,arguments.length>1)},show:function(){return Yt(this,!0)},hide:function(){return Yt(this)},toggle:function(e,t){var n=typeof e=="boolean";return v.isFunction(e)&&v.isFunction(t)?Kt.apply(this,arguments):this.each(function(){(n?e:Gt(this))?v(this).show():v(this).hide()})}}),v.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Dt(e,"opacity");return n===""?"1":n}}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":v.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(!e||e.nodeType===3||e.nodeType===8||!e.style){return}var s,o,u,a=v.camelCase(n),f=e.style;n=v.cssProps[a]||(v.cssProps[a]=Qt(f,a)),u=v.cssHooks[n]||v.cssHooks[a];if(r===t){return u&&"get" in u&&(s=u.get(e,!1,i))!==t?s:f[n]}o=typeof r,o==="string"&&(s=zt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(v.css(e,n)),o="number");if(r==null||o==="number"&&isNaN(r)){return}o==="number"&&!v.cssNumber[a]&&(r+="px");if(!u||!("set" in u)||(r=u.set(e,r,i))!==t){try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=v.camelCase(n);return n=v.cssProps[a]||(v.cssProps[a]=Qt(e.style,a)),u=v.cssHooks[n]||v.cssHooks[a],u&&"get" in u&&(s=u.get(e,!0,i)),s===t&&(s=Dt(e,n)),s==="normal"&&n in Vt&&(s=Vt[n]),r||i!==t?(o=parseFloat(s),r||v.isNumeric(o)?o||0:s):s},swap:function(e,t,n){var r,i,s={};for(i in t){s[i]=e.style[i],e.style[i]=t[i]}r=n.call(e);for(i in t){e.style[i]=s[i]}return r}}),e.getComputedStyle?Dt=function(t,n){var r,i,s,o,u=e.getComputedStyle(t,null),a=t.style;return u&&(r=u.getPropertyValue(n)||u[n],r===""&&!v.contains(t.ownerDocument,t)&&(r=v.style(t,n)),Ut.test(r)&&qt.test(n)&&(i=a.width,s=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=r,r=u.width,a.width=i,a.minWidth=s,a.maxWidth=o)),r}:i.documentElement.currentStyle&&(Dt=function(e,t){var n,r,i=e.currentStyle&&e.currentStyle[t],s=e.style;return i==null&&s&&s[t]&&(i=s[t]),Ut.test(i)&&!Ft.test(t)&&(n=s.left,r=e.runtimeStyle&&e.runtimeStyle.left,r&&(e.runtimeStyle.left=e.currentStyle.left),s.left=t==="fontSize"?"1em":i,i=s.pixelLeft+"px",s.left=n,r&&(e.runtimeStyle.left=r)),i===""?"auto":i}),v.each(["height","width"],function(e,t){v.cssHooks[t]={get:function(e,n,r){if(n){return e.offsetWidth===0&&It.test(Dt(e,"display"))?v.swap(e,Xt,function(){return tn(e,t,r)}):tn(e,t,r)}},set:function(e,n,r){return Zt(e,n,r?en(e,t,r,v.support.boxSizing&&v.css(e,"boxSizing")==="border-box"):0)}}}),v.support.opacity||(v.cssHooks.opacity={get:function(e,t){return jt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=v.isNumeric(t)?"alpha(opacity="+t*100+")":"",s=r&&r.filter||n.filter||"";n.zoom=1;if(t>=1&&v.trim(s.replace(Bt,""))===""&&n.removeAttribute){n.removeAttribute("filter");if(r&&!r.filter){return}}n.filter=Bt.test(s)?s.replace(Bt,i):s+" "+i}}),v(function(){v.support.reliableMarginRight||(v.cssHooks.marginRight={get:function(e,t){return v.swap(e,{display:"inline-block"},function(){if(t){return Dt(e,"marginRight")}})}}),!v.support.pixelPosition&&v.fn.position&&v.each(["top","left"],function(e,t){v.cssHooks[t]={get:function(e,n){if(n){var r=Dt(e,t);return Ut.test(r)?v(e).position()[t]+"px":r}}}})}),v.expr&&v.expr.filters&&(v.expr.filters.hidden=function(e){return e.offsetWidth===0&&e.offsetHeight===0||!v.support.reliableHiddenOffsets&&(e.style&&e.style.display||Dt(e,"display"))==="none"},v.expr.filters.visible=function(e){return !v.expr.filters.hidden(e)}),v.each({margin:"",padding:"",border:"Width"},function(e,t){v.cssHooks[e+t]={expand:function(n){var r,i=typeof n=="string"?n.split(" "):[n],s={};for(r=0;r<4;r++){s[e+$t[r]+t]=i[r]||i[r-2]||i[0]}return s}},qt.test(e)||(v.cssHooks[e+t].set=Zt)});var rn=/%20/g,sn=/\[\]$/,on=/\r?\n/g,un=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,an=/^(?:select|textarea)/i;v.fn.extend({serialize:function(){return v.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?v.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||an.test(this.nodeName)||un.test(this.type))}).map(function(e,t){var n=v(this).val();return n==null?null:v.isArray(n)?v.map(n,function(e,n){return{name:t.name,value:e.replace(on,"\r\n")}}):{name:t.name,value:n.replace(on,"\r\n")}}).get()}}),v.param=function(e,n){var r,i=[],s=function(e,t){t=v.isFunction(t)?t():t==null?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};n===t&&(n=v.ajaxSettings&&v.ajaxSettings.traditional);if(v.isArray(e)||e.jquery&&!v.isPlainObject(e)){v.each(e,function(){s(this.name,this.value)})}else{for(r in e){fn(r,e[r],n,s)}}return i.join("&").replace(rn,"+")};var ln,cn,hn=/#.*$/,pn=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,dn=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,vn=/^(?:GET|HEAD)$/,mn=/^\/\//,gn=/\?/,yn=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,bn=/([?&])_=[^&]*/,wn=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,En=v.fn.load,Sn={},xn={},Tn=["*/"]+["*"];try{cn=s.href}catch(Nn){cn=i.createElement("a"),cn.href="",cn=cn.href}ln=wn.exec(cn.toLowerCase())||[],v.fn.load=function(e,n,r){if(typeof e!="string"&&En){return En.apply(this,arguments)}if(!this.length){return this}var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),v.isFunction(n)?(r=n,n=t):n&&typeof n=="object"&&(s="POST"),v.ajax({url:e,type:s,dataType:"html",data:n,complete:function(e,t){r&&u.each(r,o||[e.responseText,t,e])}}).done(function(e){o=arguments,u.html(i?v("<div>").append(e.replace(yn,"")).find(i):e)}),this},v.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(e,t){v.fn[t]=function(e){return this.on(t,e)}}),v.each(["get","post"],function(e,n){v[n]=function(e,r,i,s){return v.isFunction(r)&&(s=s||i,i=r,r=t),v.ajax({type:n,url:e,data:r,success:i,dataType:s})}}),v.extend({getScript:function(e,n){return v.get(e,t,n,"script")},getJSON:function(e,t,n){return v.get(e,t,n,"json")},ajaxSetup:function(e,t){return t?Ln(e,v.ajaxSettings):(t=e,e=v.ajaxSettings),Ln(e,t),e},ajaxSettings:{url:cn,isLocal:dn.test(ln[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":Tn},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":e.String,"text html":!0,"text json":v.parseJSON,"text xml":v.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:Cn(Sn),ajaxTransport:Cn(xn),ajax:function(e,n){function T(e,n,s,a){var l,y,b,w,S,T=n;if(E===2){return}E=2,u&&clearTimeout(u),o=t,i=a||"",x.readyState=e>0?4:0,s&&(w=An(c,x,s));if(e>=200&&e<300||e===304){c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(v.lastModified[r]=S),S=x.getResponseHeader("Etag"),S&&(v.etag[r]=S)),e===304?(T="notmodified",l=!0):(l=On(c,w),T=l.state,y=l.data,b=l.error,l=!b)}else{b=T;if(!T||e){T="error",e<0&&(e=0)}}x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[y,T,x]):d.rejectWith(h,[x,T,b]),x.statusCode(g),g=t,f&&p.trigger("ajax"+(l?"Success":"Error"),[x,c,l?y:b]),m.fireWith(h,[x,T]),f&&(p.trigger("ajaxComplete",[x,c]),--v.active||v.event.trigger("ajaxStop"))}typeof e=="object"&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=v.ajaxSetup({},n),h=c.context||c,p=h!==c&&(h.nodeType||h instanceof v)?v(h):v.event,d=v.Deferred(),m=v.Callbacks("once memory"),g=c.statusCode||{},b={},w={},E=0,S="canceled",x={readyState:0,setRequestHeader:function(e,t){if(!E){var n=e.toLowerCase();e=w[n]=w[n]||e,b[e]=t}return this},getAllResponseHeaders:function(){return E===2?i:null},getResponseHeader:function(e){var n;if(E===2){if(!s){s={};while(n=pn.exec(i)){s[n[1].toLowerCase()]=n[2]}}n=s[e.toLowerCase()]}return n===t?null:n},overrideMimeType:function(e){return E||(c.mimeType=e),this},abort:function(e){return e=e||S,o&&o.abort(e),T(0,e),this}};d.promise(x),x.success=x.done,x.error=x.fail,x.complete=m.add,x.statusCode=function(e){if(e){var t;if(E<2){for(t in e){g[t]=[g[t],e[t]]}}else{t=e[x.status],x.always(t)}}return this},c.url=((e||c.url)+"").replace(hn,"").replace(mn,ln[1]+"//"),c.dataTypes=v.trim(c.dataType||"*").toLowerCase().split(y),c.crossDomain==null&&(a=wn.exec(c.url.toLowerCase()),c.crossDomain=!(!a||a[1]===ln[1]&&a[2]===ln[2]&&(a[3]||(a[1]==="http:"?80:443))==(ln[3]||(ln[1]==="http:"?80:443)))),c.data&&c.processData&&typeof c.data!="string"&&(c.data=v.param(c.data,c.traditional)),kn(Sn,c,n,x);if(E===2){return x}f=c.global,c.type=c.type.toUpperCase(),c.hasContent=!vn.test(c.type),f&&v.active++===0&&v.event.trigger("ajaxStart");if(!c.hasContent){c.data&&(c.url+=(gn.test(c.url)?"&":"?")+c.data,delete c.data),r=c.url;if(c.cache===!1){var N=v.now(),C=c.url.replace(bn,"$1_="+N);c.url=C+(C===c.url?(gn.test(c.url)?"&":"?")+"_="+N:"")}}(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),c.ifModified&&(r=r||c.url,v.lastModified[r]&&x.setRequestHeader("If-Modified-Since",v.lastModified[r]),v.etag[r]&&x.setRequestHeader("If-None-Match",v.etag[r])),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+(c.dataTypes[0]!=="*"?", "+Tn+"; q=0.01":""):c.accepts["*"]);for(l in c.headers){x.setRequestHeader(l,c.headers[l])}if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&E!==2){S="abort";for(l in {success:1,error:1,complete:1}){x[l](c[l])}o=kn(xn,c,n,x);if(!o){T(-1,"No Transport")}else{x.readyState=1,f&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{E=1,o.send(b,T)}catch(k){if(!(E<2)){throw k}T(-1,k)}}return x}return x.abort()},active:0,lastModified:{},etag:{}});var Mn=[],_n=/\?/,Dn=/(=)\?(?=&|$)|\?\?/,Pn=v.now();v.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Mn.pop()||v.expando+"_"+Pn++;return this[e]=!0,e}}),v.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.data,f=n.url,l=n.jsonp!==!1,c=l&&Dn.test(f),h=l&&!c&&typeof a=="string"&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dn.test(a);if(n.dataTypes[0]==="jsonp"||c||h){return s=n.jsonpCallback=v.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,o=e[s],c?n.url=f.replace(Dn,"$1"+s):h?n.data=a.replace(Dn,"$1"+s):l&&(n.url+=(_n.test(f)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||v.error(s+" was not called"),u[0]},n.dataTypes[0]="json",e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,Mn.push(s)),u&&v.isFunction(o)&&o(u[0]),u=o=t}),"script"}}),v.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(e){return v.globalEval(e),e}}}),v.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),v.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=i.head||i.getElementsByTagName("head")[0]||i.documentElement;return{send:function(s,o){n=i.createElement("script"),n.async="async",e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,i){if(i||!n.readyState||/loaded|complete/.test(n.readyState)){n.onload=n.onreadystatechange=null,r&&n.parentNode&&r.removeChild(n),n=t,i||o(200,"success")}},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(0,1)}}}});var Hn,Bn=e.ActiveXObject?function(){for(var e in Hn){Hn[e](0,1)}}:!1,jn=0;v.ajaxSettings.xhr=e.ActiveXObject?function(){return !this.isLocal&&Fn()||In()}:Fn,function(e){v.extend(v.support,{ajax:!!e,cors:!!e&&"withCredentials" in e})}(v.ajaxSettings.xhr()),v.support.ajax&&v.ajaxTransport(function(n){if(!n.crossDomain||v.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async);if(n.xhrFields){for(u in n.xhrFields){a[u]=n.xhrFields[u]}}n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),!n.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i){a.setRequestHeader(u,i[u])}}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c,h;try{if(r&&(i||a.readyState===4)){r=t,o&&(a.onreadystatechange=v.noop,Bn&&delete Hn[o]);if(i){a.readyState!==4&&a.abort()}else{u=a.status,l=a.getAllResponseHeaders(),c={},h=a.responseXML,h&&h.documentElement&&(c.xml=h);try{c.text=a.responseText}catch(p){}try{f=a.statusText}catch(p){f=""}!u&&n.isLocal&&!n.crossDomain?u=c.text?200:404:u===1223&&(u=204)}}}catch(d){i||s(-1,d)}c&&s(u,f,c,l)},n.async?a.readyState===4?setTimeout(r,0):(o=++jn,Bn&&(Hn||(Hn={},v(e).unload(Bn)),Hn[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(0,1)}}}});var qn,Rn,Un=/^(?:toggle|show|hide)$/,zn=new RegExp("^(?:([-+])=|)("+m+")([a-z%]*)$","i"),Wn=/queueHooks$/,Xn=[Gn],Vn={"*":[function(e,t){var n,r,i=this.createTween(e,t),s=zn.exec(t),o=i.cur(),u=+o||0,a=1,f=20;if(s){n=+s[2],r=s[3]||(v.cssNumber[e]?"":"px");if(r!=="px"&&u){u=v.css(i.elem,e,!0)||n||1;do{a=a||".5",u/=a,v.style(i.elem,e,u+r)}while(a!==(a=i.cur()/o)&&a!==1&&--f)}i.unit=r,i.start=u,i.end=s[1]?u+(s[1]+1)*n:n}return i}]};v.Animation=v.extend(Kn,{tweener:function(e,t){v.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;r<i;r++){n=e[r],Vn[n]=Vn[n]||[],Vn[n].unshift(t)}},prefilter:function(e,t){t?Xn.unshift(e):Xn.push(e)}}),v.Tween=Yn,Yn.prototype={constructor:Yn,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(v.cssNumber[n]?"":"px")},cur:function(){var e=Yn.propHooks[this.prop];return e&&e.get?e.get(this):Yn.propHooks._default.get(this)},run:function(e){var t,n=Yn.propHooks[this.prop];return this.options.duration?this.pos=t=v.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Yn.propHooks._default.set(this),this}},Yn.prototype.init.prototype=Yn.prototype,Yn.propHooks={_default:{get:function(e){var t;return e.elem[e.prop]==null||!!e.elem.style&&e.elem.style[e.prop]!=null?(t=v.css(e.elem,e.prop,!1,""),!t||t==="auto"?0:t):e.elem[e.prop]},set:function(e){v.fx.step[e.prop]?v.fx.step[e.prop](e):e.elem.style&&(e.elem.style[v.cssProps[e.prop]]!=null||v.cssHooks[e.prop])?v.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Yn.propHooks.scrollTop=Yn.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},v.each(["toggle","show","hide"],function(e,t){var n=v.fn[t];v.fn[t]=function(r,i,s){return r==null||typeof r=="boolean"||!e&&v.isFunction(r)&&v.isFunction(i)?n.apply(this,arguments):this.animate(Zn(t,!0),r,i,s)}}),v.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Gt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=v.isEmptyObject(e),s=v.speed(t,n,r),o=function(){var t=Kn(this,v.extend({},e),s);i&&t.stop(!0)};return i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return typeof e!="string"&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=e!=null&&e+"queueHooks",s=v.timers,o=v._data(this);if(n){o[n]&&o[n].stop&&i(o[n])}else{for(n in o){o[n]&&o[n].stop&&Wn.test(n)&&i(o[n])}}for(n=s.length;n--;){s[n].elem===this&&(e==null||s[n].queue===e)&&(s[n].anim.stop(r),t=!1,s.splice(n,1))}(t||!r)&&v.dequeue(this,e)})}}),v.each({slideDown:Zn("show"),slideUp:Zn("hide"),slideToggle:Zn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){v.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),v.speed=function(e,t,n){var r=e&&typeof e=="object"?v.extend({},e):{complete:n||!n&&t||v.isFunction(e)&&e,duration:e,easing:n&&t||t&&!v.isFunction(t)&&t};r.duration=v.fx.off?0:typeof r.duration=="number"?r.duration:r.duration in v.fx.speeds?v.fx.speeds[r.duration]:v.fx.speeds._default;if(r.queue==null||r.queue===!0){r.queue="fx"}return r.old=r.complete,r.complete=function(){v.isFunction(r.old)&&r.old.call(this),r.queue&&v.dequeue(this,r.queue)},r},v.easing={linear:function(e){return e},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2}},v.timers=[],v.fx=Yn.prototype.init,v.fx.tick=function(){var e,n=v.timers,r=0;qn=v.now();for(;r<n.length;r++){e=n[r],!e()&&n[r]===e&&n.splice(r--,1)}n.length||v.fx.stop(),qn=t},v.fx.timer=function(e){e()&&v.timers.push(e)&&!Rn&&(Rn=setInterval(v.fx.tick,v.fx.interval))},v.fx.interval=13,v.fx.stop=function(){clearInterval(Rn),Rn=null},v.fx.speeds={slow:600,fast:200,_default:400},v.fx.step={},v.expr&&v.expr.filters&&(v.expr.filters.animated=function(e){return v.grep(v.timers,function(t){return e===t.elem}).length});var er=/^(?:body|html)$/i;v.fn.offset=function(e){if(arguments.length){return e===t?this:this.each(function(t){v.offset.setOffset(this,e,t)})}var n,r,i,s,o,u,a,f={top:0,left:0},l=this[0],c=l&&l.ownerDocument;if(!c){return}return(r=c.body)===l?v.offset.bodyOffset(l):(n=c.documentElement,v.contains(n,l)?(typeof l.getBoundingClientRect!="undefined"&&(f=l.getBoundingClientRect()),i=tr(c),s=n.clientTop||r.clientTop||0,o=n.clientLeft||r.clientLeft||0,u=i.pageYOffset||n.scrollTop,a=i.pageXOffset||n.scrollLeft,{top:f.top+u-s,left:f.left+a-o}):f)},v.offset={bodyOffset:function(e){var t=e.offsetTop,n=e.offsetLeft;return v.support.doesNotIncludeMarginInBodyOffset&&(t+=parseFloat(v.css(e,"marginTop"))||0,n+=parseFloat(v.css(e,"marginLeft"))||0),{top:t,left:n}},setOffset:function(e,t,n){var r=v.css(e,"position");r==="static"&&(e.style.position="relative");var i=v(e),s=i.offset(),o=v.css(e,"top"),u=v.css(e,"left"),a=(r==="absolute"||r==="fixed")&&v.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),v.isFunction(t)&&(t=t.call(e,n,s)),t.top!=null&&(f.top=t.top-s.top+c),t.left!=null&&(f.left=t.left-s.left+h),"using" in t?t.using.call(e,f):i.css(f)}},v.fn.extend({position:function(){if(!this[0]){return}var e=this[0],t=this.offsetParent(),n=this.offset(),r=er.test(t[0].nodeName)?{top:0,left:0}:t.offset();return n.top-=parseFloat(v.css(e,"marginTop"))||0,n.left-=parseFloat(v.css(e,"marginLeft"))||0,r.top+=parseFloat(v.css(t[0],"borderTopWidth"))||0,r.left+=parseFloat(v.css(t[0],"borderLeftWidth"))||0,{top:n.top-r.top,left:n.left-r.left}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||i.body;while(e&&!er.test(e.nodeName)&&v.css(e,"position")==="static"){e=e.offsetParent}return e||i.body})}}),v.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);v.fn[e]=function(i){return v.access(this,function(e,i,s){var o=tr(e);if(s===t){return o?n in o?o[n]:o.document.documentElement[i]:e[i]}o?o.scrollTo(r?v(o).scrollLeft():s,r?s:v(o).scrollTop()):e[i]=s},e,i,arguments.length,null)}}),v.each({Height:"height",Width:"width"},function(e,n){v.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){v.fn[i]=function(i,s){var o=arguments.length&&(r||typeof i!="boolean"),u=r||(i===!0||s===!0?"margin":"border");return v.access(this,function(n,r,i){var s;return v.isWindow(n)?n.document.documentElement["client"+e]:n.nodeType===9?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?v.css(n,r,i,u):v.style(n,r,i,u)},n,o?i:t,o,null)}})}),e.jQuery=e.$=v,typeof define=="function"&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return v})})(window);
/*! jQuery UI - v1.9.2 - 2013-06-24
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.menu.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js, jquery.ui.effect.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js
* Copyright 2013 jQuery Foundation and other contributors Licensed MIT */
(function(h,c){function a(q,y){var v,m,x,e=q.nodeName.toLowerCase();return"area"===e?(v=q.parentNode,m=v.name,!q.href||!m||v.nodeName.toLowerCase()!=="map"?!1:(x=h("img[usemap=#"+m+"]")[0],!!x&&f(x))):(/input|select|textarea|button|object/.test(e)?!q.disabled:"a"===e?q.href||y:y)&&f(q)}function f(e){return h.expr.filters.visible(e)&&!h(e).parents().andSelf().filter(function(){return h.css(this,"visibility")==="hidden"}).length}var k=0,g=/^ui-id-\d+$/;h.ui=h.ui||{};if(h.ui.version){return}h.extend(h.ui,{version:"1.9.2",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),h.fn.extend({_focus:h.fn.focus,focus:function(e,m){return typeof e=="number"?this.each(function(){var n=this;setTimeout(function(){h(n).focus(),m&&m.call(n)},e)}):this._focus.apply(this,arguments)},scrollParent:function(){var e;return h.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?e=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(h.css(this,"position"))&&/(auto|scroll)/.test(h.css(this,"overflow")+h.css(this,"overflow-y")+h.css(this,"overflow-x"))}).eq(0):e=this.parents().filter(function(){return/(auto|scroll)/.test(h.css(this,"overflow")+h.css(this,"overflow-y")+h.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?h(document):e},zIndex:function(q){if(q!==c){return this.css("zIndex",q)}if(this.length){var o=h(this[0]),e,m;while(o.length&&o[0]!==document){e=o.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){m=parseInt(o.css("zIndex"),10);if(!isNaN(m)&&m!==0){return m}}o=o.parent()}}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++k)})},removeUniqueId:function(){return this.each(function(){g.test(this.id)&&h(this).removeAttr("id")})}}),h.extend(h.expr[":"],{data:h.expr.createPseudo?h.expr.createPseudo(function(e){return function(m){return !!h.data(m,e)}}):function(e,o,m){return !!h.data(e,m[3])},focusable:function(e){return a(e,!isNaN(h.attr(e,"tabindex")))},tabbable:function(e){var o=h.attr(e,"tabindex"),m=isNaN(o);return(m||o>=0)&&a(e,!m)}}),h(function(){var e=document.body,m=e.appendChild(m=document.createElement("div"));m.offsetHeight,h.extend(m.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),h.support.minHeight=m.offsetHeight===100,h.support.selectstart="onselectstart" in m,e.removeChild(m).style.display="none"}),h("<a>").outerWidth(1).jquery||h.each(["Width","Height"],function(x,t){function e(o,z,y,u){return h.each(m,function(){z-=parseFloat(h.css(o,"padding"+this))||0,y&&(z-=parseFloat(h.css(o,"border"+this+"Width"))||0),u&&(z-=parseFloat(h.css(o,"margin"+this))||0)}),z}var m=t==="Width"?["Left","Right"]:["Top","Bottom"],q=t.toLowerCase(),v={innerWidth:h.fn.innerWidth,innerHeight:h.fn.innerHeight,outerWidth:h.fn.outerWidth,outerHeight:h.fn.outerHeight};h.fn["inner"+t]=function(o){return o===c?v["inner"+t].call(this):this.each(function(){h(this).css(q,e(this,o)+"px")})},h.fn["outer"+t]=function(o,r){return typeof o!="number"?v["outer"+t].call(this,o):this.each(function(){h(this).css(q,e(this,o,!0,r)+"px")})}}),h("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(h.fn.removeData=function(e){return function(m){return arguments.length?e.call(this,h.camelCase(m)):e.call(this)}}(h.fn.removeData)),function(){var e=/msie ([\w.]+)/.exec(navigator.userAgent.toLowerCase())||[];h.ui.ie=e.length?!0:!1,h.ui.ie6=parseFloat(e[1],10)===6}(),h.fn.extend({disableSelection:function(){return this.bind((h.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(m){m.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),h.extend(h.ui,{plugin:{add:function(m,u,q){var e,o=h.ui[m].prototype;for(e in q){o.plugins[e]=o.plugins[e]||[],o.plugins[e].push([u,q[e]])}},call:function(u,o,v){var q,m=u.plugins[o];if(!m||!u.element[0].parentNode||u.element[0].parentNode.nodeType===11){return}for(q=0;q<m.length;q++){u.options[m[q][0]]&&m[q][1].apply(u.element,v)}}},contains:h.contains,hasScroll:function(m,q){if(h(m).css("overflow")==="hidden"){return !1}var o=q&&q==="left"?"scrollLeft":"scrollTop",e=!1;return m[o]>0?!0:(m[o]=1,e=m[o]>0,m[o]=0,e)},isOverAxis:function(o,m,q){return o>m&&o<m+q},isOver:function(m,x,u,e,q,v){return h.ui.isOverAxis(m,u,q)&&h.ui.isOverAxis(x,e,v)}})})(jQuery);(function(g,c){var h=0,f=Array.prototype.slice,a=g.cleanData;g.cleanData=function(e){for(var o=0,m;(m=e[o])!=null;o++){try{g(m).triggerHandler("remove")}catch(k){}}a(e)},g.widget=function(q,z,x){var m,v,y,k,e=q.split(".")[0];q=q.split(".")[1],m=e+"-"+q,x||(x=z,z=g.Widget),g.expr[":"][m.toLowerCase()]=function(n){return !!g.data(n,m)},g[e]=g[e]||{},v=g[e][q],y=g[e][q]=function(o,n){if(!this._createWidget){return new y(o,n)}arguments.length&&this._createWidget(o,n)},g.extend(y,v,{version:x.version,_proto:g.extend({},x),_childConstructors:[]}),k=new z,k.options=g.widget.extend({},k.options),g.each(x,function(o,n){g.isFunction(n)&&(x[o]=function(){var u=function(){return z.prototype[o].apply(this,arguments)},t=function(r){return z.prototype[o].apply(this,r)};return function(){var r=this._super,B=this._superApply,A;return this._super=u,this._superApply=t,A=n.apply(this,arguments),this._super=r,this._superApply=B,A}}())}),y.prototype=g.widget.extend(k,{widgetEventPrefix:v?k.widgetEventPrefix:q},x,{constructor:y,namespace:e,widgetName:q,widgetBaseClass:m,widgetFullName:m}),v?(g.each(v._childConstructors,function(o,A){var u=A.prototype;g.widget(u.namespace+"."+u.widgetName,y,A._proto)}),delete v._childConstructors):z._childConstructors.push(y),g.widget.bridge(q,y)},g.widget.extend=function(t){var m=f.call(arguments,1),q=0,r=m.length,k,e;for(;q<r;q++){for(k in m[q]){e=m[q][k],m[q].hasOwnProperty(k)&&e!==c&&(g.isPlainObject(e)?t[k]=g.isPlainObject(t[k])?g.widget.extend({},t[k],e):g.widget.extend({},e):t[k]=e)}}return t},g.widget.bridge=function(m,e){var k=e.prototype.widgetFullName||m;g.fn[m]=function(t){var q=typeof t=="string",n=f.call(arguments,1),r=this;return t=!q&&n.length?g.widget.extend.apply(null,[t].concat(n)):t,q?this.each(function(){var u,o=g.data(this,k);if(!o){return g.error("cannot call methods on "+m+" prior to initialization; attempted to call method '"+t+"'")}if(!g.isFunction(o[t])||t.charAt(0)==="_"){return g.error("no such method '"+t+"' for "+m+" widget instance")}u=o[t].apply(o,n);if(u!==o&&u!==c){return r=u&&u.jquery?r.pushStack(u.get()):u,!1}}):this.each(function(){var o=g.data(this,k);o?o.option(t||{})._init():g.data(this,k,new e(t,this))}),r}},g.Widget=function(){},g.Widget._childConstructors=[],g.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,k){k=g(k||this.defaultElement||this)[0],this.element=g(k),this.uuid=h++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=g.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=g(),this.hoverable=g(),this.focusable=g(),k!==this&&(g.data(k,this.widgetName,this),g.data(k,this.widgetFullName,this),this._on(!0,this.element,{remove:function(m){m.target===k&&this.destroy()}}),this.document=g(k.style?k.ownerDocument:k.document||k),this.window=g(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:g.noop,_getCreateEventData:g.noop,_create:g.noop,_init:g.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(g.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:g.noop,widget:function(){return this.element},option:function(v,q){var k=v,m,t,e;if(arguments.length===0){return g.widget.extend({},this.options)}if(typeof v=="string"){k={},m=v.split("."),v=m.shift();if(m.length){t=k[v]=g.widget.extend({},this.options[v]);for(e=0;e<m.length-1;e++){t[m[e]]=t[m[e]]||{},t=t[m[e]]}v=m.pop();if(q===c){return t[v]===c?null:t[v]}t[v]=q}else{if(q===c){return this.options[v]===c?null:this.options[v]}k[v]=q}}return this._setOptions(k),this},_setOptions:function(m){var k;for(k in m){this._setOption(k,m[k])}return this},_setOption:function(m,k){return this.options[m]=k,m==="disabled"&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!k).attr("aria-disabled",k),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(k,q,o){var e,m=this;typeof k!="boolean"&&(o=q,q=k,k=!1),o?(q=e=g(q),this.bindings=this.bindings.add(q)):(o=q,q=this.element,e=this.widget()),g.each(o,function(x,z){function v(){if(!k&&(m.options.disabled===!0||g(this).hasClass("ui-state-disabled"))){return}return(typeof z=="string"?m[z]:z).apply(m,arguments)}typeof z!="string"&&(v.guid=z.guid=z.guid||v.guid||g.guid++);var t=x.match(/^(\w+)\s*(.*)$/),y=t[1]+m.eventNamespace,n=t[2];n?e.delegate(n,y,v):q.bind(y,v)})},_off:function(m,k){k=(k||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,m.unbind(k).undelegate(k)},_delay:function(o,k){function q(){return(typeof o=="string"?m[o]:o).apply(m,arguments)}var m=this;return setTimeout(q,k||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(k){g(k.currentTarget).addClass("ui-state-hover")},mouseleave:function(k){g(k.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(k){g(k.currentTarget).addClass("ui-state-focus")},focusout:function(k){g(k.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(k,v,q){var e,m,u=this.options[k];q=q||{},v=g.Event(v),v.type=(k===this.widgetEventPrefix?k:this.widgetEventPrefix+k).toLowerCase(),v.target=this.element[0],m=v.originalEvent;if(m){for(e in m){e in v||(v[e]=m[e])}}return this.element.trigger(v,q),!(g.isFunction(u)&&u.apply(this.element[0],[v].concat(q))===!1||v.isDefaultPrevented())}},g.each({show:"fadeIn",hide:"fadeOut"},function(e,k){g.Widget.prototype["_"+e]=function(t,n,q){typeof n=="string"&&(n={effect:n});var v,m=n?n===!0||typeof n=="number"?k:n.effect||k:e;n=n||{},typeof n=="number"&&(n={duration:n}),v=!g.isEmptyObject(n),n.complete=q,n.delay&&t.delay(n.delay),v&&g.effects&&(g.effects.effect[m]||g.uiBackCompat!==!1&&g.effects[m])?t[e](n):m!==e&&t[m]?t[m](n.duration,n.easing,q):t.queue(function(o){g(this)[e](),q&&q.call(t[0]),o()})}}),g.uiBackCompat!==!1&&(g.Widget.prototype._getCreateOptions=function(){return g.metadata&&g.metadata.get(this.element[0])[this.widgetName]})})(jQuery);(function(c,a){var f=!1;c(document).mouseup(function(g){f=!1}),c.widget("ui.mouse",{version:"1.9.2",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(g){return e._mouseDown(g)}).bind("click."+this.widgetName,function(g){if(!0===c.data(g.target,e.widgetName+".preventClickEvent")){return c.removeData(g.target,e.widgetName+".preventClickEvent"),g.stopImmediatePropagation(),!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(g){if(f){return}this._mouseStarted&&this._mouseUp(g),this._mouseDownEvent=g;var k=this,e=g.which===1,h=typeof this.options.cancel=="string"&&g.target.nodeName?c(g.target).closest(this.options.cancel).length:!1;if(!e||h||!this._mouseCapture(g)){return !0}this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){k.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(g)&&this._mouseDelayMet(g)){this._mouseStarted=this._mouseStart(g)!==!1;if(!this._mouseStarted){return g.preventDefault(),!0}}return !0===c.data(g.target,this.widgetName+".preventClickEvent")&&c.removeData(g.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(m){return k._mouseMove(m)},this._mouseUpDelegate=function(m){return k._mouseUp(m)},c(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),g.preventDefault(),f=!0,!0},_mouseMove:function(e){return !c.ui.ie||document.documentMode>=9||!!e.button?this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted):this._mouseUp(e)},_mouseUp:function(e){return c(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&c.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(g){return Math.max(Math.abs(this._mouseDownEvent.pageX-g.pageX),Math.abs(this._mouseDownEvent.pageY-g.pageY))>=this.options.distance},_mouseDelayMet:function(g){return this.mouseDelayMet},_mouseStart:function(g){},_mouseDrag:function(g){},_mouseStop:function(g){},_mouseCapture:function(g){return !0}})})(jQuery);(function(A,E){function y(c,a,f){return[parseInt(c[0],10)*(v.test(c[0])?a/100:1),parseInt(c[1],10)*(v.test(c[1])?f/100:1)]}function k(a,c){return parseInt(A.css(a,c),10)||0}A.ui=A.ui||{};var q,g=Math.max,x=Math.abs,F=Math.round,m=/left|center|right/,D=/top|center|bottom/,C=/[\+\-]\d+%?/,z=/^\w+/,v=/%$/,B=A.fn.position;A.position={scrollbarWidth:function(){if(q!==E){return q}var e,a,c=A("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),f=c.children()[0];return A("body").append(c),e=f.offsetWidth,c.css("overflow","scroll"),a=f.offsetWidth,e===a&&(a=c[0].clientWidth),c.remove(),q=e-a},getScrollInfo:function(c){var h=c.isWindow?"":c.element.css("overflow-x"),f=c.isWindow?"":c.element.css("overflow-y"),a=h==="scroll"||h==="auto"&&c.width<c.element[0].scrollWidth,e=f==="scroll"||f==="auto"&&c.height<c.element[0].scrollHeight;return{width:a?A.position.scrollbarWidth():0,height:e?A.position.scrollbarWidth():0}},getWithinInfo:function(a){var e=A(a||window),c=A.isWindow(e[0]);return{element:e,isWindow:c,offset:e.offset()||{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:c?e.width():e.outerWidth(),height:c?e.height():e.outerHeight()}}},A.fn.position=function(I){if(!I||!I.of){return B.apply(this,arguments)}I=A.extend({},I);var a,e,o,H,c,h=A(I.of),u=A.position.getWithinInfo(I.within),r=A.position.getScrollInfo(u),G=h[0],J=(I.collision||"flip").split(" "),f={};return G.nodeType===9?(e=h.width(),o=h.height(),H={top:0,left:0}):A.isWindow(G)?(e=h.width(),o=h.height(),H={top:h.scrollTop(),left:h.scrollLeft()}):G.preventDefault?(I.at="left top",e=o=0,H={top:G.pageY,left:G.pageX}):(e=h.outerWidth(),o=h.outerHeight(),H=h.offset()),c=A.extend({},H),A.each(["my","at"],function(){var K=(I[this]||"").split(" "),M,t;K.length===1&&(K=m.test(K[0])?K.concat(["center"]):D.test(K[0])?["center"].concat(K):["center","center"]),K[0]=m.test(K[0])?K[0]:"center",K[1]=D.test(K[1])?K[1]:"center",M=C.exec(K[0]),t=C.exec(K[1]),f[this]=[M?M[0]:0,t?t[0]:0],I[this]=[z.exec(K[0])[0],z.exec(K[1])[0]]}),J.length===1&&(J[1]=J[0]),I.at[0]==="right"?c.left+=e:I.at[0]==="center"&&(c.left+=e/2),I.at[1]==="bottom"?c.top+=o:I.at[1]==="center"&&(c.top+=o/2),a=y(f.at,e,o),c.left+=a[0],c.top+=a[1],this.each(function(){var t,V,R=A(this),O=R.outerWidth(),Q=R.outerHeight(),U=k(this,"marginLeft"),S=k(this,"marginTop"),M=O+U+k(this,"marginRight")+r.width,P=Q+S+k(this,"marginBottom")+r.height,n=A.extend({},c),K=y(f.my,R.outerWidth(),R.outerHeight());I.my[0]==="right"?n.left-=O:I.my[0]==="center"&&(n.left-=O/2),I.my[1]==="bottom"?n.top-=Q:I.my[1]==="center"&&(n.top-=Q/2),n.left+=K[0],n.top+=K[1],A.support.offsetFractions||(n.left=F(n.left),n.top=F(n.top)),t={marginLeft:U,marginTop:S},A.each(["left","top"],function(T,N){A.ui.position[J[T]]&&A.ui.position[J[T]][N](n,{targetWidth:e,targetHeight:o,elemWidth:O,elemHeight:Q,collisionPosition:t,collisionWidth:M,collisionHeight:P,offset:[a[0]+K[0],a[1]+K[1]],my:I.my,at:I.at,within:u,elem:R})}),A.fn.bgiframe&&R.bgiframe(),I.using&&(V=function(X){var Z=H.left-n.left,W=Z+e-O,Y=H.top-n.top,N=Y+o-Q,T={target:{element:h,left:H.left,top:H.top,width:e,height:o},element:{element:R,left:n.left,top:n.top,width:O,height:Q},horizontal:W<0?"left":Z>0?"right":"center",vertical:N<0?"top":Y>0?"bottom":"middle"};e<O&&x(Z+W)<e&&(T.horizontal="center"),o<Q&&x(Y+N)<o&&(T.vertical="middle"),g(x(Z),x(W))>g(x(Y),x(N))?T.important="horizontal":T.important="vertical",I.using.call(this,X,T)}),R.offset(A.extend(n,{using:V}))})},A.ui.position={fit:{left:function(H,K){var h=K.within,r=h.isWindow?h.scrollLeft:h.offset.left,M=h.width,c=H.left-K.collisionPosition.marginLeft,J=r-c,I=c+K.collisionWidth-M-r,G;K.collisionWidth>M?J>0&&I<=0?(G=H.left+J+K.collisionWidth-M-r,H.left+=J-G):I>0&&J<=0?H.left=r:J>I?H.left=r+M-K.collisionWidth:H.left=r:J>0?H.left+=J:I>0?H.left-=I:H.left=g(H.left-c,H.left)},top:function(H,K){var h=K.within,r=h.isWindow?h.scrollTop:h.offset.top,M=K.within.height,c=H.top-K.collisionPosition.marginTop,J=r-c,I=c+K.collisionHeight-M-r,G;K.collisionHeight>M?J>0&&I<=0?(G=H.top+J+K.collisionHeight-M-r,H.top+=J-G):I>0&&J<=0?H.top=r:J>I?H.top=r+M-K.collisionHeight:H.top=r:J>0?H.top+=J:I>0?H.top-=I:H.top=g(H.top-c,H.top)}},flip:{left:function(O,T){var J=T.within,G=J.offset.left+J.scrollLeft,U=J.width,I=J.isWindow?J.scrollLeft:J.offset.left,S=O.left-T.collisionPosition.marginLeft,R=S-I,N=S+T.collisionWidth-U-I,K=T.my[0]==="left"?-T.elemWidth:T.my[0]==="right"?T.elemWidth:0,Q=T.at[0]==="left"?T.targetWidth:T.at[0]==="right"?-T.targetWidth:0,M=-2*T.offset[0],H,P;if(R<0){H=O.left+K+Q+M+T.collisionWidth-U-G;if(H<0||H<x(R)){O.left+=K+Q+M}}else{if(N>0){P=O.left-T.collisionPosition.marginLeft+K+Q+M-I;if(P>0||x(P)<N){O.left+=K+Q+M}}}},top:function(O,U){var J=U.within,G=J.offset.top+J.scrollTop,V=J.height,I=J.isWindow?J.scrollTop:J.offset.top,T=O.top-U.collisionPosition.marginTop,R=T-I,N=T+U.collisionHeight-V-I,K=U.my[1]==="top",Q=K?-U.elemHeight:U.my[1]==="bottom"?U.elemHeight:0,M=U.at[1]==="top"?U.targetHeight:U.at[1]==="bottom"?-U.targetHeight:0,H=-2*U.offset[1],P,S;R<0?(S=O.top+Q+M+H+U.collisionHeight-V-G,O.top+Q+M+H>R&&(S<0||S<x(R))&&(O.top+=Q+M+H)):N>0&&(P=O.top-U.collisionPosition.marginTop+Q+M+H-I,O.top+Q+M+H>N&&(P>0||x(P)<N)&&(O.top+=Q+M+H))}},flipfit:{left:function(){A.ui.position.flip.left.apply(this,arguments),A.ui.position.fit.left.apply(this,arguments)},top:function(){A.ui.position.flip.top.apply(this,arguments),A.ui.position.fit.top.apply(this,arguments)}}},function(){var e,H,h,c,f,G=document.getElementsByTagName("body")[0],a=document.createElement("div");e=document.createElement(G?"div":"body"),h={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},G&&A.extend(h,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in h){e.style[f]=h[f]}e.appendChild(a),H=G||document.documentElement,H.insertBefore(e,H.firstChild),a.style.cssText="position: absolute; left: 10.7432222px;",c=A(a).offset().left,A.support.offsetFractions=c>10&&c<11,e.innerHTML="",H.removeChild(e)}(),A.uiBackCompat!==!1&&function(a){var c=a.fn.position;a.fn.position=function(h){if(!h||!h.offset){return c.call(this,h)}var e=h.offset.split(" "),f=h.at.split(" ");return e.length===1&&(e[1]=e[0]),/^\d/.test(e[0])&&(e[0]="+"+e[0]),/^\d/.test(e[1])&&(e[1]="+"+e[1]),f.length===1&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center")),c.call(this,a.extend(h,{at:f[0]+e[0]+" "+f[1]+e[1],offset:E}))}}(jQuery)})(jQuery);(function(c,a){c.widget("ui.draggable",c.ui.mouse,{version:"1.9.2",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var f=this.options;return this.helper||f.disabled||c(e.target).is(".ui-resizable-handle")?!1:(this.handle=this._getHandle(e),this.handle?(c(f.iframeFix===!0?"iframe":f.iframeFix).each(function(){c('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(c(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var f=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),c.ui.ddmanager&&(c.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},c.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,f.cursorAt&&this._adjustOffsetFromHelper(f.cursorAt),f.containment&&this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),c.ui.ddmanager&&!f.dropBehaviour&&c.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),c.ui.ddmanager&&c.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,g){this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute");if(!g){var f=this._uiHash();if(this._trigger("drag",e,f)===!1){return this._mouseUp({}),!1}this.position=f.position}if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}return c.ui.ddmanager&&c.ui.ddmanager.drag(this,e),!1},_mouseStop:function(f){var k=!1;c.ui.ddmanager&&!this.options.dropBehaviour&&(k=c.ui.ddmanager.drop(this,f)),this.dropped&&(k=this.dropped,this.dropped=!1);var h=this.element[0],e=!1;while(h&&(h=h.parentNode)){h==document&&(e=!0)}if(!e&&this.options.helper==="original"){return !1}if(this.options.revert=="invalid"&&!k||this.options.revert=="valid"&&k||this.options.revert===!0||c.isFunction(this.options.revert)&&this.options.revert.call(this.element,k)){var g=this;c(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){g._trigger("stop",f)!==!1&&g._clear()})}else{this._trigger("stop",f)!==!1&&this._clear()}return !1},_mouseUp:function(e){return c("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),c.ui.ddmanager&&c.ui.ddmanager.dragStop(this,e),c.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){var f=!this.options.handle||!c(this.options.handle,this.element).length?!0:!1;return c(this.options.handle,this.element).find("*").andSelf().each(function(){this==e.target&&(f=!0)}),f},_createHelper:function(e){var g=this.options,f=c.isFunction(g.helper)?c(g.helper.apply(this.element[0],[e])):g.helper=="clone"?this.element.clone().removeAttr("id"):this.element;return f.parents("body").length||f.appendTo(g.appendTo=="parent"?this.element[0].parentNode:g.appendTo),f[0]!=this.element[0]&&!/(fixed|absolute)/.test(f.css("position"))&&f.css("position","absolute"),f},_adjustOffsetFromHelper:function(e){typeof e=="string"&&(e=e.split(" ")),c.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left" in e&&(this.offset.click.left=e.left+this.margins.left),"right" in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top" in e&&(this.offset.click.top=e.top+this.margins.top),"bottom" in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&c.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&c.ui.ie){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var f=this.element.position();return{top:f.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:f.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;f.containment=="parent"&&(f.containment=this.helper[0].parentNode);if(f.containment=="document"||f.containment=="window"){this.containment=[f.containment=="document"?0:c(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,f.containment=="document"?0:c(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(f.containment=="document"?0:c(window).scrollLeft())+c(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(f.containment=="document"?0:c(window).scrollTop())+(c(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(f.containment)&&f.containment.constructor!=Array){var k=c(f.containment),h=k[0];if(!h){return}var e=k.offset(),g=c(h).css("overflow")!="hidden";this.containment=[(parseInt(c(h).css("borderLeftWidth"),10)||0)+(parseInt(c(h).css("paddingLeft"),10)||0),(parseInt(c(h).css("borderTopWidth"),10)||0)+(parseInt(c(h).css("paddingTop"),10)||0),(g?Math.max(h.scrollWidth,h.offsetWidth):h.offsetWidth)-(parseInt(c(h).css("borderLeftWidth"),10)||0)-(parseInt(c(h).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(g?Math.max(h.scrollHeight,h.offsetHeight):h.offsetHeight)-(parseInt(c(h).css("borderTopWidth"),10)||0)-(parseInt(c(h).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=k}else{f.containment.constructor==Array&&(this.containment=f.containment)}},_convertPositionTo:function(f,m){m||(m=this.position);var h=f=="absolute"?1:-1,e=this.options,g=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!c.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,k=/(html|body)/i.test(g[0].tagName);return{top:m.top+this.offset.relative.top*h+this.offset.parent.top*h-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():k?0:g.scrollTop())*h,left:m.left+this.offset.relative.left*h+this.offset.parent.left*h-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:g.scrollLeft())*h}},_generatePosition:function(y){var h=this.options,e=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!c.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,m=/(html|body)/i.test(e[0].tagName),z=y.pageX,g=y.pageY;if(this.originalPosition){var x;if(this.containment){if(this.relative_container){var v=this.relative_container.offset();x=[this.containment[0]+v.left,this.containment[1]+v.top,this.containment[2]+v.left,this.containment[3]+v.top]}else{x=this.containment}y.pageX-this.offset.click.left<x[0]&&(z=x[0]+this.offset.click.left),y.pageY-this.offset.click.top<x[1]&&(g=x[1]+this.offset.click.top),y.pageX-this.offset.click.left>x[2]&&(z=x[2]+this.offset.click.left),y.pageY-this.offset.click.top>x[3]&&(g=x[3]+this.offset.click.top)}if(h.grid){var q=h.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/h.grid[1])*h.grid[1]:this.originalPageY;g=x?q-this.offset.click.top<x[1]||q-this.offset.click.top>x[3]?q-this.offset.click.top<x[1]?q+h.grid[1]:q-h.grid[1]:q:q;var k=h.grid[0]?this.originalPageX+Math.round((z-this.originalPageX)/h.grid[0])*h.grid[0]:this.originalPageX;z=x?k-this.offset.click.left<x[0]||k-this.offset.click.left>x[2]?k-this.offset.click.left<x[0]?k+h.grid[0]:k-h.grid[0]:k:k}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():m?0:e.scrollTop()),left:z-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():m?0:e.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,g,f){return f=f||this._uiHash(),c.ui.plugin.call(this,e,[g,f]),e=="drag"&&(this.positionAbs=this._convertPositionTo("absolute")),c.Widget.prototype._trigger.call(this,e,g,f)},plugins:{},_uiHash:function(f){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),c.ui.plugin.add("draggable","connectToSortable",{start:function(f,k){var h=c(this).data("draggable"),e=h.options,g=c.extend({},k,{item:h.element});h.sortables=[],c(e.connectToSortable).each(function(){var m=c.data(this,"sortable");m&&!m.options.disabled&&(h.sortables.push({instance:m,shouldRevert:m.options.revert}),m.refreshPositions(),m._trigger("activate",f,g))})},stop:function(f,h){var g=c(this).data("draggable"),e=c.extend({},h,{item:g.element});c.each(g.sortables,function(){this.instance.isOver?(this.instance.isOver=0,g.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(f),this.instance.options.helper=this.instance.options._helper,g.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",f,e))})},drag:function(f,k){var h=c(this).data("draggable"),e=this,g=function(B){var v=this.offset.click.top,m=this.offset.click.left,x=this.positionAbs.top,C=this.positionAbs.left,q=B.height,A=B.width,z=B.top,y=B.left;return c.ui.isOver(x+v,C+m,z,y,q,A)};c.each(h.sortables,function(n){var q=!1,m=this;this.instance.positionAbs=h.positionAbs,this.instance.helperProportions=h.helperProportions,this.instance.offset.click=h.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(q=!0,c.each(h.sortables,function(){return this.instance.positionAbs=h.positionAbs,this.instance.helperProportions=h.helperProportions,this.instance.offset.click=h.offset.click,this!=m&&this.instance._intersectsWith(this.instance.containerCache)&&c.ui.contains(m.instance.element[0],this.instance.element[0])&&(q=!1),q})),q?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=c(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return k.helper[0]},f.target=this.instance.currentItem[0],this.instance._mouseCapture(f,!0),this.instance._mouseStart(f,!0,!0),this.instance.offset.click.top=h.offset.click.top,this.instance.offset.click.left=h.offset.click.left,this.instance.offset.parent.left-=h.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=h.offset.parent.top-this.instance.offset.parent.top,h._trigger("toSortable",f),h.dropped=this.instance.element,h.currentItem=h.element,this.instance.fromOutside=h),this.instance.currentItem&&this.instance._mouseDrag(f)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",f,this.instance._uiHash(this.instance)),this.instance._mouseStop(f,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),h._trigger("fromSortable",f),h.dropped=!1)})}}),c.ui.plugin.add("draggable","cursor",{start:function(f,h){var g=c("body"),e=c(this).data("draggable").options;g.css("cursor")&&(e._cursor=g.css("cursor")),g.css("cursor",e.cursor)},stop:function(e,g){var f=c(this).data("draggable").options;f._cursor&&c("body").css("cursor",f._cursor)}}),c.ui.plugin.add("draggable","opacity",{start:function(f,h){var g=c(h.helper),e=c(this).data("draggable").options;g.css("opacity")&&(e._opacity=g.css("opacity")),g.css("opacity",e.opacity)},stop:function(e,g){var f=c(this).data("draggable").options;f._opacity&&c(g.helper).css("opacity",f._opacity)}}),c.ui.plugin.add("draggable","scroll",{start:function(e,g){var f=c(this).data("draggable");f.scrollParent[0]!=document&&f.scrollParent[0].tagName!="HTML"&&(f.overflowOffset=f.scrollParent.offset())},drag:function(f,k){var h=c(this).data("draggable"),e=h.options,g=!1;if(h.scrollParent[0]!=document&&h.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x"){h.overflowOffset.top+h.scrollParent[0].offsetHeight-f.pageY<e.scrollSensitivity?h.scrollParent[0].scrollTop=g=h.scrollParent[0].scrollTop+e.scrollSpeed:f.pageY-h.overflowOffset.top<e.scrollSensitivity&&(h.scrollParent[0].scrollTop=g=h.scrollParent[0].scrollTop-e.scrollSpeed)}if(!e.axis||e.axis!="y"){h.overflowOffset.left+h.scrollParent[0].offsetWidth-f.pageX<e.scrollSensitivity?h.scrollParent[0].scrollLeft=g=h.scrollParent[0].scrollLeft+e.scrollSpeed:f.pageX-h.overflowOffset.left<e.scrollSensitivity&&(h.scrollParent[0].scrollLeft=g=h.scrollParent[0].scrollLeft-e.scrollSpeed)}}else{if(!e.axis||e.axis!="x"){f.pageY-c(document).scrollTop()<e.scrollSensitivity?g=c(document).scrollTop(c(document).scrollTop()-e.scrollSpeed):c(window).height()-(f.pageY-c(document).scrollTop())<e.scrollSensitivity&&(g=c(document).scrollTop(c(document).scrollTop()+e.scrollSpeed))}if(!e.axis||e.axis!="y"){f.pageX-c(document).scrollLeft()<e.scrollSensitivity?g=c(document).scrollLeft(c(document).scrollLeft()-e.scrollSpeed):c(window).width()-(f.pageX-c(document).scrollLeft())<e.scrollSensitivity&&(g=c(document).scrollLeft(c(document).scrollLeft()+e.scrollSpeed))}}g!==!1&&c.ui.ddmanager&&!e.dropBehaviour&&c.ui.ddmanager.prepareOffsets(h,f)}}),c.ui.plugin.add("draggable","snap",{start:function(f,h){var g=c(this).data("draggable"),e=g.options;g.snapElements=[],c(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var k=c(this),m=k.offset();this!=g.element[0]&&g.snapElements.push({item:this,width:k.outerWidth(),height:k.outerHeight(),top:m.top,left:m.left})})},drag:function(x,D){var A=c(this).data("draggable"),G=A.options,z=G.snapTolerance,C=D.offset.left,q=C+A.helperProportions.width,O=D.offset.top,J=O+A.helperProportions.height;for(var F=A.snapElements.length-1;F>=0;F--){var M=A.snapElements[F].left,H=M+A.snapElements[F].width,B=A.snapElements[F].top,K=B+A.snapElements[F].height;if(!(M-z<C&&C<H+z&&B-z<O&&O<K+z||M-z<C&&C<H+z&&B-z<J&&J<K+z||M-z<q&&q<H+z&&B-z<O&&O<K+z||M-z<q&&q<H+z&&B-z<J&&J<K+z)){A.snapElements[F].snapping&&A.options.snap.release&&A.options.snap.release.call(A.element,x,c.extend(A._uiHash(),{snapItem:A.snapElements[F].item})),A.snapElements[F].snapping=!1;continue}if(G.snapMode!="inner"){var k=Math.abs(B-J)<=z,E=Math.abs(K-O)<=z,I=Math.abs(M-q)<=z,e=Math.abs(H-C)<=z;k&&(D.position.top=A._convertPositionTo("relative",{top:B-A.helperProportions.height,left:0}).top-A.margins.top),E&&(D.position.top=A._convertPositionTo("relative",{top:K,left:0}).top-A.margins.top),I&&(D.position.left=A._convertPositionTo("relative",{top:0,left:M-A.helperProportions.width}).left-A.margins.left),e&&(D.position.left=A._convertPositionTo("relative",{top:0,left:H}).left-A.margins.left)}var N=k||E||I||e;if(G.snapMode!="outer"){var k=Math.abs(B-O)<=z,E=Math.abs(K-J)<=z,I=Math.abs(M-C)<=z,e=Math.abs(H-q)<=z;k&&(D.position.top=A._convertPositionTo("relative",{top:B,left:0}).top-A.margins.top),E&&(D.position.top=A._convertPositionTo("relative",{top:K-A.helperProportions.height,left:0}).top-A.margins.top),I&&(D.position.left=A._convertPositionTo("relative",{top:0,left:M}).left-A.margins.left),e&&(D.position.left=A._convertPositionTo("relative",{top:0,left:H-A.helperProportions.width}).left-A.margins.left)}!A.snapElements[F].snapping&&(k||E||I||e||N)&&A.options.snap.snap&&A.options.snap.snap.call(A.element,x,c.extend(A._uiHash(),{snapItem:A.snapElements[F].item})),A.snapElements[F].snapping=k||E||I||e||N}}}),c.ui.plugin.add("draggable","stack",{start:function(f,k){var h=c(this).data("draggable").options,e=c.makeArray(c(h.stack)).sort(function(m,o){return(parseInt(c(m).css("zIndex"),10)||0)-(parseInt(c(o).css("zIndex"),10)||0)});if(!e.length){return}var g=parseInt(e[0].style.zIndex)||0;c(e).each(function(m){this.style.zIndex=g+m}),this[0].style.zIndex=g+e.length}}),c.ui.plugin.add("draggable","zIndex",{start:function(f,h){var g=c(h.helper),e=c(this).data("draggable").options;g.css("zIndex")&&(e._zIndex=g.css("zIndex")),g.css("zIndex",e.zIndex)},stop:function(e,g){var f=c(this).data("draggable").options;f._zIndex&&c(g.helper).css("zIndex",f._zIndex)}})})(jQuery);(function(c,a){c.widget("ui.droppable",{version:"1.9.2",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect"},_create:function(){var e=this.options,f=e.accept;this.isover=0,this.isout=1,this.accept=c.isFunction(f)?f:function(g){return g.is(f)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},c.ui.ddmanager.droppables[e.scope]=c.ui.ddmanager.droppables[e.scope]||[],c.ui.ddmanager.droppables[e.scope].push(this),e.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){var e=c.ui.ddmanager.droppables[this.options.scope];for(var f=0;f<e.length;f++){e[f]==this&&e.splice(f,1)}this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,f){e=="accept"&&(this.accept=c.isFunction(f)?f:function(g){return g.is(f)}),c.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var f=c.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),f&&this._trigger("activate",e,this.ui(f))},_deactivate:function(e){var f=c.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),f&&this._trigger("deactivate",e,this.ui(f))},_over:function(e){var f=c.ui.ddmanager.current;if(!f||(f.currentItem||f.element)[0]==this.element[0]){return}this.accept.call(this.element[0],f.currentItem||f.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(f)))},_out:function(e){var f=c.ui.ddmanager.current;if(!f||(f.currentItem||f.element)[0]==this.element[0]){return}this.accept.call(this.element[0],f.currentItem||f.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(f)))},_drop:function(f,h){var g=h||c.ui.ddmanager.current;if(!g||(g.currentItem||g.element)[0]==this.element[0]){return !1}var e=!1;return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function(){var k=c.data(this,"droppable");if(k.options.greedy&&!k.options.disabled&&k.options.scope==g.options.scope&&k.accept.call(k.element[0],g.currentItem||g.element)&&c.ui.intersect(g,c.extend(k,{offset:k.element.offset()}),k.options.tolerance)){return e=!0,!1}}),e?!1:this.accept.call(this.element[0],g.currentItem||g.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",f,this.ui(g)),this.element):!1},ui:function(f){return{draggable:f.currentItem||f.element,helper:f.helper,position:f.position,offset:f.positionAbs}}}),c.ui.intersect=function(D,m,e){if(!m.offset){return !1}var v=(D.positionAbs||D.position.absolute).left,E=v+D.helperProportions.width,k=(D.positionAbs||D.position.absolute).top,C=k+D.helperProportions.height,B=m.offset.left,y=B+m.proportions.width,q=m.offset.top,A=q+m.proportions.height;switch(e){case"fit":return B<=v&&E<=y&&q<=k&&C<=A;case"intersect":return B<v+D.helperProportions.width/2&&E-D.helperProportions.width/2<y&&q<k+D.helperProportions.height/2&&C-D.helperProportions.height/2<A;case"pointer":var x=(D.positionAbs||D.position.absolute).left+(D.clickOffset||D.offset.click).left,g=(D.positionAbs||D.position.absolute).top+(D.clickOffset||D.offset.click).top,z=c.ui.isOver(g,x,q,B,m.proportions.height,m.proportions.width);return z;case"touch":return(k>=q&&k<=A||C>=q&&C<=A||k<q&&C>A)&&(v>=B&&v<=y||E>=B&&E<=y||v<B&&E>y);default:return !1}},c.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(g,q){var k=c.ui.ddmanager.droppables[g.options.scope]||[],f=q?q.type:null,h=(g.currentItem||g.element).find(":data(droppable)").andSelf();c:for(var m=0;m<k.length;m++){if(k[m].options.disabled||g&&!k[m].accept.call(k[m].element[0],g.currentItem||g.element)){continue}for(var e=0;e<h.length;e++){if(h[e]==k[m].element[0]){k[m].proportions.height=0;continue c}}k[m].visible=k[m].element.css("display")!="none";if(!k[m].visible){continue}f=="mousedown"&&k[m]._activate.call(k[m],q),k[m].offset=k[m].element.offset(),k[m].proportions={width:k[m].element[0].offsetWidth,height:k[m].element[0].offsetHeight}}},drop:function(e,g){var f=!1;return c.each(c.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options){return}!this.options.disabled&&this.visible&&c.ui.intersect(e,this,this.options.tolerance)&&(f=this._drop.call(this,g)||f),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=1,this.isover=0,this._deactivate.call(this,g))}),f},dragStart:function(e,f){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||c.ui.ddmanager.prepareOffsets(e,f)})},drag:function(e,f){e.options.refreshPositions&&c.ui.ddmanager.prepareOffsets(e,f),c.each(c.ui.ddmanager.droppables[e.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var m=c.ui.intersect(e,this,this.options.tolerance),h=!m&&this.isover==1?"isout":m&&this.isover==0?"isover":null;if(!h){return}var k;if(this.options.greedy){var n=this.options.scope,g=this.element.parents(":data(droppable)").filter(function(){return c.data(this,"droppable").options.scope===n});g.length&&(k=c.data(g[0],"droppable"),k.greedyChild=h=="isover"?1:0)}k&&h=="isover"&&(k.isover=0,k.isout=1,k._out.call(k,f)),this[h]=1,this[h=="isout"?"isover":"isout"]=0,this[h=="isover"?"_over":"_out"].call(this,f),k&&h=="isout"&&(k.isout=0,k.isover=1,k._over.call(k,f))})},dragStop:function(e,f){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||c.ui.ddmanager.prepareOffsets(e,f)}}})(jQuery);(function(f,a){f.widget("ui.resizable",f.ui.mouse,{version:"1.9.2",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:1000},_create:function(){var k=this,x=this.options;this.element.addClass("ui-resizable"),f.extend(this,{_aspectRatio:!!x.aspectRatio,aspectRatio:x.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:x.helper||x.ghost||x.animate?x.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(f('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("resizable",this.element.data("resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=x.handles||(f(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se");if(this.handles.constructor==String){this.handles=="all"&&(this.handles="n,e,s,w,se,sw,ne,nw");var q=this.handles.split(",");this.handles={};for(var h=0;h<q.length;h++){var m=f.trim(q[h]),v="ui-resizable-"+m,e=f('<div class="ui-resizable-handle '+v+'"></div>');e.css({zIndex:x.zIndex}),"se"==m&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[m]=".ui-resizable-"+m,this.element.append(e)}}this._renderAxis=function(u){u=u||this.element;for(var A in this.handles){this.handles[A].constructor==String&&(this.handles[A]=f(this.handles[A],this.element).show());if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){var z=f(this.handles[A],this.element),o=0;o=/sw|ne|nw|se|n|s/.test(A)?z.outerHeight():z.outerWidth();var y=["padding",/ne|nw|n/.test(A)?"Top":/se|sw|s/.test(A)?"Bottom":/^e$/.test(A)?"Right":"Left"].join("");u.css(y,o),this._proportionallyResize()}if(!f(this.handles[A]).length){continue}}},this._renderAxis(this.element),this._handles=f(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){if(!k.resizing){if(this.className){var n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}k.axis=n&&n[1]?n[1]:"se"}}),x.autoHide&&(this._handles.hide(),f(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(x.disabled){return}f(this).removeClass("ui-resizable-autohide"),k._handles.show()}).mouseleave(function(){if(x.disabled){return}k.resizing||(f(this).addClass("ui-resizable-autohide"),k._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var e=function(k){f(k).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){e(this.element);var h=this.element;this.originalElement.css({position:h.css("position"),width:h.outerWidth(),height:h.outerHeight(),top:h.css("top"),left:h.css("left")}).insertAfter(h),h.remove()}return this.originalElement.css("resize",this.originalResizeStyle),e(this.originalElement),this},_mouseCapture:function(e){var k=!1;for(var h in this.handles){f(this.handles[h])[0]==e.target&&(k=!0)}return !this.options.disabled&&k},_mouseStart:function(m){var q=this.options,k=this.element.position(),n=this.element;this.resizing=!0,this.documentScroll={top:f(document).scrollTop(),left:f(document).scrollLeft()},(n.is(".ui-draggable")||/absolute/.test(n.css("position")))&&n.css({position:"absolute",top:k.top,left:k.left}),this._renderProxy();var v=g(this.helper.css("left")),h=g(this.helper.css("top"));q.containment&&(v+=f(q.containment).scrollLeft()||0,h+=f(q.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:v,top:h},this.size=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()},this.originalSize=this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()},this.originalPosition={left:v,top:h},this.sizeDiff={width:n.outerWidth()-n.width(),height:n.outerHeight()-n.height()},this.originalMousePosition={left:m.pageX,top:m.pageY},this.aspectRatio=typeof q.aspectRatio=="number"?q.aspectRatio:this.originalSize.width/this.originalSize.height||1;var e=f(".ui-resizable-"+this.axis).css("cursor");return f("body").css("cursor",e=="auto"?this.axis+"-resize":e),n.addClass("ui-resizable-resizing"),this._propagate("start",m),!0},_mouseDrag:function(y){var B=this.helper,m=this.options,h={},v=this,C=this.originalMousePosition,k=this.axis,A=y.pageX-C.left||0,z=y.pageY-C.top||0,x=this._change[k];if(!x){return !1}var q=x.apply(this,[y,A,z]);this._updateVirtualBoundaries(y.shiftKey);if(this._aspectRatio||y.shiftKey){q=this._updateRatio(q,y)}return q=this._respectSize(q,y),this._propagate("resize",y),B.css({top:this.position.top+"px",left:this.position.left+"px",width:this.size.width+"px",height:this.size.height+"px"}),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),this._updateCache(q),this._trigger("resize",y,this.ui()),!1},_mouseStop:function(z){this.resizing=!1;var k=this.options,e=this;if(this._helper){var q=this._proportionallyResizeElements,A=q.length&&/textarea/i.test(q[0].nodeName),h=A&&f.ui.hasScroll(q[0],"left")?0:e.sizeDiff.height,y=A?0:e.sizeDiff.width,x={width:e.helper.width()-y,height:e.helper.height()-h},v=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,m=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;k.animate||this.element.css(f.extend(x,{top:m,left:v})),e.helper.height(e.size.height),e.helper.width(e.size.width),this._helper&&!k.animate&&this._proportionallyResize()}return f("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",z),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(r){var m=this.options,x,k,q,v,h;h={minWidth:c(m.minWidth)?m.minWidth:0,maxWidth:c(m.maxWidth)?m.maxWidth:Infinity,minHeight:c(m.minHeight)?m.minHeight:0,maxHeight:c(m.maxHeight)?m.maxHeight:Infinity};if(this._aspectRatio||r){x=h.minHeight*this.aspectRatio,q=h.minWidth/this.aspectRatio,k=h.maxHeight*this.aspectRatio,v=h.maxWidth/this.aspectRatio,x>h.minWidth&&(h.minWidth=x),q>h.minHeight&&(h.minHeight=q),k<h.maxWidth&&(h.maxWidth=k),v<h.maxHeight&&(h.maxHeight=v)}this._vBoundaries=h},_updateCache:function(k){var h=this.options;this.offset=this.helper.offset(),c(k.left)&&(this.position.left=k.left),c(k.top)&&(this.position.top=k.top),c(k.height)&&(this.size.height=k.height),c(k.width)&&(this.size.width=k.width)},_updateRatio:function(q,k){var u=this.options,h=this.position,m=this.size,r=this.axis;return c(q.height)?q.width=q.height*this.aspectRatio:c(q.width)&&(q.height=q.width/this.aspectRatio),r=="sw"&&(q.left=h.left+(m.width-q.width),q.top=null),r=="nw"&&(q.top=h.top+(m.height-q.height),q.left=h.left+(m.width-q.width)),q},_respectSize:function(A,G){var q=this.helper,x=this._vBoundaries,H=this._aspectRatio||G.shiftKey,m=this.axis,F=c(A.width)&&x.maxWidth&&x.maxWidth<A.width,D=c(A.height)&&x.maxHeight&&x.maxHeight<A.height,z=c(A.width)&&x.minWidth&&x.minWidth>A.width,r=c(A.height)&&x.minHeight&&x.minHeight>A.height;z&&(A.width=x.minWidth),r&&(A.height=x.minHeight),F&&(A.width=x.maxWidth),D&&(A.height=x.maxHeight);var C=this.originalPosition.left+this.originalSize.width,y=this.position.top+this.size.height,k=/sw|nw|w/.test(m),B=/nw|ne|n/.test(m);z&&k&&(A.left=C-x.minWidth),F&&k&&(A.left=C-x.maxWidth),r&&B&&(A.top=y-x.minHeight),D&&B&&(A.top=y-x.maxHeight);var E=!A.width&&!A.height;return E&&!A.left&&A.top?A.top=null:E&&!A.top&&A.left&&(A.left=null),A},_proportionallyResize:function(){var h=this.options;if(!this._proportionallyResizeElements.length){return}var u=this.helper||this.element;for(var m=0;m<this._proportionallyResizeElements.length;m++){var e=this._proportionallyResizeElements[m];if(!this.borderDif){var k=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],q=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")];this.borderDif=f.map(k,function(x,o){var y=parseInt(x,10)||0,v=parseInt(q[o],10)||0;return y+v})}e.css({height:u.height()-this.borderDif[0]-this.borderDif[2]||0,width:u.width()-this.borderDif[1]-this.borderDif[3]||0})}},_renderProxy:function(){var h=this.element,m=this.options;this.elementOffset=h.offset();if(this._helper){this.helper=this.helper||f('<div style="overflow:hidden;"></div>');var k=f.ui.ie6?1:0,e=f.ui.ie6?2:-1;this.helper.addClass(this._helper).css({width:this.element.outerWidth()+e,height:this.element.outerHeight()+e,position:"absolute",left:this.elementOffset.left-k+"px",top:this.elementOffset.top-k+"px",zIndex:++m.zIndex}),this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(k,h,m){return{width:this.originalSize.width+h}},w:function(q,k,u){var o=this.options,h=this.originalSize,m=this.originalPosition;return{left:m.left+k,width:h.width-k}},n:function(q,k,u){var o=this.options,h=this.originalSize,m=this.originalPosition;return{top:m.top+u,height:h.height-u}},s:function(k,h,m){return{height:this.originalSize.height+m}},se:function(e,k,h){return f.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[e,k,h]))},sw:function(e,k,h){return f.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[e,k,h]))},ne:function(e,k,h){return f.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[e,k,h]))},nw:function(e,k,h){return f.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[e,k,h]))}},_propagate:function(e,h){f.ui.plugin.call(this,e,[h,this.ui()]),e!="resize"&&this._trigger(e,h,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),f.ui.plugin.add("resizable","alsoResize",{start:function(h,o){var m=f(this).data("resizable"),e=m.options,k=function(n){f(n).each(function(){var q=f(this);q.data("resizable-alsoresize",{width:parseInt(q.width(),10),height:parseInt(q.height(),10),left:parseInt(q.css("left"),10),top:parseInt(q.css("top"),10)})})};typeof e.alsoResize=="object"&&!e.alsoResize.parentNode?e.alsoResize.length?(e.alsoResize=e.alsoResize[0],k(e.alsoResize)):f.each(e.alsoResize,function(n){k(n)}):k(e.alsoResize)},resize:function(m,y){var v=f(this).data("resizable"),k=v.options,q=v.originalSize,x=v.originalPosition,h={height:v.size.height-q.height||0,width:v.size.width-q.width||0,top:v.position.top-x.top||0,left:v.position.left-x.left||0},e=function(n,o){f(n).each(function(){var u=f(this),r=f(this).data("resizable-alsoresize"),z={},A=o&&o.length?o:u.parents(y.originalElement[0]).length?["width","height"]:["width","height","top","left"];f.each(A,function(C,B){var D=(r[B]||0)+(h[B]||0);D&&D>=0&&(z[B]=D||null)}),u.css(z)})};typeof k.alsoResize=="object"&&!k.alsoResize.nodeType?f.each(k.alsoResize,function(o,n){e(o,n)}):e(k.alsoResize)},stop:function(e,h){f(this).removeData("resizable-alsoresize")}}),f.ui.plugin.add("resizable","animate",{stop:function(A,k){var e=f(this).data("resizable"),q=e.options,B=e._proportionallyResizeElements,h=B.length&&/textarea/i.test(B[0].nodeName),z=h&&f.ui.hasScroll(B[0],"left")?0:e.sizeDiff.height,y=h?0:e.sizeDiff.width,v={width:e.size.width-y,height:e.size.height-z},m=parseInt(e.element.css("left"),10)+(e.position.left-e.originalPosition.left)||null,x=parseInt(e.element.css("top"),10)+(e.position.top-e.originalPosition.top)||null;e.element.animate(f.extend(v,x&&m?{top:x,left:m}:{}),{duration:q.animateDuration,easing:q.animateEasing,step:function(){var o={width:parseInt(e.element.css("width"),10),height:parseInt(e.element.css("height"),10),top:parseInt(e.element.css("top"),10),left:parseInt(e.element.css("left"),10)};B&&B.length&&f(B[0]).css({width:o.width,height:o.height}),e._updateCache(o),e._propagate("resize",A)}})}}),f.ui.plugin.add("resizable","containment",{start:function(E,e){var q=f(this).data("resizable"),F=q.options,m=q.element,D=F.containment,B=D instanceof f?D.get(0):/parent/.test(D)?m.parent().get(0):D;if(!B){return}q.containerElement=f(B);if(/document/.test(D)||D==document){q.containerOffset={left:0,top:0},q.containerPosition={left:0,top:0},q.parentData={element:f(document),left:0,top:0,width:f(document).width(),height:f(document).height()||document.body.parentNode.scrollHeight}}else{var y=f(B),n=[];f(["Top","Right","Left","Bottom"]).each(function(o,h){n[o]=g(y.css("padding"+h))}),q.containerOffset=y.offset(),q.containerPosition=y.position(),q.containerSize={height:y.innerHeight()-n[3],width:y.innerWidth()-n[1]};var A=q.containerOffset,x=q.containerSize.height,k=q.containerSize.width,z=f.ui.hasScroll(B,"left")?B.scrollWidth:k,C=f.ui.hasScroll(B)?B.scrollHeight:x;q.parentData={element:B,left:A.left,top:A.top,width:z,height:C}}},resize:function(G,q){var e=f(this).data("resizable"),y=e.options,H=e.containerSize,m=e.containerOffset,F=e.size,D=e.position,A=e._aspectRatio||G.shiftKey,x={top:0,left:0},C=e.containerElement;C[0]!=document&&/static/.test(C.css("position"))&&(x=m),D.left<(e._helper?m.left:0)&&(e.size.width=e.size.width+(e._helper?e.position.left-m.left:e.position.left-x.left),A&&(e.size.height=e.size.width/e.aspectRatio),e.position.left=y.helper?m.left:0),D.top<(e._helper?m.top:0)&&(e.size.height=e.size.height+(e._helper?e.position.top-m.top:e.position.top),A&&(e.size.width=e.size.height*e.aspectRatio),e.position.top=e._helper?m.top:0),e.offset.left=e.parentData.left+e.position.left,e.offset.top=e.parentData.top+e.position.top;var z=Math.abs((e._helper?e.offset.left-x.left:e.offset.left-x.left)+e.sizeDiff.width),k=Math.abs((e._helper?e.offset.top-x.top:e.offset.top-m.top)+e.sizeDiff.height),B=e.containerElement.get(0)==e.element.parent().get(0),E=/relative|absolute/.test(e.containerElement.css("position"));B&&E&&(z-=e.parentData.left),z+e.size.width>=e.parentData.width&&(e.size.width=e.parentData.width-z,A&&(e.size.height=e.size.width/e.aspectRatio)),k+e.size.height>=e.parentData.height&&(e.size.height=e.parentData.height-k,A&&(e.size.width=e.size.height*e.aspectRatio))},stop:function(C,m){var e=f(this).data("resizable"),v=e.options,D=e.position,k=e.containerOffset,B=e.containerPosition,A=e.containerElement,y=f(e.helper),q=y.offset(),z=y.outerWidth()-e.sizeDiff.width,x=y.outerHeight()-e.sizeDiff.height;e._helper&&!v.animate&&/relative/.test(A.css("position"))&&f(this).css({left:q.left-B.left-k.left,width:z,height:x}),e._helper&&!v.animate&&/static/.test(A.css("position"))&&f(this).css({left:q.left-B.left-k.left,width:z,height:x})}}),f.ui.plugin.add("resizable","ghost",{start:function(h,o){var m=f(this).data("resizable"),e=m.options,k=m.size;m.ghost=m.originalElement.clone(),m.ghost.css({opacity:0.25,display:"block",position:"relative",height:k.height,width:k.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof e.ghost=="string"?e.ghost:""),m.ghost.appendTo(m.helper)},resize:function(h,m){var k=f(this).data("resizable"),e=k.options;k.ghost&&k.ghost.css({position:"relative",height:k.size.height,width:k.size.width})},stop:function(h,m){var k=f(this).data("resizable"),e=k.options;k.ghost&&k.helper&&k.helper.get(0).removeChild(k.ghost.get(0))}}),f.ui.plugin.add("resizable","grid",{resize:function(A,k){var e=f(this).data("resizable"),q=e.options,B=e.size,h=e.originalSize,z=e.originalPosition,y=e.axis,v=q._aspectRatio||A.shiftKey;q.grid=typeof q.grid=="number"?[q.grid,q.grid]:q.grid;var m=Math.round((B.width-h.width)/(q.grid[0]||1))*(q.grid[0]||1),x=Math.round((B.height-h.height)/(q.grid[1]||1))*(q.grid[1]||1);/^(se|s|e)$/.test(y)?(e.size.width=h.width+m,e.size.height=h.height+x):/^(ne)$/.test(y)?(e.size.width=h.width+m,e.size.height=h.height+x,e.position.top=z.top-x):/^(sw)$/.test(y)?(e.size.width=h.width+m,e.size.height=h.height+x,e.position.left=z.left-m):(e.size.width=h.width+m,e.size.height=h.height+x,e.position.top=z.top-x,e.position.left=z.left-m)}});var g=function(h){return parseInt(h,10)||0},c=function(h){return !isNaN(parseInt(h,10))}})(jQuery);(function(c,a){c.widget("ui.selectable",c.ui.mouse,{version:"1.9.2",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch"},_create:function(){var e=this;this.element.addClass("ui-selectable"),this.dragged=!1;var f;this.refresh=function(){f=c(e.options.filter,e.element[0]),f.addClass("ui-selectee"),f.each(function(){var g=c(this),h=g.offset();c.data(this,"selectable-item",{element:this,$element:g,left:h.left,top:h.top,right:h.left+g.outerWidth(),bottom:h.top+g.outerHeight(),startselected:!1,selected:g.hasClass("ui-selected"),selecting:g.hasClass("ui-selecting"),unselecting:g.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=f.addClass("ui-selectee"),this._mouseInit(),this.helper=c("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var g=this;this.opos=[e.pageX,e.pageY];if(this.options.disabled){return}var f=this.options;this.selectees=c(f.filter,this.element[0]),this._trigger("start",e),c(f.appendTo).append(this.helper),this.helper.css({left:e.clientX,top:e.clientY,width:0,height:0}),f.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var h=c.data(this,"selectable-item");h.startselected=!0,!e.metaKey&&!e.ctrlKey&&(h.$element.removeClass("ui-selected"),h.selected=!1,h.$element.addClass("ui-unselecting"),h.unselecting=!0,g._trigger("unselecting",e,{unselecting:h.element}))}),c(e.target).parents().andSelf().each(function(){var k=c.data(this,"selectable-item");if(k){var h=!e.metaKey&&!e.ctrlKey||!k.$element.hasClass("ui-selected");return k.$element.removeClass(h?"ui-unselecting":"ui-selected").addClass(h?"ui-selecting":"ui-unselecting"),k.unselecting=!h,k.selecting=h,k.selected=h,h?g._trigger("selecting",e,{selecting:k.element}):g._trigger("unselecting",e,{unselecting:k.element}),!1}})},_mouseDrag:function(h){var v=this;this.dragged=!0;if(this.options.disabled){return}var m=this.options,g=this.opos[0],k=this.opos[1],q=h.pageX,f=h.pageY;if(g>q){var e=q;q=g,g=e}if(k>f){var e=f;f=k,k=e}return this.helper.css({left:g,top:k,width:q-g,height:f-k}),this.selectees.each(function(){var n=c.data(this,"selectable-item");if(!n||n.element==v.element[0]){return}var o=!1;m.tolerance=="touch"?o=!(n.left>q||n.right<g||n.top>f||n.bottom<k):m.tolerance=="fit"&&(o=n.left>g&&n.right<q&&n.top>k&&n.bottom<f),o?(n.selected&&(n.$element.removeClass("ui-selected"),n.selected=!1),n.unselecting&&(n.$element.removeClass("ui-unselecting"),n.unselecting=!1),n.selecting||(n.$element.addClass("ui-selecting"),n.selecting=!0,v._trigger("selecting",h,{selecting:n.element}))):(n.selecting&&((h.metaKey||h.ctrlKey)&&n.startselected?(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.$element.addClass("ui-selected"),n.selected=!0):(n.$element.removeClass("ui-selecting"),n.selecting=!1,n.startselected&&(n.$element.addClass("ui-unselecting"),n.unselecting=!0),v._trigger("unselecting",h,{unselecting:n.element}))),n.selected&&!h.metaKey&&!h.ctrlKey&&!n.startselected&&(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,v._trigger("unselecting",h,{unselecting:n.element})))}),!1},_mouseStop:function(e){var g=this;this.dragged=!1;var f=this.options;return c(".ui-unselecting",this.element[0]).each(function(){var h=c.data(this,"selectable-item");h.$element.removeClass("ui-unselecting"),h.unselecting=!1,h.startselected=!1,g._trigger("unselected",e,{unselected:h.element})}),c(".ui-selecting",this.element[0]).each(function(){var h=c.data(this,"selectable-item");h.$element.removeClass("ui-selecting").addClass("ui-selected"),h.selecting=!1,h.selected=!0,h.startselected=!0,g._trigger("selected",e,{selected:h.element})}),this._trigger("stop",e),this.helper.remove(),!1}})})(jQuery);(function(c,a){c.widget("ui.sortable",c.ui.mouse,{version:"1.9.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var f=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?f.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var f=this.items.length-1;f>=0;f--){this.items[f].item.removeData(this.widgetName+"-item")}return this},_setOption:function(e,f){e==="disabled"?(this.options[e]=f,this.widget().toggleClass("ui-sortable-disabled",!!f)):c.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(f,m){var h=this;if(this.reverting){return !1}if(this.options.disabled||this.options.type=="static"){return !1}this._refreshItems(f);var e=null,g=c(f.target).parents().each(function(){if(c.data(this,h.widgetName+"-item")==h){return e=c(this),!1}});c.data(f.target,h.widgetName+"-item")==h&&(e=c(f.target));if(!e){return !1}if(this.options.handle&&!m){var k=!1;c(this.options.handle,e).find("*").andSelf().each(function(){this==f.target&&(k=!0)});if(!k){return !1}}return this.currentItem=e,this._removeCurrentsFromItems(),!0},_mouseStart:function(f,k,h){var e=this.options;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(f),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},c.extend(this.offset,{click:{left:f.pageX-this.offset.left,top:f.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(f),this.originalPageX=f.pageX,this.originalPageY=f.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),e.containment&&this._setContainment(),e.cursor&&(c("body").css("cursor")&&(this._storedCursor=c("body").css("cursor")),c("body").css("cursor",e.cursor)),e.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",e.opacity)),e.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",e.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",f,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!h){for(var g=this.containers.length-1;g>=0;g--){this.containers[g]._trigger("activate",f,this._uiHash(this))}}return c.ui.ddmanager&&(c.ui.ddmanager.current=this),c.ui.ddmanager&&!e.dropBehaviour&&c.ui.ddmanager.prepareOffsets(this,f),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(f),!0},_mouseDrag:function(g){this.position=this._generatePosition(g),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var q=this.options,k=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-g.pageY<q.scrollSensitivity?this.scrollParent[0].scrollTop=k=this.scrollParent[0].scrollTop+q.scrollSpeed:g.pageY-this.overflowOffset.top<q.scrollSensitivity&&(this.scrollParent[0].scrollTop=k=this.scrollParent[0].scrollTop-q.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-g.pageX<q.scrollSensitivity?this.scrollParent[0].scrollLeft=k=this.scrollParent[0].scrollLeft+q.scrollSpeed:g.pageX-this.overflowOffset.left<q.scrollSensitivity&&(this.scrollParent[0].scrollLeft=k=this.scrollParent[0].scrollLeft-q.scrollSpeed)):(g.pageY-c(document).scrollTop()<q.scrollSensitivity?k=c(document).scrollTop(c(document).scrollTop()-q.scrollSpeed):c(window).height()-(g.pageY-c(document).scrollTop())<q.scrollSensitivity&&(k=c(document).scrollTop(c(document).scrollTop()+q.scrollSpeed)),g.pageX-c(document).scrollLeft()<q.scrollSensitivity?k=c(document).scrollLeft(c(document).scrollLeft()-q.scrollSpeed):c(window).width()-(g.pageX-c(document).scrollLeft())<q.scrollSensitivity&&(k=c(document).scrollLeft(c(document).scrollLeft()+q.scrollSpeed))),k!==!1&&c.ui.ddmanager&&!q.dropBehaviour&&c.ui.ddmanager.prepareOffsets(this,g)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var f=this.items.length-1;f>=0;f--){var h=this.items[f],m=h.item[0],e=this._intersectsWithPointer(h);if(!e){continue}if(h.instance!==this.currentContainer){continue}if(m!=this.currentItem[0]&&this.placeholder[e==1?"next":"prev"]()[0]!=m&&!c.contains(this.placeholder[0],m)&&(this.options.type=="semi-dynamic"?!c.contains(this.element[0],m):!0)){this.direction=e==1?"down":"up";if(this.options.tolerance!="pointer"&&!this._intersectsWithSides(h)){break}this._rearrange(g,h),this._trigger("change",g,this._uiHash());break}}return this._contactContainers(g),c.ui.ddmanager&&c.ui.ddmanager.drag(this,g),this._trigger("sort",g,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(f,h){if(!f){return}c.ui.ddmanager&&!this.options.dropBehaviour&&c.ui.ddmanager.drop(this,f);if(this.options.revert){var g=this,e=this.placeholder.offset();this.reverting=!0,c(this.helper).animate({left:e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){g._clear(f)})}else{this._clear(f,h)}return !1},cancel:function(){if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),c.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?c(this.domPosition.prev).after(this.currentItem):c(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var g=this._getItemsAsjQuery(e&&e.connected),f=[];return e=e||{},c(g).each(function(){var h=(c(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[-=_](.+)/);h&&f.push((e.key||h[1]+"[]")+"="+(e.key&&e.expression?h[1]:h[2]))}),!f.length&&e.key&&f.push(e.key+"="),f.join("&")},toArray:function(e){var g=this._getItemsAsjQuery(e&&e.connected),f=[];return e=e||{},g.each(function(){f.push(c(e.item||this).attr(e.attribute||"id")||"")}),f},_intersectsWith:function(x){var B=this.positionAbs.left,k=B+this.helperProportions.width,g=this.positionAbs.top,q=g+this.helperProportions.height,C=x.left,h=C+x.width,A=x.top,z=A+x.height,v=this.offset.click.top,m=this.offset.click.left,y=g+v>A&&g+v<z&&B+m>C&&B+m<h;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>x[this.floating?"width":"height"]?y:C<B+this.helperProportions.width/2&&k-this.helperProportions.width/2<h&&A<g+this.helperProportions.height/2&&q-this.helperProportions.height/2<z},_intersectsWithPointer:function(f){var m=this.options.axis==="x"||c.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top,f.height),h=this.options.axis==="y"||c.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left,f.width),e=m&&h,g=this._getDragVerticalDirection(),k=this._getDragHorizontalDirection();return e?this.floating?k&&k=="right"||g=="down"?2:1:g&&(g=="down"?2:1):!1},_intersectsWithSides:function(f){var k=c.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,f.top+f.height/2,f.height),h=c.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,f.left+f.width/2,f.width),e=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?g=="right"&&h||g=="left"&&!h:e&&(e=="down"&&k||e=="up"&&!k)},_getDragVerticalDirection:function(){var f=this.positionAbs.top-this.lastPositionAbs.top;return f!=0&&(f>0?"down":"up")},_getDragHorizontalDirection:function(){var f=this.positionAbs.left-this.lastPositionAbs.left;return f!=0&&(f>0?"right":"left")},refresh:function(f){return this._refreshItems(f),this.refreshPositions(),this},_connectWith:function(){var f=this.options;return f.connectWith.constructor==String?[f.connectWith]:f.connectWith},_getItemsAsjQuery:function(h){var v=[],m=[],g=this._connectWith();if(g&&h){for(var k=g.length-1;k>=0;k--){var q=c(g[k]);for(var f=q.length-1;f>=0;f--){var e=c.data(q[f],this.widgetName);e&&e!=this&&!e.options.disabled&&m.push([c.isFunction(e.options.items)?e.options.items.call(e.element):c(e.options.items,e.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),e])}}}m.push([c.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):c(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var k=m.length-1;k>=0;k--){m[k][0].each(function(){v.push(this)})}return c(v)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=c.grep(this.items,function(f){for(var g=0;g<e.length;g++){if(e[g]==f.item[0]){return !1}}return !0})},_refreshItems:function(B){this.items=[],this.containers=[this];var k=this.items,e=[[c.isFunction(this.options.items)?this.options.items.call(this.element[0],B,{item:this.currentItem}):c(this.options.items,this.element),this]],q=this._connectWith();if(q&&this.ready){for(var C=q.length-1;C>=0;C--){var g=c(q[C]);for(var A=g.length-1;A>=0;A--){var z=c.data(g[A],this.widgetName);z&&z!=this&&!z.options.disabled&&(e.push([c.isFunction(z.options.items)?z.options.items.call(z.element[0],B,{item:this.currentItem}):c(z.options.items,z.element),z]),this.containers.push(z))}}}for(var C=e.length-1;C>=0;C--){var x=e[C][1],m=e[C][0];for(var A=0,y=m.length;A<y;A++){var v=c(m[A]);v.data(this.widgetName+"-item",x),k.push({item:v,instance:x,width:0,height:0,left:0,top:0})}}},refreshPositions:function(f){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var k=this.items.length-1;k>=0;k--){var h=this.items[k];if(h.instance!=this.currentContainer&&this.currentContainer&&h.item[0]!=this.currentItem[0]){continue}var e=this.options.toleranceElement?c(this.options.toleranceElement,h.item):h.item;f||(h.width=e.outerWidth(),h.height=e.outerHeight());var g=e.offset();h.left=g.left,h.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var k=this.containers.length-1;k>=0;k--){var g=this.containers[k].element.offset();this.containers[k].containerCache.left=g.left,this.containers[k].containerCache.top=g.top,this.containers[k].containerCache.width=this.containers[k].element.outerWidth(),this.containers[k].containerCache.height=this.containers[k].element.outerHeight()}}return this},_createPlaceholder:function(e){e=e||this;var g=e.options;if(!g.placeholder||g.placeholder.constructor==String){var f=g.placeholder;g.placeholder={element:function(){var h=c(document.createElement(e.currentItem[0].nodeName)).addClass(f||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return f||(h.style.visibility="hidden"),h},update:function(k,h){if(f&&!g.forcePlaceholderSize){return}h.height()||h.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),h.width()||h.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10))}}}e.placeholder=c(g.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),g.placeholder.update(e,e.placeholder)},_contactContainers:function(B){var k=null,e=null;for(var q=this.containers.length-1;q>=0;q--){if(c.contains(this.currentItem[0],this.containers[q].element[0])){continue}if(this._intersectsWith(this.containers[q].containerCache)){if(k&&c.contains(this.containers[q].element[0],k.element[0])){continue}k=this.containers[q],e=q}else{this.containers[q].containerCache.over&&(this.containers[q]._trigger("out",B,this._uiHash(this)),this.containers[q].containerCache.over=0)}}if(!k){return}if(this.containers.length===1){this.containers[e]._trigger("over",B,this._uiHash(this)),this.containers[e].containerCache.over=1}else{var C=10000,g=null,A=this.containers[e].floating?"left":"top",z=this.containers[e].floating?"width":"height",x=this.positionAbs[A]+this.offset.click[A];for(var m=this.items.length-1;m>=0;m--){if(!c.contains(this.containers[e].element[0],this.items[m].item[0])){continue}if(this.items[m].item[0]==this.currentItem[0]){continue}var y=this.items[m].item.offset()[A],v=!1;Math.abs(y-x)>Math.abs(y+this.items[m][z]-x)&&(v=!0,y+=this.items[m][z]),Math.abs(y-x)<C&&(C=Math.abs(y-x),g=this.items[m],this.direction=v?"up":"down")}if(!g&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[e],g?this._rearrange(B,g,null,!0):this._rearrange(B,null,this.containers[e].element,!0),this._trigger("change",B,this._uiHash()),this.containers[e]._trigger("change",B,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[e]._trigger("over",B,this._uiHash(this)),this.containers[e].containerCache.over=1}},_createHelper:function(e){var g=this.options,f=c.isFunction(g.helper)?c(g.helper.apply(this.element[0],[e,this.currentItem])):g.helper=="clone"?this.currentItem.clone():this.currentItem;return f.parents("body").length||c(g.appendTo!="parent"?g.appendTo:this.currentItem[0].parentNode)[0].appendChild(f[0]),f[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(f[0].style.width==""||g.forceHelperSize)&&f.width(this.currentItem.width()),(f[0].style.height==""||g.forceHelperSize)&&f.height(this.currentItem.height()),f},_adjustOffsetFromHelper:function(e){typeof e=="string"&&(e=e.split(" ")),c.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left" in e&&(this.offset.click.left=e.left+this.margins.left),"right" in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top" in e&&(this.offset.click.top=e.top+this.margins.top),"bottom" in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&c.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&c.ui.ie){e={top:0,left:0}}return{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var f=this.currentItem.position();return{top:f.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:f.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var f=this.options;f.containment=="parent"&&(f.containment=this.helper[0].parentNode);if(f.containment=="document"||f.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,c(f.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(c(f.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(f.containment)){var h=c(f.containment)[0],g=c(f.containment).offset(),e=c(h).css("overflow")!="hidden";this.containment=[g.left+(parseInt(c(h).css("borderLeftWidth"),10)||0)+(parseInt(c(h).css("paddingLeft"),10)||0)-this.margins.left,g.top+(parseInt(c(h).css("borderTopWidth"),10)||0)+(parseInt(c(h).css("paddingTop"),10)||0)-this.margins.top,g.left+(e?Math.max(h.scrollWidth,h.offsetWidth):h.offsetWidth)-(parseInt(c(h).css("borderLeftWidth"),10)||0)-(parseInt(c(h).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,g.top+(e?Math.max(h.scrollHeight,h.offsetHeight):h.offsetHeight)-(parseInt(c(h).css("borderTopWidth"),10)||0)-(parseInt(c(h).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(f,m){m||(m=this.position);var h=f=="absolute"?1:-1,e=this.options,g=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!c.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,k=/(html|body)/i.test(g[0].tagName);return{top:m.top+this.offset.relative.top*h+this.offset.parent.top*h-(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():k?0:g.scrollTop())*h,left:m.left+this.offset.relative.left*h+this.offset.parent.left*h-(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():k?0:g.scrollLeft())*h}},_generatePosition:function(h){var v=this.options,m=this.cssPosition!="absolute"||this.scrollParent[0]!=document&&!!c.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,g=/(html|body)/i.test(m[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var k=h.pageX,q=h.pageY;if(this.originalPosition){this.containment&&(h.pageX-this.offset.click.left<this.containment[0]&&(k=this.containment[0]+this.offset.click.left),h.pageY-this.offset.click.top<this.containment[1]&&(q=this.containment[1]+this.offset.click.top),h.pageX-this.offset.click.left>this.containment[2]&&(k=this.containment[2]+this.offset.click.left),h.pageY-this.offset.click.top>this.containment[3]&&(q=this.containment[3]+this.offset.click.top));if(v.grid){var f=this.originalPageY+Math.round((q-this.originalPageY)/v.grid[1])*v.grid[1];q=this.containment?f-this.offset.click.top<this.containment[1]||f-this.offset.click.top>this.containment[3]?f-this.offset.click.top<this.containment[1]?f+v.grid[1]:f-v.grid[1]:f:f;var e=this.originalPageX+Math.round((k-this.originalPageX)/v.grid[0])*v.grid[0];k=this.containment?e-this.offset.click.left<this.containment[0]||e-this.offset.click.left>this.containment[2]?e-this.offset.click.left<this.containment[0]?e+v.grid[0]:e-v.grid[0]:e:e}}return{top:q-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:m.scrollTop()),left:k-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:m.scrollLeft())}},_rearrange:function(k,g,m,h){m?m[0].appendChild(this.placeholder[0]):g.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?g.item[0]:g.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var f=this.counter;this._delay(function(){f==this.counter&&this.refreshPositions(!h)})},_clear:function(f,h){this.reverting=!1;var g=[];!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var e in this._storedCSS){if(this._storedCSS[e]=="auto"||this._storedCSS[e]=="static"){this._storedCSS[e]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}this.fromOutside&&!h&&g.push(function(k){this._trigger("receive",k,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!h&&g.push(function(k){this._trigger("update",k,this._uiHash())}),this!==this.currentContainer&&(h||(g.push(function(k){this._trigger("remove",k,this._uiHash())}),g.push(function(k){return function(m){k._trigger("receive",m,this._uiHash(this))}}.call(this,this.currentContainer)),g.push(function(k){return function(m){k._trigger("update",m,this._uiHash(this))}}.call(this,this.currentContainer))));for(var e=this.containers.length-1;e>=0;e--){h||g.push(function(k){return function(m){k._trigger("deactivate",m,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over&&(g.push(function(k){return function(m){k._trigger("out",m,this._uiHash(this))}}.call(this,this.containers[e])),this.containers[e].containerCache.over=0)}this._storedCursor&&c("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!h){this._trigger("beforeStop",f,this._uiHash());for(var e=0;e<g.length;e++){g[e].call(this,f)}this._trigger("stop",f,this._uiHash())}return this.fromOutside=!1,!1}h||this._trigger("beforeStop",f,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!h){for(var e=0;e<g.length;e++){g[e].call(this,f)}this._trigger("stop",f,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){c.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var f=e||this;return{helper:f.helper,placeholder:f.placeholder||c([]),position:f.position,originalPosition:f.originalPosition,offset:f.positionAbs,item:f.currentItem,sender:e?e.element:null}}})})(jQuery);(function(g,c){var h=0,f={},a={};f.height=f.paddingTop=f.paddingBottom=f.borderTopWidth=f.borderBottomWidth="hide",a.height=a.paddingTop=a.paddingBottom=a.borderTopWidth=a.borderBottomWidth="show",g.widget("ui.accordion",{version:"1.9.2",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var e=this.accordionId="ui-accordion-"+(this.element.attr("id")||++h),k=this.options;this.prevShow=this.prevHide=g(),this.element.addClass("ui-accordion ui-widget ui-helper-reset"),this.headers=this.element.find(k.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this._hoverable(this.headers),this._focusable(this.headers),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide(),!k.collapsible&&(k.active===!1||k.active==null)&&(k.active=0),k.active<0&&(k.active+=this.headers.length),this.active=this._findActive(k.active).addClass("ui-accordion-header-active ui-state-active").toggleClass("ui-corner-all ui-corner-top"),this.active.next().addClass("ui-accordion-content-active").show(),this._createIcons(),this.refresh(),this.element.attr("role","tablist"),this.headers.attr("role","tab").each(function(v){var t=g(this),m=t.attr("id"),q=t.next(),u=q.attr("id");m||(m=e+"-header-"+v,t.attr("id",m)),u||(u=e+"-panel-"+v,q.attr("id",u)),t.attr("aria-controls",u),q.attr("aria-labelledby",m)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._on(this.headers,{keydown:"_keydown"}),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._setupEvents(k.event)},_getCreateEventData:function(){return{header:this.active,content:this.active.length?this.active.next():g()}},_createIcons:function(){var e=this.options.icons;e&&(g("<span>").addClass("ui-accordion-header-icon ui-icon "+e.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(e.header).addClass(e.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var k;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),k=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this.options.heightStyle!=="content"&&k.css("height","")},_setOption:function(m,k){if(m==="active"){this._activate(k);return}m==="event"&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(k)),this._super(m,k),m==="collapsible"&&!k&&this.options.active===!1&&this._activate(0),m==="icons"&&(this._destroyIcons(),k&&this._createIcons()),m==="disabled"&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!k)},_keydown:function(k){if(k.altKey||k.ctrlKey){return}var q=g.ui.keyCode,o=this.headers.length,e=this.headers.index(k.target),m=!1;switch(k.keyCode){case q.RIGHT:case q.DOWN:m=this.headers[(e+1)%o];break;case q.LEFT:case q.UP:m=this.headers[(e-1+o)%o];break;case q.SPACE:case q.ENTER:this._eventHandler(k);break;case q.HOME:m=this.headers[0];break;case q.END:m=this.headers[o-1]}m&&(g(k.target).attr("tabIndex",-1),g(m).attr("tabIndex",0),m.focus(),k.preventDefault())},_panelKeyDown:function(e){e.keyCode===g.ui.keyCode.UP&&e.ctrlKey&&g(e.currentTarget).prev().focus()},refresh:function(){var k,o,m=this.options.heightStyle,e=this.element.parent();m==="fill"?(g.support.minHeight||(o=e.css("overflow"),e.css("overflow","hidden")),k=e.height(),this.element.siblings(":visible").each(function(){var t=g(this),q=t.css("position");if(q==="absolute"||q==="fixed"){return}k-=t.outerHeight(!0)}),o&&e.css("overflow",o),this.headers.each(function(){k-=g(this).outerHeight(!0)}),this.headers.next().each(function(){g(this).height(Math.max(0,k-g(this).innerHeight()+g(this).height()))}).css("overflow","auto")):m==="auto"&&(k=0,this.headers.next().each(function(){k=Math.max(k,g(this).css("height","").height())}).height(k))},_activate:function(e){var k=this._findActive(e)[0];if(k===this.active[0]){return}k=k||this.active[0],this._eventHandler({target:k,currentTarget:k,preventDefault:g.noop})},_findActive:function(e){return typeof e=="number"?this.headers.eq(e):g()},_setupEvents:function(e){var k={};if(!e){return}g.each(e.split(" "),function(n,m){k[m]="_eventHandler"}),this._on(this.headers,k)},_eventHandler:function(z){var m=this.options,e=this.active,q=g(z.currentTarget),A=q[0]===e[0],k=A&&m.collapsible,y=k?g():q.next(),x=e.next(),v={oldHeader:e,oldPanel:x,newHeader:k?g():q,newPanel:y};z.preventDefault();if(A&&!m.collapsible||this._trigger("beforeActivate",z,v)===!1){return}m.active=k?!1:this.headers.index(q),this.active=A?g():q,this._toggle(v),e.removeClass("ui-accordion-header-active ui-state-active"),m.icons&&e.children(".ui-accordion-header-icon").removeClass(m.icons.activeHeader).addClass(m.icons.header),A||(q.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),m.icons&&q.children(".ui-accordion-header-icon").removeClass(m.icons.header).addClass(m.icons.activeHeader),q.next().addClass("ui-accordion-content-active"))},_toggle:function(e){var m=e.newPanel,k=this.prevShow.length?this.prevShow:e.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=m,this.prevHide=k,this.options.animate?this._animate(m,k,e):(k.hide(),m.show(),this._toggleComplete(e)),k.attr({"aria-expanded":"false","aria-hidden":"true"}),k.prev().attr("aria-selected","false"),m.length&&k.length?k.prev().attr("tabIndex",-1):m.length&&this.headers.filter(function(){return g(this).attr("tabIndex")===0}).attr("tabIndex",-1),m.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(y,C,q){var D,m,B,A=this,x=0,r=y.length&&(!C.length||y.index()<C.index()),z=this.options.animate||{},v=r&&z.down||z,k=function(){A._toggleComplete(q)};typeof v=="number"&&(B=v),typeof v=="string"&&(m=v),m=m||v.easing||z.easing,B=B||v.duration||z.duration;if(!C.length){return y.animate(a,B,m,k)}if(!y.length){return C.animate(f,B,m,k)}D=y.show().outerHeight(),C.animate(f,{duration:B,easing:m,step:function(o,n){n.now=Math.round(o)}}),y.hide().animate(a,{duration:B,easing:m,complete:k,step:function(o,t){t.now=Math.round(o),t.prop!=="height"?x+=t.now:A.options.heightStyle!=="content"&&(t.now=Math.round(D-C.outerHeight()-x),x=0)}})},_toggleComplete:function(m){var k=m.oldPanel;k.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),k.length&&(k.parent()[0].className=k.parent()[0].className),this._trigger("activate",null,m)}}),g.uiBackCompat!==!1&&(function(m,k){m.extend(k.options,{navigation:!1,navigationFilter:function(){return this.href.toLowerCase()===location.href.toLowerCase()}});var o=k._create;k._create=function(){if(this.options.navigation){var n=this,u=this.element.find(this.options.header),e=u.next(),q=u.add(e).find("a").filter(this.options.navigationFilter)[0];q&&u.add(e).each(function(r){if(m.contains(this,q)){return n.options.active=Math.floor(r/2),!1}})}o.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(o,k){o.extend(k.options,{heightStyle:null,autoHeight:!0,clearStyle:!1,fillSpace:!1});var q=k._create,m=k._setOption;o.extend(k,{_create:function(){this.options.heightStyle=this.options.heightStyle||this._mergeHeightStyle(),q.call(this)},_setOption:function(n){if(n==="autoHeight"||n==="clearStyle"||n==="fillSpace"){this.options.heightStyle=this._mergeHeightStyle()}m.apply(this,arguments)},_mergeHeightStyle:function(){var n=this.options;if(n.fillSpace){return"fill"}if(n.clearStyle){return"content"}if(n.autoHeight){return"auto"}}})}(jQuery,jQuery.ui.accordion.prototype),function(m,k){m.extend(k.options.icons,{activeHeader:null,headerSelected:"ui-icon-triangle-1-s"});var o=k._createIcons;k._createIcons=function(){this.options.icons&&(this.options.icons.activeHeader=this.options.icons.activeHeader||this.options.icons.headerSelected),o.call(this)}}(jQuery,jQuery.ui.accordion.prototype),function(m,k){k.activate=k._activate;var o=k._findActive;k._findActive=function(n){return n===-1&&(n=!1),n&&typeof n!="number"&&(n=this.headers.index(this.headers.filter(n)),n===-1&&(n=!1)),o.call(this,n)}}(jQuery,jQuery.ui.accordion.prototype),jQuery.ui.accordion.prototype.resize=jQuery.ui.accordion.prototype.refresh,function(m,k){m.extend(k.options,{change:null,changestart:null});var o=k._trigger;k._trigger=function(v,q,u){var n=o.apply(this,arguments);return n?(v==="beforeActivate"?n=o.call(this,"changestart",q,{oldHeader:u.oldHeader,oldContent:u.oldPanel,newHeader:u.newHeader,newContent:u.newPanel}):v==="activate"&&(n=o.call(this,"change",q,{oldHeader:u.oldHeader,oldContent:u.oldPanel,newHeader:u.newHeader,newContent:u.newPanel})),n):!1}}(jQuery,jQuery.ui.accordion.prototype),function(m,k){m.extend(k.options,{animate:null,animated:"slide"});var o=k._create;k._create=function(){var n=this.options;n.animate===null&&(n.animated?n.animated==="slide"?n.animate=300:n.animated==="bounceslide"?n.animate={duration:200,down:{easing:"easeOutBounce",duration:1000}}:n.animate=n.animated:n.animate=!1),o.call(this)}}(jQuery,jQuery.ui.accordion.prototype))})(jQuery);(function(c,a){var f=0;c.widget("ui.autocomplete",{version:"1.9.2",defaultElement:"<input>",options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var e,h,g;this.isMultiLine=this._isMultiLine(),this.valueMethod=this.element[this.element.is("input,textarea")?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(k){if(this.element.prop("readOnly")){e=!0,g=!0,h=!0;return}e=!1,g=!1,h=!1;var m=c.ui.keyCode;switch(k.keyCode){case m.PAGE_UP:e=!0,this._move("previousPage",k);break;case m.PAGE_DOWN:e=!0,this._move("nextPage",k);break;case m.UP:e=!0,this._keyEvent("previous",k);break;case m.DOWN:e=!0,this._keyEvent("next",k);break;case m.ENTER:case m.NUMPAD_ENTER:this.menu.active&&(e=!0,k.preventDefault(),this.menu.select(k));break;case m.TAB:this.menu.active&&this.menu.select(k);break;case m.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(k),k.preventDefault());break;default:h=!0,this._searchTimeout(k)}},keypress:function(m){if(e){e=!1,m.preventDefault();return}if(h){return}var k=c.ui.keyCode;switch(m.keyCode){case k.PAGE_UP:this._move("previousPage",m);break;case k.PAGE_DOWN:this._move("nextPage",m);break;case k.UP:this._keyEvent("previous",m);break;case k.DOWN:this._keyEvent("next",m)}},input:function(k){if(g){g=!1,k.preventDefault();return}this._searchTimeout(k)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(k){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching),this.close(k),this._change(k)}}),this._initSource(),this.menu=c("<ul>").addClass("ui-autocomplete").appendTo(this.document.find(this.options.appendTo||"body")[0]).menu({input:c(),role:null}).zIndex(this.element.zIndex()+1).hide().data("menu"),this._on(this.menu.element,{mousedown:function(k){k.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var m=this.menu.element[0];c(k.target).closest(".ui-menu-item").length||this._delay(function(){var n=this;this.document.one("mousedown",function(o){o.target!==n.element[0]&&o.target!==m&&!c.contains(m,o.target)&&n.close()})})},menufocus:function(k,o){if(this.isNewMenu){this.isNewMenu=!1;if(k.originalEvent&&/^mouse/.test(k.originalEvent.type)){this.menu.blur(),this.document.one("mousemove",function(){c(k.target).trigger(k.originalEvent)});return}}var m=o.item.data("ui-autocomplete-item")||o.item.data("item.autocomplete");!1!==this._trigger("focus",k,{item:m})?k.originalEvent&&/^key/.test(k.originalEvent.type)&&this._value(m.value):this.liveRegion.text(m.value)},menuselect:function(o,k){var q=k.item.data("ui-autocomplete-item")||k.item.data("item.autocomplete"),m=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=m,this._delay(function(){this.previous=m,this.selectedItem=q})),!1!==this._trigger("select",o,{item:q})&&this._value(q.value),this.term=this._value(),this.close(o),this.selectedItem=q}}),this.liveRegion=c("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertAfter(this.element),c.fn.bgiframe&&this.menu.element.bgiframe(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(h,g){this._super(h,g),h==="source"&&this._initSource(),h==="appendTo"&&this.menu.element.appendTo(this.document.find(g||"body")[0]),h==="disabled"&&g&&this.xhr&&this.xhr.abort()},_isMultiLine:function(){return this.element.is("textarea")?!0:this.element.is("input")?!1:this.element.prop("isContentEditable")},_initSource:function(){var e,h,g=this;c.isArray(this.options.source)?(e=this.options.source,this.source=function(m,k){k(c.ui.autocomplete.filter(e,m.term))}):typeof this.options.source=="string"?(h=this.options.source,this.source=function(m,k){g.xhr&&g.xhr.abort(),g.xhr=c.ajax({url:h,data:m,dataType:"json",success:function(n){k(n)},error:function(){k([])}})}):this.source=this.options.source},_searchTimeout:function(g){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,g))},this.options.delay)},search:function(h,g){h=h!=null?h:this._value(),this.term=this._value();if(h.length<this.options.minLength){return this.close(g)}if(this._trigger("search",g)===!1){return}return this._search(h)},_search:function(g){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:g},this._response())},_response:function(){var h=this,g=++f;return function(e){g===f&&h.__response(e),h.pending--,h.pending||h.element.removeClass("ui-autocomplete-loading")}},__response:function(g){g&&(g=this._normalize(g)),this._trigger("response",null,{content:g}),!this.options.disabled&&g&&g.length&&!this.cancelSearch?(this._suggest(g),this._trigger("open")):this._close()},close:function(g){this.cancelSearch=!0,this._close(g)},_close:function(g){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",g))},_change:function(g){this.previous!==this._value()&&this._trigger("change",g,{item:this.selectedItem})},_normalize:function(e){return e.length&&e[0].label&&e[0].value?e:c.map(e,function(g){return typeof g=="string"?{label:g,value:g}:c.extend({label:g.label||g.value,value:g.value||g.label},g)})},_suggest:function(e){var g=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(g,e),this.menu.refresh(),g.show(),this._resizeMenu(),g.position(c.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var g=this.menu.element;g.outerWidth(Math.max(g.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(e,h){var g=this;c.each(h,function(k,m){g._renderItemData(e,m)})},_renderItemData:function(h,g){return this._renderItem(h,g).data("ui-autocomplete-item",g)},_renderItem:function(e,g){return c("<li>").append(c("<a>").text(g.label)).appendTo(e)},_move:function(h,g){if(!this.menu.element.is(":visible")){this.search(null,g);return}if(this.menu.isFirstItem()&&/^previous/.test(h)||this.menu.isLastItem()&&/^next/.test(h)){this._value(this.term),this.menu.blur();return}this.menu[h](g)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(h,g){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(h,g),g.preventDefault()}}}),c.extend(c.ui.autocomplete,{escapeRegex:function(g){return g.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(e,h){var g=new RegExp(c.ui.autocomplete.escapeRegex(h),"i");return c.grep(e,function(k){return g.test(k.label||k.value||k)})}}),c.widget("ui.autocomplete",c.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(g){return g+(g>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(h){var g;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}h&&h.length?g=this.options.messages.results(h.length):g=this.options.messages.noResults,this.liveRegion.text(g)}})})(jQuery);(function(v,z){var h,c,m,A,g="ui-button ui-widget ui-state-default ui-corner-all",y="ui-state-hover ui-state-active ",x="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",q=function(){var a=v(this).find(":ui-button");setTimeout(function(){a.button("refresh")},1)},k=function(e){var o=e.name,f=e.form,a=v([]);return o&&(f?a=v(f).find("[name='"+o+"']"):a=v("[name='"+o+"']",e.ownerDocument).filter(function(){return !this.form})),a};v.widget("ui.button",{version:"1.9.2",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,q),typeof this.options.disabled!="boolean"?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var n=this,f=this.options,e=this.type==="checkbox"||this.type==="radio",r=e?"":"ui-state-active",o="ui-state-focus";f.label===null&&(f.label=this.type==="input"?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(f.disabled){return}this===h&&v(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){if(f.disabled){return}v(this).removeClass(r)}).bind("click"+this.eventNamespace,function(a){f.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){n.buttonElement.addClass(o)}).bind("blur"+this.eventNamespace,function(){n.buttonElement.removeClass(o)}),e&&(this.element.bind("change"+this.eventNamespace,function(){if(A){return}n.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){if(f.disabled){return}A=!1,c=a.pageX,m=a.pageY}).bind("mouseup"+this.eventNamespace,function(a){if(f.disabled){return}if(c!==a.pageX||m!==a.pageY){A=!0}})),this.type==="checkbox"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(f.disabled||A){return !1}v(this).toggleClass("ui-state-active"),n.buttonElement.attr("aria-pressed",n.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click"+this.eventNamespace,function(){if(f.disabled||A){return !1}v(this).addClass("ui-state-active"),n.buttonElement.attr("aria-pressed","true");var a=n.element[0];k(a).not(a).map(function(){return v(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(f.disabled){return !1}v(this).addClass("ui-state-active"),h=this,n.document.one("mouseup",function(){h=null})}).bind("mouseup"+this.eventNamespace,function(){if(f.disabled){return !1}v(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(a){if(f.disabled){return !1}(a.keyCode===v.ui.keyCode.SPACE||a.keyCode===v.ui.keyCode.ENTER)&&v(this).addClass("ui-state-active")}).bind("keyup"+this.eventNamespace,function(){v(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(a){a.keyCode===v.ui.keyCode.SPACE&&v(this).click()})),this._setOption("disabled",f.disabled),this._resetButton()},_determineButtonType:function(){var f,a,o;this.element.is("[type=checkbox]")?this.type="checkbox":this.element.is("[type=radio]")?this.type="radio":this.element.is("input")?this.type="input":this.type="button",this.type==="checkbox"||this.type==="radio"?(f=this.element.parents().last(),a="label[for='"+this.element.attr("id")+"']",this.buttonElement=f.find(a),this.buttonElement.length||(f=f.length?f.siblings():this.element.siblings(),this.buttonElement=f.filter(a),this.buttonElement.length||(this.buttonElement=f.find(a))),this.element.addClass("ui-helper-hidden-accessible"),o=this.element.is(":checked"),o&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",o)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+y+" "+x).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(f,a){this._super(f,a);if(f==="disabled"){a?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var a=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");a!==this.options.disabled&&this._setOption("disabled",a),this.type==="radio"?k(this.element[0]).each(function(){v(this).is(":checked")?v(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):v(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var e=this.buttonElement.removeClass(x),u=v("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(e.empty()).text(),o=this.options.icons,a=o.primary&&o.secondary,f=[];o.primary||o.secondary?(this.options.text&&f.push("ui-button-text-icon"+(a?"s":o.primary?"-primary":"-secondary")),o.primary&&e.prepend("<span class='ui-button-icon-primary ui-icon "+o.primary+"'></span>"),o.secondary&&e.append("<span class='ui-button-icon-secondary ui-icon "+o.secondary+"'></span>"),this.options.text||(f.push(a?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||e.attr("title",v.trim(u)))):f.push("ui-button-text-only"),e.addClass(f.join(" "))}}),v.widget("ui.buttonset",{version:"1.9.2",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(f,a){f==="disabled"&&this.buttons.button("option",f,a),this._super(f,a)},refresh:function(){var a=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return v(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(a?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(a?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return v(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})})(jQuery);(function($,undefined){function Datepicker(){this.debug=!1,this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},$.extend(this._defaults,this.regional[""]),this.dpDiv=bindHover($('<div id="'+this._mainDivId+'" class="ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>'))}function bindHover(e){var t="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return e.delegate(t,"mouseout",function(){$(this).removeClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&$(this).removeClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&$(this).removeClass("ui-datepicker-next-hover")}).delegate(t,"mouseover",function(){$.datepicker._isDisabledDatepicker(instActive.inline?e.parent()[0]:instActive.input[0])||($(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),$(this).addClass("ui-state-hover"),this.className.indexOf("ui-datepicker-prev")!=-1&&$(this).addClass("ui-datepicker-prev-hover"),this.className.indexOf("ui-datepicker-next")!=-1&&$(this).addClass("ui-datepicker-next-hover"))})}function extendRemove(e,t){$.extend(e,t);for(var n in t){if(t[n]==null||t[n]==undefined){e[n]=t[n]}}return e}$.extend($.ui,{datepicker:{version:"1.9.2"}});var PROP_NAME="datepicker",dpuuid=(new Date).getTime(),instActive;$.extend(Datepicker.prototype,{markerClassName:"hasDatepicker",maxRows:4,log:function(){this.debug&&console.log.apply("",arguments)},_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(e){return extendRemove(this._defaults,e||{}),this},_attachDatepicker:function(target,settings){var inlineSettings=null;for(var attrName in this._defaults){var attrValue=target.getAttribute("date:"+attrName);if(attrValue){inlineSettings=inlineSettings||{};try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}}var nodeName=target.nodeName.toLowerCase(),inline=nodeName=="div"||nodeName=="span";target.id||(this.uuid+=1,target.id="dp"+this.uuid);var inst=this._newInst($(target),inline);inst.settings=$.extend({},settings||{},inlineSettings||{}),nodeName=="input"?this._connectDatepicker(target,inst):inline&&this._inlineDatepicker(target,inst)},_newInst:function(e,t){var n=e[0].id.replace(/([^A-Za-z0-9_-])/g,"\\\\$1");return{id:n,input:e,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:t,dpDiv:t?bindHover($('<div class="'+this._inlineClass+' ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>')):this.dpDiv}},_connectDatepicker:function(e,t){var n=$(e);t.append=$([]),t.trigger=$([]);if(n.hasClass(this.markerClassName)){return}this._attachments(n,t),n.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),this._autoSize(t),$.data(e,PROP_NAME,t),t.settings.disabled&&this._disableDatepicker(e)},_attachments:function(e,t){var n=this._get(t,"appendText"),r=this._get(t,"isRTL");t.append&&t.append.remove(),n&&(t.append=$('<span class="'+this._appendClass+'">'+n+"</span>"),e[r?"before":"after"](t.append)),e.unbind("focus",this._showDatepicker),t.trigger&&t.trigger.remove();var i=this._get(t,"showOn");(i=="focus"||i=="both")&&e.focus(this._showDatepicker);if(i=="button"||i=="both"){var s=this._get(t,"buttonText"),o=this._get(t,"buttonImage");t.trigger=$(this._get(t,"buttonImageOnly")?$("<img/>").addClass(this._triggerClass).attr({src:o,alt:s,title:s}):$('<button type="button"></button>').addClass(this._triggerClass).html(o==""?s:$("<img/>").attr({src:o,alt:s,title:s}))),e[r?"before":"after"](t.trigger),t.trigger.click(function(){return $.datepicker._datepickerShowing&&$.datepicker._lastInput==e[0]?$.datepicker._hideDatepicker():$.datepicker._datepickerShowing&&$.datepicker._lastInput!=e[0]?($.datepicker._hideDatepicker(),$.datepicker._showDatepicker(e[0])):$.datepicker._showDatepicker(e[0]),!1})}},_autoSize:function(e){if(this._get(e,"autoSize")&&!e.inline){var t=new Date(2009,11,20),n=this._get(e,"dateFormat");if(n.match(/[DM]/)){var r=function(e){var t=0,n=0;for(var r=0;r<e.length;r++){e[r].length>t&&(t=e[r].length,n=r)}return n};t.setMonth(r(this._get(e,n.match(/MM/)?"monthNames":"monthNamesShort"))),t.setDate(r(this._get(e,n.match(/DD/)?"dayNames":"dayNamesShort"))+20-t.getDay())}e.input.attr("size",this._formatDate(e,t).length)}},_inlineDatepicker:function(e,t){var n=$(e);if(n.hasClass(this.markerClassName)){return}n.addClass(this.markerClassName).append(t.dpDiv).bind("setData.datepicker",function(e,n,r){t.settings[n]=r}).bind("getData.datepicker",function(e,n){return this._get(t,n)}),$.data(e,PROP_NAME,t),this._setDate(t,this._getDefaultDate(t),!0),this._updateDatepicker(t),this._updateAlternate(t),t.settings.disabled&&this._disableDatepicker(e),t.dpDiv.css("display","block")},_dialogDatepicker:function(e,t,n,r,i){var s=this._dialogInst;if(!s){this.uuid+=1;var o="dp"+this.uuid;this._dialogInput=$('<input type="text" id="'+o+'" style="position: absolute; top: -100px; width: 0px;"/>'),this._dialogInput.keydown(this._doKeyDown),$("body").append(this._dialogInput),s=this._dialogInst=this._newInst(this._dialogInput,!1),s.settings={},$.data(this._dialogInput[0],PROP_NAME,s)}extendRemove(s.settings,r||{}),t=t&&t.constructor==Date?this._formatDate(s,t):t,this._dialogInput.val(t),this._pos=i?i.length?i:[i.pageX,i.pageY]:null;if(!this._pos){var u=document.documentElement.clientWidth,a=document.documentElement.clientHeight,f=document.documentElement.scrollLeft||document.body.scrollLeft,l=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[u/2-100+f,a/2-150+l]}return this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),s.settings.onSelect=n,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),$.blockUI&&$.blockUI(this.dpDiv),$.data(this._dialogInput[0],PROP_NAME,s),this},_destroyDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName)){return}var r=e.nodeName.toLowerCase();$.removeData(e,PROP_NAME),r=="input"?(n.append.remove(),n.trigger.remove(),t.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):(r=="div"||r=="span")&&t.removeClass(this.markerClassName).empty()},_enableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName)){return}var r=e.nodeName.toLowerCase();if(r=="input"){e.disabled=!1,n.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().removeClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)}}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t})},_disableDatepicker:function(e){var t=$(e),n=$.data(e,PROP_NAME);if(!t.hasClass(this.markerClassName)){return}var r=e.nodeName.toLowerCase();if(r=="input"){e.disabled=!0,n.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(r=="div"||r=="span"){var i=t.children("."+this._inlineClass);i.children().addClass("ui-state-disabled"),i.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)}}this._disabledInputs=$.map(this._disabledInputs,function(t){return t==e?null:t}),this._disabledInputs[this._disabledInputs.length]=e},_isDisabledDatepicker:function(e){if(!e){return !1}for(var t=0;t<this._disabledInputs.length;t++){if(this._disabledInputs[t]==e){return !0}}return !1},_getInst:function(e){try{return $.data(e,PROP_NAME)}catch(t){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(e,t,n){var r=this._getInst(e);if(arguments.length==2&&typeof t=="string"){return t=="defaults"?$.extend({},$.datepicker._defaults):r?t=="all"?$.extend({},r.settings):this._get(r,t):null}var i=t||{};typeof t=="string"&&(i={},i[t]=n);if(r){this._curInst==r&&this._hideDatepicker();var s=this._getDateDatepicker(e,!0),o=this._getMinMaxDate(r,"min"),u=this._getMinMaxDate(r,"max");extendRemove(r.settings,i),o!==null&&i.dateFormat!==undefined&&i.minDate===undefined&&(r.settings.minDate=this._formatDate(r,o)),u!==null&&i.dateFormat!==undefined&&i.maxDate===undefined&&(r.settings.maxDate=this._formatDate(r,u)),this._attachments($(e),r),this._autoSize(r),this._setDate(r,s),this._updateAlternate(r),this._updateDatepicker(r)}},_changeDatepicker:function(e,t,n){this._optionDatepicker(e,t,n)},_refreshDatepicker:function(e){var t=this._getInst(e);t&&this._updateDatepicker(t)},_setDateDatepicker:function(e,t){var n=this._getInst(e);n&&(this._setDate(n,t),this._updateDatepicker(n),this._updateAlternate(n))},_getDateDatepicker:function(e,t){var n=this._getInst(e);return n&&!n.inline&&this._setDateFromField(n,t),n?this._getDate(n):null},_doKeyDown:function(e){var t=$.datepicker._getInst(e.target),n=!0,r=t.dpDiv.is(".ui-datepicker-rtl");t._keyEvent=!0;if($.datepicker._datepickerShowing){switch(e.keyCode){case 9:$.datepicker._hideDatepicker(),n=!1;break;case 13:var i=$("td."+$.datepicker._dayOverClass+":not(."+$.datepicker._currentClass+")",t.dpDiv);i[0]&&$.datepicker._selectDay(e.target,t.selectedMonth,t.selectedYear,i[0]);var s=$.datepicker._get(t,"onSelect");if(s){var o=$.datepicker._formatDate(t);s.apply(t.input?t.input[0]:null,[o,t])}else{$.datepicker._hideDatepicker()}return !1;case 27:$.datepicker._hideDatepicker();break;case 33:$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 34:$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 35:(e.ctrlKey||e.metaKey)&&$.datepicker._clearDate(e.target),n=e.ctrlKey||e.metaKey;break;case 36:(e.ctrlKey||e.metaKey)&&$.datepicker._gotoToday(e.target),n=e.ctrlKey||e.metaKey;break;case 37:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?1:-1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?-$.datepicker._get(t,"stepBigMonths"):-$.datepicker._get(t,"stepMonths"),"M");break;case 38:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,-7,"D"),n=e.ctrlKey||e.metaKey;break;case 39:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,r?-1:1,"D"),n=e.ctrlKey||e.metaKey,e.originalEvent.altKey&&$.datepicker._adjustDate(e.target,e.ctrlKey?+$.datepicker._get(t,"stepBigMonths"):+$.datepicker._get(t,"stepMonths"),"M");break;case 40:(e.ctrlKey||e.metaKey)&&$.datepicker._adjustDate(e.target,7,"D"),n=e.ctrlKey||e.metaKey;break;default:n=!1}}else{e.keyCode==36&&e.ctrlKey?$.datepicker._showDatepicker(this):n=!1}n&&(e.preventDefault(),e.stopPropagation())},_doKeyPress:function(e){var t=$.datepicker._getInst(e.target);if($.datepicker._get(t,"constrainInput")){var n=$.datepicker._possibleChars($.datepicker._get(t,"dateFormat")),r=String.fromCharCode(e.charCode==undefined?e.keyCode:e.charCode);return e.ctrlKey||e.metaKey||r<" "||!n||n.indexOf(r)>-1}},_doKeyUp:function(e){var t=$.datepicker._getInst(e.target);if(t.input.val()!=t.lastVal){try{var n=$.datepicker.parseDate($.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,$.datepicker._getFormatConfig(t));n&&($.datepicker._setDateFromField(t),$.datepicker._updateAlternate(t),$.datepicker._updateDatepicker(t))}catch(r){$.datepicker.log(r)}}return !0},_showDatepicker:function(e){e=e.target||e,e.nodeName.toLowerCase()!="input"&&(e=$("input",e.parentNode)[0]);if($.datepicker._isDisabledDatepicker(e)||$.datepicker._lastInput==e){return}var t=$.datepicker._getInst(e);$.datepicker._curInst&&$.datepicker._curInst!=t&&($.datepicker._curInst.dpDiv.stop(!0,!0),t&&$.datepicker._datepickerShowing&&$.datepicker._hideDatepicker($.datepicker._curInst.input[0]));var n=$.datepicker._get(t,"beforeShow"),r=n?n.apply(e,[e,t]):{};if(r===!1){return}extendRemove(t.settings,r),t.lastVal=null,$.datepicker._lastInput=e,$.datepicker._setDateFromField(t),$.datepicker._inDialog&&(e.value=""),$.datepicker._pos||($.datepicker._pos=$.datepicker._findPos(e),$.datepicker._pos[1]+=e.offsetHeight);var i=!1;$(e).parents().each(function(){return i|=$(this).css("position")=="fixed",!i});var s={left:$.datepicker._pos[0],top:$.datepicker._pos[1]};$.datepicker._pos=null,t.dpDiv.empty(),t.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),$.datepicker._updateDatepicker(t),s=$.datepicker._checkOffset(t,s,i),t.dpDiv.css({position:$.datepicker._inDialog&&$.blockUI?"static":i?"fixed":"absolute",display:"none",left:s.left+"px",top:s.top+"px"});if(!t.inline){var o=$.datepicker._get(t,"showAnim"),u=$.datepicker._get(t,"duration"),a=function(){var e=t.dpDiv.find("iframe.ui-datepicker-cover");if(!!e.length){var n=$.datepicker._getBorders(t.dpDiv);e.css({left:-n[0],top:-n[1],width:t.dpDiv.outerWidth(),height:t.dpDiv.outerHeight()})}};t.dpDiv.zIndex($(e).zIndex()+1),$.datepicker._datepickerShowing=!0,$.effects&&($.effects.effect[o]||$.effects[o])?t.dpDiv.show(o,$.datepicker._get(t,"showOptions"),u,a):t.dpDiv[o||"show"](o?u:null,a),(!o||!u)&&a(),t.input.is(":visible")&&!t.input.is(":disabled")&&t.input.focus(),$.datepicker._curInst=t}},_updateDatepicker:function(e){this.maxRows=4;var t=$.datepicker._getBorders(e.dpDiv);instActive=e,e.dpDiv.empty().append(this._generateHTML(e)),this._attachHandlers(e);var n=e.dpDiv.find("iframe.ui-datepicker-cover");!n.length||n.css({left:-t[0],top:-t[1],width:e.dpDiv.outerWidth(),height:e.dpDiv.outerHeight()}),e.dpDiv.find("."+this._dayOverClass+" a").mouseover();var r=this._getNumberOfMonths(e),i=r[1],s=17;e.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),i>1&&e.dpDiv.addClass("ui-datepicker-multi-"+i).css("width",s*i+"em"),e.dpDiv[(r[0]!=1||r[1]!=1?"add":"remove")+"Class"]("ui-datepicker-multi"),e.dpDiv[(this._get(e,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),e==$.datepicker._curInst&&$.datepicker._datepickerShowing&&e.input&&e.input.is(":visible")&&!e.input.is(":disabled")&&e.input[0]!=document.activeElement&&e.input.focus();if(e.yearshtml){var o=e.yearshtml;setTimeout(function(){o===e.yearshtml&&e.yearshtml&&e.dpDiv.find("select.ui-datepicker-year:first").replaceWith(e.yearshtml),o=e.yearshtml=null},0)}},_getBorders:function(e){var t=function(e){return{thin:1,medium:2,thick:3}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,n){var r=e.dpDiv.outerWidth(),i=e.dpDiv.outerHeight(),s=e.input?e.input.outerWidth():0,o=e.input?e.input.outerHeight():0,u=document.documentElement.clientWidth+(n?0:$(document).scrollLeft()),a=document.documentElement.clientHeight+(n?0:$(document).scrollTop());return t.left-=this._get(e,"isRTL")?r-s:0,t.left-=n&&t.left==e.input.offset().left?$(document).scrollLeft():0,t.top-=n&&t.top==e.input.offset().top+o?$(document).scrollTop():0,t.left-=Math.min(t.left,t.left+r>u&&u>r?Math.abs(t.left+r-u):0),t.top-=Math.min(t.top,t.top+i>a&&a>i?Math.abs(i+o):0),t},_findPos:function(e){var t=this._getInst(e),n=this._get(t,"isRTL");while(e&&(e.type=="hidden"||e.nodeType!=1||$.expr.filters.hidden(e))){e=e[n?"previousSibling":"nextSibling"]}var r=$(e).offset();return[r.left,r.top]},_hideDatepicker:function(e){var t=this._curInst;if(!t||e&&t!=$.data(e,PROP_NAME)){return}if(this._datepickerShowing){var n=this._get(t,"showAnim"),r=this._get(t,"duration"),i=function(){$.datepicker._tidyDialog(t)};$.effects&&($.effects.effect[n]||$.effects[n])?t.dpDiv.hide(n,$.datepicker._get(t,"showOptions"),r,i):t.dpDiv[n=="slideDown"?"slideUp":n=="fadeIn"?"fadeOut":"hide"](n?r:null,i),n||i(),this._datepickerShowing=!1;var s=this._get(t,"onClose");s&&s.apply(t.input?t.input[0]:null,[t.input?t.input.val():"",t]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),$.blockUI&&($.unblockUI(),$("body").append(this.dpDiv))),this._inDialog=!1}},_tidyDialog:function(e){e.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(e){if(!$.datepicker._curInst){return}var t=$(e.target),n=$.datepicker._getInst(t[0]);(t[0].id!=$.datepicker._mainDivId&&t.parents("#"+$.datepicker._mainDivId).length==0&&!t.hasClass($.datepicker.markerClassName)&&!t.closest("."+$.datepicker._triggerClass).length&&$.datepicker._datepickerShowing&&(!$.datepicker._inDialog||!$.blockUI)||t.hasClass($.datepicker.markerClassName)&&$.datepicker._curInst!=n)&&$.datepicker._hideDatepicker()},_adjustDate:function(e,t,n){var r=$(e),i=this._getInst(r[0]);if(this._isDisabledDatepicker(r[0])){return}this._adjustInstDate(i,t+(n=="M"?this._get(i,"showCurrentAtPos"):0),n),this._updateDatepicker(i)},_gotoToday:function(e){var t=$(e),n=this._getInst(t[0]);if(this._get(n,"gotoCurrent")&&n.currentDay){n.selectedDay=n.currentDay,n.drawMonth=n.selectedMonth=n.currentMonth,n.drawYear=n.selectedYear=n.currentYear}else{var r=new Date;n.selectedDay=r.getDate(),n.drawMonth=n.selectedMonth=r.getMonth(),n.drawYear=n.selectedYear=r.getFullYear()}this._notifyChange(n),this._adjustDate(t)},_selectMonthYear:function(e,t,n){var r=$(e),i=this._getInst(r[0]);i["selected"+(n=="M"?"Month":"Year")]=i["draw"+(n=="M"?"Month":"Year")]=parseInt(t.options[t.selectedIndex].value,10),this._notifyChange(i),this._adjustDate(r)},_selectDay:function(e,t,n,r){var i=$(e);if($(r).hasClass(this._unselectableClass)||this._isDisabledDatepicker(i[0])){return}var s=this._getInst(i[0]);s.selectedDay=s.currentDay=$("a",r).html(),s.selectedMonth=s.currentMonth=t,s.selectedYear=s.currentYear=n,this._selectDate(e,this._formatDate(s,s.currentDay,s.currentMonth,s.currentYear))},_clearDate:function(e){var t=$(e),n=this._getInst(t[0]);this._selectDate(t,"")},_selectDate:function(e,t){var n=$(e),r=this._getInst(n[0]);t=t!=null?t:this._formatDate(r),r.input&&r.input.val(t),this._updateAlternate(r);var i=this._get(r,"onSelect");i?i.apply(r.input?r.input[0]:null,[t,r]):r.input&&r.input.trigger("change"),r.inline?this._updateDatepicker(r):(this._hideDatepicker(),this._lastInput=r.input[0],typeof r.input[0]!="object"&&r.input.focus(),this._lastInput=null)},_updateAlternate:function(e){var t=this._get(e,"altField");if(t){var n=this._get(e,"altFormat")||this._get(e,"dateFormat"),r=this._getDate(e),i=this.formatDate(n,r,this._getFormatConfig(e));$(t).each(function(){$(this).val(i)})}},noWeekends:function(e){var t=e.getDay();return[t>0&&t<6,""]},iso8601Week:function(e){var t=new Date(e.getTime());t.setDate(t.getDate()+4-(t.getDay()||7));var n=t.getTime();return t.setMonth(0),t.setDate(1),Math.floor(Math.round((n-t)/86400000)/7)+1},parseDate:function(e,t,n){if(e==null||t==null){throw"Invalid arguments"}t=typeof t=="object"?t.toString():t+"";if(t==""){return null}var r=(n?n.shortYearCutoff:null)||this._defaults.shortYearCutoff;r=typeof r!="string"?r:(new Date).getFullYear()%100+parseInt(r,10);var i=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,s=(n?n.dayNames:null)||this._defaults.dayNames,o=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,u=(n?n.monthNames:null)||this._defaults.monthNames,a=-1,f=-1,l=-1,c=-1,h=!1,p=function(t){var n=y+1<e.length&&e.charAt(y+1)==t;return n&&y++,n},d=function(e){var n=p(e),r=e=="@"?14:e=="!"?20:e=="y"&&n?4:e=="o"?3:2,i=new RegExp("^\\d{1,"+r+"}"),s=t.substring(g).match(i);if(!s){throw"Missing number at position "+g}return g+=s[0].length,parseInt(s[0],10)},v=function(e,n,r){var i=$.map(p(e)?r:n,function(e,t){return[[t,e]]}).sort(function(e,t){return -(e[1].length-t[1].length)}),s=-1;$.each(i,function(e,n){var r=n[1];if(t.substr(g,r.length).toLowerCase()==r.toLowerCase()){return s=n[0],g+=r.length,!1}});if(s!=-1){return s+1}throw"Unknown name at position "+g},m=function(){if(t.charAt(g)!=e.charAt(y)){throw"Unexpected literal at position "+g}g++},g=0;for(var y=0;y<e.length;y++){if(h){e.charAt(y)=="'"&&!p("'")?h=!1:m()}else{switch(e.charAt(y)){case"d":l=d("d");break;case"D":v("D",i,s);break;case"o":c=d("o");break;case"m":f=d("m");break;case"M":f=v("M",o,u);break;case"y":a=d("y");break;case"@":var b=new Date(d("@"));a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"!":var b=new Date((d("!")-this._ticksTo1970)/10000);a=b.getFullYear(),f=b.getMonth()+1,l=b.getDate();break;case"'":p("'")?m():h=!0;break;default:m()}}}if(g<t.length){var w=t.substr(g);if(!/^\s+/.test(w)){throw"Extra/unparsed characters found in date: "+w}}a==-1?a=(new Date).getFullYear():a<100&&(a+=(new Date).getFullYear()-(new Date).getFullYear()%100+(a<=r?0:-100));if(c>-1){f=1,l=c;do{var E=this._getDaysInMonth(a,f-1);if(l<=E){break}f++,l-=E}while(!0)}var b=this._daylightSavingAdjust(new Date(a,f-1,l));if(b.getFullYear()!=a||b.getMonth()+1!=f||b.getDate()!=l){throw"Invalid date"}return b},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925))*24*60*60*10000000,formatDate:function(e,t,n){if(!t){return""}var r=(n?n.dayNamesShort:null)||this._defaults.dayNamesShort,i=(n?n.dayNames:null)||this._defaults.dayNames,s=(n?n.monthNamesShort:null)||this._defaults.monthNamesShort,o=(n?n.monthNames:null)||this._defaults.monthNames,u=function(t){var n=h+1<e.length&&e.charAt(h+1)==t;return n&&h++,n},a=function(e,t,n){var r=""+t;if(u(e)){while(r.length<n){r="0"+r}}return r},f=function(e,t,n,r){return u(e)?r[t]:n[t]},l="",c=!1;if(t){for(var h=0;h<e.length;h++){if(c){e.charAt(h)=="'"&&!u("'")?c=!1:l+=e.charAt(h)}else{switch(e.charAt(h)){case"d":l+=a("d",t.getDate(),2);break;case"D":l+=f("D",t.getDay(),r,i);break;case"o":l+=a("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/86400000),3);break;case"m":l+=a("m",t.getMonth()+1,2);break;case"M":l+=f("M",t.getMonth(),s,o);break;case"y":l+=u("y")?t.getFullYear():(t.getYear()%100<10?"0":"")+t.getYear()%100;break;case"@":l+=t.getTime();break;case"!":l+=t.getTime()*10000+this._ticksTo1970;break;case"'":u("'")?l+="'":c=!0;break;default:l+=e.charAt(h)}}}}return l},_possibleChars:function(e){var t="",n=!1,r=function(t){var n=i+1<e.length&&e.charAt(i+1)==t;return n&&i++,n};for(var i=0;i<e.length;i++){if(n){e.charAt(i)=="'"&&!r("'")?n=!1:t+=e.charAt(i)}else{switch(e.charAt(i)){case"d":case"m":case"y":case"@":t+="0123456789";break;case"D":case"M":return null;case"'":r("'")?t+="'":n=!0;break;default:t+=e.charAt(i)}}}return t},_get:function(e,t){return e.settings[t]!==undefined?e.settings[t]:this._defaults[t]},_setDateFromField:function(e,t){if(e.input.val()==e.lastVal){return}var n=this._get(e,"dateFormat"),r=e.lastVal=e.input?e.input.val():null,i,s;i=s=this._getDefaultDate(e);var o=this._getFormatConfig(e);try{i=this.parseDate(n,r,o)||s}catch(u){this.log(u),r=t?"":r}e.selectedDay=i.getDate(),e.drawMonth=e.selectedMonth=i.getMonth(),e.drawYear=e.selectedYear=i.getFullYear(),e.currentDay=r?i.getDate():0,e.currentMonth=r?i.getMonth():0,e.currentYear=r?i.getFullYear():0,this._adjustInstDate(e)},_getDefaultDate:function(e){return this._restrictMinMax(e,this._determineDate(e,this._get(e,"defaultDate"),new Date))},_determineDate:function(e,t,n){var r=function(e){var t=new Date;return t.setDate(t.getDate()+e),t},i=function(t){try{return $.datepicker.parseDate($.datepicker._get(e,"dateFormat"),t,$.datepicker._getFormatConfig(e))}catch(n){}var r=(t.toLowerCase().match(/^c/)?$.datepicker._getDate(e):null)||new Date,i=r.getFullYear(),s=r.getMonth(),o=r.getDate(),u=/([+-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=u.exec(t);while(a){switch(a[2]||"d"){case"d":case"D":o+=parseInt(a[1],10);break;case"w":case"W":o+=parseInt(a[1],10)*7;break;case"m":case"M":s+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s));break;case"y":case"Y":i+=parseInt(a[1],10),o=Math.min(o,$.datepicker._getDaysInMonth(i,s))}a=u.exec(t)}return new Date(i,s,o)},s=t==null||t===""?n:typeof t=="string"?i(t):typeof t=="number"?isNaN(t)?n:r(t):new Date(t.getTime());return s=s&&s.toString()=="Invalid Date"?n:s,s&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(e){return e?(e.setHours(e.getHours()>12?e.getHours()+2:0),e):null},_setDate:function(e,t,n){var r=!t,i=e.selectedMonth,s=e.selectedYear,o=this._restrictMinMax(e,this._determineDate(e,t,new Date));e.selectedDay=e.currentDay=o.getDate(),e.drawMonth=e.selectedMonth=e.currentMonth=o.getMonth(),e.drawYear=e.selectedYear=e.currentYear=o.getFullYear(),(i!=e.selectedMonth||s!=e.selectedYear)&&!n&&this._notifyChange(e),this._adjustInstDate(e),e.input&&e.input.val(r?"":this._formatDate(e))},_getDate:function(e){var t=!e.currentYear||e.input&&e.input.val()==""?null:this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return t},_attachHandlers:function(e){var t=this._get(e,"stepMonths"),n="#"+e.id.replace(/\\\\/g,"\\");e.dpDiv.find("[data-handler]").map(function(){var e={prev:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,-t,"M")},next:function(){window["DP_jQuery_"+dpuuid].datepicker._adjustDate(n,+t,"M")},hide:function(){window["DP_jQuery_"+dpuuid].datepicker._hideDatepicker()},today:function(){window["DP_jQuery_"+dpuuid].datepicker._gotoToday(n)},selectDay:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectDay(n,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"M"),!1},selectYear:function(){return window["DP_jQuery_"+dpuuid].datepicker._selectMonthYear(n,this,"Y"),!1}};$(this).bind(this.getAttribute("data-event"),e[this.getAttribute("data-handler")])})},_generateHTML:function(e){var t=new Date;t=this._daylightSavingAdjust(new Date(t.getFullYear(),t.getMonth(),t.getDate()));var n=this._get(e,"isRTL"),r=this._get(e,"showButtonPanel"),i=this._get(e,"hideIfNoPrevNext"),s=this._get(e,"navigationAsDateFormat"),o=this._getNumberOfMonths(e),u=this._get(e,"showCurrentAtPos"),a=this._get(e,"stepMonths"),f=o[0]!=1||o[1]!=1,l=this._daylightSavingAdjust(e.currentDay?new Date(e.currentYear,e.currentMonth,e.currentDay):new Date(9999,9,9)),c=this._getMinMaxDate(e,"min"),h=this._getMinMaxDate(e,"max"),p=e.drawMonth-u,d=e.drawYear;p<0&&(p+=12,d--);if(h){var v=this._daylightSavingAdjust(new Date(h.getFullYear(),h.getMonth()-o[0]*o[1]+1,h.getDate()));v=c&&v<c?c:v;while(this._daylightSavingAdjust(new Date(d,p,1))>v){p--,p<0&&(p=11,d--)}}e.drawMonth=p,e.drawYear=d;var m=this._get(e,"prevText");m=s?this.formatDate(m,this._daylightSavingAdjust(new Date(d,p-a,1)),this._getFormatConfig(e)):m;var g=this._canAdjustMonth(e,-1,d,p)?'<a class="ui-datepicker-prev ui-corner-all" data-handler="prev" data-event="click" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>":i?"":'<a class="ui-datepicker-prev ui-corner-all ui-state-disabled" title="'+m+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"e":"w")+'">'+m+"</span></a>",y=this._get(e,"nextText");y=s?this.formatDate(y,this._daylightSavingAdjust(new Date(d,p+a,1)),this._getFormatConfig(e)):y;var b=this._canAdjustMonth(e,1,d,p)?'<a class="ui-datepicker-next ui-corner-all" data-handler="next" data-event="click" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>":i?"":'<a class="ui-datepicker-next ui-corner-all ui-state-disabled" title="'+y+'"><span class="ui-icon ui-icon-circle-triangle-'+(n?"w":"e")+'">'+y+"</span></a>",w=this._get(e,"currentText"),E=this._get(e,"gotoCurrent")&&e.currentDay?l:t;w=s?this.formatDate(w,E,this._getFormatConfig(e)):w;var S=e.inline?"":'<button type="button" class="ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all" data-handler="hide" data-event="click">'+this._get(e,"closeText")+"</button>",x=r?'<div class="ui-datepicker-buttonpane ui-widget-content">'+(n?S:"")+(this._isInRange(e,E)?'<button type="button" class="ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all" data-handler="today" data-event="click">'+w+"</button>":"")+(n?"":S)+"</div>":"",T=parseInt(this._get(e,"firstDay"),10);T=isNaN(T)?0:T;var N=this._get(e,"showWeek"),C=this._get(e,"dayNames"),k=this._get(e,"dayNamesShort"),L=this._get(e,"dayNamesMin"),A=this._get(e,"monthNames"),O=this._get(e,"monthNamesShort"),M=this._get(e,"beforeShowDay"),_=this._get(e,"showOtherMonths"),D=this._get(e,"selectOtherMonths"),P=this._get(e,"calculateWeek")||this.iso8601Week,H=this._getDefaultDate(e),B="";for(var j=0;j<o[0];j++){var F="";this.maxRows=4;for(var I=0;I<o[1];I++){var q=this._daylightSavingAdjust(new Date(d,p,e.selectedDay)),R=" ui-corner-all",U="";if(f){U+='<div class="ui-datepicker-group';if(o[1]>1){switch(I){case 0:U+=" ui-datepicker-group-first",R=" ui-corner-"+(n?"right":"left");break;case o[1]-1:U+=" ui-datepicker-group-last",R=" ui-corner-"+(n?"left":"right");break;default:U+=" ui-datepicker-group-middle",R=""}}U+='">'}U+='<div class="ui-datepicker-header ui-widget-header ui-helper-clearfix'+R+'">'+(/all|left/.test(R)&&j==0?n?b:g:"")+(/all|right/.test(R)&&j==0?n?g:b:"")+this._generateMonthYearHeader(e,p,d,c,h,j>0||I>0,A,O)+'</div><table class="ui-datepicker-calendar"><thead><tr>';var z=N?'<th class="ui-datepicker-week-col">'+this._get(e,"weekHeader")+"</th>":"";for(var W=0;W<7;W++){var X=(W+T)%7;z+="<th"+((W+T+6)%7>=5?' class="ui-datepicker-week-end"':"")+'><span title="'+C[X]+'">'+L[X]+"</span></th>"}U+=z+"</tr></thead><tbody>";var V=this._getDaysInMonth(d,p);d==e.selectedYear&&p==e.selectedMonth&&(e.selectedDay=Math.min(e.selectedDay,V));var J=(this._getFirstDayOfMonth(d,p)-T+7)%7,K=Math.ceil((J+V)/7),Q=f?this.maxRows>K?this.maxRows:K:K;this.maxRows=Q;var G=this._daylightSavingAdjust(new Date(d,p,1-J));for(var Y=0;Y<Q;Y++){U+="<tr>";var Z=N?'<td class="ui-datepicker-week-col">'+this._get(e,"calculateWeek")(G)+"</td>":"";for(var W=0;W<7;W++){var et=M?M.apply(e.input?e.input[0]:null,[G]):[!0,""],tt=G.getMonth()!=p,nt=tt&&!D||!et[0]||c&&G<c||h&&G>h;Z+='<td class="'+((W+T+6)%7>=5?" ui-datepicker-week-end":"")+(tt?" ui-datepicker-other-month":"")+(G.getTime()==q.getTime()&&p==e.selectedMonth&&e._keyEvent||H.getTime()==G.getTime()&&H.getTime()==q.getTime()?" "+this._dayOverClass:"")+(nt?" "+this._unselectableClass+" ui-state-disabled":"")+(tt&&!_?"":" "+et[1]+(G.getTime()==l.getTime()?" "+this._currentClass:"")+(G.getTime()==t.getTime()?" ui-datepicker-today":""))+'"'+((!tt||_)&&et[2]?' title="'+et[2]+'"':"")+(nt?"":' data-handler="selectDay" data-event="click" data-month="'+G.getMonth()+'" data-year="'+G.getFullYear()+'"')+">"+(tt&&!_?"&#xa0;":nt?'<span class="ui-state-default">'+G.getDate()+"</span>":'<a class="ui-state-default'+(G.getTime()==t.getTime()?" ui-state-highlight":"")+(G.getTime()==l.getTime()?" ui-state-active":"")+(tt?" ui-priority-secondary":"")+'" href="#">'+G.getDate()+"</a>")+"</td>",G.setDate(G.getDate()+1),G=this._daylightSavingAdjust(G)}U+=Z+"</tr>"}p++,p>11&&(p=0,d++),U+="</tbody></table>"+(f?"</div>"+(o[0]>0&&I==o[1]-1?'<div class="ui-datepicker-row-break"></div>':""):""),F+=U}B+=F}return B+=x+($.ui.ie6&&!e.inline?'<iframe src="javascript:false;" class="ui-datepicker-cover" frameborder="0"></iframe>':""),e._keyEvent=!1,B},_generateMonthYearHeader:function(e,t,n,r,i,s,o,u){var a=this._get(e,"changeMonth"),f=this._get(e,"changeYear"),l=this._get(e,"showMonthAfterYear"),c='<div class="ui-datepicker-title">',h="";if(s||!a){h+='<span class="ui-datepicker-month">'+o[t]+"</span>"}else{var p=r&&r.getFullYear()==n,d=i&&i.getFullYear()==n;h+='<select class="ui-datepicker-month" data-handler="selectMonth" data-event="change">';for(var v=0;v<12;v++){(!p||v>=r.getMonth())&&(!d||v<=i.getMonth())&&(h+='<option value="'+v+'"'+(v==t?' selected="selected"':"")+">"+u[v]+"</option>")}h+="</select>"}l||(c+=h+(s||!a||!f?"&#xa0;":""));if(!e.yearshtml){e.yearshtml="";if(s||!f){c+='<span class="ui-datepicker-year">'+n+"</span>"}else{var m=this._get(e,"yearRange").split(":"),g=(new Date).getFullYear(),y=function(e){var t=e.match(/c[+-].*/)?n+parseInt(e.substring(1),10):e.match(/[+-].*/)?g+parseInt(e,10):parseInt(e,10);return isNaN(t)?g:t},b=y(m[0]),w=Math.max(b,y(m[1]||""));b=r?Math.max(b,r.getFullYear()):b,w=i?Math.min(w,i.getFullYear()):w,e.yearshtml+='<select class="ui-datepicker-year" data-handler="selectYear" data-event="change">';for(;b<=w;b++){e.yearshtml+='<option value="'+b+'"'+(b==n?' selected="selected"':"")+">"+b+"</option>"}e.yearshtml+="</select>",c+=e.yearshtml,e.yearshtml=null}}return c+=this._get(e,"yearSuffix"),l&&(c+=(s||!a||!f?"&#xa0;":"")+h),c+="</div>",c},_adjustInstDate:function(e,t,n){var r=e.drawYear+(n=="Y"?t:0),i=e.drawMonth+(n=="M"?t:0),s=Math.min(e.selectedDay,this._getDaysInMonth(r,i))+(n=="D"?t:0),o=this._restrictMinMax(e,this._daylightSavingAdjust(new Date(r,i,s)));e.selectedDay=o.getDate(),e.drawMonth=e.selectedMonth=o.getMonth(),e.drawYear=e.selectedYear=o.getFullYear(),(n=="M"||n=="Y")&&this._notifyChange(e)},_restrictMinMax:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max"),i=n&&t<n?n:t;return i=r&&i>r?r:i,i},_notifyChange:function(e){var t=this._get(e,"onChangeMonthYear");t&&t.apply(e.input?e.input[0]:null,[e.selectedYear,e.selectedMonth+1,e])},_getNumberOfMonths:function(e){var t=this._get(e,"numberOfMonths");return t==null?[1,1]:typeof t=="number"?[1,t]:t},_getMinMaxDate:function(e,t){return this._determineDate(e,this._get(e,t+"Date"),null)},_getDaysInMonth:function(e,t){return 32-this._daylightSavingAdjust(new Date(e,t,32)).getDate()},_getFirstDayOfMonth:function(e,t){return(new Date(e,t,1)).getDay()},_canAdjustMonth:function(e,t,n,r){var i=this._getNumberOfMonths(e),s=this._daylightSavingAdjust(new Date(n,r+(t<0?t:i[0]*i[1]),1));return t<0&&s.setDate(this._getDaysInMonth(s.getFullYear(),s.getMonth())),this._isInRange(e,s)},_isInRange:function(e,t){var n=this._getMinMaxDate(e,"min"),r=this._getMinMaxDate(e,"max");return(!n||t.getTime()>=n.getTime())&&(!r||t.getTime()<=r.getTime())},_getFormatConfig:function(e){var t=this._get(e,"shortYearCutoff");return t=typeof t!="string"?t:(new Date).getFullYear()%100+parseInt(t,10),{shortYearCutoff:t,dayNamesShort:this._get(e,"dayNamesShort"),dayNames:this._get(e,"dayNames"),monthNamesShort:this._get(e,"monthNamesShort"),monthNames:this._get(e,"monthNames")}},_formatDate:function(e,t,n,r){t||(e.currentDay=e.selectedDay,e.currentMonth=e.selectedMonth,e.currentYear=e.selectedYear);var i=t?typeof t=="object"?t:this._daylightSavingAdjust(new Date(r,n,t)):this._daylightSavingAdjust(new Date(e.currentYear,e.currentMonth,e.currentDay));return this.formatDate(this._get(e,"dateFormat"),i,this._getFormatConfig(e))}}),$.fn.datepicker=function(e){if(!this.length){return this}$.datepicker.initialized||($(document).mousedown($.datepicker._checkExternalClick).find(document.body).append($.datepicker.dpDiv),$.datepicker.initialized=!0);var t=Array.prototype.slice.call(arguments,1);return typeof e!="string"||e!="isDisabled"&&e!="getDate"&&e!="widget"?e=="option"&&arguments.length==2&&typeof arguments[1]=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t)):this.each(function(){typeof e=="string"?$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this].concat(t)):$.datepicker._attachDatepicker(this,e)}):$.datepicker["_"+e+"Datepicker"].apply($.datepicker,[this[0]].concat(t))},$.datepicker=new Datepicker,$.datepicker.initialized=!1,$.datepicker.uuid=(new Date).getTime(),$.datepicker.version="1.9.2",window["DP_jQuery_"+dpuuid]=$})(jQuery);(function(g,c){var h="ui-dialog ui-widget ui-widget-content ui-corner-all ",f={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},a={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};g.widget("ui.dialog",{version:"1.9.2",options:{autoOpen:!0,buttons:{},closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:!1,maxWidth:!1,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(e){var k=g(this).css(e).offset().top;k<0&&g(this).css("top",e.top-k)}},resizable:!0,show:null,stack:!0,title:"",width:300,zIndex:1000},_create:function(){this.originalTitle=this.element.attr("title"),typeof this.originalTitle!="string"&&(this.originalTitle=""),this.oldPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.options.title=this.options.title||this.originalTitle;var n=this,v=this.options,m=v.title||"&#160;",q,y,k,e,x;q=(this.uiDialog=g("<div>")).addClass(h+v.dialogClass).css({display:"none",outline:0,zIndex:v.zIndex}).attr("tabIndex",-1).keydown(function(o){v.closeOnEscape&&!o.isDefaultPrevented()&&o.keyCode&&o.keyCode===g.ui.keyCode.ESCAPE&&(n.close(o),o.preventDefault())}).mousedown(function(o){n.moveToTop(!1,o)}).appendTo("body"),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(q),y=(this.uiDialogTitlebar=g("<div>")).addClass("ui-dialog-titlebar  ui-widget-header  ui-corner-all  ui-helper-clearfix").bind("mousedown",function(){q.focus()}).prependTo(q),k=g("<a href='#'></a>").addClass("ui-dialog-titlebar-close  ui-corner-all").attr("role","button").click(function(o){o.preventDefault(),n.close(o)}).appendTo(y),(this.uiDialogTitlebarCloseText=g("<span>")).addClass("ui-icon ui-icon-closethick").text(v.closeText).appendTo(k),e=g("<span>").uniqueId().addClass("ui-dialog-title").html(m).prependTo(y),x=(this.uiDialogButtonPane=g("<div>")).addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),(this.uiButtonSet=g("<div>")).addClass("ui-dialog-buttonset").appendTo(x),q.attr({role:"dialog","aria-labelledby":e.attr("id")}),y.find("*").add(y).disableSelection(),this._hoverable(k),this._focusable(k),v.draggable&&g.fn.draggable&&this._makeDraggable(),v.resizable&&g.fn.resizable&&this._makeResizable(),this._createButtons(v.buttons),this._isOpen=!1,g.fn.bgiframe&&q.bgiframe(),this._on(q,{keydown:function(u){if(!v.modal||u.keyCode!==g.ui.keyCode.TAB){return}var A=g(":tabbable",q),r=A.filter(":first"),z=A.filter(":last");if(u.target===z[0]&&!u.shiftKey){return r.focus(1),!1}if(u.target===r[0]&&u.shiftKey){return z.focus(1),!1}}})},_init:function(){this.options.autoOpen&&this.open()},_destroy:function(){var m,k=this.oldPosition;this.overlay&&this.overlay.destroy(),this.uiDialog.hide(),this.element.removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),m=k.parent.children().eq(k.index),m.length&&m[0]!==this.element[0]?m.before(this.element):k.parent.append(this.element)},widget:function(){return this.uiDialog},close:function(k){var o=this,m,e;if(!this._isOpen){return}if(!1===this._trigger("beforeClose",k)){return}return this._isOpen=!1,this.overlay&&this.overlay.destroy(),this.options.hide?this._hide(this.uiDialog,this.options.hide,function(){o._trigger("close",k)}):(this.uiDialog.hide(),this._trigger("close",k)),g.ui.dialog.overlay.resize(),this.options.modal&&(m=0,g(".ui-dialog").each(function(){this!==o.uiDialog[0]&&(e=g(this).css("z-index"),isNaN(e)||(m=Math.max(m,e)))}),g.ui.dialog.maxZ=m),this},isOpen:function(){return this._isOpen},moveToTop:function(k,o){var m=this.options,e;return m.modal&&!k||!m.stack&&!m.modal?this._trigger("focus",o):(m.zIndex>g.ui.dialog.maxZ&&(g.ui.dialog.maxZ=m.zIndex),this.overlay&&(g.ui.dialog.maxZ+=1,g.ui.dialog.overlay.maxZ=g.ui.dialog.maxZ,this.overlay.$el.css("z-index",g.ui.dialog.overlay.maxZ)),e={scrollTop:this.element.scrollTop(),scrollLeft:this.element.scrollLeft()},g.ui.dialog.maxZ+=1,this.uiDialog.css("z-index",g.ui.dialog.maxZ),this.element.attr(e),this._trigger("focus",o),this)},open:function(){if(this._isOpen){return}var e,m=this.options,k=this.uiDialog;return this._size(),this._position(m.position),k.show(m.show),this.overlay=m.modal?new g.ui.dialog.overlay(this):null,this.moveToTop(!0),e=this.element.find(":tabbable"),e.length||(e=this.uiDialogButtonPane.find(":tabbable"),e.length||(e=k)),e.eq(0).focus(),this._isOpen=!0,this._trigger("open"),this},_createButtons:function(e){var m=this,k=!1;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),typeof e=="object"&&e!==null&&g.each(e,function(){return !(k=!0)}),k?(g.each(e,function(o,u){var n,q;u=g.isFunction(u)?{click:u,text:o}:u,u=g.extend({type:"button"},u),q=u.click,u.click=function(){q.apply(m.element[0],arguments)},n=g("<button></button>",u).appendTo(m.uiButtonSet),g.fn.button&&n.button()}),this.uiDialog.addClass("ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog)):this.uiDialog.removeClass("ui-dialog-buttons")},_makeDraggable:function(){function k(n){return{position:n.position,offset:n.offset}}var e=this,m=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(q,o){g(this).addClass("ui-dialog-dragging"),e._trigger("dragStart",q,k(o))},drag:function(o,q){e._trigger("drag",o,k(q))},stop:function(n,o){m.position=[o.position.left-e.document.scrollLeft(),o.position.top-e.document.scrollTop()],g(this).removeClass("ui-dialog-dragging"),e._trigger("dragStop",n,k(o)),g.ui.dialog.overlay.resize()}})},_makeResizable:function(v){function e(n){return{originalPosition:n.originalPosition,originalSize:n.originalSize,position:n.position,size:n.size}}v=v===c?this.options.resizable:v;var q=this,k=this.options,m=this.uiDialog.css("position"),t=typeof v=="string"?v:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:k.maxWidth,maxHeight:k.maxHeight,minWidth:k.minWidth,minHeight:this._minHeight(),handles:t,start:function(o,r){g(this).addClass("ui-dialog-resizing"),q._trigger("resizeStart",o,e(r))},resize:function(o,n){q._trigger("resize",o,e(n))},stop:function(o,r){g(this).removeClass("ui-dialog-resizing"),k.height=g(this).height(),k.width=g(this).width(),q._trigger("resizeStop",o,e(r)),g.ui.dialog.overlay.resize()}}).css("position",m).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")},_minHeight:function(){var k=this.options;return k.height==="auto"?k.minHeight:Math.min(k.minHeight,k.height)},_position:function(k){var o=[],m=[0,0],e;if(k){if(typeof k=="string"||typeof k=="object"&&"0" in k){o=k.split?k.split(" "):[k[0],k[1]],o.length===1&&(o[1]=o[0]),g.each(["left","top"],function(q,n){+o[q]===o[q]&&(m[q]=o[q],o[q]=n)}),k={my:o[0]+(m[0]<0?m[0]:"+"+m[0])+" "+o[1]+(m[1]<0?m[1]:"+"+m[1]),at:o.join(" ")}}k=g.extend({},g.ui.dialog.prototype.options.position,k)}else{k=g.ui.dialog.prototype.options.position}e=this.uiDialog.is(":visible"),e||this.uiDialog.show(),this.uiDialog.position(k),e||this.uiDialog.hide()},_setOptions:function(e){var q=this,k={},m=!1;g.each(e,function(o,n){q._setOption(o,n),o in f&&(m=!0),o in a&&(k[o]=n)}),m&&this._size(),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option",k)},_setOption:function(k,n){var e,m,q=this.uiDialog;switch(k){case"buttons":this._createButtons(n);break;case"closeText":this.uiDialogTitlebarCloseText.text(""+n);break;case"dialogClass":q.removeClass(this.options.dialogClass).addClass(h+n);break;case"disabled":n?q.addClass("ui-dialog-disabled"):q.removeClass("ui-dialog-disabled");break;case"draggable":e=q.is(":data(draggable)"),e&&!n&&q.draggable("destroy"),!e&&n&&this._makeDraggable();break;case"position":this._position(n);break;case"resizable":m=q.is(":data(resizable)"),m&&!n&&q.resizable("destroy"),m&&typeof n=="string"&&q.resizable("option","handles",n),!m&&n!==!1&&this._makeResizable(n);break;case"title":g(".ui-dialog-title",this.uiDialogTitlebar).html(""+(n||"&#160;"))}this._super(k,n)},_size:function(){var k,q,o,e=this.options,m=this.uiDialog.is(":visible");this.element.show().css({width:"auto",minHeight:0,height:0}),e.minWidth>e.width&&(e.width=e.minWidth),k=this.uiDialog.css({height:"auto",width:e.width}).outerHeight(),q=Math.max(0,e.minHeight-k),e.height==="auto"?g.support.minHeight?this.element.css({minHeight:q,height:"auto"}):(this.uiDialog.show(),o=this.element.css("height","auto").height(),m||this.uiDialog.hide(),this.element.height(Math.max(o,q))):this.element.height(Math.max(e.height-k,0)),this.uiDialog.is(":data(resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())}}),g.extend(g.ui.dialog,{uuid:0,maxZ:0,getTitleId:function(m){var k=m.attr("id");return k||(this.uuid+=1,k=this.uuid),"ui-dialog-title-"+k},overlay:function(e){this.$el=g.ui.dialog.overlay.create(e)}}),g.extend(g.ui.dialog.overlay,{instances:[],oldInstances:[],maxZ:0,events:g.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(k){return k+".dialog-overlay"}).join(" "),create:function(e){this.instances.length===0&&(setTimeout(function(){g.ui.dialog.overlay.instances.length&&g(document).bind(g.ui.dialog.overlay.events,function(m){if(g(m.target).zIndex()<g.ui.dialog.overlay.maxZ){return !1}})},1),g(window).bind("resize.dialog-overlay",g.ui.dialog.overlay.resize));var k=this.oldInstances.pop()||g("<div>").addClass("ui-widget-overlay");return g(document).bind("keydown.dialog-overlay",function(n){var m=g.ui.dialog.overlay.instances;m.length!==0&&m[m.length-1]===k&&e.options.closeOnEscape&&!n.isDefaultPrevented()&&n.keyCode&&n.keyCode===g.ui.keyCode.ESCAPE&&(e.close(n),n.preventDefault())}),k.appendTo(document.body).css({width:this.width(),height:this.height()}),g.fn.bgiframe&&k.bgiframe(),this.instances.push(k),k},destroy:function(e){var m=g.inArray(e,this.instances),k=0;m!==-1&&this.oldInstances.push(this.instances.splice(m,1)[0]),this.instances.length===0&&g([document,window]).unbind(".dialog-overlay"),e.height(0).width(0).remove(),g.each(this.instances,function(){k=Math.max(k,this.css("z-index"))}),this.maxZ=k},height:function(){var e,k;return g.ui.ie?(e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),k=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),e<k?g(window).height()+"px":e+"px"):g(document).height()+"px"},width:function(){var e,k;return g.ui.ie?(e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),k=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),e<k?g(window).width()+"px":e+"px"):g(document).width()+"px"},resize:function(){var e=g([]);g.each(g.ui.dialog.overlay.instances,function(){e=e.add(this)}),e.css({width:0,height:0}).css({width:g.ui.dialog.overlay.width(),height:g.ui.dialog.overlay.height()})}}),g.extend(g.ui.dialog.overlay.prototype,{destroy:function(){g.ui.dialog.overlay.destroy(this.$el)}})})(jQuery);(function(c,a){var f=!1;c.widget("ui.menu",{version:"1.9.2",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,c.proxy(function(g){this.options.disabled&&g.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(g){g.preventDefault()},"click .ui-state-disabled > a":function(g){g.preventDefault()},"click .ui-menu-item:has(a)":function(e){var g=c(e.target).closest(".ui-menu-item");!f&&g.not(".ui-state-disabled").length&&(f=!0,this.select(e),g.has(".ui-menu").length?this.expand(e):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&this.active.parents(".ui-menu").length===1&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(e){var g=c(e.currentTarget);g.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(e,g)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(h,g){var k=this.active||this.element.children(".ui-menu-item").eq(0);g||this.focus(h,k)},blur:function(e){this._delay(function(){c.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(e)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(e){c(e.target).closest(".ui-menu").length||this.collapseAll(e),f=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var e=c(this);e.data("ui-menu-submenu-carat")&&e.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(k){function e(n){return n.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var x,q,h,m,v,g=!0;switch(k.keyCode){case c.ui.keyCode.PAGE_UP:this.previousPage(k);break;case c.ui.keyCode.PAGE_DOWN:this.nextPage(k);break;case c.ui.keyCode.HOME:this._move("first","first",k);break;case c.ui.keyCode.END:this._move("last","last",k);break;case c.ui.keyCode.UP:this.previous(k);break;case c.ui.keyCode.DOWN:this.next(k);break;case c.ui.keyCode.LEFT:this.collapse(k);break;case c.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(k);break;case c.ui.keyCode.ENTER:case c.ui.keyCode.SPACE:this._activate(k);break;case c.ui.keyCode.ESCAPE:this.collapse(k);break;default:g=!1,q=this.previousFilter||"",h=String.fromCharCode(k.keyCode),m=!1,clearTimeout(this.filterTimer),h===q?m=!0:h=q+h,v=new RegExp("^"+e(h),"i"),x=this.activeMenu.children(".ui-menu-item").filter(function(){return v.test(c(this).children("a").text())}),x=m&&x.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):x,x.length||(h=String.fromCharCode(k.keyCode),v=new RegExp("^"+e(h),"i"),x=this.activeMenu.children(".ui-menu-item").filter(function(){return v.test(c(this).children("a").text())})),x.length?(this.focus(k,x),x.length>1?(this.previousFilter=h,this.filterTimer=this._delay(function(){delete this.previousFilter},1000)):delete this.previousFilter):delete this.previousFilter}g&&k.preventDefault()},_activate:function(g){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(g):this.select(g))},refresh:function(){var e,h=this.options.icons.submenu,g=this.element.find(this.options.menus);g.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var m=c(this),n=m.prev("a"),k=c("<span>").addClass("ui-menu-icon ui-icon "+h).data("ui-menu-submenu-carat",!0);n.attr("aria-haspopup","true").prepend(k),m.attr("aria-labelledby",n.attr("id"))}),e=g.add(this.element),e.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),e.children(":not(.ui-menu-item)").each(function(){var k=c(this);/[^\-—–\s]/.test(k.text())||k.addClass("ui-widget-content ui-menu-divider")}),e.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!c.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},focus:function(k,g){var m,h;this.blur(k,k&&k.type==="focus"),this._scrollIntoView(g),this.active=g.first(),h=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",h.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),k&&k.type==="keydown"?this._close():this.timer=this._delay(function(){this._close()},this.delay),m=g.children(".ui-menu"),m.length&&/^mouse/.test(k.type)&&this._startOpening(m),this.activeMenu=g.parent(),this._trigger("focus",k,{item:g})},_scrollIntoView:function(h){var v,m,g,k,q,e;this._hasScroll()&&(v=parseFloat(c.css(this.activeMenu[0],"borderTopWidth"))||0,m=parseFloat(c.css(this.activeMenu[0],"paddingTop"))||0,g=h.offset().top-this.activeMenu.offset().top-v-m,k=this.activeMenu.scrollTop(),q=this.activeMenu.height(),e=h.height(),g<0?this.activeMenu.scrollTop(k+g):g+e>q&&this.activeMenu.scrollTop(k+g-q+e))},blur:function(h,g){g||clearTimeout(this.timer);if(!this.active){return}this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",h,{item:this.active})},_startOpening:function(g){clearTimeout(this.timer);if(g.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close(),this._open(g)},this.delay)},_open:function(e){var g=c.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(e.parents(".ui-menu")).hide().attr("aria-hidden","true"),e.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(g)},collapseAll:function(e,g){clearTimeout(this.timer),this.timer=this._delay(function(){var h=g?this.element:c(e&&e.target).closest(this.element.find(".ui-menu"));h.length||(h=this.element),this._close(h),this.blur(e),this.activeMenu=h},this.delay)},_close:function(g){g||(g=this.active?this.active.parent():this.element),g.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(h){var g=this.active&&this.active.parent().closest(".ui-menu-item",this.element);g&&g.length&&(this._close(),this.focus(h,g))},expand:function(h){var g=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();g&&g.length&&(this._open(g.parent()),this._delay(function(){this.focus(h,g)}))},next:function(g){this._move("next","first",g)},previous:function(g){this._move("prev","last",g)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(k,g,m){var h;this.active&&(k==="first"||k==="last"?h=this.active[k==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):h=this.active[k+"All"](".ui-menu-item").eq(0));if(!h||!h.length||!this.active){h=this.activeMenu.children(".ui-menu-item")[g]()}this.focus(m,h)},nextPage:function(g){var k,h,e;if(!this.active){this.next(g);return}if(this.isLastItem()){return}this._hasScroll()?(h=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return k=c(this),k.offset().top-h-e<0}),this.focus(g,k)):this.focus(g,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(g){var k,h,e;if(!this.active){this.next(g);return}if(this.isFirstItem()){return}this._hasScroll()?(h=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return k=c(this),k.offset().top-h+e>0}),this.focus(g,k)):this.focus(g,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(e){this.active=this.active||c(e.target).closest(".ui-menu-item");var g={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(e,!0),this._trigger("select",e,g)}})})(jQuery);(function(c,a){c.widget("ui.progressbar",{version:"1.9.2",options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()}),this.valueDiv=c("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this.oldValue=this._value(),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(f){return f===a?this._value():(this._setOption("value",f),this)},_setOption:function(g,f){g==="value"&&(this.options.value=f,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),this._super(g,f)},_value:function(){var f=this.options.value;return typeof f!="number"&&(f=0),Math.min(this.options.max,Math.max(this.min,f))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var g=this.value(),f=this._percentage();this.oldValue!==g&&(this.oldValue=g,this._trigger("change")),this.valueDiv.toggle(g>this.min).toggleClass("ui-corner-right",g===this.options.max).width(f.toFixed(0)+"%"),this.element.attr("aria-valuenow",g)}})})(jQuery);(function(c,a){var f=5;c.widget("ui.slider",c.ui.mouse,{version:"1.9.2",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null},_create:function(){var h,m,g=this.options,k=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),n="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",e=[];this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"+(g.disabled?" ui-slider-disabled ui-disabled":"")),this.range=c([]),g.range&&(g.range===!0&&(g.values||(g.values=[this._valueMin(),this._valueMin()]),g.values.length&&g.values.length!==2&&(g.values=[g.values[0],g.values[0]])),this.range=c("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header"+(g.range==="min"||g.range==="max"?" ui-slider-range-"+g.range:""))),m=g.values&&g.values.length||1;for(h=k.length;h<m;h++){e.push(n)}this.handles=k.add(c(e.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.add(this.range).filter("a").click(function(o){o.preventDefault()}).mouseenter(function(){g.disabled||c(this).addClass("ui-state-hover")}).mouseleave(function(){c(this).removeClass("ui-state-hover")}).focus(function(){g.disabled?c(this).blur():(c(".ui-slider .ui-state-focus").removeClass("ui-state-focus"),c(this).addClass("ui-state-focus"))}).blur(function(){c(this).removeClass("ui-state-focus")}),this.handles.each(function(o){c(this).data("ui-slider-handle-index",o)}),this._on(this.handles,{keydown:function(x){var z,v,y,A,q=c(x.target).data("ui-slider-handle-index");switch(x.keyCode){case c.ui.keyCode.HOME:case c.ui.keyCode.END:case c.ui.keyCode.PAGE_UP:case c.ui.keyCode.PAGE_DOWN:case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:x.preventDefault();if(!this._keySliding){this._keySliding=!0,c(x.target).addClass("ui-state-active"),z=this._start(x,q);if(z===!1){return}}}A=this.options.step,this.options.values&&this.options.values.length?v=y=this.values(q):v=y=this.value();switch(x.keyCode){case c.ui.keyCode.HOME:y=this._valueMin();break;case c.ui.keyCode.END:y=this._valueMax();break;case c.ui.keyCode.PAGE_UP:y=this._trimAlignValue(v+(this._valueMax()-this._valueMin())/f);break;case c.ui.keyCode.PAGE_DOWN:y=this._trimAlignValue(v-(this._valueMax()-this._valueMin())/f);break;case c.ui.keyCode.UP:case c.ui.keyCode.RIGHT:if(v===this._valueMax()){return}y=this._trimAlignValue(v+A);break;case c.ui.keyCode.DOWN:case c.ui.keyCode.LEFT:if(v===this._valueMin()){return}y=this._trimAlignValue(v-A)}this._slide(x,q,y)},keyup:function(o){var q=c(o.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(o,q),this._change(o,q),c(o.target).removeClass("ui-state-active"))}}),this._refreshValue(),this._animateOff=!1},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(z){var h,e,m,A,g,y,x,q,k=this,v=this.options;return v.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),h={x:z.pageX,y:z.pageY},e=this._normValueFromMouse(h),m=this._valueMax()-this._valueMin()+1,this.handles.each(function(o){var r=Math.abs(e-k.values(o));m>r&&(m=r,A=c(this),g=o)}),v.range===!0&&this.values(1)===v.min&&(g+=1,A=c(this.handles[g])),y=this._start(z,g),y===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,A.addClass("ui-state-active").focus(),x=A.offset(),q=!c(z.target).parents().andSelf().is(".ui-slider-handle"),this._clickOffset=q?{left:0,top:0}:{left:z.pageX-x.left-A.width()/2,top:z.pageY-x.top-A.height()/2-(parseInt(A.css("borderTopWidth"),10)||0)-(parseInt(A.css("borderBottomWidth"),10)||0)+(parseInt(A.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(z,g,e),this._animateOff=!0,!0))},_mouseStart:function(){return !0},_mouseDrag:function(h){var g={x:h.pageX,y:h.pageY},k=this._normValueFromMouse(g);return this._slide(h,this._handleIndex,k),!1},_mouseStop:function(g){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(g,this._handleIndex),this._change(g,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation=this.options.orientation==="vertical"?"vertical":"horizontal"},_normValueFromMouse:function(o){var h,q,m,g,k;return this.orientation==="horizontal"?(h=this.elementSize.width,q=o.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(h=this.elementSize.height,q=o.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),m=q/h,m>1&&(m=1),m<0&&(m=0),this.orientation==="vertical"&&(m=1-m),g=this._valueMax()-this._valueMin(),k=this._valueMin()+m*g,this._trimAlignValue(k)},_start:function(h,g){var k={handle:this.handles[g],value:this.value()};return this.options.values&&this.options.values.length&&(k.value=this.values(g),k.values=this.values()),this._trigger("start",h,k)},_slide:function(o,h,q){var m,g,k;this.options.values&&this.options.values.length?(m=this.values(h?0:1),this.options.values.length===2&&this.options.range===!0&&(h===0&&q>m||h===1&&q<m)&&(q=m),q!==this.values(h)&&(g=this.values(),g[h]=q,k=this._trigger("slide",o,{handle:this.handles[h],value:q,values:g}),m=this.values(h?0:1),k!==!1&&this.values(h,q,!0))):q!==this.value()&&(k=this._trigger("slide",o,{handle:this.handles[h],value:q}),k!==!1&&this.value(q))},_stop:function(h,g){var k={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(k.value=this.values(g),k.values=this.values()),this._trigger("stop",h,k)},_change:function(h,g){if(!this._keySliding&&!this._mouseSliding){var k={handle:this.handles[g],value:this.value()};this.options.values&&this.options.values.length&&(k.value=this.values(g),k.values=this.values()),this._trigger("change",h,k)}},value:function(g){if(arguments.length){this.options.value=this._trimAlignValue(g),this._refreshValue(),this._change(null,0);return}return this._value()},values:function(g,m){var k,e,h;if(arguments.length>1){this.options.values[g]=this._trimAlignValue(m),this._refreshValue(),this._change(null,g);return}if(!arguments.length){return this._values()}if(!c.isArray(arguments[0])){return this.options.values&&this.options.values.length?this._values(g):this.value()}k=this.options.values,e=arguments[0];for(h=0;h<k.length;h+=1){k[h]=this._trimAlignValue(e[h]),this._change(null,h)}this._refreshValue()},_setOption:function(g,k){var h,e=0;c.isArray(this.options.values)&&(e=this.options.values.length),c.Widget.prototype._setOption.apply(this,arguments);switch(g){case"disabled":k?(this.handles.filter(".ui-state-focus").blur(),this.handles.removeClass("ui-state-hover"),this.handles.prop("disabled",!0),this.element.addClass("ui-disabled")):(this.handles.prop("disabled",!1),this.element.removeClass("ui-disabled"));break;case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":this._animateOff=!0,this._refreshValue();for(h=0;h<e;h+=1){this._change(null,h)}this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1}},_value:function(){var g=this.options.value;return g=this._trimAlignValue(g),g},_values:function(k){var g,m,h;if(arguments.length){return g=this.options.values[k],g=this._trimAlignValue(g),g}m=this.options.values.slice();for(h=0;h<m.length;h+=1){m[h]=this._trimAlignValue(m[h])}return m},_trimAlignValue:function(k){if(k<=this._valueMin()){return this._valueMin()}if(k>=this._valueMax()){return this._valueMax()}var g=this.options.step>0?this.options.step:1,m=(k-this._valueMin())%g,h=k-m;return Math.abs(m)*2>=g&&(h+=m>0?g:-g),parseFloat(h.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var y,h,e,m,z,g=this.options.range,x=this.options,v=this,q=this._animateOff?!1:x.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(n){h=(v.values(n)-v._valueMin())/(v._valueMax()-v._valueMin())*100,k[v.orientation==="horizontal"?"left":"bottom"]=h+"%",c(this).stop(1,1)[q?"animate":"css"](k,x.animate),v.options.range===!0&&(v.orientation==="horizontal"?(n===0&&v.range.stop(1,1)[q?"animate":"css"]({left:h+"%"},x.animate),n===1&&v.range[q?"animate":"css"]({width:h-y+"%"},{queue:!1,duration:x.animate})):(n===0&&v.range.stop(1,1)[q?"animate":"css"]({bottom:h+"%"},x.animate),n===1&&v.range[q?"animate":"css"]({height:h-y+"%"},{queue:!1,duration:x.animate}))),y=h}):(e=this.value(),m=this._valueMin(),z=this._valueMax(),h=z!==m?(e-m)/(z-m)*100:0,k[this.orientation==="horizontal"?"left":"bottom"]=h+"%",this.handle.stop(1,1)[q?"animate":"css"](k,x.animate),g==="min"&&this.orientation==="horizontal"&&this.range.stop(1,1)[q?"animate":"css"]({width:h+"%"},x.animate),g==="max"&&this.orientation==="horizontal"&&this.range[q?"animate":"css"]({width:100-h+"%"},{queue:!1,duration:x.animate}),g==="min"&&this.orientation==="vertical"&&this.range.stop(1,1)[q?"animate":"css"]({height:h+"%"},x.animate),g==="max"&&this.orientation==="vertical"&&this.range[q?"animate":"css"]({height:100-h+"%"},{queue:!1,duration:x.animate}))}})})(jQuery);(function(c){function a(f){return function(){var e=this.element.val();f.apply(this,arguments),this._refresh(),e!==this.element.val()&&this._trigger("change")}}c.widget("ui.spinner",{version:"1.9.2",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var e={},f=this.element;return c.each(["min","max","step"],function(k,h){var g=f.attr(h);g!==undefined&&g.length&&(e[h]=g)}),e},_events:{keydown:function(f){this._start(f)&&this._keydown(f)&&f.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(f){if(this.cancelBlur){delete this.cancelBlur;return}this._refresh(),this.previous!==this.element.val()&&this._trigger("change",f)},mousewheel:function(g,f){if(!f){return}if(!this.spinning&&!this._start(g)){return !1}this._spin((f>0?1:-1)*this.options.step,g),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(g)},100),g.preventDefault()},"mousedown .ui-spinner-button":function(e){function f(){var h=this.element[0]===this.document[0].activeElement;h||(this.element.focus(),this.previous=g,this._delay(function(){this.previous=g}))}var g;g=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),e.preventDefault(),f.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,f.call(this)});if(this._start(e)===!1){return}this._repeat(null,c(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(e){if(!c(e.currentTarget).hasClass("ui-state-active")){return}if(this._start(e)===!1){return !1}this._repeat(null,c(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var f=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=f.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(f.height()*0.5)&&f.height()>0&&f.height(f.height()),this.options.disabled&&this.disable()},_keydown:function(e){var g=this.options,f=c.ui.keyCode;switch(e.keyCode){case f.UP:return this._repeat(null,1,e),!0;case f.DOWN:return this._repeat(null,-1,e),!0;case f.PAGE_UP:return this._repeat(null,g.page,e),!0;case f.PAGE_DOWN:return this._repeat(null,-g.page,e),!0}return !1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(f){return !this.spinning&&this._trigger("start",f)===!1?!1:(this.counter||(this.counter=1),this.spinning=!0,!0)},_repeat:function(g,f,h){g=g||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,f,h)},g),this._spin(f*this.options.step,h)},_spin:function(g,f){var h=this.value()||0;this.counter||(this.counter=1),h=this._adjustValue(h+g*this._increment(this.counter));if(!this.spinning||this._trigger("spin",f,{value:h})!==!1){this._value(h),this.counter++}},_increment:function(e){var f=this.options.incremental;return f?c.isFunction(f)?f(e):Math.floor(e*e*e/50000-e*e/500+17*e/200+1):1},_precision:function(){var f=this._precisionOf(this.options.step);return this.options.min!==null&&(f=Math.max(f,this._precisionOf(this.options.min))),f},_precisionOf:function(g){var f=g.toString(),h=f.indexOf(".");return h===-1?0:f.length-h-1},_adjustValue:function(h){var f,k,g=this.options;return f=g.min!==null?g.min:0,k=h-f,k=Math.round(k/g.step)*g.step,h=f+k,h=parseFloat(h.toFixed(this._precision())),g.max!==null&&h>g.max?g.max:g.min!==null&&h<g.min?g.min:h},_stop:function(f){if(!this.spinning){return}clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",f)},_setOption:function(g,f){if(g==="culture"||g==="numberFormat"){var h=this._parse(this.element.val());this.options[g]=f,this.element.val(this._format(h));return}(g==="max"||g==="min"||g==="step")&&typeof f=="string"&&(f=this._parse(f)),this._super(g,f),g==="disabled"&&(f?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:a(function(f){this._super(f),this._value(this.element.val())}),_parse:function(f){return typeof f=="string"&&f!==""&&(f=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(f,10,this.options.culture):+f),f===""||isNaN(f)?null:f},_format:function(f){return f===""?"":window.Globalize&&this.options.numberFormat?Globalize.format(f,this.options.numberFormat,this.options.culture):f},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(g,f){var h;g!==""&&(h=this._parse(g),h!==null&&(f||(h=this._adjustValue(h)),g=this._format(h))),this.element.val(g),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:a(function(f){this._stepUp(f)}),_stepUp:function(f){this._spin((f||1)*this.options.step)},stepDown:a(function(f){this._stepDown(f)}),_stepDown:function(f){this._spin((f||1)*-this.options.step)},pageUp:a(function(f){this._stepUp((f||1)*this.options.page)}),pageDown:a(function(f){this._stepDown((f||1)*this.options.page)}),value:function(f){if(!arguments.length){return this._parse(this.element.val())}a(this._value).call(this,f)},widget:function(){return this.uiSpinner}})})(jQuery);(function(h,c){function a(){return ++k}function f(m){return m.hash.length>1&&m.href.replace(g,"")===location.href.replace(g,"").replace(/\s/g,"%20")}var k=0,g=/#.*$/;h.widget("ui.tabs",{version:"1.9.2",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var m=this,q=this.options,o=q.active,e=location.hash.substring(1);this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",q.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(n){h(this).is(".ui-state-disabled")&&n.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){h(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this._processTabs();if(o===null){e&&this.tabs.each(function(r,u){if(h(u).attr("aria-controls")===e){return o=r,!1}}),o===null&&(o=this.tabs.index(this.tabs.filter(".ui-tabs-active")));if(o===null||o===-1){o=this.tabs.length?0:!1}}o!==!1&&(o=this.tabs.index(this.tabs.eq(o)),o===-1&&(o=q.collapsible?!1:0)),q.active=o,!q.collapsible&&q.active===!1&&this.anchors.length&&(q.active=0),h.isArray(q.disabled)&&(q.disabled=h.unique(q.disabled.concat(h.map(this.tabs.filter(".ui-state-disabled"),function(n){return m.tabs.index(n)}))).sort()),this.options.active!==!1&&this.anchors.length?this.active=this._findActive(this.options.active):this.active=h(),this._refresh(),this.active.length&&this.load(q.active)},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):h()}},_tabKeydown:function(m){var q=h(this.document[0].activeElement).closest("li"),o=this.tabs.index(q),e=!0;if(this._handlePageNav(m)){return}switch(m.keyCode){case h.ui.keyCode.RIGHT:case h.ui.keyCode.DOWN:o++;break;case h.ui.keyCode.UP:case h.ui.keyCode.LEFT:e=!1,o--;break;case h.ui.keyCode.END:o=this.anchors.length-1;break;case h.ui.keyCode.HOME:o=0;break;case h.ui.keyCode.SPACE:m.preventDefault(),clearTimeout(this.activating),this._activate(o);return;case h.ui.keyCode.ENTER:m.preventDefault(),clearTimeout(this.activating),this._activate(o===this.options.active?!1:o);return;default:return}m.preventDefault(),clearTimeout(this.activating),o=this._focusNextTab(o,e),m.ctrlKey||(q.attr("aria-selected","false"),this.tabs.eq(o).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",o)},this.delay))},_panelKeydown:function(e){if(this._handlePageNav(e)){return}e.ctrlKey&&e.keyCode===h.ui.keyCode.UP&&(e.preventDefault(),this.active.focus())},_handlePageNav:function(e){if(e.altKey&&e.keyCode===h.ui.keyCode.PAGE_UP){return this._activate(this._focusNextTab(this.options.active-1,!1)),!0}if(e.altKey&&e.keyCode===h.ui.keyCode.PAGE_DOWN){return this._activate(this._focusNextTab(this.options.active+1,!0)),!0}},_findNextTab:function(m,q){function e(){return m>o&&(m=0),m<0&&(m=o),m}var o=this.tabs.length-1;while(h.inArray(e(),this.options.disabled)!==-1){m=q?m+1:m-1}return m},_focusNextTab:function(n,m){return n=this._findNextTab(n,m),this.tabs.eq(n).focus(),n},_setOption:function(n,m){if(n==="active"){this._activate(m);return}if(n==="disabled"){this._setupDisabled(m);return}this._super(n,m),n==="collapsible"&&(this.element.toggleClass("ui-tabs-collapsible",m),!m&&this.options.active===!1&&this._activate(0)),n==="event"&&this._setupEvents(m),n==="heightStyle"&&this._setupHeightStyle(m)},_tabId:function(m){return m.attr("aria-controls")||"ui-tabs-"+a()},_sanitizeSelector:function(m){return m?m.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var e=this.options,m=this.tablist.children(":has(a[href])");e.disabled=h.map(m.filter(".ui-state-disabled"),function(n){return m.index(n)}),this._processTabs(),e.active===!1||!this.anchors.length?(e.active=!1,this.active=h()):this.active.length&&!h.contains(this.tablist[0],this.active[0])?this.tabs.length===e.disabled.length?(e.active=!1,this.active=h()):this._activate(this._findNextTab(Math.max(0,e.active-1),!1)):e.active=this.tabs.index(this.active),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var e=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return h("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=h(),this.anchors.each(function(A,x){var v,z,t,q=h(x).uniqueId().attr("id"),y=h(x).closest("li"),m=y.attr("aria-controls");f(x)?(v=x.hash,z=e.element.find(e._sanitizeSelector(v))):(t=e._tabId(y),v="#"+t,z=e.element.find(v),z.length||(z=e._createPanel(t),z.insertAfter(e.panels[A-1]||e.tablist)),z.attr("aria-live","polite")),z.length&&(e.panels=e.panels.add(z)),m&&y.data("ui-tabs-aria-controls",m),y.attr({"aria-controls":v.substring(1),"aria-labelledby":q}),z.attr("aria-labelledby",q)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(e){return h("<div>").attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(e){h.isArray(e)&&(e.length?e.length===this.anchors.length&&(e=!0):e=!1);for(var o=0,m;m=this.tabs[o];o++){e===!0||h.inArray(o,e)!==-1?h(m).addClass("ui-state-disabled").attr("aria-disabled","true"):h(m).removeClass("ui-state-disabled").removeAttr("aria-disabled")}this.options.disabled=e},_setupEvents:function(e){var m={click:function(n){n.preventDefault()}};e&&h.each(e.split(" "),function(o,n){m[n]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,m),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(m){var q,o,e=this.element.parent();m==="fill"?(h.support.minHeight||(o=e.css("overflow"),e.css("overflow","hidden")),q=e.height(),this.element.siblings(":visible").each(function(){var n=h(this),u=n.css("position");if(u==="absolute"||u==="fixed"){return}q-=n.outerHeight(!0)}),o&&e.css("overflow",o),this.element.children().not(this.panels).each(function(){q-=h(this).outerHeight(!0)}),this.panels.each(function(){h(this).height(Math.max(0,q-h(this).innerHeight()+h(this).height()))}).css("overflow","auto")):m==="auto"&&(q=0,this.panels.each(function(){q=Math.max(q,h(this).height("").height())}).height(q))},_eventHandler:function(B){var q=this.options,e=this.active,x=h(B.currentTarget),C=x.closest("li"),m=C[0]===e[0],A=m&&q.collapsible,z=A?h():this._getPanelForTab(C),y=e.length?this._getPanelForTab(e):h(),v={oldTab:e,oldPanel:y,newTab:A?h():C,newPanel:z};B.preventDefault();if(C.hasClass("ui-state-disabled")||C.hasClass("ui-tabs-loading")||this.running||m&&!q.collapsible||this._trigger("beforeActivate",B,v)===!1){return}q.active=A?!1:this.tabs.index(C),this.active=m?h():C,this.xhr&&this.xhr.abort(),!y.length&&!z.length&&h.error("jQuery UI Tabs: Mismatching fragment identifier."),z.length&&this.load(this.tabs.index(C),B),this._toggle(B,v)},_toggle:function(q,z){function y(){x.running=!1,x._trigger("activate",q,z)}function e(){z.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),m.length&&x.options.show?x._show(m,x.options.show,y):(m.show(),y())}var x=this,m=z.newPanel,v=z.oldPanel;this.running=!0,v.length&&this.options.hide?this._hide(v,this.options.hide,function(){z.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(z.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),v.hide(),e()),v.attr({"aria-expanded":"false","aria-hidden":"true"}),z.oldTab.attr("aria-selected","false"),m.length&&v.length?z.oldTab.attr("tabIndex",-1):m.length&&this.tabs.filter(function(){return h(this).attr("tabIndex")===0}).attr("tabIndex",-1),m.attr({"aria-expanded":"true","aria-hidden":"false"}),z.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(e){var o,m=this._findActive(e);if(m[0]===this.active[0]){return}m.length||(m=this.active),o=m.find(".ui-tabs-anchor")[0],this._eventHandler({target:o,currentTarget:o,preventDefault:h.noop})},_findActive:function(e){return e===!1?h():this.tabs.eq(e)},_getIndex:function(m){return typeof m=="string"&&(m=this.anchors.index(this.anchors.filter("[href$='"+m+"']"))),m},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeData("href.tabs").removeData("load.tabs").removeUniqueId(),this.tabs.add(this.panels).each(function(){h.data(this,"ui-tabs-destroy")?h(this).remove():h(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var e=h(this),m=e.data("ui-tabs-aria-controls");m?e.attr("aria-controls",m):e.removeAttr("aria-controls")}),this.panels.show(),this.options.heightStyle!=="content"&&this.panels.css("height","")},enable:function(m){var e=this.options.disabled;if(e===!1){return}m===c?e=!1:(m=this._getIndex(m),h.isArray(e)?e=h.map(e,function(n){return n!==m?n:null}):e=h.map(this.tabs,function(o,n){return n!==m?n:null})),this._setupDisabled(e)},disable:function(m){var e=this.options.disabled;if(e===!0){return}if(m===c){e=!0}else{m=this._getIndex(m);if(h.inArray(m,e)!==-1){return}h.isArray(e)?e=h.merge([m],e).sort():e=[m]}this._setupDisabled(e)},load:function(v,z){v=this._getIndex(v);var x=this,q=this.tabs.eq(v),y=q.find(".ui-tabs-anchor"),m=this._getPanelForTab(q),e={tab:q,panel:m};if(f(y[0])){return}this.xhr=h.ajax(this._ajaxSettings(y,z,e)),this.xhr&&this.xhr.statusText!=="canceled"&&(q.addClass("ui-tabs-loading"),m.attr("aria-busy","true"),this.xhr.success(function(n){setTimeout(function(){m.html(n),x._trigger("load",z,e)},1)}).complete(function(o,n){setTimeout(function(){n==="abort"&&x.panels.stop(!1,!0),q.removeClass("ui-tabs-loading"),m.removeAttr("aria-busy"),o===x.xhr&&delete x.xhr},1)}))},_ajaxSettings:function(m,q,o){var e=this;return{url:m.attr("href"),beforeSend:function(n,r){return e._trigger("beforeLoad",q,h.extend({jqXHR:n,ajaxSettings:r},o))}}},_getPanelForTab:function(e){var m=h(e).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+m))}}),h.uiBackCompat!==!1&&(h.ui.tabs.prototype._ui=function(n,m){return{tab:n,panel:m,index:this.anchors.index(n)}},h.widget("ui.tabs",h.ui.tabs,{url:function(n,m){this.anchors.eq(n).attr("href",m)}}),h.widget("ui.tabs",h.ui.tabs,{options:{ajaxOptions:null,cache:!1},_create:function(){this._super();var e=this;this._on({tabsbeforeload:function(o,m){if(h.data(m.tab[0],"cache.tabs")){o.preventDefault();return}m.jqXHR.success(function(){e.options.cache&&h.data(m.tab[0],"cache.tabs",!0)})}})},_ajaxSettings:function(m,q,o){var e=this.options.ajaxOptions;return h.extend({},e,{error:function(u,r){try{e.error(u,r,o.tab.closest("li").index(),o.tab[0])}catch(v){}}},this._superApply(arguments))},_setOption:function(n,m){n==="cache"&&m===!1&&this.anchors.removeData("cache.tabs"),this._super(n,m)},_destroy:function(){this.anchors.removeData("cache.tabs"),this._super()},url:function(m){this.anchors.eq(m).removeData("cache.tabs"),this._superApply(arguments)}}),h.widget("ui.tabs",h.ui.tabs,{abort:function(){this.xhr&&this.xhr.abort()}}),h.widget("ui.tabs",h.ui.tabs,{options:{spinner:"<em>Loading&#8230;</em>"},_create:function(){this._super(),this._on({tabsbeforeload:function(q,m){if(q.target!==this.element[0]||!this.options.spinner){return}var u=m.tab.find("span"),o=u.html();u.html(this.options.spinner),m.jqXHR.complete(function(){u.html(o)})}})}}),h.widget("ui.tabs",h.ui.tabs,{options:{enable:null,disable:null},enable:function(e){var o=this.options,m;if(e&&o.disabled===!0||h.isArray(o.disabled)&&h.inArray(e,o.disabled)!==-1){m=!0}this._superApply(arguments),m&&this._trigger("enable",null,this._ui(this.anchors[e],this.panels[e]))},disable:function(e){var o=this.options,m;if(e&&o.disabled===!1||h.isArray(o.disabled)&&h.inArray(e,o.disabled)===-1){m=!0}this._superApply(arguments),m&&this._trigger("disable",null,this._ui(this.anchors[e],this.panels[e]))}}),h.widget("ui.tabs",h.ui.tabs,{options:{add:null,remove:null,tabTemplate:"<li><a href='#{href}'><span>#{label}</span></a></li>"},add:function(z,v,q){q===c&&(q=this.anchors.length);var t,y,m=this.options,e=h(m.tabTemplate.replace(/#\{href\}/g,z).replace(/#\{label\}/g,v)),x=z.indexOf("#")?this._tabId(e):z.replace("#","");return e.addClass("ui-state-default ui-corner-top").data("ui-tabs-destroy",!0),e.attr("aria-controls",x),t=q>=this.tabs.length,y=this.element.find("#"+x),y.length||(y=this._createPanel(x),t?q>0?y.insertAfter(this.panels.eq(-1)):y.appendTo(this.element):y.insertBefore(this.panels[q])),y.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").hide(),t?e.appendTo(this.tablist):e.insertBefore(this.tabs[q]),m.disabled=h.map(m.disabled,function(n){return n>=q?++n:n}),this.refresh(),this.tabs.length===1&&m.active===!1&&this.option("active",0),this._trigger("add",null,this._ui(this.anchors[q],this.panels[q])),this},remove:function(m){m=this._getIndex(m);var q=this.options,o=this.tabs.eq(m).remove(),e=this._getPanelForTab(o).remove();return o.hasClass("ui-tabs-active")&&this.anchors.length>2&&this._activate(m+(m+1<this.anchors.length?1:-1)),q.disabled=h.map(h.grep(q.disabled,function(n){return n!==m}),function(n){return n>=m?--n:n}),this.refresh(),this._trigger("remove",null,this._ui(o.find("a")[0],e[0])),this}}),h.widget("ui.tabs",h.ui.tabs,{length:function(){return this.anchors.length}}),h.widget("ui.tabs",h.ui.tabs,{options:{idPrefix:"ui-tabs-"},_tabId:function(e){var m=e.is("li")?e.find("a[href]"):e;return m=m[0],h(m).closest("li").attr("aria-controls")||m.title&&m.title.replace(/\s/g,"_").replace(/[^\w\u00c0-\uFFFF\-]/g,"")||this.options.idPrefix+a()}}),h.widget("ui.tabs",h.ui.tabs,{options:{panelTemplate:"<div></div>"},_createPanel:function(e){return h(this.options.panelTemplate).attr("id",e).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)}}),h.widget("ui.tabs",h.ui.tabs,{_create:function(){var m=this.options;m.active===null&&m.selected!==c&&(m.active=m.selected===-1?!1:m.selected),this._super(),m.selected=m.active,m.selected===!1&&(m.selected=-1)},_setOption:function(o,m){if(o!=="selected"){return this._super(o,m)}var q=this.options;this._super("active",m===-1?!1:m),q.selected=q.active,q.selected===!1&&(q.selected=-1)},_eventHandler:function(){this._superApply(arguments),this.options.selected=this.options.active,this.options.selected===!1&&(this.options.selected=-1)}}),h.widget("ui.tabs",h.ui.tabs,{options:{show:null,select:null},_create:function(){this._super(),this.options.active!==!1&&this._trigger("show",null,this._ui(this.active.find(".ui-tabs-anchor")[0],this._getPanelForTab(this.active)[0]))},_trigger:function(v,o,x){var u,m,q=this._superApply(arguments);return q?(v==="beforeActivate"?(u=x.newTab.length?x.newTab:x.oldTab,m=x.newPanel.length?x.newPanel:x.oldPanel,q=this._super("select",o,{tab:u.find(".ui-tabs-anchor")[0],panel:m[0],index:u.closest("li").index()})):v==="activate"&&x.newTab.length&&(q=this._super("show",o,{tab:x.newTab.find(".ui-tabs-anchor")[0],panel:x.newPanel[0],index:x.newTab.closest("li").index()})),q):!1}}),h.widget("ui.tabs",h.ui.tabs,{select:function(m){m=this._getIndex(m);if(m===-1){if(!this.options.collapsible||this.options.selected===-1){return}m=this.options.selected}this.anchors.eq(m).trigger(this.options.event+this.eventNamespace)}}),function(){var e=0;h.widget("ui.tabs",h.ui.tabs,{options:{cookie:null},_create:function(){var n=this.options,m;n.active==null&&n.cookie&&(m=parseInt(this._cookie(),10),m===-1&&(m=!1),n.active=m),this._super()},_cookie:function(o){var m=[this.cookie||(this.cookie=this.options.cookie.name||"ui-tabs-"+ ++e)];return arguments.length&&(m.push(o===!1?-1:o),m.push(this.options.cookie)),h.cookie.apply(null,m)},_refresh:function(){this._super(),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_eventHandler:function(){this._superApply(arguments),this.options.cookie&&this._cookie(this.options.active,this.options.cookie)},_destroy:function(){this._super(),this.options.cookie&&this._cookie(null,this.options.cookie)}})}(),h.widget("ui.tabs",h.ui.tabs,{_trigger:function(m,q,o){var e=h.extend({},o);return m==="load"&&(e.panel=e.panel[0],e.tab=e.tab.find(".ui-tabs-anchor")[0]),this._super(m,q,e)}}),h.widget("ui.tabs",h.ui.tabs,{options:{fx:null},_getFx:function(){var e,o,m=this.options.fx;return m&&(h.isArray(m)?(e=m[0],o=m[1]):e=o=m),m?{show:o,hide:e}:null},_toggle:function(z,v){function A(){B.running=!1,B._trigger("activate",z,v)}function m(){v.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),y.length&&x.show?y.animate(x.show,x.show.duration,function(){A()}):(y.show(),A())}var B=this,y=v.newPanel,q=v.oldPanel,x=this._getFx();if(!x){return this._super(z,v)}B.running=!0,q.length&&x.hide?q.animate(x.hide,x.hide.duration,function(){v.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),m()}):(v.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),q.hide(),m())}}))})(jQuery);(function(f){function g(e,k){var h=(e.attr("aria-describedby")||"").split(/\s+/);h.push(k),e.data("ui-tooltip-id",k).attr("aria-describedby",f.trim(h.join(" ")))}function c(h){var m=h.data("ui-tooltip-id"),k=(h.attr("aria-describedby")||"").split(/\s+/),e=f.inArray(m,k);e!==-1&&k.splice(e,1),h.removeData("ui-tooltip-id"),k=f.trim(k.join(" ")),k?h.attr("aria-describedby",k):h.removeAttr("aria-describedby")}var a=0;f.widget("ui.tooltip",{version:"1.9.2",options:{content:function(){return f(this).attr("title")},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(e,k){var h=this;if(e==="disabled"){this[k?"_disable":"_enable"](),this.options[e]=k;return}this._super(e,k),e==="content"&&f.each(this.tooltips,function(n,m){h._updateContent(m)})},_disable:function(){var e=this;f.each(this.tooltips,function(m,k){var h=f.Event("blur");h.target=h.currentTarget=k[0],e.close(h,!0)}),this.element.find(this.options.items).andSelf().each(function(){var h=f(this);h.is("[title]")&&h.data("ui-tooltip-title",h.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).andSelf().each(function(){var e=f(this);e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title"))})},open:function(e){var k=this,h=f(e?e.target:this.element).closest(this.options.items);if(!h.length||h.data("ui-tooltip-id")){return}h.attr("title")&&h.data("ui-tooltip-title",h.attr("title")),h.data("ui-tooltip-open",!0),e&&e.type==="mouseover"&&h.parents().each(function(){var m=f(this),n;m.data("ui-tooltip-open")&&(n=f.Event("blur"),n.target=n.currentTarget=this,k.close(n,!0)),m.attr("title")&&(m.uniqueId(),k.parents[this.id]={element:this,title:m.attr("title")},m.attr("title",""))}),this._updateContent(h,e)},_updateContent:function(q,k){var u,o=this.options.content,h=this,m=k?k.type:null;if(typeof o=="string"){return this._open(k,q,o)}u=o.call(q[0],function(e){if(!q.data("ui-tooltip-open")){return}h._delay(function(){k&&(k.type=m),this._open(k,q,e)})}),u&&this._open(k,q,u)},_open:function(m,q,k){function v(o){e.of=o;if(n.is(":hidden")){return}n.position(e)}var n,x,h,e=f.extend({},this.options.position);if(!k){return}n=this._find(q);if(n.length){n.find(".ui-tooltip-content").html(k);return}q.is("[title]")&&(m&&m.type==="mouseover"?q.attr("title",""):q.removeAttr("title")),n=this._tooltip(q),g(q,n.attr("id")),n.find(".ui-tooltip-content").html(k),this.options.track&&m&&/^mouse/.test(m.type)?(this._on(this.document,{mousemove:v}),v(m)):n.position(f.extend({of:q},this.options.position)),n.hide(),this._show(n,this.options.show),this.options.show&&this.options.show.delay&&(h=setInterval(function(){n.is(":visible")&&(v(e.of),clearInterval(h))},f.fx.interval)),this._trigger("open",m,{tooltip:n}),x={keyup:function(o){if(o.keyCode===f.ui.keyCode.ESCAPE){var r=f.Event(o);r.currentTarget=q[0],this.close(r,!0)}},remove:function(){this._removeTooltip(n)}};if(!m||m.type==="mouseover"){x.mouseleave="close"}if(!m||m.type==="focusin"){x.focusout="close"}this._on(!0,q,x)},close:function(h){var m=this,e=f(h?h.currentTarget:this.element),k=this._find(e);if(this.closing){return}e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title")),c(e),k.stop(!0),this._hide(k,this.options.hide,function(){m._removeTooltip(f(this))}),e.removeData("ui-tooltip-open"),this._off(e,"mouseleave focusout keyup"),e[0]!==this.element[0]&&this._off(e,"remove"),this._off(this.document,"mousemove"),h&&h.type==="mouseleave"&&f.each(this.parents,function(n,o){f(o.element).attr("title",o.title),delete m.parents[n]}),this.closing=!0,this._trigger("close",h,{tooltip:k}),this.closing=!1},_tooltip:function(k){var h="ui-tooltip-"+a++,e=f("<div>").attr({id:h,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return f("<div>").addClass("ui-tooltip-content").appendTo(e),e.appendTo(this.document[0].body),f.fn.bgiframe&&e.bgiframe(),this.tooltips[h]=k,e},_find:function(e){var h=e.data("ui-tooltip-id");return h?f("#"+h):f()},_removeTooltip:function(h){h.remove(),delete this.tooltips[h.attr("id")]},_destroy:function(){var e=this;f.each(this.tooltips,function(m,k){var h=f.Event("blur");h.target=h.currentTarget=k[0],e.close(h,!0),f("#"+m).remove(),k.data("ui-tooltip-title")&&(k.attr("title",k.data("ui-tooltip-title")),k.removeData("ui-tooltip-title"))})}})})(jQuery);jQuery.effects||function(f,a){var g=f.uiBackCompat!==!1,c="ui-effects-";f.effects={effect:{}},function(G,q){function k(u,h,v){var o=D[h.type]||{};return u==null?v||!h.def?null:h.def:(u=o.floor?~~u:parseFloat(u),isNaN(u)?h.def:o.mod?(u+o.mod)%o.mod:0>u?0:o.max<u?o.max:u)}function B(o){var t=m(),h=t._rgba=[];return o=o.toLowerCase(),z(H,function(u,r){var v,J=r.re.exec(o),n=J&&r.parse(J),I=r.space||"rgba";if(n){return v=t[I](n),t[F[I].cache]=v[F[I].cache],h=t._rgba=v._rgba,!1}}),h.length?(h.join()==="0,0,0,0"&&G.extend(h,C.transparent),t):C[o]}function E(o,h,r){return r=(r+1)%1,r*6<1?o+(h-o)*r*6:r*2<1?h:r*3<2?o+(h-o)*(2/3-r)*6:o}var e="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor".split(" "),y=/^([\-+])=\s*(\d+\.?\d*)/,H=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(h){return[h[1],h[2],h[3],h[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(h){return[h[1]*2.55,h[2]*2.55,h[3]*2.55,h[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(h){return[parseInt(h[1],16),parseInt(h[2],16),parseInt(h[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(h){return[parseInt(h[1]+h[1],16),parseInt(h[2]+h[2],16),parseInt(h[3]+h[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(h){return[h[1],h[2]/100,h[3]/100,h[4]]}}],m=G.Color=function(t,u,o,h){return new G.Color.fn.parse(t,u,o,h)},F={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},D={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},A=m.support={},x=G("<p>")[0],C,z=G.each;x.style.cssText="background-color:rgba(1,1,1,.5)",A.rgba=x.style.backgroundColor.indexOf("rgba")>-1,z(F,function(n,h){h.cache="_"+n,h.props.alpha={idx:3,type:"percent",def:1}}),m.fn=G.extend(m.prototype,{parse:function(I,t,u,n){if(I===q){return this._rgba=[null,null,null,null],this}if(I.jquery||I.nodeType){I=G(I).css(t),t=q}var J=this,h=G.type(I),o=this._rgba=[];t!==q&&(I=[I,t,u,n],h="array");if(h==="string"){return this.parse(B(I)||C._default)}if(h==="array"){return z(F.rgba.props,function(v,r){o[r.idx]=k(I[r.idx],r)}),this}if(h==="object"){return I instanceof m?z(F,function(v,r){I[r.cache]&&(J[r.cache]=I[r.cache].slice())}):z(F,function(v,K){var r=K.cache;z(K.props,function(N,M){if(!J[r]&&K.to){if(N==="alpha"||I[N]==null){return}J[r]=K.to(J._rgba)}J[r][M.idx]=k(I[N],M,!0)}),J[r]&&f.inArray(null,J[r].slice(0,3))<0&&(J[r][3]=1,K.from&&(J._rgba=K.from(J[r])))}),this}},is:function(u){var h=m(u),v=!0,o=this;return z(F,function(t,n){var r,I=h[n.cache];return I&&(r=o[n.cache]||n.to&&n.to(o._rgba)||[],z(n.props,function(K,J){if(I[J.idx]!=null){return v=I[J.idx]===r[J.idx],v}})),v}),v},_space:function(){var n=[],h=this;return z(F,function(t,o){h[o.cache]&&n.push(t)}),n.pop()},transition:function(K,u){var M=m(K),I=M._space(),o=F[I],v=this.alpha()===0?m("transparent"):this,J=v[o.cache]||o.to(v._rgba),h=J.slice();return M=M[o.cache],z(o.props,function(P,O){var t=O.idx,N=J[t],Q=M[t],n=D[O.type]||{};if(Q===null){return}N===null?h[t]=Q:(n.mod&&(Q-N>n.mod/2?N+=n.mod:N-Q>n.mod/2&&(N-=n.mod)),h[t]=k((Q-N)*u+N,O))}),this[I](h)},blend:function(t){if(this._rgba[3]===1){return this}var u=this._rgba.slice(),o=u.pop(),h=m(t)._rgba;return m(G.map(u,function(r,n){return(1-o)*h[n]+o*r}))},toRgbaString:function(){var h="rgba(",o=G.map(this._rgba,function(r,n){return r==null?n>2?1:0:r});return o[3]===1&&(o.pop(),h="rgb("),h+o.join()+")"},toHslaString:function(){var h="hsla(",o=G.map(this.hsla(),function(r,n){return r==null&&(r=n>2?1:0),n&&n<3&&(r=Math.round(r*100)+"%"),r});return o[3]===1&&(o.pop(),h="hsl("),h+o.join()+")"},toHexString:function(o){var t=this._rgba.slice(),h=t.pop();return o&&t.push(~~(h*255)),"#"+G.map(t,function(n){return n=(n||0).toString(16),n.length===1?"0"+n:n}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}}),m.fn.parse.prototype=m.fn,F.hsla.to=function(N){if(N[0]==null||N[1]==null||N[2]==null){return[null,null,null,N[3]]}var R=N[0]/255,I=N[1]/255,h=N[2]/255,K=N[3],S=Math.max(R,I,h),v=Math.min(R,I,h),Q=S-v,P=S+v,M=P*0.5,J,O;return v===S?J=0:R===S?J=60*(I-h)/Q+360:I===S?J=60*(h-R)/Q+120:J=60*(R-I)/Q+240,M===0||M===1?O=M:M<=0.5?O=Q/P:O=Q/(2-P),[Math.round(J)%360,O,M,K==null?1:K]},F.hsla.from=function(J){if(J[0]==null||J[1]==null||J[2]==null){return[null,null,null,J[3]]}var u=J[0]/360,M=J[1],I=J[2],h=J[3],v=I<=0.5?I*(1+M):I+M-I*M,K=2*I-v;return[Math.round(E(K,v,u+1/3)*255),Math.round(E(K,v,u)*255),Math.round(E(K,v,u-1/3)*255),h]},z(F,function(I,t){var o=t.props,n=t.cache,h=t.to,v=t.from;m.fn[I]=function(M){h&&!this[n]&&(this[n]=h(this._rgba));if(M===q){return this[n].slice()}var K,J=G.type(M),u=J==="array"||J==="object"?M:arguments,N=this[n].slice();return z(o,function(O,r){var P=u[J==="object"?O:r.idx];P==null&&(P=N[r.idx]),N[r.idx]=k(P,r)}),v?(K=m(v(N)),K[n]=N,K):m(N)},z(o,function(J,u){if(m.fn[J]){return}m.fn[J]=function(N){var P=G.type(N),M=J==="alpha"?this._hsla?"hsla":"rgba":I,K=this[M](),O=K[u.idx],r;return P==="undefined"?O:(P==="function"&&(N=N.call(this,O),P=G.type(N)),N==null&&u.empty?this:(P==="string"&&(r=y.exec(N),r&&(N=O+parseFloat(r[2])*(r[1]==="+"?1:-1))),K[u.idx]=N,this[M](K)))}})}),z(e,function(h,o){G.cssHooks[o]={set:function(M,K){var I,J,v="";if(G.type(K)!=="string"||(I=B(K))){K=m(I||K);if(!A.rgba&&K._rgba[3]!==1){J=o==="backgroundColor"?M.parentNode:M;while((v===""||v==="transparent")&&J&&J.style){try{v=G.css(J,"backgroundColor"),J=J.parentNode}catch(t){}}K=K.blend(v&&v!=="transparent"?v:"_default")}K=K.toRgbaString()}try{M.style[o]=K}catch(n){}}},G.fx.step[o]=function(n){n.colorInit||(n.start=m(n.elem,o),n.end=m(n.end),n.colorInit=!0),G.cssHooks[o].set(n.elem,n.start.transition(n.end,n.pos))}}),G.cssHooks.borderColor={expand:function(n){var h={};return z(["Top","Right","Bottom","Left"],function(t,o){h["border"+o+"Color"]=n}),h}},C=G.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function e(){var q=this.ownerDocument.defaultView?this.ownerDocument.defaultView.getComputedStyle(this,null):this.currentStyle,v={},u,o;if(q&&q.length&&q[0]&&q[q[0]]){o=q.length;while(o--){u=q[o],typeof q[u]=="string"&&(v[f.camelCase(u)]=q[u])}}else{for(u in q){typeof q[u]=="string"&&(v[u]=q[u])}}return v}function h(r,x){var q={},u,v;for(u in x){v=x[u],r[u]!==v&&!k[u]&&(f.fx.step[u]||!isNaN(parseFloat(v)))&&(q[u]=v)}return q}var m=["add","remove","toggle"],k={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};f.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(o,q){f.fx.step[q]=function(n){if(n.end!=="none"&&!n.setAttr||n.pos===1&&!n.setAttr){jQuery.style(n.elem,q,n.end),n.setAttr=!0}}}),f.effects.animateClass=function(v,x,y,q){var n=f.speed(x,y,q);return this.queue(function(){var z=f(this),B=z.attr("class")||"",t,A=n.children?z.find("*").andSelf():z;A=A.map(function(){var o=f(this);return{el:o,start:e.call(this)}}),t=function(){f.each(m,function(o,r){v[r]&&z[r+"Class"](v[r])})},t(),A=A.map(function(){return this.end=e.call(this.el[0]),this.diff=h(this.start,this.end),this}),z.attr("class",B),A=A.map(function(){var o=this,C=f.Deferred(),u=jQuery.extend({},n,{queue:!1,complete:function(){C.resolve(o)}});return this.el.animate(this.diff,u),C.promise()}),f.when.apply(f,A.get()).done(function(){t(),f.each(arguments,function(){var o=this.el;f.each(this.diff,function(r){o.css(r,"")})}),n.complete.call(z[0])})})},f.fn.extend({_addClass:f.fn.addClass,addClass:function(q,v,u,o){return v?f.effects.animateClass.call(this,{add:q},v,u,o):this._addClass(q)},_removeClass:f.fn.removeClass,removeClass:function(q,v,u,o){return v?f.effects.animateClass.call(this,{remove:q},v,u,o):this._removeClass(q)},_toggleClass:f.fn.toggleClass,toggleClass:function(x,u,q,t,v){return typeof u=="boolean"||u===a?q?f.effects.animateClass.call(this,u?{add:x}:{remove:x},q,t,v):this._toggleClass(x,u):f.effects.animateClass.call(this,{toggle:x},u,q,t)},switchClass:function(q,x,v,o,u){return f.effects.animateClass.call(this,{add:x,remove:q},v,o,u)}})}(),function(){function e(m,q,o,k){f.isPlainObject(m)&&(q=m,m=m.effect),m={effect:m},q==null&&(q={}),f.isFunction(q)&&(k=q,o=null,q={});if(typeof q=="number"||f.fx.speeds[q]){k=o,o=q,q={}}return f.isFunction(o)&&(k=o,o=null),q&&f.extend(m,q),o=o||q.duration,m.duration=f.fx.off?0:typeof o=="number"?o:o in f.fx.speeds?f.fx.speeds[o]:f.fx.speeds._default,m.complete=k||q.complete,m}function h(k){return !k||typeof k=="number"||f.fx.speeds[k]?!0:typeof k=="string"&&!f.effects.effect[k]?g&&f.effects[k]?!1:!0:!1}f.extend(f.effects,{version:"1.9.2",save:function(m,k){for(var o=0;o<k.length;o++){k[o]!==null&&m.data(c+k[o],m[0].style[k[o]])}},restore:function(o,q){var k,m;for(m=0;m<q.length;m++){q[m]!==null&&(k=o.data(c+q[m]),k===a&&(k=""),o.css(q[m],k))}},setMode:function(m,k){return k==="toggle"&&(k=m.is(":hidden")?"show":"hide"),k},getBaseline:function(o,k){var q,m;switch(o[0]){case"top":q=0;break;case"middle":q=0.5;break;case"bottom":q=1;break;default:q=o[0]/k.height}switch(o[1]){case"left":m=0;break;case"center":m=0.5;break;case"right":m=1;break;default:m=o[1]/k.width}return{x:m,y:q}},createWrapper:function(m){if(m.parent().is(".ui-effects-wrapper")){return m.parent()}var x={width:m.outerWidth(!0),height:m.outerHeight(!0),"float":m.css("float")},u=f("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),k={width:m.width(),height:m.height()},q=document.activeElement;try{q.id}catch(v){q=document.body}return m.wrap(u),(m[0]===q||f.contains(m[0],q))&&f(q).focus(),u=m.parent(),m.css("position")==="static"?(u.css({position:"relative"}),m.css({position:"relative"})):(f.extend(x,{position:m.css("position"),zIndex:m.css("z-index")}),f.each(["top","left","bottom","right"],function(o,n){x[n]=m.css(n),isNaN(parseInt(x[n],10))&&(x[n]="auto")}),m.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),m.css(k),u.css(x).show()},removeWrapper:function(k){var m=document.activeElement;return k.parent().is(".ui-effects-wrapper")&&(k.parent().replaceWith(k),(k[0]===m||f.contains(k[0],m))&&f(m).focus()),k},setTransition:function(m,q,o,k){return k=k||{},f.each(q,function(t,u){var r=m.cssUnit(u);r[0]>0&&(k[u]=r[0]*o+r[1])}),k}}),f.fn.extend({effect:function(){function k(A){function o(){f.isFunction(t)&&t.call(z[0]),f.isFunction(A)&&A()}var z=f(this),t=n.complete,y=n.mode;(z.is(":hidden")?y==="hide":y==="show")?o():x.call(z[0],n,o)}var n=e.apply(this,arguments),v=n.mode,q=n.queue,x=f.effects.effect[n.effect],m=!x&&g&&f.effects[n.effect];return f.fx.off||!x&&!m?v?this[v](n.duration,n.complete):this.each(function(){n.complete&&n.complete.call(this)}):x?q===!1?this.each(k):this.queue(q||"fx",k):m.call(this,{options:n,duration:n.duration,callback:n.complete,mode:n.mode})},_show:f.fn.show,show:function(m){if(h(m)){return this._show.apply(this,arguments)}var k=e.apply(this,arguments);return k.mode="show",this.effect.call(this,k)},_hide:f.fn.hide,hide:function(m){if(h(m)){return this._hide.apply(this,arguments)}var k=e.apply(this,arguments);return k.mode="hide",this.effect.call(this,k)},__toggle:f.fn.toggle,toggle:function(k){if(h(k)||typeof k=="boolean"||f.isFunction(k)){return this.__toggle.apply(this,arguments)}var m=e.apply(this,arguments);return m.mode="toggle",this.effect.call(this,m)},cssUnit:function(k){var o=this.css(k),m=[];return f.each(["em","px","%","pt"],function(q,n){o.indexOf(n)>0&&(m=[parseFloat(o),n])}),m}})}(),function(){var e={};f.each(["Quad","Cubic","Quart","Quint","Expo"],function(h,k){e[k]=function(m){return Math.pow(m,h+2)}}),f.extend(e,{Sine:function(h){return 1-Math.cos(h*Math.PI/2)},Circ:function(h){return 1-Math.sqrt(1-h*h)},Elastic:function(h){return h===0||h===1?h:-Math.pow(2,8*(h-1))*Math.sin(((h-1)*80-7.5)*Math.PI/15)},Back:function(h){return h*h*(3*h-2)},Bounce:function(k){var h,m=4;while(k<((h=Math.pow(2,--m))-1)/11){}return 1/Math.pow(4,3-m)-7.5625*Math.pow((h*3-2)/22-k,2)}}),f.each(e,function(h,k){f.easing["easeIn"+h]=k,f.easing["easeOut"+h]=function(m){return 1-k(1-m)},f.easing["easeInOut"+h]=function(m){return m<0.5?k(m*2)/2:1-k(m*-2+2)/2}})}()}(jQuery);(function(f,a){var g=/up|down|vertical/,c=/up|left|vertical|horizontal/;f.effects.effect.blind=function(F,r){var G=f(this),k=["position","top","bottom","left","right","height","width"],E=f.effects.setMode(G,F.mode||"hide"),C=F.direction||"up",z=g.test(C),q=z?"height":"width",B=z?"top":"left",x=c.test(C),e={},A=E==="show",D,n,y;G.parent().is(".ui-effects-wrapper")?f.effects.save(G.parent(),k):f.effects.save(G,k),G.show(),D=f.effects.createWrapper(G).css({overflow:"hidden"}),n=D[q](),y=parseFloat(D.css(B))||0,e[q]=A?n:0,x||(G.css(z?"bottom":"right",0).css(z?"top":"left","auto").css({position:"absolute"}),e[B]=A?y:n+y),A&&(D.css(q,0),x||D.css(B,y+n)),D.animate(e,{duration:F.duration,easing:F.easing,queue:!1,complete:function(){E==="hide"&&G.hide(),f.effects.restore(G,k),f.effects.removeWrapper(G),r()}})}})(jQuery);(function(c,a){c.effects.effect.bounce=function(z,E){var B=c(this),H=["position","top","bottom","left","right","height","width"],A=c.effects.setMode(B,z.mode||"effect"),D=A==="hide",x=A==="show",P=z.direction||"up",K=z.distance,G=z.times||5,N=G*2+(x||D?1:0),I=z.duration/N,C=z.easing,M=P==="up"||P==="down"?"top":"left",q=P==="up"||P==="left",F,J,e,O=B.queue(),k=O.length;(x||D)&&H.push("opacity"),c.effects.save(B,H),B.show(),c.effects.createWrapper(B),K||(K=B[M==="top"?"outerHeight":"outerWidth"]()/3),x&&(e={opacity:1},e[M]=0,B.css("opacity",0).css(M,q?-K*2:K*2).animate(e,I,C)),D&&(K/=Math.pow(2,G-1)),e={},e[M]=0;for(F=0;F<G;F++){J={},J[M]=(q?"-=":"+=")+K,B.animate(J,I,C).animate(e,I,C),K=D?K*2:K/2}D&&(J={opacity:0},J[M]=(q?"-=":"+=")+K,B.animate(J,I,C)),B.queue(function(){D&&B.hide(),c.effects.restore(B,H),c.effects.removeWrapper(B),E()}),k>1&&O.splice.apply(O,[1,0].concat(O.splice(k,N+1))),B.dequeue()}})(jQuery);(function(c,a){c.effects.effect.clip=function(D,m){var e=c(this),v=["position","top","bottom","left","right","height","width"],E=c.effects.setMode(e,D.mode||"hide"),k=E==="show",C=D.direction||"vertical",B=C==="vertical",y=B?"height":"width",q=B?"top":"left",A={},x,g,z;c.effects.save(e,v),e.show(),x=c.effects.createWrapper(e).css({overflow:"hidden"}),g=e[0].tagName==="IMG"?x:e,z=g[y](),k&&(g.css(y,0),g.css(q,z/2)),A[y]=k?z:0,A[q]=k?0:z/2,g.animate(A,{queue:!1,duration:D.duration,easing:D.easing,complete:function(){k||e.hide(),c.effects.restore(e,v),c.effects.removeWrapper(e),m()}})}})(jQuery);(function(c,a){c.effects.effect.drop=function(z,h){var e=c(this),m=["position","top","bottom","left","right","opacity","height","width"],A=c.effects.setMode(e,z.mode||"hide"),g=A==="show",y=z.direction||"left",x=y==="up"||y==="down"?"top":"left",q=y==="up"||y==="left"?"pos":"neg",k={opacity:g?1:0},v;c.effects.save(e,m),e.show(),c.effects.createWrapper(e),v=z.distance||e[x==="top"?"outerHeight":"outerWidth"](!0)/2,g&&e.css("opacity",0).css(x,q==="pos"?-v:v),k[x]=(g?q==="pos"?"+=":"-=":q==="pos"?"-=":"+=")+v,e.animate(k,{queue:!1,duration:z.duration,easing:z.easing,complete:function(){A==="hide"&&e.hide(),c.effects.restore(e,m),c.effects.removeWrapper(e),h()}})}})(jQuery);(function(c,a){c.effects.effect.explode=function(x,D){function e(){M.push(this),M.length===A*G&&N()}function N(){z.css({visibility:"visible"}),c(M).remove(),q||z.hide(),D()}var A=x.pieces?Math.round(Math.sqrt(x.pieces)):3,G=A,z=c(this),C=c.effects.setMode(z,x.mode||"hide"),q=C==="show",O=z.show().css("visibility","hidden").offset(),J=Math.ceil(z.outerWidth()/G),F=Math.ceil(z.outerHeight()/A),M=[],H,B,K,k,E,I;for(H=0;H<A;H++){k=O.top+H*F,I=H-(A-1)/2;for(B=0;B<G;B++){K=O.left+B*J,E=B-(G-1)/2,z.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-B*J,top:-H*F}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:J,height:F,left:K+(q?E*J:0),top:k+(q?I*F:0),opacity:q?0:1}).animate({left:K+(q?0:E*J),top:k+(q?0:I*F),opacity:q?1:0},x.duration||500,x.easing,e)}}}})(jQuery);(function(c,a){c.effects.effect.fade=function(f,h){var g=c(this),e=c.effects.setMode(g,f.mode||"toggle");g.animate({opacity:e},{queue:!1,duration:f.duration,easing:f.easing,complete:h})}})(jQuery);(function(c,a){c.effects.effect.fold=function(J,x){var e=c(this),A=["position","top","bottom","left","right","height","width"],K=c.effects.setMode(e,J.mode||"hide"),q=K==="show",I=K==="hide",G=J.size||15,D=/([0-9]+)%/.exec(G),z=!!J.horizFirst,F=q!==z,B=F?["width","height"]:["height","width"],k=J.duration/2,E,H,y={},C={};c.effects.save(e,A),e.show(),E=c.effects.createWrapper(e).css({overflow:"hidden"}),H=F?[E.width(),E.height()]:[E.height(),E.width()],D&&(G=parseInt(D[1],10)/100*H[I?0:1]),q&&E.css(z?{height:0,width:G}:{height:G,width:0}),y[B[0]]=q?H[0]:G,C[B[1]]=q?H[1]:0,E.animate(y,k,J.easing).animate(C,k,J.easing,function(){I&&e.hide(),c.effects.restore(e,A),c.effects.removeWrapper(e),x()})}})(jQuery);(function(c,a){c.effects.effect.highlight=function(f,m){var h=c(this),e=["backgroundImage","backgroundColor","opacity"],g=c.effects.setMode(h,f.mode||"show"),k={backgroundColor:h.css("backgroundColor")};g==="hide"&&(k.opacity=0),c.effects.save(h,e),h.show().css({backgroundImage:"none",backgroundColor:f.color||"#ffff99"}).animate(k,{queue:!1,duration:f.duration,easing:f.easing,complete:function(){g==="hide"&&h.hide(),c.effects.restore(h,e),m()}})}})(jQuery);(function(c,a){c.effects.effect.pulsate=function(C,m){var e=c(this),v=c.effects.setMode(e,C.mode||"show"),D=v==="show",k=v==="hide",B=D||v==="hide",A=(C.times||5)*2+(B?1:0),y=C.duration/A,q=0,z=e.queue(),x=z.length,g;if(D||!e.is(":visible")){e.css("opacity",0).show(),q=1}for(g=1;g<A;g++){e.animate({opacity:q},y,C.easing),q=1-q}e.animate({opacity:q},y,C.easing),e.queue(function(){k&&e.hide(),m()}),x>1&&z.splice.apply(z,[1,0].concat(z.splice(x,A+1))),e.dequeue()}})(jQuery);(function(c,a){c.effects.effect.puff=function(h,v){var m=c(this),g=c.effects.setMode(m,h.mode||"hide"),k=g==="hide",q=parseInt(h.percent,10)||150,f=q/100,e={height:m.height(),width:m.width(),outerHeight:m.outerHeight(),outerWidth:m.outerWidth()};c.extend(h,{effect:"scale",queue:!1,fade:!0,mode:g,complete:v,percent:k?q:100,from:k?e:{height:e.height*f,width:e.width*f,outerHeight:e.outerHeight*f,outerWidth:e.outerWidth*f}}),m.effect(h)},c.effects.effect.scale=function(y,h){var e=c(this),m=c.extend(!0,{},y),z=c.effects.setMode(e,y.mode||"effect"),g=parseInt(y.percent,10)||(parseInt(y.percent,10)===0?0:z==="hide"?0:100),x=y.direction||"both",v=y.origin,q={height:e.height(),width:e.width(),outerHeight:e.outerHeight(),outerWidth:e.outerWidth()},k={y:x!=="horizontal"?g/100:1,x:x!=="vertical"?g/100:1};m.effect="size",m.queue=!1,m.complete=h,z!=="effect"&&(m.origin=v||["middle","center"],m.restore=!0),m.from=y.from||(z==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:q),m.to={height:q.height*k.y,width:q.width*k.x,outerHeight:q.outerHeight*k.y,outerWidth:q.outerWidth*k.x},m.fade&&(z==="show"&&(m.from.opacity=0,m.to.opacity=1),z==="hide"&&(m.from.opacity=1,m.to.opacity=0)),e.effect(m)},c.effects.effect.size=function(x,D){var A,G,z,C=c(this),q=["position","top","bottom","left","right","width","height","overflow","opacity"],O=["position","top","bottom","left","right","overflow","opacity"],J=["width","height","overflow"],F=["fontSize"],M=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],H=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],B=c.effects.setMode(C,x.mode||"effect"),K=x.restore||B!=="effect",k=x.scale||"both",E=x.origin||["middle","center"],I=C.css("position"),e=K?q:O,N={height:0,width:0,outerHeight:0,outerWidth:0};B==="show"&&C.show(),A={height:C.height(),width:C.width(),outerHeight:C.outerHeight(),outerWidth:C.outerWidth()},x.mode==="toggle"&&B==="show"?(C.from=x.to||N,C.to=x.from||A):(C.from=x.from||(B==="show"?N:A),C.to=x.to||(B==="hide"?N:A)),z={from:{y:C.from.height/A.height,x:C.from.width/A.width},to:{y:C.to.height/A.height,x:C.to.width/A.width}};if(k==="box"||k==="both"){z.from.y!==z.to.y&&(e=e.concat(M),C.from=c.effects.setTransition(C,M,z.from.y,C.from),C.to=c.effects.setTransition(C,M,z.to.y,C.to)),z.from.x!==z.to.x&&(e=e.concat(H),C.from=c.effects.setTransition(C,H,z.from.x,C.from),C.to=c.effects.setTransition(C,H,z.to.x,C.to))}(k==="content"||k==="both")&&z.from.y!==z.to.y&&(e=e.concat(F).concat(J),C.from=c.effects.setTransition(C,F,z.from.y,C.from),C.to=c.effects.setTransition(C,F,z.to.y,C.to)),c.effects.save(C,e),C.show(),c.effects.createWrapper(C),C.css("overflow","hidden").css(C.from),E&&(G=c.effects.getBaseline(E,A),C.from.top=(A.outerHeight-C.outerHeight())*G.y,C.from.left=(A.outerWidth-C.outerWidth())*G.x,C.to.top=(A.outerHeight-C.to.outerHeight)*G.y,C.to.left=(A.outerWidth-C.to.outerWidth)*G.x),C.css(C.from);if(k==="content"||k==="both"){M=M.concat(["marginTop","marginBottom"]).concat(F),H=H.concat(["marginLeft","marginRight"]),J=q.concat(M).concat(H),C.find("*[width]").each(function(){var g=c(this),f={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()};K&&c.effects.save(g,J),g.from={height:f.height*z.from.y,width:f.width*z.from.x,outerHeight:f.outerHeight*z.from.y,outerWidth:f.outerWidth*z.from.x},g.to={height:f.height*z.to.y,width:f.width*z.to.x,outerHeight:f.height*z.to.y,outerWidth:f.width*z.to.x},z.from.y!==z.to.y&&(g.from=c.effects.setTransition(g,M,z.from.y,g.from),g.to=c.effects.setTransition(g,M,z.to.y,g.to)),z.from.x!==z.to.x&&(g.from=c.effects.setTransition(g,H,z.from.x,g.from),g.to=c.effects.setTransition(g,H,z.to.x,g.to)),g.css(g.from),g.animate(g.to,x.duration,x.easing,function(){K&&c.effects.restore(g,J)})})}C.animate(C.to,{queue:!1,duration:x.duration,easing:x.easing,complete:function(){C.to.opacity===0&&C.css("opacity",C.from.opacity),B==="hide"&&C.hide(),c.effects.restore(C,e),K||(I==="static"?C.css({position:"relative",top:C.to.top,left:C.to.left}):c.each(["top","left"],function(g,f){C.css(f,function(m,u){var o=parseInt(u,10),h=g?C.to.left:C.to.top;return u==="auto"?h+"px":o+h+"px"})})),c.effects.removeWrapper(C),D()}})}})(jQuery);(function(c,a){c.effects.effect.shake=function(x,D){var A=c(this),G=["position","top","bottom","left","right","height","width"],z=c.effects.setMode(A,x.mode||"effect"),C=x.direction||"left",q=x.distance||20,N=x.times||3,J=N*2+1,F=Math.round(x.duration/J),M=C==="up"||C==="down"?"top":"left",H=C==="up"||C==="left",B={},K={},k={},E,I=A.queue(),e=I.length;c.effects.save(A,G),A.show(),c.effects.createWrapper(A),B[M]=(H?"-=":"+=")+q,K[M]=(H?"+=":"-=")+q*2,k[M]=(H?"-=":"+=")+q*2,A.animate(B,F,x.easing);for(E=1;E<N;E++){A.animate(K,F,x.easing).animate(k,F,x.easing)}A.animate(K,F,x.easing).animate(B,F/2,x.easing).queue(function(){z==="hide"&&A.hide(),c.effects.restore(A,G),c.effects.removeWrapper(A),D()}),e>1&&I.splice.apply(I,[1,0].concat(I.splice(e,J+1))),A.dequeue()}})(jQuery);(function(c,a){c.effects.effect.slide=function(z,h){var e=c(this),m=["position","top","bottom","left","right","width","height"],A=c.effects.setMode(e,z.mode||"show"),g=A==="show",y=z.direction||"left",x=y==="up"||y==="down"?"top":"left",q=y==="up"||y==="left",k,v={};c.effects.save(e,m),e.show(),k=z.distance||e[x==="top"?"outerHeight":"outerWidth"](!0),c.effects.createWrapper(e).css({overflow:"hidden"}),g&&e.css(x,q?isNaN(k)?"-"+k:-k:k),v[x]=(g?q?"+=":"-=":q?"-=":"+=")+k,e.animate(v,{queue:!1,duration:z.duration,easing:z.easing,complete:function(){A==="hide"&&e.hide(),c.effects.restore(e,m),c.effects.removeWrapper(e),h()}})}})(jQuery);(function(c,a){c.effects.effect.transfer=function(B,k){var e=c(this),q=c(B.to),C=q.css("position")==="fixed",g=c("body"),A=C?g.scrollTop():0,z=C?g.scrollLeft():0,x=q.offset(),m={top:x.top-A,left:x.left-z,height:q.innerHeight(),width:q.innerWidth()},y=e.offset(),v=c('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(B.className).css({top:y.top-A,left:y.left-z,height:e.innerHeight(),width:e.innerWidth(),position:C?"fixed":"absolute"}).animate(m,B.duration,B.easing,function(){v.remove(),k()})}})(jQuery);(function(a){if(a&&window.XDomainRequest){a.ajaxTransport(function(e){if(e.crossDomain&&e.async){if(e.timeout){e.xdrTimeout=e.timeout;delete e.timeout}var c;return{send:function(g,f){function h(k,o,n,m){c.onload=c.onerror=c.ontimeout=function(){};c=undefined;f(k,o,n,m)}c=new XDomainRequest();c.open(e.type,e.url);c.onload=function(){h(200,"OK",{text:c.responseText},"Content-Type: "+c.contentType)};c.onerror=function(){h(404,"Not Found")};c.ontimeout=function(){h(0,"timeout")};if(e.xdrTimeout){c.timeout=e.xdrTimeout}else{c.timeout=5000}c.onprogress=function(){};c.send((e.hasContent&&e.data)||null)},abort:function(){if(c){c.onerror=a.noop;c.abort()}}}}})}})(jQuery);(function(c){function a(e){this.options=c.extend({},a.defaults,e)}a.instances=[];a.repositionAll=function(){for(var f=0;f<a.instances.length;f++){if(!a.instances[f]){continue}var e=a.instances[f].options;new a(e).positionImg(c(a.instances[f].target),c.data(a.instances[f].target,"busy"),e.position)}};a.prototype.hide=function(e){e.each(function(){var g=c.data(this,"busy");if(g){g.remove()}c(this).css("visibility","");c.data(this,"busy",null);for(var f=0;f<a.instances.length;f++){if(a.instances[f]!=null&&a.instances[f].target==this){a.instances[f]=null}}})};a.prototype.show=function(e){var f=this;e.each(function(){if(c.data(this,"busy")){return}var h=c(this);var g=f.buildImg();g.css("visibility","hidden");g.load(function(){f.positionImg(h,g,f.options.position);g.css("visibility","")});c("body").append(g);if(f.options.hide){h.css("visibility","hidden")}c.data(this,"busy",g);a.instances.push({target:this,options:f.options})})};a.prototype.preload=function(){var e=this.buildImg();e.css("visibility","hidden");e.load(function(){c(this).remove()});c("body").append(e)};a.prototype.buildImg=function(){var e="<img src='"+this.options.img+"' alt='"+this.options.alt+"' title='"+this.options.title+"'";if(this.options.width){e+=" width='"+this.options.width+"'"}if(this.options.height){e+=" height='"+this.options.height+"'"}e+=" />";return c(e)};a.prototype.positionImg=function(n,e,k){var h=n.offset();var o=n.outerWidth();var m=n.outerHeight();var q=e.outerWidth();var r=e.outerHeight();if(k=="left"){var f=h.left-q-this.options.offset}else{if(k=="right"){var f=h.left+o+this.options.offset}else{var f=h.left+(o-q)/2}}var g=h.top+(m-r)/2;e.css("position","absolute");e.css("left",f+"px");e.css("top",g+"px")};a.defaults={img:"busy.gif",alt:"Please wait...",title:"Please wait...",hide:true,position:"center",zIndex:1001,width:null,height:null,offset:10};c.fn.busy=function(e,f){if(c.inArray(e,["clear","hide","remove"])!=-1){new a(e).hide(c(this))}else{if(e=="defaults"){c.extend(a.defaults,f||{})}else{if(e=="preload"){new a(e).preload()}else{if(e=="reposition"){a.repositionAll()}else{new a(e).show(c(this));return c(this)}}}}}})(jQuery);(function(a){function c(e){this.options=a.extend({},c.defaults,e)}c.prototype.hide=function(e){e.each(function(){var f=a.data(this,"loader");if(f){f.remove()}a.data(this,"loader",null)})};c.prototype.show=function(e){var f=this;e.each(function(){if(a.data(this,"loader")){return}var h=(h?h:"Loading...");var g=jQuery("<div style='width:100%; text-align:center;' class='loader' ></div> ");g.html('<div style=\'margin:5px auto;\'><div class="loading" style="margin:0 auto;width:16px;height:16px" alt=\''+h+"'></div></div>");var k=a(this);g.appendTo(k);a.data(this,"loader",g)})};a.fn.loader=function(e,f){if(a.inArray(e,["clear","hide","remove"])!=-1){new c(e).hide(a(this));return a(this)}else{new c(e).show(a(this));return a(this)}}})(jQuery);(function(a){a.address=(function(){var f=function(av){a(a.address).trigger(a.extend(a.Event(av),(function(){var az={},ay=a.address.parameterNames();for(var ax=0,aw=ay.length;ax<aw;ax++){az[ay[ax]]=a.address.parameter(ay[ax])}return{value:a.address.value(),path:a.address.path(),pathNames:a.address.pathNames(),parameterNames:ay,parameters:az,queryString:a.address.queryString()}}).call(a.address)))},o=function(ax,aw,av){a().bind.apply(a(a.address),Array.prototype.slice.call(arguments));return a.address},X=function(){return(al.pushState&&O.state!==S)},R=function(){return("/"+ah.pathname.replace(new RegExp(O.state),"")+ah.search+(ad()?"#"+ad():"")).replace(Z,"/")},ad=function(){var av=ah.href.indexOf("#");return av!=-1?N(ah.href.substr(av+1),am):""},I=function(){return X()?R():ad()},c=function(){return window},r=function(){return"javascript"},at=function(av){av=av.toString();return(O.strict&&av.substr(0,1)!="/"?"/":"")+av},N=function(av,aw){if(O.crawlable&&aw){return(av!==""?"!":"")+av}return av.replace(/^\!/,"")},ac=function(av,aw){return parseInt(av.css(aw),10)},q=function(az){var aw,ay;for(var ax=0,av=az.childNodes.length;ax<av;ax++){try{if("src" in az.childNodes[ax]&&az.childNodes[ax].src){aw=String(az.childNodes[ax].src)}}catch(aA){}ay=q(az.childNodes[ax]);if(ay){aw=ay}}return aw},ak=function(){if(!B){var aw=I(),av=af!=aw;if(av){if(m&&y<7){ah.reload()}else{if(m&&y<8&&O.history){u(P,50)}af=aw;ai(am)}}}},ai=function(av){f(Q);f(av?k:ar);u(F,10)},F=function(){if(O.tracker!=="null"&&O.tracker!==null){var av=a.isFunction(O.tracker)?O.tracker:aa[O.tracker],aw=(ah.pathname+ah.search+(a.address&&!X()?a.address.value():"")).replace(/\/\//,"/").replace(/^\/$/,"");if(a.isFunction(av)){av(aw)}else{if(a.isFunction(aa.urchinTracker)){aa.urchinTracker(aw)}else{if(aa.pageTracker!==S&&a.isFunction(aa.pageTracker._trackPageview)){aa.pageTracker._trackPageview(aw)}else{if(aa._gaq!==S&&a.isFunction(aa._gaq.push)){aa._gaq.push(["_trackPageview",decodeURI(aw)])}}}}}},P=function(){var av=r()+":"+am+";document.open();document.writeln('<html><head><title>"+ap.title.replace("'","\\'")+"</title><script>var "+H+' = "'+encodeURIComponent(I())+(ap.domain!=ah.hostname?'";document.domain="'+ap.domain:"")+"\";<\/script></head></html>');document.close();";if(y<7){g.src=av}else{g.contentWindow.location.replace(av)}},an=function(){if(n&&e!=-1){var aw,av=n.substr(e+1).split("&");for(i=0;i<av.length;i++){aw=av[i].split("=");if(/^(autoUpdate|crawlable|history|strict|wrap)$/.test(aw[0])){O[aw[0]]=(isNaN(aw[1])?/^(true|yes)$/i.test(aw[1]):(parseInt(aw[1],10)!==0))}if(/^(state|tracker)$/.test(aw[0])){O[aw[0]]=aw[1]}}n=null}af=I()},ab=function(){if(!ag){ag=M;an();var ax=function(){E.call(this);z.call(this)},aw=a("body").ajaxComplete(ax);ax();if(O.wrap){var ay=a("body > *").wrapAll('<div style="padding:'+(ac(aw,"marginTop")+ac(aw,"paddingTop"))+"px "+(ac(aw,"marginRight")+ac(aw,"paddingRight"))+"px "+(ac(aw,"marginBottom")+ac(aw,"paddingBottom"))+"px "+(ac(aw,"marginLeft")+ac(aw,"paddingLeft"))+'px;" />').parent().wrap('<div id="'+H+'" style="height:100%;overflow:auto;position:relative;'+(A&&!window.statusbar.visible?"resize:both;":"")+'" />');a("html, body").css({height:"100%",margin:0,padding:0,overflow:"hidden"});if(A){a('<style type="text/css" />').appendTo("head").text("#"+H+"::-webkit-resizer { background-color: #fff; }")}}if(m&&y<8){var av=ap.getElementsByTagName("frameset")[0];g=ap.createElement((av?"":"i")+"frame");if(av){av.insertAdjacentElement("beforeEnd",g);av[av.cols?"cols":"rows"]+=",0";g.noResize=M;g.frameBorder=g.frameSpacing=0}else{g.style.display="none";g.style.width=g.style.height=0;g.tabIndex=-1;ap.body.insertAdjacentElement("afterBegin",g)}u(function(){a(g).bind("load",function(){var az=g.contentWindow;af=az[H]!==S?az[H]:"";if(af!=I()){ai(am);ah.hash=N(af,M)}});if(g.contentWindow[H]===S){P()}},50)}u(function(){f("init");ai(am)},1);if(!X()){if((m&&y>7)||(!m&&("on"+ae) in aa)){if(aa.addEventListener){aa.addEventListener(ae,ak,am)}else{if(aa.attachEvent){aa.attachEvent("on"+ae,ak)}}}else{C(ak,50)}}}},E=function(){var ay,aA=a("a"),az=aA.size(),aw=1,av=-1,ax=function(){if(++av!=az){ay=a(aA.get(av));if(ay.is('[rel*="address:"]')){ay.address()}u(ax,aw)}};u(ax,aw)},x=function(){if(af!=I()){af=I();ai(am)}},v=function(){if(aa.removeEventListener){aa.removeEventListener(ae,ak,am)}else{if(aa.detachEvent){aa.detachEvent("on"+ae,ak)}}},z=function(){if(O.crawlable){var aw=ah.pathname.replace(/\/$/,""),av="_escaped_fragment_";if(a("body").html().indexOf(av)!=-1){a('a[href]:not([href^=http]), a[href*="'+document.domain+'"]').each(function(){var ax=a(this).attr("href").replace(/^http:/,"").replace(new RegExp(aw+"/?$"),"");if(ax===""||ax.indexOf(av)!=-1){a(this).attr("href","#"+ax.replace(new RegExp("/(.*)\\?"+av+"=(.*)$"),"!$2"))}})}}},S,H="jQueryAddress",aj="string",ae="hashchange",t="init",Q="change",k="internalChange",ar="externalChange",M=true,am=false,O={autoUpdate:M,crawlable:am,history:M,strict:M,wrap:am},K=a.browser,y=parseFloat(a.browser.version),ao=K.mozilla,m=K.msie,W=K.opera,A=K.webkit||K.safari,aq=am,aa=c(),ap=aa.document,al=aa.history,ah=aa.location,C=setInterval,u=setTimeout,Z=/\/{2,9}/g,au=navigator.userAgent,g,U,n=q(document),e=n?n.indexOf("?"):-1,T=ap.title,B=am,ag=am,Y=M,V=M,G=am,J={},af=I();if(m){y=parseFloat(au.substr(au.indexOf("MSIE")+4));if(ap.documentMode&&ap.documentMode!=y){y=ap.documentMode!=8?7:8}var D=ap.onpropertychange;ap.onpropertychange=function(){if(D){D.call(ap)}if(ap.title!=T&&ap.title.indexOf("#"+I())!=-1){ap.title=T}}}aq=(ao&&y>=1)||(m&&y>=6)||(W&&y>=9.5)||(A&&y>=523);if(aq){if(W){history.navigationMode="compatible"}if(document.readyState=="complete"){var h=setInterval(function(){if(a.address){ab();clearInterval(h)}},50)}else{an();a(ab)}a(window).bind("popstate",x).bind("unload",v)}else{if(!aq&&ad()!==""){ah.replace(ah.href.substr(0,ah.href.indexOf("#")))}else{F()}}return{bind:function(aw,ax,av){return o(aw,ax,av)},init:function(av){return o(t,av)},change:function(av){return o(Q,av)},internalChange:function(av){return o(k,av)},externalChange:function(av){return o(ar,av)},baseURL:function(){var av=ah.href;if(av.indexOf("#")!=-1){av=av.substr(0,av.indexOf("#"))}if(/\/$/.test(av)){av=av.substr(0,av.length-1)}return av},autoUpdate:function(av){if(av!==S){O.autoUpdate=av;return this}return O.autoUpdate},crawlable:function(av){if(av!==S){O.crawlable=av;return this}return O.crawlable},history:function(av){if(av!==S){O.history=av;return this}return O.history},state:function(av){if(av!==S){O.state=av;var aw=R();if(O.state!==S){if(al.pushState){if(aw.substr(0,3)=="/#/"){ah.replace(O.state.replace(/^\/$/,"")+aw.substr(2))}}else{if(aw!="/"&&aw.replace(/^\/#/,"")!=ad()){u(function(){ah.replace(O.state.replace(/^\/$/,"")+"/#"+aw)},1)}}}return this}return O.state},strict:function(av){if(av!==S){O.strict=av;return this}return O.strict},tracker:function(av){if(av!==S){O.tracker=av;return this}return O.tracker},wrap:function(av){if(av!==S){O.wrap=av;return this}return O.wrap},update:function(){G=M;this.value(af);G=am;return this},title:function(av){if(av!==S){u(function(){T=ap.title=av;if(V&&g&&g.contentWindow&&g.contentWindow.document){g.contentWindow.document.title=av;V=am}if(!Y&&ao){ah.replace(ah.href.indexOf("#")!=-1?ah.href:ah.href+"#")}Y=am},50);return this}return ap.title},value:function(av){if(av!==S){av=at(av);if(av=="/"){av=""}if(af==av&&!G){return}Y=M;af=av;if(O.autoUpdate||G){ai(M);if(X()){al[O.history?"pushState":"replaceState"]({},"",O.state.replace(/\/$/,"")+(af===""?"/":af))}else{B=M;if(A){if(O.history){ah.hash="#"+N(af,M)}else{ah.replace("#"+N(af,M))}}else{if(af!=I()){if(O.history){ah.hash="#"+N(af,M)}else{ah.replace("#"+N(af,M))}}}if((m&&y<8)&&O.history){u(P,50)}if(A){u(function(){B=am},1)}else{B=am}}}return this}if(!aq){return null}return at(af)},path:function(aw){if(aw!==S){var av=this.queryString(),ax=this.hash();this.value(aw+(av?"?"+av:"")+(ax?"#"+ax:""));return this}return at(af).split("#")[0].split("?")[0]},pathNames:function(){var aw=this.path(),av=aw.replace(Z,"/").split("/");if(aw.substr(0,1)=="/"||aw.length===0){av.splice(0,1)}if(aw.substr(aw.length-1,1)=="/"){av.splice(av.length-1,1)}return av},queryString:function(aw){if(aw!==S){var ax=this.hash();this.value(this.path()+(aw?"?"+aw:"")+(ax?"#"+ax:""));return this}var av=af.split("?");return av.slice(1,av.length).join("?").split("#")[0]},parameter:function(aw,aE,ay){var aC,aA;if(aE!==S){var aD=this.parameterNames();aA=[];aE=aE?aE.toString():"";for(aC=0;aC<aD.length;aC++){var az=aD[aC],aF=this.parameter(az);if(typeof aF==aj){aF=[aF]}if(az==aw){aF=(aE===null||aE==="")?[]:(ay?aF.concat([aE]):[aE])}for(var aB=0;aB<aF.length;aB++){aA.push(az+"="+aF[aB])}}if(a.inArray(aw,aD)==-1&&aE!==null&&aE!==""){aA.push(aw+"="+aE)}this.queryString(aA.join("&"));return this}aE=this.queryString();if(aE){var av=[];aA=aE.split("&");for(aC=0;aC<aA.length;aC++){var ax=aA[aC].split("=");if(ax[0]==aw){av.push(ax.slice(1).join("="))}}if(av.length!==0){return av.length!=1?av:av[0]}}},parameterNames:function(){var av=this.queryString(),ay=[];if(av&&av.indexOf("=")!=-1){var az=av.split("&");for(var ax=0;ax<az.length;ax++){var aw=az[ax].split("=")[0];if(a.inArray(aw,ay)==-1){ay.push(aw)}}}return ay},hash:function(aw){if(aw!==S){this.value(af.split("#")[0]+(aw?"#"+aw:""));return this}var av=af.split("#");return av.slice(1,av.length).join("#")}}})();a.fn.address=function(c){if(!a(this).attr("address")){var e=function(g){if(g.shiftKey||g.ctrlKey||g.metaKey){return true}if(a(this).is("a")){var f=c?c.call(this):/address:/.test(a(this).attr("rel"))?a(this).attr("rel").split("address:")[1].split(" ")[0]:a.address.state()!==undefined&&a.address.state()!="/"?a(this).attr("href").replace(new RegExp("^(.*"+a.address.state()+"|\\.)"),""):a(this).attr("href").replace(/^(#\!?|\.)/,"");a.address.value(f);g.preventDefault()}};a(this).click(e).live("click",e).live("submit",function(h){if(a(this).is("form")){var g=a(this).attr("action"),f=c?c.call(this):(g.indexOf("?")!=-1?g.replace(/&$/,""):g+"?")+a(this).serialize();a.address.value(f);h.preventDefault()}}).attr("address",true)}return this}})(jQuery);(function(g){var h={},e={},o={},m={},r={},k=null;function f(t,u){if(t.height()&&t.width()){clearInterval(e[u]);clearTimeout(o[u]);delete e[u];delete o[u];delete m[u];h[u].resolveWith(t,[t[0]])}}function a(t){console.log("timeout",t);if(e[t]){clearInterval(e[t]);delete e[t];delete o[t];delete r[t];h[t].reject()}}function c(u,v){var t=new g.Deferred();m[v]=function(){f(u,v)};r[v]=function(){a(v)};e[v]=setInterval(m[v],100);o[v]=setTimeout(r[v],5000);u.load(m[v]);h[v]=t;return h[v]}function n(){return g("<div/>",{id:"a"+Math.floor(Math.random()*1000),css:{width:"1px",height:"1px",position:"absolute",top:"-5000px",left:"-5000px",overflow:"hidden"}}).appendTo("body")}function q(v){var t,u=v&&v.replace&&v.replace(/[\W]+/g,"_");if(!u){return null}if(h[u]){return h[u].promise()}if(!k){k=n()}t=g("<img/>",{src:v}).appendTo(k);return c(t,u).promise()}g.loadImage=q;g.fn.loadImage=function(t){if(!this.is("img")){return null}return q(this.attr("src")||t)}}(jQuery));(function(ab,aI,az,ae,aE,ah){var aJ=this;var aB=Math.floor(Math.random()*100)*100;var ay=Function.prototype;var Y=/^(http.?:\/\/([^\/\s]+))/;var X=/[\-\w]+\/\.\.\//;var aj=/([^:])\/\//g;var ag="";var aA={};var ac=ab.easyXDM;var U="easyXDM_";var ak;function am(e,a){var c=typeof e[a];return c=="function"||(!!(c=="object"&&e[a]))||c=="unknown"}function au(c,a){return !!(typeof(c[a])=="object"&&c[a])}function ax(a){return Object.prototype.toString.call(a)==="[object Array]"}var at,aq;if(am(ab,"addEventListener")){at=function(a,e,c){a.addEventListener(e,c,false)};aq=function(a,e,c){a.removeEventListener(e,c,false)}}else{if(am(ab,"attachEvent")){at=function(e,a,c){e.attachEvent("on"+a,c)};aq=function(e,a,c){e.detachEvent("on"+a,c)}}else{throw new Error("Browser not supported")}}var S=false,af=[],ad;if("readyState" in aI){ad=aI.readyState;S=ad=="complete"||(~navigator.userAgent.indexOf("AppleWebKit/")&&(ad=="loaded"||ad=="interactive"))}else{S=!!aI.body}function aw(){aw=ay;S=true;for(var a=0;a<af.length;a++){af[a]()}af.length=0}if(!S){if(am(ab,"addEventListener")){at(aI,"DOMContentLoaded",aw)}else{at(aI,"readystatechange",function(){if(aI.readyState=="complete"){aw()}});if(aI.documentElement.doScroll&&ab===top){(function aG(){if(S){return}try{aI.documentElement.doScroll("left")}catch(a){ae(aG,1);return}aw()}())}}at(ab,"load",aw)}function ai(a,c){if(S){a.call(c);return}af.push(function(){a.call(c)})}function aC(){var a=parent;if(ag!==""){for(var e=0,c=ag.split(".");e<c.length;e++){a=a[c[e]]}}return a.easyXDM}function aH(a){ab.easyXDM=ac;ag=a;if(ag){U="easyXDM_"+ag.replace(".","_")+"_"}return aA}function ap(a){return a.match(Y)[2]}function aF(a){return a.match(Y)[1]}function an(c){c=c.replace(aj,"$1/");if(!c.match(/^(http||https):\/\//)){var a=(c.substring(0,1)==="/")?"":az.pathname;if(a.substring(a.length-1)!=="/"){a=a.substring(0,a.lastIndexOf("/")+1)}c=az.protocol+"//"+az.host+a+c}while(X.test(c)){c=c.replace(X,"")}return c}function Z(g,c){var h="",e=g.indexOf("#");if(e!==-1){h=g.substring(e);g=g.substring(0,e)}var a=[];for(var f in c){if(c.hasOwnProperty(f)){a.push(f+"="+ah(c[f]))}}return g+((g.indexOf("?")===-1)?"?":"&")+a.join("&")+h}var W=(function(){var c={},a,e=az.search.substring(1).split("&"),f=e.length;while(f--){a=e[f].split("=");c[a[0]]=aE(a[1])}return c}());function av(a){return typeof a==="undefined"}function aa(){var c={};var a={a:[1,2,3]},e='{"a":[1,2,3]}';if(JSON&&typeof JSON.stringify==="function"&&JSON.stringify(a).replace((/\s/g),"")===e){return JSON}if(Object.toJSON){if(Object.toJSON(a).replace((/\s/g),"")===e){c.stringify=Object.toJSON}}if(typeof String.prototype.evalJSON==="function"){a=e.evalJSON();if(a.a&&a.a.length===3&&a.a[2]===3){c.parse=function(f){return f.evalJSON()}}}if(c.stringify&&c.parse){aa=function(){return c};return c}return null}function V(g,f,e){var a;for(var c in f){if(f.hasOwnProperty(c)){if(c in g){a=f[c];if(typeof a==="object"){V(g[c],a,e)}else{if(!e){g[c]=f[c]}}}else{g[c]=f[c]}}}return g}function aK(){var a=aI.createElement("iframe");a.name=U+"TEST";V(a.style,{position:"absolute",left:"-2000px",top:"0px"});aI.body.appendChild(a);ak=!(a.contentWindow===ab.frames[a.name]);aI.body.removeChild(a)}function ao(c){if(av(ak)){aK()}var a;if(ak){a=aI.createElement('<iframe name="'+c.props.name+'"/>')}else{a=aI.createElement("IFRAME");a.name=c.props.name}a.id=a.name=c.props.name;delete c.props.name;if(c.onLoad){at(a,"load",c.onLoad)}if(typeof c.container=="string"){c.container=aI.getElementById(c.container)}if(!c.container){a.style.position="absolute";a.style.left="-2000px";a.style.top="0px";c.container=aI.body}a.border=a.frameBorder=0;c.container.insertBefore(a,c.container.firstChild);V(a,c.props);return a}function T(a,c){if(typeof a=="string"){a=[a]}var e,f=a.length;while(f--){e=a[f];e=new RegExp(e.substr(0,1)=="^"?e:("^"+e.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"));if(e.test(c)){return true}}return false}function aD(e){var h=e.protocol,f;e.isHost=e.isHost||av(W.xdm_p);if(!e.props){e.props={}}if(!e.isHost){e.channel=W.xdm_c;e.secret=W.xdm_s;e.remote=W.xdm_e;h=W.xdm_p;if(e.acl&&!T(e.acl,e.remote)){throw new Error("Access denied for "+e.remote)}}else{e.remote=an(e.remote);e.channel=e.channel||"default"+aB++;e.secret=Math.random().toString(16).substring(2);if(av(h)){if(aF(az.href)==aF(e.remote)){h="4"}else{if(am(ab,"postMessage")||am(aI,"postMessage")){h="1"}else{if(am(ab,"ActiveXObject")&&am(ab,"execScript")){h="3"}else{if(navigator.product==="Gecko"&&"frameElement" in ab&&navigator.userAgent.indexOf("WebKit")==-1){h="5"}else{if(e.remoteHelper){e.remoteHelper=an(e.remoteHelper);h="2"}else{h="0"}}}}}}}switch(h){case"0":V(e,{interval:100,delay:2000,useResize:true,useParent:false,usePolling:false},true);if(e.isHost){if(!e.local){var m=az.protocol+"//"+az.host,g=aI.body.getElementsByTagName("img"),k;var c=g.length;while(c--){k=g[c];if(k.src.substring(0,m.length)===m){e.local=k.src;break}}if(!e.local){e.local=ab}}var a={xdm_c:e.channel,xdm_p:0};if(e.local===ab){e.usePolling=true;e.useParent=true;e.local=az.protocol+"//"+az.host+az.pathname+az.search;a.xdm_e=e.local;a.xdm_pa=1}else{a.xdm_e=an(e.local)}if(e.container){e.useResize=false;a.xdm_po=1}e.remote=Z(e.remote,a)}else{V(e,{channel:W.xdm_c,remote:W.xdm_e,useParent:!av(W.xdm_pa),usePolling:!av(W.xdm_po),useResize:e.useParent?false:e.useResize})}f=[new aA.stack.HashTransport(e),new aA.stack.ReliableBehavior({}),new aA.stack.QueueBehavior({encode:true,maxLength:4000-e.remote.length}),new aA.stack.VerifyBehavior({initiate:e.isHost})];break;case"1":f=[new aA.stack.PostMessageTransport(e)];break;case"2":f=[new aA.stack.NameTransport(e),new aA.stack.QueueBehavior(),new aA.stack.VerifyBehavior({initiate:e.isHost})];break;case"3":f=[new aA.stack.NixTransport(e)];break;case"4":f=[new aA.stack.SameOriginTransport(e)];break;case"5":f=[new aA.stack.FrameElementTransport(e)];break}f.push(new aA.stack.QueueBehavior({lazy:e.lazy,remove:true}));return f}function al(c){var a,e={incoming:function(h,k){this.up.incoming(h,k)},outgoing:function(k,h){this.down.outgoing(k,h)},callback:function(h){this.up.callback(h)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}};for(var f=0,g=c.length;f<g;f++){a=c[f];V(a,e,true);if(f!==0){a.down=c[f-1]}if(f!==g-1){a.up=c[f+1]}}return a}function ar(a){a.up.down=a.down;a.down.up=a.up;a.up=a.down=null}V(aA,{version:"2.4.10.103",query:W,stack:{},apply:V,getJSONObject:aa,whenReady:ai,noConflict:aH});aA.DomHelper={on:at,un:aq,requiresJSON:function(a){if(!au(ab,"JSON")){aI.write('<script type="text/javascript" src="'+a+'"><\/script>')}}};(function(){var a={};aA.Fn={set:function(e,c){a[e]=c},get:function(e,f){var c=a[e];if(f){delete a[e]}return c}}}());aA.Socket=function(c){var e=al(aD(c).concat([{incoming:function(f,g){c.onMessage(f,g)},callback:function(f){if(c.onReady){c.onReady(f)}}}])),a=aF(c.remote);this.origin=aF(c.remote);this.destroy=function(){e.destroy()};this.postMessage=function(f){e.outgoing(f,a)};e.init()};aA.Rpc=function(e,f){if(f.local){for(var a in f.local){if(f.local.hasOwnProperty(a)){var c=f.local[a];if(typeof c==="function"){f.local[a]={method:c}}}}}var g=al(aD(e).concat([new aA.stack.RpcBehavior(this,f),{callback:function(h){if(e.onReady){e.onReady(h)}}}]));this.origin=aF(e.remote);this.destroy=function(){g.destroy()};g.init()};aA.stack.SameOriginTransport=function(f){var e,a,c,g;return(e={outgoing:function(k,h,m){c(k);if(m){m()}},destroy:function(){if(a){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){g=aF(f.remote);if(f.isHost){V(f.props,{src:Z(f.remote,{xdm_e:az.protocol+"//"+az.host+az.pathname,xdm_c:f.channel,xdm_p:4}),name:U+f.channel+"_provider"});a=ao(f);aA.Fn.set(f.channel,function(h){c=h;ae(function(){e.up.callback(true)},0);return function(k){e.up.incoming(k,g)}})}else{c=aC().Fn.get(f.channel,true)(function(h){e.up.incoming(h,g)});ae(function(){e.up.callback(true)},0)}},init:function(){ai(e.onDOMReady,e)}})};aA.stack.PostMessageTransport=function(c){var k,h,f,e;function g(m){if(m.origin){return m.origin}if(m.uri){return aF(m.uri)}if(m.domain){return az.protocol+"//"+m.domain}throw"Unable to retrieve the origin of the event"}function a(n){var m=g(n);if(m==e&&n.data.substring(0,c.channel.length+1)==c.channel+" "){k.up.incoming(n.data.substring(c.channel.length+1),m)}}return(k={outgoing:function(o,m,n){f.postMessage(c.channel+" "+o,m||e);if(n){n()}},destroy:function(){aq(ab,"message",a);if(h){f=null;h.parentNode.removeChild(h);h=null}},onDOMReady:function(){e=aF(c.remote);if(c.isHost){at(ab,"message",function m(n){if(n.data==c.channel+"-ready"){f=("postMessage" in h.contentWindow)?h.contentWindow:h.contentWindow.document;aq(ab,"message",m);at(ab,"message",a);ae(function(){k.up.callback(true)},0)}});V(c.props,{src:Z(c.remote,{xdm_e:az.protocol+"//"+az.host,xdm_c:c.channel,xdm_p:1}),name:U+c.channel+"_provider"});h=ao(c)}else{at(ab,"message",a);f=("postMessage" in ab.parent)?ab.parent:ab.parent.document;f.postMessage(c.channel+"-ready",e);ae(function(){k.up.callback(true)},0)}},init:function(){ai(k.onDOMReady,k)}})};aA.stack.FrameElementTransport=function(f){var e,a,c,g;return(e={outgoing:function(k,h,m){c.call(this,k);if(m){m()}},destroy:function(){if(a){a.parentNode.removeChild(a);a=null}},onDOMReady:function(){g=aF(f.remote);if(f.isHost){V(f.props,{src:Z(f.remote,{xdm_e:az.protocol+"//"+az.host+az.pathname+az.search,xdm_c:f.channel,xdm_p:5}),name:U+f.channel+"_provider"});a=ao(f);a.fn=function(h){delete a.fn;c=h;ae(function(){e.up.callback(true)},0);return function(k){e.up.incoming(k,g)}}}else{ab.parent.location=W.xdm_e+"#";c=ab.frameElement.fn(function(h){e.up.incoming(h,g)});e.up.callback(true)}},init:function(){ai(e.onDOMReady,e)}})};aA.stack.NixTransport=function(f){var c,h,a,g,e;return(c={outgoing:function(m,k,n){a(m);if(n){n()}},destroy:function(){e=null;if(h){h.parentNode.removeChild(h);h=null}},onDOMReady:function(){g=aF(f.remote);if(f.isHost){try{if(!am(ab,"getNixProxy")){ab.execScript("Class NixProxy\n    Private m_parent, m_child, m_Auth\n\n    Public Sub SetParent(obj, auth)\n        If isEmpty(m_Auth) Then m_Auth = auth\n        SET m_parent = obj\n    End Sub\n    Public Sub SetChild(obj)\n        SET m_child = obj\n        m_parent.ready()\n    End Sub\n\n    Public Sub SendToParent(data, auth)\n        If m_Auth = auth Then m_parent.send(CStr(data))\n    End Sub\n    Public Sub SendToChild(data, auth)\n        If m_Auth = auth Then m_child.send(CStr(data))\n    End Sub\nEnd Class\nFunction getNixProxy()\n    Set GetNixProxy = New NixProxy\nEnd Function\n","vbscript")}e=getNixProxy();e.SetParent({send:function(n){c.up.incoming(n,g)},ready:function(){ae(function(){c.up.callback(true)},0)}},f.secret);a=function(n){e.SendToChild(n,f.secret)}}catch(k){throw new Error("Could not set up VBScript NixProxy:"+k.message)}V(f.props,{src:Z(f.remote,{xdm_e:az.protocol+"//"+az.host+az.pathname+az.search,xdm_c:f.channel,xdm_s:f.secret,xdm_p:3}),name:U+f.channel+"_provider"});h=ao(f);h.contentWindow.opener=e}else{ab.parent.location=W.xdm_e+"#";try{e=ab.opener}catch(m){throw new Error("Cannot access window.opener")}e.SetChild({send:function(n){aJ.setTimeout(function(){c.up.incoming(n,g)},0)}});a=function(n){e.SendToParent(n,f.secret)};ae(function(){c.up.callback(true)},0)}},init:function(){ai(c.onDOMReady,c)}})};aA.stack.NameTransport=function(g){var f;var c,q,h,t,r,m,n;function a(u){var v=g.remoteHelper+(c?"#_3":"#_2")+g.channel;q.contentWindow.sendMessage(u,v)}function e(){if(c){if(++t===2||!c){f.up.callback(true)}}else{a("ready");f.up.callback(true)}}function o(u){f.up.incoming(u,m)}function k(){if(r){ae(function(){r(true)},0)}}return(f={outgoing:function(v,u,x){r=x;a(v)},destroy:function(){q.parentNode.removeChild(q);q=null;if(c){h.parentNode.removeChild(h);h=null}},onDOMReady:function(){c=g.isHost;t=0;m=aF(g.remote);g.local=an(g.local);if(c){aA.Fn.set(g.channel,function(v){if(c&&v==="ready"){aA.Fn.set(g.channel,o);e()}});n=Z(g.remote,{xdm_e:g.local,xdm_c:g.channel,xdm_p:2});V(g.props,{src:n+"#"+g.channel,name:U+g.channel+"_provider"});h=ao(g)}else{g.remoteHelper=g.remote;aA.Fn.set(g.channel,o)}q=ao({props:{src:g.local+"#_4"+g.channel},onLoad:function u(){aq(q,"load",u);aA.Fn.set(g.channel+"_load",k);(function v(){if(typeof q.contentWindow.sendMessage=="function"){e()}else{ae(v,50)}}())}})},init:function(){ai(f.onDOMReady,f)}})};aA.stack.HashTransport=function(k){var f;var v=this,a,h,n,e,o,g,q;var x,m;function r(z){if(!q){return}var y=k.remote+"#"+(o++)+"_"+z;((a||!x)?q.contentWindow:q).location=y}function c(y){e=y;f.up.incoming(e.substring(e.indexOf("_")+1),m)}function t(){if(!g){return}var y=g.location.href,z="",A=y.indexOf("#");if(A!=-1){z=y.substring(A)}if(z&&z!=e){c(z)}}function u(){h=setInterval(t,n)}return(f={outgoing:function(y,z){r(y)},destroy:function(){ab.clearInterval(h);if(a||!x){q.parentNode.removeChild(q)}q=null},onDOMReady:function(){a=k.isHost;n=k.interval;e="#"+k.channel;o=0;x=k.useParent;m=aF(k.remote);if(a){k.props={src:k.remote,name:U+k.channel+"_provider"};if(x){k.onLoad=function(){g=ab;u();f.up.callback(true)}}else{var z=0,y=k.delay/50;(function A(){if(++z>y){throw new Error("Unable to reference listenerwindow")}try{g=q.contentWindow.frames[U+k.channel+"_consumer"]}catch(B){}if(g){u();f.up.callback(true)}else{ae(A,50)}}())}q=ao(k)}else{g=ab;u();if(x){q=parent;f.up.callback(true)}else{V(k,{props:{src:k.remote+"#"+k.channel+new Date(),name:U+k.channel+"_consumer"},onLoad:function(){f.up.callback(true)}});q=ao(k)}}},init:function(){ai(f.onDOMReady,f)}})};aA.stack.ReliableBehavior=function(f){var c,h;var a=0,g=0,e="";return(c={incoming:function(n,o){var m=n.indexOf("_"),k=n.substring(0,m).split(",");n=n.substring(m+1);if(k[0]==a){e="";if(h){h(true)}}if(n.length>0){c.down.outgoing(k[1]+","+a+"_"+e,o);if(g!=k[1]){g=k[1];c.up.incoming(n,o)}}},outgoing:function(m,n,k){e=m;h=k;c.down.outgoing(g+","+(++a)+"_"+m,n)}})};aA.stack.QueueBehavior=function(k){var f,e=[],o=true,h="",a,n=0,m=false,g=false;function c(){if(k.remove&&e.length===0){ar(f);return}if(o||e.length===0||a){return}o=true;var q=e.shift();f.down.outgoing(q.data,q.origin,function(r){o=false;if(q.callback){ae(function(){q.callback(r)},0)}c()})}return(f={init:function(){if(av(k)){k={}}if(k.maxLength){n=k.maxLength;g=true}if(k.lazy){m=true}else{f.down.init()}},callback:function(q){o=false;var r=f.up;c();r.callback(q)},incoming:function(q,t){if(g){var r=q.indexOf("_"),u=parseInt(q.substring(0,r),10);h+=q.substring(r+1);if(u===0){if(k.encode){h=aE(h)}f.up.incoming(h,t);h=""}}else{f.up.incoming(q,t)}},outgoing:function(q,u,r){if(k.encode){q=ah(q)}var v=[],t;if(g){while(q.length!==0){t=q.substring(0,n);q=q.substring(t.length);v.push(t)}while((t=v.shift())){e.push({data:v.length+"_"+t,origin:u,callback:v.length===0?r:null})}}else{e.push({data:q,origin:u,callback:r})}if(m){f.down.init()}else{c()}},destroy:function(){a=true;f.down.destroy()}})};aA.stack.VerifyBehavior=function(a){var h,c,f,e=false;function g(){c=Math.random().toString(16).substring(2);h.down.outgoing(c)}return(h={incoming:function(m,n){var k=m.indexOf("_");if(k===-1){if(m===c){h.up.callback(true)}else{if(!f){f=m;if(!a.initiate){g()}h.down.outgoing(m)}}}else{if(m.substring(0,k)===f){h.up.incoming(m.substring(k+1),n)}}},outgoing:function(m,n,k){h.down.outgoing(c+"_"+m,n,k)},callback:function(k){if(a.initiate){g()}}})};aA.stack.RpcBehavior=function(e,m){var h,a=m.serializer||aa();var c=0,f={};function n(o){o.jsonrpc="2.0";h.down.outgoing(a.stringify(o))}function g(r,o){var q=Array.prototype.slice;return function(){var v=arguments.length,t,u={method:o};if(v>0&&typeof arguments[v-1]==="function"){if(v>1&&typeof arguments[v-2]==="function"){t={success:arguments[v-2],error:arguments[v-1]};u.params=q.call(arguments,0,v-2)}else{t={success:arguments[v-1]};u.params=q.call(arguments,0,v-1)}f[""+(++c)]=t;u.id=c}else{u.params=q.call(arguments,0)}if(r.namedParams&&u.params.length===1){u.params=u.params[0]}n(u)}}function k(o,q,v,r){if(!v){if(q){n({id:q,error:{code:-32601,message:"Procedure not found."}})}return}var t,x;if(q){t=function(z){t=ay;n({id:q,result:z})};x=function(B,A){x=ay;var z={id:q,error:{code:-32099,message:B}};if(A){z.error.data=A}n(z)}}else{t=x=ay}if(!ax(r)){r=[r]}try{var y=v.method.apply(v.scope,r.concat([t,x]));if(!av(y)){t(y)}}catch(u){x(u.message)}}return(h={incoming:function(r,t){var q=a.parse(r);if(q.method){if(m.handle){m.handle(q,n)}else{k(q.method,q.id,m.local[q.method],q.params)}}else{var o=f[q.id];if(q.error){if(o.error){o.error(q.error)}}else{if(o.success){o.success(q.result)}}delete f[q.id]}},init:function(){if(m.remote){for(var o in m.remote){if(m.remote.hasOwnProperty(o)){e[o]=g(m.remote[o],o)}}}h.down.init()},destroy:function(){for(var o in m.remote){if(m.remote.hasOwnProperty(o)&&e.hasOwnProperty(o)){delete e[o]}}h.down.destroy()}})};aJ.easyXDM=aA})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);(function(){if(jQuery&&jQuery.jstree){return}var e=false,c=false,a=false;(function(k){k.vakata={};k.vakata.css={get_css:function(t,o,q){t=t.toLowerCase();var r=q.cssRules||q.rules,n=0;do{if(r.length&&n>r.length+5){return false}if(r[n].selectorText&&r[n].selectorText.toLowerCase()==t){if(o===true){if(q.removeRule){q.removeRule(n)}if(q.deleteRule){q.deleteRule(n)}return true}else{return r[n]}}}while(r[++n]);return false},add_css:function(o,n){if(k.jstree.css.get_css(o,false,n)){return false}if(n.insertRule){n.insertRule(o+" { }",0)}else{n.addRule(o,null,0)}return k.vakata.css.get_css(o)},remove_css:function(o,n){return k.vakata.css.get_css(o,true,n)},add_sheet:function(o){var n=false,r=true;if(o.str){if(o.title){n=k("style[id='"+o.title+"-stylesheet']")[0]}if(n){r=false}else{n=document.createElement("style");n.setAttribute("type","text/css");if(o.title){n.setAttribute("id",o.title+"-stylesheet")}}if(n.styleSheet){if(r){document.getElementsByTagName("head")[0].appendChild(n);n.styleSheet.cssText=o.str}else{n.styleSheet.cssText=n.styleSheet.cssText+" "+o.str}}else{n.appendChild(document.createTextNode(o.str));document.getElementsByTagName("head")[0].appendChild(n)}return n.sheet||n.styleSheet}if(o.url){if(document.createStyleSheet){try{n=document.createStyleSheet(o.url)}catch(q){}}else{n=document.createElement("link");n.rel="stylesheet";n.type="text/css";n.media="all";n.href=o.url;document.getElementsByTagName("head")[0].appendChild(n);return n.styleSheet}}}};var m=[],h=-1,g={},f={};k.fn.jstree=function(r){var n=(typeof r=="string"),o=Array.prototype.slice.call(arguments,1),q=this;if(n){if(r.substring(0,1)=="_"){return q}this.each(function(){var t=m[k.data(this,"jstree-instance-id")],u=(t&&k.isFunction(t[r]))?t[r].apply(t,o):t;if(typeof u!=="undefined"&&(r.indexOf("is_")===0||(u!==true&&u!==false))){q=u;return false}})}else{this.each(function(){var z=k.data(this,"jstree-instance-id"),v=[],u=r?k.extend({},true,r):{},A=k(this),y=false,x=[];v=v.concat(o);if(A.data("jstree")){v.push(A.data("jstree"))}u=v.length?k.extend.apply(null,[true,u].concat(v)):u;if(typeof z!=="undefined"&&m[z]){m[z].destroy()}z=parseInt(m.push({}),10)-1;k.data(this,"jstree-instance-id",z);u.plugins=k.isArray(u.plugins)?u.plugins:k.jstree.defaults.plugins.slice();u.plugins.unshift("core");u.plugins=u.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");y=k.extend(true,{},k.jstree.defaults,u);y.plugins=u.plugins;k.each(g,function(t,B){if(k.inArray(t,y.plugins)===-1){y[t]=null;delete y[t]}else{x.push(t)}});y.plugins=x;m[z]=new k.jstree._instance(z,k(this).addClass("jstree jstree-"+z),y);k.each(m[z]._get_settings().plugins,function(t,B){m[z].data[B]={}});k.each(m[z]._get_settings().plugins,function(t,B){if(g[B]){g[B].__init.apply(m[z])}});setTimeout(function(){m[z].init()},0)})}return q};k.jstree={defaults:{plugins:[]},_focused:function(){return m[h]||null},_reference:function(n){if(m[n]){return m[n]}var q=k(n);if(!q.length&&typeof n==="string"){q=k("#"+n)}if(!q.length){return null}return m[q.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(o,n,q){this.data={core:{}};this.get_settings=function(){return k.extend(true,{},q)};this._get_settings=function(){return q};this.get_index=function(){return o};this.get_container=function(){return n};this.get_container_ul=function(){return n.children("ul:eq(0)")};this._set_settings=function(r){q=k.extend(true,{},q,r)}},_fn:{},plugin:function(n,o){o=k.extend({},{__init:k.noop,__destroy:k.noop,_fn:{},defaults:false},o);g[n]=o;k.jstree.defaults[n]=o.defaults;k.each(o._fn,function(q,r){r.plugin=n;r.old=k.jstree._fn[q];k.jstree._fn[q]=function(){var t,v=r,u=Array.prototype.slice.call(arguments),y=new k.Event("before.jstree"),x=false;if(this.data.core.locked===true&&q!=="unlock"&&q!=="is_locked"){return}do{if(v&&v.plugin&&k.inArray(v.plugin,this._get_settings().plugins)!==-1){break}v=v.old}while(v);if(!v){return}if(q.indexOf("_")===0){t=v.apply(this,u)}else{t=this.get_container().triggerHandler(y,{func:q,inst:this,args:u,plugin:v.plugin});if(t===false){return}if(typeof t!=="undefined"){u=t}t=v.apply(k.extend({},this,{__callback:function(z){this.get_container().triggerHandler(q+".jstree",{inst:this,args:u,rslt:z,rlbk:x})},__rollback:function(){x=this.get_rollback();return x},__call_old:function(z){return v.old.apply(this,(z?Array.prototype.slice.call(arguments,1):u))}}),u)}return t};k.jstree._fn[q].old=r.old;k.jstree._fn[q].plugin=n})},rollback:function(n){if(n){if(!k.isArray(n)){n=[n]}k.each(n,function(o,q){m[q.i].set_rollback(q.h,q.d)})}}};k.jstree._fn=k.jstree._instance.prototype={};k(function(){var q=navigator.userAgent.toLowerCase(),o=(q.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],n=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:auto; line-height:16px; height:16px; color:#333; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; font-size: 0.7em; font-family: sans-serif; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(q)&&parseInt(o,10)==6){e=true;try{document.execCommand("BackgroundImageCache",false,true)}catch(r){}n+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}if(/msie/.test(q)&&parseInt(o,10)==7){c=true;n+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "}if(!/compatible/.test(q)&&/mozilla/.test(q)&&parseFloat(o,10)<1.9){a=true;n+=".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "}k.vakata.css.add_sheet({str:n,title:"jstree"})});k.jstree.plugin("core",{__init:function(){this.data.core.locked=false;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:false,animation:500,initially_open:[],initially_load:[],open_parents:true,notify_plugins:true,rtl:false,load_open:false,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl")}this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",k.proxy(function(o){var n=k(o.target);if(n.is("ins")&&o.pageY-n.offset().top<this.data.core.li_height){this.toggle_node(n)}},this)).bind("mousedown.jstree",k.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(o){var q;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){q=window.getSelection();try{q.removeAllRanges();q.collapse()}catch(n){}}}});if(this._get_settings().core.notify_plugins){this.get_container().bind("load_node.jstree",k.proxy(function(r,q){var u=this._get_node(q.rslt.obj),n=this;if(u===-1){u=this.get_container_ul()}if(!u.length){return}u.find("li").each(function(){var o=k(this);if(o.data("jstree")){k.each(o.data("jstree"),function(v,t){if(n.data[v]&&k.isFunction(n["_"+v+"_notify"])){n["_"+v+"_notify"].call(n,o,t)}})}})},this))}if(this._get_settings().core.load_open){this.get_container().bind("load_node.jstree",k.proxy(function(r,q){var u=this._get_node(q.rslt.obj),n=this;if(u===-1){u=this.get_container_ul()}if(!u.length){return}u.find("li.jstree-open:not(:has(ul))").each(function(){n.load_node(this,k.noop,k.noop)})},this))}this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var o,t=this.get_index(),q=this._get_settings(),r=this;k.each(q.plugins,function(n,v){try{g[v].__destroy.apply(r)}catch(u){}});this.__callback();if(this.is_focused()){for(o in m){if(m.hasOwnProperty(o)&&o!=t){m[o].set_focus();break}}}if(t===h){h=-1}this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});k(document).unbind(".jstree-"+t).undelegate(".jstree-"+t);m[t]=null;delete m[t]},_core_notify:function(q,o){if(o.opened){this.open_node(q,false,true)}},lock:function(){this.data.core.locked=true;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({})},unlock:function(){this.data.core.locked=false;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var n=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){if(this.id){n.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(n.data.core.to_open)},save_loaded:function(){},reload_nodes:function(o){var t=this,n=true,r=[],q=[];if(!o){this.data.core.reopen=false;this.data.core.refreshing=true;this.data.core.to_open=k.map(k.makeArray(this.data.core.to_open),function(u){return"#"+u.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.data.core.to_load=k.map(k.makeArray(this.data.core.to_load),function(u){return"#"+u.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});if(this.data.core.to_open.length){this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)}}if(this.data.core.to_load.length){k.each(this.data.core.to_load,function(u,v){if(v=="#"){return true}if(k(v).length){r.push(v)}else{q.push(v)}});if(r.length){this.data.core.to_load=q;k.each(r,function(u,v){if(!t._is_loaded(v)){t.load_node(v,function(){t.reload_nodes(true)},function(){t.reload_nodes(true)});n=false}})}}if(this.data.core.to_open.length){k.each(this.data.core.to_open,function(u,v){t.open_node(v,false,true)})}if(n){if(this.data.core.reopen){clearTimeout(this.data.core.reopen)}this.data.core.reopen=setTimeout(function(){t.__callback({},t)},50);this.data.core.refreshing=false;this.reopen()}},reopen:function(){var n=this;if(this.data.core.to_open.length){k.each(this.data.core.to_open,function(o,q){n.open_node(q,false,true)})}this.__callback({})},refresh:function(n){var o=this;this.save_opened();if(!n){n=-1}n=this._get_node(n);if(!n){n=-1}if(n!==-1){n.children("UL").remove()}else{this.get_container_ul().empty()}this.load_node(n,function(){o.__callback({obj:n});o.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused()){return}var n=k.jstree._focused();if(n){n.unset_focus()}this.get_container().addClass("jstree-focused");h=this.get_index();this.__callback()},is_focused:function(){return h==this.get_index()},unset_focus:function(){if(this.is_focused()){this.get_container().removeClass("jstree-focused");h=-1}this.__callback()},_get_node:function(n){var o=k(n,this.get_container());if(o.is(".jstree")||n==-1){return -1}o=o.closest("li",this.get_container());return o.length?o:false},_get_next:function(o,n){o=this._get_node(o);if(o===-1){return this.get_container().find("> ul > li:first-child")}if(!o.length){return false}if(n){return(o.nextAll("li").size()>0)?o.nextAll("li:eq(0)"):false}if(o.hasClass("jstree-open")){return o.find("li:eq(0)")}else{if(o.nextAll("li").size()>0){return o.nextAll("li:eq(0)")}else{return o.parentsUntil(".jstree","li").next("li").eq(0)}}},_get_prev:function(q,n){q=this._get_node(q);if(q===-1){return this.get_container().find("> ul > li:last-child")}if(!q.length){return false}if(n){return(q.prevAll("li").length>0)?q.prevAll("li:eq(0)"):false}if(q.prev("li").length){q=q.prev("li").eq(0);while(q.hasClass("jstree-open")){q=q.children("ul:eq(0)").children("li:last")}return q}else{var r=q.parentsUntil(".jstree","li:eq(0)");return r.length?r:false}},_get_parent:function(n){n=this._get_node(n);if(n==-1||!n.length){return false}var q=n.parentsUntil(".jstree","li:eq(0)");return q.length?q:-1},_get_children:function(n){n=this._get_node(n);if(n===-1){return this.get_container().children("ul:eq(0)").children("li")}if(!n.length){return false}return n.children("ul:eq(0)").children("li")},get_path:function(q,n){var o=[],r=this;q=this._get_node(q);if(q===-1||!q||!q.length){return false}q.parentsUntil(".jstree","li").each(function(){o.push(n?this.id:r.get_text(this))});o.reverse();o.push(n?q.attr("id"):this.get_text(q));return o},_get_string:function(n){return this._get_settings().core.strings[n]||n},is_open:function(n){n=this._get_node(n);return n&&n!==-1&&n.hasClass("jstree-open")},is_closed:function(n){n=this._get_node(n);return n&&n!==-1&&n.hasClass("jstree-closed")},is_leaf:function(n){n=this._get_node(n);return n&&n!==-1&&n.hasClass("jstree-leaf")},correct_state:function(n){n=this._get_node(n);if(!n||n===-1){return false}n.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:n})},open_node:function(r,u,o){r=this._get_node(r);if(!r.length){return false}if(!r.hasClass("jstree-closed")){if(u){u.call()}return false}var q=o||e?0:this._get_settings().core.animation,n=this;if(!this._is_loaded(r)){r.children("a").addClass("jstree-loading");this.load_node(r,function(){n.open_node(r,u,o)},u)}else{if(this._get_settings().core.open_parents){r.parentsUntil(".jstree",".jstree-closed").each(function(){n.open_node(this,false,true)})}if(q){r.children("ul").css("display","none")}r.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(q){r.children("ul").stop(true,true).slideDown(q,function(){this.style.display="";n.after_open(r)})}else{n.after_open(r)}this.__callback({obj:r});if(u){u.call()}}},after_open:function(n){this.__callback({obj:n})},close_node:function(r,o){r=this._get_node(r);var q=o||e?0:this._get_settings().core.animation,n=this;if(!r.length||!r.hasClass("jstree-open")){return false}if(q){r.children("ul").attr("style","display:block !important")}r.removeClass("jstree-open").addClass("jstree-closed");if(q){r.children("ul").stop(true,true).slideUp(q,function(){this.style.display="";n.after_close(r)})}else{n.after_close(r)}this.__callback({obj:r})},after_close:function(n){this.__callback({obj:n})},toggle_node:function(n){n=this._get_node(n);if(n.hasClass("jstree-closed")){return this.open_node(n)}if(n.hasClass("jstree-open")){return this.close_node(n)}},open_all:function(q,o,n){q=q?this._get_node(q):-1;if(!q||q===-1){q=this.get_container_ul()}if(n){q=q.find("li.jstree-closed")}else{n=q;if(q.is(".jstree-closed")){q=q.find("li.jstree-closed").andSelf()}else{q=q.find("li.jstree-closed")}}var r=this;q.each(function(){var t=this;if(!r._is_loaded(this)){r.open_node(this,function(){r.open_all(t,o,n)},!o)}else{r.open_node(this,false,!o)}});if(n.find("li.jstree-closed").length===0){this.__callback({obj:n})}},close_all:function(o,n){var q=this;o=o?this._get_node(o):this.get_container();if(!o||o===-1){o=this.get_container_ul()}o.find("li.jstree-open").andSelf().each(function(){q.close_node(this,!n)});this.__callback({obj:o})},clean_node:function(n){n=n&&n!=-1?k(n):this.get_container_ul();n=n.is("li")?n.find("li").andSelf():n.find("li");n.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");n.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:n})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},set_rollback:function(n,o){this.get_container().empty().append(n);this.data=o;this.__callback()},load_node:function(q,n,o){this.__callback({obj:q})},_is_loaded:function(n){return true},create_node:function(u,n,t,x,o){u=this._get_node(u);n=typeof n==="undefined"?"last":n;var v=k("<li />"),r=this._get_settings().core,q;if(u!==-1&&!u.length){return false}if(!o&&!this._is_loaded(u)){this.load_node(u,function(){this.create_node(u,n,t,x,true)});return false}this.__rollback();if(typeof t==="string"){t={data:t}}if(!t){t={}}if(t.attr){v.attr(t.attr)}if(t.metadata){v.data(t.metadata)}if(t.state){v.addClass("jstree-"+t.state)}if(!t.data){t.data=this._get_string("new_node")}if(!k.isArray(t.data)){q=t.data;t.data=[];t.data.push(q)}k.each(t.data,function(z,y){q=k("<a />");if(k.isFunction(y)){y=y.call(this,t)}if(typeof y=="string"){q.attr("href","#")[r.html_titles?"html":"text"](y)}else{if(!y.attr){y.attr={}}if(!y.attr.href){y.attr.href="#"}q.attr(y.attr)[r.html_titles?"html":"text"](y.title);if(y.language){q.addClass(y.language)}}q.prepend("<ins class='jstree-icon'>&#160;</ins>");if(y.icon){if(y.icon.indexOf("/")===-1){q.children("ins").addClass(y.icon)}else{q.children("ins").css("background","url('"+y.icon+"') center center no-repeat")}}v.append(q)});v.prepend("<ins class='jstree-icon'>&#160;</ins>");if(u===-1){u=this.get_container();if(n==="before"){n="first"}if(n==="after"){n="last"}}switch(n){case"before":u.before(v);q=this._get_parent(u);break;case"after":u.after(v);q=this._get_parent(u);break;case"inside":case"first":if(!u.children("ul").length){u.append("<ul />")}u.children("ul").prepend(v);q=u;break;case"last":if(!u.children("ul").length){u.append("<ul />")}u.children("ul").append(v);q=u;break;default:if(!u.children("ul").length){u.append("<ul />")}if(!n){n=0}q=u.children("ul").children("li").eq(n);if(q.length){q.before(v)}else{u.children("ul").append(v)}q=u;break}if(q===-1||q.get(0)===this.get_container().get(0)){q=-1}this.clean_node(q);this.__callback({obj:v,parent:q});if(x){x.call(this,v)}return v},get_text:function(o){o=this._get_node(o);if(!o.length){return false}var n=this._get_settings().core.html_titles;o=o.children("a:eq(0)");if(n){o=o.clone();o.children("INS").remove();return o.html()}else{o=o.contents().filter(function(){return this.nodeType==3})[0];return o.nodeValue}},set_text:function(o,q){o=this._get_node(o);if(!o.length){return false}o=o.children("a:eq(0)");if(this._get_settings().core.html_titles){var n=o.children("INS").clone();o.html(q).prepend(n);this.__callback({obj:o,name:q});return true}else{o=o.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:o,name:q});return(o.nodeValue=q)}},rename_node:function(n,o){n=this._get_node(n);this.__rollback();if(n&&n.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({obj:n,name:o})}},delete_node:function(r){r=this._get_node(r);if(!r.length){return false}this.__rollback();var q=this._get_parent(r),o=k([]),n=this;r.each(function(){o=o.add(n._get_prev(this))});r=r.detach();if(q!==-1&&q.find("> ul > li").length===0){q.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}this.clean_node(q);this.__callback({obj:r,prev:o,parent:q});return r},prepare_move:function(v,t,x,n,q){var u={};u.ot=k.jstree._reference(v)||this;u.o=u.ot._get_node(v);u.r=t===-1?-1:this._get_node(t);u.p=(typeof x==="undefined"||x===false)?"last":x;if(!q&&f.o&&f.o[0]===u.o[0]&&f.r[0]===u.r[0]&&f.p===u.p){this.__callback(f);if(n){n.call(this,f)}return}u.ot=k.jstree._reference(u.o)||this;u.rt=k.jstree._reference(u.r)||this;if(u.r===-1||!u.r){u.cr=-1;switch(u.p){case"first":case"before":case"inside":u.cp=0;break;case"after":case"last":u.cp=u.rt.get_container().find(" > ul > li").length;break;default:u.cp=u.p;break}}else{if(!/^(before|after)$/.test(u.p)&&!this._is_loaded(u.r)){return this.load_node(u.r,function(){this.prepare_move(v,t,x,n,true)})}switch(u.p){case"before":u.cp=u.r.index();u.cr=u.rt._get_parent(u.r);break;case"after":u.cp=u.r.index()+1;u.cr=u.rt._get_parent(u.r);break;case"inside":case"first":u.cp=0;u.cr=u.r;break;case"last":u.cp=u.r.find(" > ul > li").length;u.cr=u.r;break;default:u.cp=u.p;u.cr=u.r;break}}u.np=u.cr==-1?u.rt.get_container():u.cr;u.op=u.ot._get_parent(u.o);u.cop=u.o.index();if(u.op===-1){u.op=u.ot?u.ot.get_container():this.get_container()}if(!/^(before|after)$/.test(u.p)&&u.op&&u.np&&u.op[0]===u.np[0]&&u.o.index()<u.cp){u.cp++}u.or=u.np.find(" > ul > li:nth-child("+(u.cp+1)+")");f=u;this.__callback(f);if(n){n.call(this,f)}},check_move:function(){var q=f,n=true,o=q.r===-1?this.get_container():q.r;if(!q||!q.o||q.or[0]===q.o[0]){return false}if(q.op&&q.np&&q.op[0]===q.np[0]&&q.cp-1===q.o.index()){return false}q.o.each(function(){if(o.parentsUntil(".jstree","li").andSelf().index(this)!==-1){n=false;return false}});return n},move_node:function(x,t,n,r,q,v){if(!q){return this.prepare_move(x,t,n,function(o){this.move_node(o,false,false,r,true,v)})}if(r){f.cy=true}if(!v&&!this.check_move()){return false}this.__rollback();var y=false;if(r){y=x.o.clone(true);y.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id}})}else{y=x.o}if(x.or.length){x.or.before(y)}else{if(!x.np.children("ul").length){k("<ul />").appendTo(x.np)}x.np.children("ul:eq(0)").append(y)}try{x.ot.clean_node(x.op);x.rt.clean_node(x.np);if(!x.op.find("> ul > li").length){x.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}}catch(u){}if(r){f.cy=true;f.oc=y}this.__callback(f);return f},_get_move:function(){return f}}})})(jQuery);(function(f){var k,h,g;f(function(){if(/msie/.test(navigator.userAgent.toLowerCase())){h=f('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");g=f('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1000,left:0}).appendTo("body");k=h.width()-g.width();h.add(g).remove()}else{h=f("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1000,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});k=100-h.width();h.parent().remove()}});f.jstree.plugin("ui",{__init:function(){this.data.ui.selected=f();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",f.proxy(function(m){m.preventDefault();m.currentTarget.blur();if(!f(m.currentTarget).hasClass("jstree-loading")){this.select_node(m.currentTarget,true,m)}},this)).delegate("a","mouseenter.jstree",f.proxy(function(m){if(!f(m.currentTarget).hasClass("jstree-loading")){this.hover_node(m.target)}},this)).delegate("a","mouseleave.jstree",f.proxy(function(m){if(!f(m.currentTarget).hasClass("jstree-loading")){this.dehover_node(m.target)}},this)).bind("reopen.jstree",f.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",f.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",f.proxy(function(){this.reselect()},this)).bind("close_node.jstree",f.proxy(function(n,o){var m=this._get_settings().ui,q=this._get_node(o.rslt.obj),r=(q&&q.length)?q.children("ul").find("a.jstree-clicked"):f(),t=this;if(m.selected_parent_close===false||!r.length){return}r.each(function(){t.deselect_node(this);if(m.selected_parent_close==="select_parent"){t.select_node(q)}})},this)).bind("delete_node.jstree",f.proxy(function(n,o){var m=this._get_settings().ui.select_prev_on_delete,q=this._get_node(o.rslt.obj),r=(q&&q.length)?q.find("a.jstree-clicked"):[],t=this;r.each(function(){t.deselect_node(this)});if(m&&r.length){o.rslt.prev.each(function(){if(this.parentNode){t.select_node(this);return false}})}},this)).bind("move_node.jstree",f.proxy(function(m,n){if(n.rslt.cy){n.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")}},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:true,select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(m,n){if(typeof m==="undefined"||m===null){return n?this.data.ui.selected:this.data.ui.last_selected}var o=f(m,this.get_container());if(o.is(".jstree")||m==-1){return -1}o=o.closest("li",this.get_container());return o.length?o:false},_ui_notify:function(o,m){if(m.selected){this.select_node(o,false)}},save_selected:function(){var m=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){if(this.id){m.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(this.data.ui.to_select)},reselect:function(){var n=this,m=this.data.ui.to_select;m=f.map(f.makeArray(m),function(o){return"#"+o.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});f.each(m,function(o,q){if(q&&q!=="#"){n.select_node(q)}});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(m){this.save_selected();return this.__call_old()},hover_node:function(m){m=this._get_node(m);if(!m.length){return false}if(!m.hasClass("jstree-hovered")){this.dehover_node()}this.data.ui.hovered=m.children("a").addClass("jstree-hovered").parent();this._fix_scroll(m);this.__callback({obj:m})},dehover_node:function(){var n=this.data.ui.hovered,m;if(!n||!n.length){return false}m=n.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===m[0]){this.data.ui.hovered=null}this.__callback({obj:n})},select_node:function(q,m,r){q=this._get_node(q);if(q==-1||!q||!q.length){return false}var y=this._get_settings().ui,v=(y.select_multiple_modifier=="on"||(y.select_multiple_modifier!==false&&r&&r[y.select_multiple_modifier+"Key"])),n=(y.select_range_modifier!==false&&r&&r[y.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==q[0]&&this.data.ui.last_selected.parent()[0]===q.parent()[0]),o=this.is_selected(q),u=true,x=this;if(m){if(y.disable_selecting_children&&v&&((q.parentsUntil(".jstree","li").children("a.jstree-clicked").length)||(q.children("ul").find("a.jstree-clicked:eq(0)").length))){return false}u=false;switch(!0){case (n):this.data.ui.last_selected.addClass("jstree-last-selected");q=q[q.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();if(y.select_limit==-1||q.length<y.select_limit){this.data.ui.last_selected.removeClass("jstree-last-selected");this.data.ui.selected.each(function(){if(this!==x.data.ui.last_selected[0]){x.deselect_node(this)}});o=false;u=true}else{u=false}break;case (o&&!v):this.deselect_all();o=false;u=true;break;case (!o&&!v):if(y.select_limit==-1||y.select_limit>0){this.deselect_all();u=true}break;case (o&&v):this.deselect_node(q);break;case (!o&&v):if(y.select_limit==-1||this.data.ui.selected.length+1<=y.select_limit){u=true}break}}if(u&&!o){if(!n){this.data.ui.last_selected=q}q.children("a").addClass("jstree-clicked");if(y.selected_parent_open){q.parents(".jstree-closed").each(function(){x.open_node(this,false,true)})}this.data.ui.selected=this.data.ui.selected.add(q);this._fix_scroll(q.eq(0));this.__callback({obj:q,e:r})}},_fix_scroll:function(n){var o=this.get_container()[0],m;if(o.scrollHeight>o.offsetHeight){n=this._get_node(n);if(!n||n===-1||!n.length||!n.is(":visible")){return}m=n.offset().top-this.get_container().offset().top;if(m<0){o.scrollTop=o.scrollTop+m-1}if(m+this.data.core.li_height+(o.scrollWidth>o.offsetWidth?k:0)>o.offsetHeight){o.scrollTop=o.scrollTop+(m-o.offsetHeight+this.data.core.li_height+1+(o.scrollWidth>o.offsetWidth?k:0))}}},deselect_node:function(m){m=this._get_node(m);if(!m.length){return false}if(this.is_selected(m)){m.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(m);if(this.data.ui.last_selected.get(0)===m.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0)}this.__callback({obj:m})}},toggle_select:function(m){m=this._get_node(m);if(!m.length){return false}if(this.is_selected(m)){this.deselect_node(m)}else{this.select_node(m)}},is_selected:function(m){return this.data.ui.selected.index(this._get_node(m))>=0},get_selected:function(m){return m?f(m).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(n){var m=n?f(n).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();m.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=f([]);this.data.ui.last_selected=false;this.__callback({obj:m})}}});f.jstree.defaults.plugins.push("ui")})(jQuery);(function(f){f.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",f.proxy(function(k,h){if(this._get_settings().crrm.move.open_onmove){var g=this;h.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){g.open_node(this,false,true)})}},this))},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(g){return true}}},_fn:{_show_input:function(g,r){g=this._get_node(g);var o=this._get_settings().core.rtl,q=this._get_settings().crrm.input_width_limit,k=g.children("ins").width(),h=g.find("> a:visible > ins").width()*g.find("> a:visible > ins").length,u=this.get_text(g),n=f("<div />",{css:{position:"absolute",top:"-200px",left:(o?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body"),m=g.css("position","relative").append(f("<input />",{value:u,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:(o?"auto":(k+h+4)+"px"),right:(o?(k+h+4)+"px":"auto"),top:"0px",height:(this.data.core.li_height-2)+"px",lineHeight:(this.data.core.li_height-2)+"px",width:"150px"},blur:f.proxy(function(){var x=g.children(".jstree-rename-input"),t=x.val();if(t===""){t=u}n.remove();x.remove();this.set_text(g,u);this.rename_node(g,t);r.call(this,g,t,u);g.css("position","")},this),keyup:function(v){var t=v.keyCode||v.which;if(t==27){this.value=u;this.blur();return}else{if(t==13){this.blur();return}else{m.width(Math.min(n.text("pW"+this.value).width(),q))}}},keypress:function(v){var t=v.keyCode||v.which;if(t==13){return false}}})).children(".jstree-rename-input");this.set_text(g,"");n.css({fontFamily:m.css("fontFamily")||"",fontSize:m.css("fontSize")||"",fontWeight:m.css("fontWeight")||"",fontStyle:m.css("fontStyle")||"",fontStretch:m.css("fontStretch")||"",fontVariant:m.css("fontVariant")||"",letterSpacing:m.css("letterSpacing")||"",wordSpacing:m.css("wordSpacing")||""});m.width(Math.min(n.text("pW"+m[0].value).width(),q))[0].select()},rename:function(h){h=this._get_node(h);this.__rollback();var g=this.__callback;this._show_input(h,function(n,m,k){g.call(this,{obj:n,new_name:m,old_name:k})})},create:function(n,h,m,q,g){var k,o=this;n=this._get_node(n);if(!n){n=-1}this.__rollback();k=this.create_node(n,h,m,function(r){var u=this._get_parent(r),v=f(r).index();if(q){q.call(this,r)}if(u.length&&u.hasClass("jstree-closed")){this.open_node(u,false,true)}if(!g){this._show_input(r,function(y,x,t){o.__callback({obj:y,name:x,parent:u,position:v})})}else{o.__callback({obj:r,name:this.get_text(r),parent:u,position:v})}});return k},remove:function(k){k=this._get_node(k,true);var h=this._get_parent(k),g=this._get_prev(k);this.__rollback();k=this.delete_node(k);if(k!==false){this.__callback({obj:k,prev:g,parent:h})}},check_move:function(){if(!this.__call_old()){return false}var g=this._get_settings().crrm.move;if(!g.check_move.call(this,this._get_move())){return false}return true},move_node:function(q,n,g,k,h,o){var m=this._get_settings().crrm.move;if(!h){if(typeof g==="undefined"){g=m.default_position}if(g==="inside"&&!m.default_position.match(/^(before|after)$/)){g=m.default_position}return this.__call_old(true,q,n,g,k,false,o)}if(m.always_copy===true||(m.always_copy==="multitree"&&q.rt.get_index()!==q.ot.get_index())){k=true}this.__call_old(true,q,n,g,k,true,o)},cut:function(g){g=this._get_node(g,true);if(!g||!g.length){return false}this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=g;this.__callback({obj:g})},copy:function(g){g=this._get_node(g,true);if(!g||!g.length){return false}this.data.crrm.ct_nodes=false;this.data.crrm.cp_nodes=g;this.__callback({obj:g})},paste:function(h){h=this._get_node(h);if(!h||!h.length){return false}var g=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false}if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,h);this.data.crrm.ct_nodes=false}if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,h,false,true)}this.__callback({obj:h,nodes:g})}}})})(jQuery);(function(f){var g=[];f.jstree._themes=false;f.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",f.proxy(function(){var h=this._get_settings().themes;this.data.themes.dots=h.dots;this.data.themes.icons=h.icons;this.set_theme(h.theme,h.url)},this)).bind("loaded.jstree",f.proxy(function(){if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}},this))},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(k,h){if(!k){return false}if(!h){h=f.jstree._themes+k+"/style.css"}if(f.inArray(h,g)==-1){f.vakata.css.add_sheet({url:h});g.push(h)}if(this.data.themes.theme!=k){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=k}this.get_container().addClass("jstree-"+k);if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons()}else{this.show_icons()}}}});f(function(){if(f.jstree._themes===false){f("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){f.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}})}if(f.jstree._themes===false){f.jstree._themes="themes/"}});f.jstree.defaults.plugins.push("themes")})(jQuery);(function(h){var g=[];function f(m,n){var o=h.jstree._focused(),k;if(o&&o.data&&o.data.hotkeys&&o.data.hotkeys.enabled){k=o._get_settings().hotkeys[m];if(k){return k.call(o,n)}}}h.jstree.plugin("hotkeys",{__init:function(){if(typeof h.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included."}if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included."}h.each(this._get_settings().hotkeys,function(m,k){if(k!==false&&h.inArray(m,g)==-1){h(document).bind("keydown",m,function(n){return f(m,n)});g.push(m)}});this.get_container().bind("lock.jstree",h.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true}},this)).bind("unlock.jstree",h.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true}},this));this.enable_hotkeys()},defaults:{up:function(){var k=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(k));return false},"ctrl+up":function(){var k=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(k));return false},"shift+up":function(){var k=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(k));return false},down:function(){var k=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(k));return false},"ctrl+down":function(){var k=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(k));return false},"shift+down":function(){var k=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(k));return false},left:function(){var k=this.data.ui.hovered||this.data.ui.last_selected;if(k){if(k.hasClass("jstree-open")){this.close_node(k)}else{this.hover_node(this._get_prev(k))}}return false},"ctrl+left":function(){var k=this.data.ui.hovered||this.data.ui.last_selected;if(k){if(k.hasClass("jstree-open")){this.close_node(k)}else{this.hover_node(this._get_prev(k))}}return false},"shift+left":function(){var k=this.data.ui.hovered||this.data.ui.last_selected;if(k){if(k.hasClass("jstree-open")){this.close_node(k)}else{this.hover_node(this._get_prev(k))}}return false},right:function(){var k=this.data.ui.hovered||this.data.ui.last_selected;if(k&&k.length){if(k.hasClass("jstree-closed")){this.open_node(k)}else{this.hover_node(this._get_next(k))}}return false},"ctrl+right":function(){var k=this.data.ui.hovered||this.data.ui.last_selected;if(k&&k.length){if(k.hasClass("jstree-closed")){this.open_node(k)}else{this.hover_node(this._get_next(k))}}return false},"shift+right":function(){var k=this.data.ui.hovered||this.data.ui.last_selected;if(k&&k.length){if(k.hasClass("jstree-closed")){this.open_node(k)}else{this.hover_node(this._get_next(k))}}return false},space:function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click()}return false},"ctrl+space":function(k){k.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(k)}return false},"shift+space":function(k){k.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(k)}return false},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}})})(jQuery);(function(f){f.jstree.plugin("json_data",{__init:function(){var g=this._get_settings().json_data;if(g.progressive_unload){this.get_container().bind("after_close.jstree",function(k,h){h.rslt.obj.children("ul").remove()})}},defaults:{data:false,ajax:false,correct_state:true,progressive_render:false,progressive_unload:false},_fn:{load_node:function(k,g,h){var m=this;this.load_node_json(k,function(){m.__callback({obj:m._get_node(k)});g.call(this)},h)},_is_loaded:function(h){var g=this._get_settings().json_data;h=this._get_node(h);return h==-1||!h||(!g.ajax&&!g.progressive_render&&!f.isFunction(g.data))||h.is(".jstree-open, .jstree-leaf")||h.children("ul").children("li").length>0},refresh:function(h){h=this._get_node(h);var g=this._get_settings().json_data;if(h&&h!==-1&&g.progressive_unload&&(f.isFunction(g.data)||!!g.ajax)){h.removeData("jstree-children")}return this.__call_old()},load_node_json:function(n,g,k){var m=this.get_settings().json_data,q,h=function(){},o=function(){};n=this._get_node(n);if(n&&n!==-1&&(m.progressive_render||m.progressive_unload)&&!n.is(".jstree-open, .jstree-leaf")&&n.children("ul").children("li").length===0&&n.data("jstree-children")){q=this._parse_json(n.data("jstree-children"),n);if(q){n.append(q);if(!m.progressive_unload){n.removeData("jstree-children")}}this.clean_node(n);if(g){g.call(this)}return}if(n&&n!==-1){if(n.data("jstree-is-loading")){return}else{n.data("jstree-is-loading",true)}}switch(!0){case (!m.data&&!m.ajax):throw"Neither data nor ajax settings supplied.";case (f.isFunction(m.data)):m.data.call(this,n,f.proxy(function(r){r=this._parse_json(r,n);if(!r){if(n===-1||!n){if(m.correct_state){this.get_container().children("ul").empty()}}else{n.children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading");if(m.correct_state){this.correct_state(n)}}if(k){k.call(this)}}else{if(n===-1||!n){this.get_container().children("ul").empty().append(r.children())}else{n.append(r).children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading")}this.clean_node(n);if(g){g.call(this)}}},this));break;case (!!m.data&&!m.ajax)||(!!m.data&&!!m.ajax&&(!n||n===-1)):if(!n||n==-1){q=this._parse_json(m.data,n);if(q){this.get_container().children("ul").empty().append(q.children());this.clean_node()}else{if(m.correct_state){this.get_container().children("ul").empty()}}}if(g){g.call(this)}break;case (!m.data&&!!m.ajax)||(!!m.data&&!!m.ajax&&n&&n!==-1):h=function(u,v,y){var r=this.get_settings().json_data.ajax.error;if(r){r.call(this,u,v,y)}if(n!=-1&&n.length){n.children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading");if(v==="success"&&m.correct_state){this.correct_state(n)}}else{if(v==="success"&&m.correct_state){this.get_container().children("ul").empty()}}if(k){k.call(this)}};o=function(y,u,r){var v=this.get_settings().json_data.ajax.success;if(v){y=v.call(this,y,u,r)||y}if(y===""||(y&&y.toString&&y.toString().replace(/^[\s\n]+$/,"")==="")||(!f.isArray(y)&&!f.isPlainObject(y))){return h.call(this,r,u,"")}y=this._parse_json(y,n);if(y){if(n===-1||!n){this.get_container().children("ul").empty().append(y.children())}else{n.append(y).children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading")}this.clean_node(n);if(g){g.call(this)}}else{if(n===-1||!n){if(m.correct_state){this.get_container().children("ul").empty();if(g){g.call(this)}}}else{n.children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading");if(m.correct_state){this.correct_state(n);if(g){g.call(this)}}}}};m.ajax.context=this;m.ajax.error=h;m.ajax.success=o;if(!m.ajax.dataType){m.ajax.dataType="json"}if(f.isFunction(m.ajax.url)){m.ajax.url=m.ajax.url.call(this,n)}if(f.isFunction(m.ajax.data)){m.ajax.data=m.ajax.data.call(this,n)}f.ajax(m.ajax);break}},_parse_json:function(g,n,v){var q=false,h=this._get_settings(),y=h.json_data,x=h.core.html_titles,o,m,k,u,r;if(!g){return q}if(y.progressive_unload&&n&&n!==-1){n.data("jstree-children",q)}if(f.isArray(g)){q=f();if(!g.length){return false}for(m=0,k=g.length;m<k;m++){o=this._parse_json(g[m],n,true);if(o.length){q=q.add(o)}}}else{if(typeof g=="string"){g={data:g}}if(!g.data&&g.data!==""){return q}q=f("<li />");if(g.attr){q.attr(g.attr)}if(g.metadata){q.data(g.metadata)}if(g.state){q.addClass("jstree-"+g.state)}if(!f.isArray(g.data)){o=g.data;g.data=[];g.data.push(o)}f.each(g.data,function(z,t){o=f("<a />");if(f.isFunction(t)){t=t.call(this,g)}if(typeof t=="string"){o.attr("href","#")[x?"html":"text"](t)}else{if(!t.attr){t.attr={}}if(!t.attr.href){t.attr.href="#"}o.attr(t.attr)[x?"html":"text"](t.title);if(t.language){o.addClass(t.language)}}o.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!t.icon&&g.icon){t.icon=g.icon}if(t.icon){if(t.icon.indexOf("/")===-1){o.children("ins").addClass(t.icon)}else{o.children("ins").css("background","url('"+t.icon+"') center center no-repeat")}}q.append(o)});q.prepend("<ins class='jstree-icon'>&#160;</ins>");if(g.children){if(y.progressive_render&&g.state!=="open"){q.addClass("jstree-closed").data("jstree-children",g.children)}else{if(y.progressive_unload){q.data("jstree-children",g.children)}if(f.isArray(g.children)&&g.children.length){o=this._parse_json(g.children,n,true);if(o.length){r=f("<ul />");r.append(o);q.append(r)}}}}}if(!v){u=f("<ul />");u.append(q);q=u}return q},get_json:function(o,k,g,v){var z=[],y=this._get_settings(),q=this,n,m,u,r,x,h;o=this._get_node(o);if(!o||o===-1){o=this.get_container().find("> ul > li")}k=f.isArray(k)?k:["id","class"];if(!v&&this.data.types){k.push(y.types.type_attr)}g=f.isArray(g)?g:[];o.each(function(){u=f(this);n={data:[]};if(k.length){n.attr={}}f.each(k,function(A,t){m=u.attr(t);if(m&&m.length&&m.replace(/jstree[^ ]*/ig,"").length){n.attr[t]=(" "+m).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}});if(u.hasClass("jstree-open")){n.state="open"}if(u.hasClass("jstree-closed")){n.state="closed"}if(u.data()){n.metadata=u.data()}r=u.children("a");r.each(function(){x=f(this);if(g.length||f.inArray("languages",y.plugins)!==-1||x.children("ins").get(0).style.backgroundImage.length||(x.children("ins").get(0).className&&x.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length)){h=false;if(f.inArray("languages",y.plugins)!==-1&&f.isArray(y.languages)&&y.languages.length){f.each(y.languages,function(t,A){if(x.hasClass(A)){h=A;return false}})}m={attr:{},title:q.get_text(x,h)};f.each(g,function(t,A){m.attr[A]=(" "+(x.attr(A)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});if(f.inArray("languages",y.plugins)!==-1&&f.isArray(y.languages)&&y.languages.length){f.each(y.languages,function(t,A){if(x.hasClass(A)){m.language=A;return true}})}if(x.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){m.icon=x.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}if(x.children("ins").get(0).style.backgroundImage.length){m.icon=x.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}}else{m=q.get_text(x)}if(r.length>1){n.data.push(m)}else{n.data=m}});u=u.find("> ul > li");if(u.length){n.children=q.get_json(u,k,g,true)}z.push(n)});return z}}})})(jQuery);(function(f){f.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(k){var m=this._get_settings().languages,h=false,g=".jstree-"+this.get_index()+" a";if(!f.isArray(m)||m.length===0){return false}if(f.inArray(k,m)==-1){if(!!m[k]){k=m[k]}else{return false}}if(k==this.data.languages.current_language){return true}h=f.vakata.css.get_css(g+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(h!==false){h.style.display="none"}h=f.vakata.css.get_css(g+"."+k,false,this.data.languages.language_css);if(h!==false){h.style.display=""}this.data.languages.current_language=k;this.__callback(k);return true},get_lang:function(){return this.data.languages.current_language},_get_string:function(g,m){var k=this._get_settings().languages,h=this._get_settings().core.strings;if(f.isArray(k)&&k.length){m=(m&&f.inArray(m,k)!=-1)?m:this.data.languages.current_language}if(h[m]&&h[m][g]){return h[m][g]}if(h[g]){return h[g]}return g},get_text:function(k,m){k=this._get_node(k)||this.data.ui.last_selected;if(!k.size()){return false}var h=this._get_settings().languages,g=this._get_settings().core.html_titles;if(f.isArray(h)&&h.length){m=(m&&f.inArray(m,h)!=-1)?m:this.data.languages.current_language;k=k.children("a."+m)}else{k=k.children("a:eq(0)")}if(g){k=k.clone();k.children("INS").remove();return k.html()}else{k=k.contents().filter(function(){return this.nodeType==3})[0];return k.nodeValue}},set_text:function(m,o,n){m=this._get_node(m)||this.data.ui.last_selected;if(!m.size()){return false}var k=this._get_settings().languages,h=this._get_settings().core.html_titles,g;if(f.isArray(k)&&k.length){n=(n&&f.inArray(n,k)!=-1)?n:this.data.languages.current_language;m=m.children("a."+n)}else{m=m.children("a:eq(0)")}if(h){g=m.children("INS").clone();m.html(o).prepend(g);this.__callback({obj:m,name:o,lang:n});return true}else{m=m.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:m,name:o,lang:n});return(m.nodeValue=o)}},_load_css:function(){var k=this._get_settings().languages,m="/* languages css */",g=".jstree-"+this.get_index()+" a",h;if(f.isArray(k)&&k.length){this.data.languages.current_language=k[0];for(h=0;h<k.length;h++){m+=g+"."+k[h]+" {";if(k[h]!=this.data.languages.current_language){m+=" display:none; "}m+=" } "}this.data.languages.language_css=f.vakata.css.add_sheet({str:m,title:"jstree-languages"})}},create_node:function(m,g,k,n){var h=this.__call_old(true,m,g,k,function(q){var u=this._get_settings().languages,o=q.children("a"),r;if(f.isArray(u)&&u.length){for(r=0;r<u.length;r++){if(!o.is("."+u[r])){q.append(o.eq(0).clone().removeClass(u.join(" ")).addClass(u[r]))}}o.not("."+u.join(", .")).remove()}if(n){n.call(this,q)}});return h}}})})(jQuery);(function(f){f.jstree.plugin("cookies",{__init:function(){if(typeof f.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included."}var h=this._get_settings().cookies,g;if(!!h.save_loaded){g=f.cookie(h.save_loaded);if(g&&g.length){this.data.core.to_load=g.split(",")}}if(!!h.save_opened){g=f.cookie(h.save_opened);if(g&&g.length){this.data.core.to_open=g.split(",")}}if(!!h.save_selected){g=f.cookie(h.save_selected);if(g&&g.length&&this.data.ui){this.data.ui.to_select=g.split(",")}}this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",f.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",f.proxy(function(k){if(this._get_settings().cookies.auto_save){this.save_cookie((k.handleObj.namespace+k.handleObj.type).replace("jstree",""))}},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(h){if(this.data.core.refreshing){return}var g=this._get_settings().cookies;if(!h){if(g.save_loaded){this.save_loaded();f.cookie(g.save_loaded,this.data.core.to_load.join(","),g.cookie_options)}if(g.save_opened){this.save_opened();f.cookie(g.save_opened,this.data.core.to_open.join(","),g.cookie_options)}if(g.save_selected&&this.data.ui){this.save_selected();f.cookie(g.save_selected,this.data.ui.to_select.join(","),g.cookie_options)}return}switch(h){case"open_node":case"close_node":if(!!g.save_opened){this.save_opened();f.cookie(g.save_opened,this.data.core.to_open.join(","),g.cookie_options)}if(!!g.save_loaded){this.save_loaded();f.cookie(g.save_loaded,this.data.core.to_load.join(","),g.cookie_options)}break;case"select_node":case"deselect_node":if(!!g.save_selected&&this.data.ui){this.save_selected();f.cookie(g.save_selected,this.data.ui.to_select.join(","),g.cookie_options)}break}}}})})(jQuery);(function(f){f.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",f.proxy(function(k,g){var h=this._get_node(g.rslt.obj);h=h===-1?this.get_container().children("ul"):h.children("ul");this.sort(h)},this)).bind("rename_node.jstree create_node.jstree create.jstree",f.proxy(function(h,g){this.sort(g.rslt.obj.parent())},this)).bind("move_node.jstree",f.proxy(function(k,h){var g=h.rslt.np==-1?this.get_container():h.rslt.np;this.sort(g.children("ul"))},this))},defaults:function(h,g){return this.get_text(h)>this.get_text(g)?1:-1},_fn:{sort:function(k){var h=this._get_settings().sort,g=this;k.append(f.makeArray(k.children("li")).sort(f.proxy(h,g)));k.find("> li > ul").each(function(){g.sort(f(this))});this.clean_node(k)}}})})(jQuery);(function(t){var h=false,f=false,k=false,n=false,u=false,g=false,x=false,v=false,q=false;t.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(y,r,m){if(t.vakata.dnd.is_drag){t.vakata.drag_stop({})}try{y.currentTarget.unselectable="on";y.currentTarget.onselectstart=function(){return false};if(y.currentTarget.style){y.currentTarget.style.MozUserSelect="none"}}catch(o){}t.vakata.dnd.init_x=y.pageX;t.vakata.dnd.init_y=y.pageY;t.vakata.dnd.user_data=r;t.vakata.dnd.is_down=true;t.vakata.dnd.helper=t("<div id='vakata-dragged' />").html(m);t(document).bind("mousemove",t.vakata.dnd.drag);t(document).bind("mouseup",t.vakata.dnd.drag_stop);return false},drag:function(r){if(!t.vakata.dnd.is_down){return}if(!t.vakata.dnd.is_drag){if(Math.abs(r.pageX-t.vakata.dnd.init_x)>5||Math.abs(r.pageY-t.vakata.dnd.init_y)>5){t.vakata.dnd.helper.appendTo("body");t.vakata.dnd.is_drag=true;t(document).triggerHandler("drag_start.vakata",{event:r,data:t.vakata.dnd.user_data})}else{return}}if(r.type==="mousemove"){var y=t(document),o=y.scrollTop(),m=y.scrollLeft();if(r.pageY-o<20){if(g&&x==="down"){clearInterval(g);g=false}if(!g){x="up";g=setInterval(function(){t(document).scrollTop(t(document).scrollTop()-t.vakata.dnd.scroll_spd)},150)}}else{if(g&&x==="up"){clearInterval(g);g=false}}if(t(window).height()-(r.pageY-o)<20){if(g&&x==="up"){clearInterval(g);g=false}if(!g){x="down";g=setInterval(function(){t(document).scrollTop(t(document).scrollTop()+t.vakata.dnd.scroll_spd)},150)}}else{if(g&&x==="down"){clearInterval(g);g=false}}if(r.pageX-m<20){if(u&&v==="right"){clearInterval(u);u=false}if(!u){v="left";u=setInterval(function(){t(document).scrollLeft(t(document).scrollLeft()-t.vakata.dnd.scroll_spd)},150)}}else{if(u&&v==="left"){clearInterval(u);u=false}}if(t(window).width()-(r.pageX-m)<20){if(u&&v==="left"){clearInterval(u);u=false}if(!u){v="right";u=setInterval(function(){t(document).scrollLeft(t(document).scrollLeft()+t.vakata.dnd.scroll_spd)},150)}}else{if(u&&v==="right"){clearInterval(u);u=false}}}t.vakata.dnd.helper.css({left:(r.pageX+t.vakata.dnd.helper_left)+"px",top:(r.pageY+t.vakata.dnd.helper_top)+"px"});t(document).triggerHandler("drag.vakata",{event:r,data:t.vakata.dnd.user_data})},drag_stop:function(m){if(u){clearInterval(u)}if(g){clearInterval(g)}t(document).unbind("mousemove",t.vakata.dnd.drag);t(document).unbind("mouseup",t.vakata.dnd.drag_stop);t(document).triggerHandler("drag_stop.vakata",{event:m,data:t.vakata.dnd.user_data});t.vakata.dnd.helper.remove();t.vakata.dnd.init_x=0;t.vakata.dnd.init_y=0;t.vakata.dnd.user_data={};t.vakata.dnd.is_down=false;t.vakata.dnd.is_drag=false}};t(function(){var m="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";t.vakata.css.add_sheet({str:m,title:"vakata"})});t.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false,mto:false};this.get_container().bind("mouseenter.jstree",t.proxy(function(y){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){if(this.data.themes){k.attr("class","jstree-"+this.data.themes.theme);if(n){n.attr("class","jstree-"+this.data.themes.theme)}t.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}if(y.currentTarget===y.target&&t.vakata.dnd.user_data.obj&&t(t.vakata.dnd.user_data.obj).length&&t(t.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==y.target){var r=t.jstree._reference(y.target),o;if(r.data.dnd.foreign){o=r._get_settings().dnd.drag_check.call(this,{o:h,r:r.get_container(),is_root:true});if(o===true||o.inside===true||o.before===true||o.after===true){t.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}else{r.prepare_move(h,r.get_container(),"last");if(r.check_move()){t.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}}}},this)).bind("mouseup.jstree",t.proxy(function(y){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree&&y.currentTarget===y.target&&t.vakata.dnd.user_data.obj&&t(t.vakata.dnd.user_data.obj).length&&t(t.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==y.target){var r=t.jstree._reference(y.currentTarget),o;if(r.data.dnd.foreign){o=r._get_settings().dnd.drag_check.call(this,{o:h,r:r.get_container(),is_root:true});if(o===true||o.inside===true||o.before===true||o.after===true){r._get_settings().dnd.drag_finish.call(this,{o:h,r:r.get_container(),is_root:true})}}else{r.move_node(h,r.get_container(),"last",y[r._get_settings().dnd.copy_modifier+"Key"])}}},this)).bind("mouseleave.jstree",t.proxy(function(o){if(o.relatedTarget&&o.relatedTarget.id&&o.relatedTarget.id==="jstree-marker-line"){return false}if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(t.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){t.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}}},this)).bind("mousemove.jstree",t.proxy(function(r){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){var o=this.get_container()[0];if(r.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(t.proxy(function(){this.scrollLeft+=t.vakata.dnd.scroll_spd},o),100)}else{if(r.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(t.proxy(function(){this.scrollLeft-=t.vakata.dnd.scroll_spd},o),100)}else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}}}if(r.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(t.proxy(function(){this.scrollTop+=t.vakata.dnd.scroll_spd},o),100)}else{if(r.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(t.proxy(function(){this.scrollTop-=t.vakata.dnd.scroll_spd},o),100)}else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}}}}},this)).bind("scroll.jstree",t.proxy(function(o){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree&&k&&n){k.hide();n.hide()}},this)).delegate("a","mousedown.jstree",t.proxy(function(o){if(o.which===1){this.start_drag(o.currentTarget,o);return false}},this)).delegate("a","mouseenter.jstree",t.proxy(function(o){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){this.dnd_enter(o.currentTarget)}},this)).delegate("a","mousemove.jstree",t.proxy(function(o){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){if(!f||!f.length||f.children("a")[0]!==o.currentTarget){this.dnd_enter(o.currentTarget)}if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=t(o.target).offset()}this.data.dnd.w=(o.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height}this.dnd_show()}},this)).delegate("a","mouseleave.jstree",t.proxy(function(o){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){if(o.relatedTarget&&o.relatedTarget.id&&o.relatedTarget.id==="jstree-marker-line"){return false}if(k){k.hide()}if(n){n.hide()}this.data.dnd.mto=setTimeout((function(r){return function(){r.dnd_leave(o)}})(this),0)}},this)).delegate("a","mouseup.jstree",t.proxy(function(o){if(t.vakata.dnd.is_drag&&t.vakata.dnd.user_data.jstree){this.dnd_finish(o)}},this));t(document).bind("drag_stop.vakata",t.proxy(function(){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.i1=false;this.data.dnd.i2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(k){k.css({top:"-2000px"})}if(n){n.css({top:"-2000px"})}},this)).bind("drag_start.vakata",t.proxy(function(y,o){if(o.data.jstree){var r=t(o.event.target);if(r.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(r)}}},this));var m=this._get_settings().dnd;if(m.drag_target){t(document).delegate(m.drag_target,"mousedown.jstree-"+this.get_index(),t.proxy(function(r){h=r.target;t.vakata.dnd.drag_start(r,{jstree:true,obj:r.target},"<ins class='jstree-icon'></ins>"+t(r.target).text());if(this.data.themes){if(k){k.attr("class","jstree-"+this.data.themes.theme)}if(n){n.attr("class","jstree-"+this.data.themes.theme)}t.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}t.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var o=this.get_container();this.data.dnd.cof=o.offset();this.data.dnd.cw=parseInt(o.width(),10);this.data.dnd.ch=parseInt(o.height(),10);this.data.dnd.foreign=true;r.preventDefault()},this))}if(m.drop_target){t(document).delegate(m.drop_target,"mouseenter.jstree-"+this.get_index(),t.proxy(function(o){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:h,r:t(o.target),e:o})){t.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}},this)).delegate(m.drop_target,"mouseleave.jstree-"+this.get_index(),t.proxy(function(o){if(this.data.dnd.active){t.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}},this)).delegate(m.drop_target,"mouseup.jstree-"+this.get_index(),t.proxy(function(o){if(this.data.dnd.active&&t.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{o:h,r:t(o.target),e:o})}},this))}},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(m){return true},drop_finish:t.noop,drag_target:".jstree-draggable",drag_finish:t.noop,drag_check:function(m){return{after:false,before:false,inside:true}}},_fn:{dnd_prepare:function(){if(!f||!f.length){return}this.data.dnd.off=f.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+f.width()}if(this.data.dnd.foreign){var m=this._get_settings().dnd.drag_check.call(this,{o:h,r:f});this.data.dnd.after=m.after;this.data.dnd.before=m.before;this.data.dnd.inside=m.inside;this.data.dnd.prepared=true;return this.dnd_show()}this.prepare_move(h,f,"before");this.data.dnd.before=this.check_move();this.prepare_move(h,f,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(f)){this.prepare_move(h,f,"inside");this.data.dnd.inside=this.check_move()}else{this.data.dnd.inside=false}this.data.dnd.prepared=true;return this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared){return}var z=["before","inside","after"],m=false,y=this._get_settings().core.rtl,A;if(this.data.dnd.w<this.data.core.li_height/3){z=["before","inside","after"]}else{if(this.data.dnd.w<=this.data.core.li_height*2/3){z=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]}else{z=["after","inside","before"]}}t.each(z,t.proxy(function(o,r){if(this.data.dnd[r]){t.vakata.dnd.helper.children("ins").attr("class","jstree-ok");m=r;return false}},this));if(m===false){t.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}A=y?(this.data.dnd.off.right-18):(this.data.dnd.off.left+10);switch(m){case"before":k.css({left:A+"px",top:(this.data.dnd.off.top-6)+"px"}).show();if(n){n.css({left:(A+8)+"px",top:(this.data.dnd.off.top-1)+"px"}).show()}break;case"after":k.css({left:A+"px",top:(this.data.dnd.off.top+this.data.core.li_height-6)+"px"}).show();if(n){n.css({left:(A+8)+"px",top:(this.data.dnd.off.top+this.data.core.li_height-1)+"px"}).show()}break;case"inside":k.css({left:A+(y?-4:4)+"px",top:(this.data.dnd.off.top+this.data.core.li_height/2-5)+"px"}).show();if(n){n.hide()}break;default:k.hide();if(n){n.hide()}break}q=m;return m},dnd_open:function(){this.data.dnd.to2=false;this.open_node(f,t.proxy(this.dnd_prepare,this),true)},dnd_finish:function(m){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{o:h,r:f,p:q})}}else{this.dnd_prepare();this.move_node(h,f,q,m[this._get_settings().dnd.copy_modifier+"Key"])}h=false;f=false;k.hide();if(n){n.hide()}},dnd_enter:function(o){if(this.data.dnd.mto){clearTimeout(this.data.dnd.mto);this.data.dnd.mto=false}var m=this._get_settings().dnd;this.data.dnd.prepared=false;f=this._get_node(o);if(m.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}this.data.dnd.to1=setTimeout(t.proxy(this.dnd_prepare,this),m.check_timeout)}else{this.dnd_prepare()}if(m.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(f&&f.length&&f.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout(t.proxy(this.dnd_open,this),m.open_timeout)}}else{if(f&&f.length&&f.hasClass("jstree-closed")){this.dnd_open()}}},dnd_leave:function(m){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;t.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");k.hide();if(n){n.hide()}if(f&&f[0]===m.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false}}},start_drag:function(y,r){h=this._get_node(y);if(this.data.ui&&this.is_selected(h)){h=this._get_node(null,true)}var o=h.length>1?this._get_string("multiple_selection"):this.get_text(h),m=this.get_container();if(!this._get_settings().core.html_titles){o=o.replace(/</ig,"&lt;").replace(/>/ig,"&gt;")}t.vakata.dnd.drag_start(r,{jstree:true,obj:h},"<ins class='jstree-icon'></ins>"+o);if(this.data.themes){if(k){k.attr("class","jstree-"+this.data.themes.theme)}if(n){n.attr("class","jstree-"+this.data.themes.theme)}t.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}this.data.dnd.cof=m.offset();this.data.dnd.cw=parseInt(m.width(),10);this.data.dnd.ch=parseInt(m.height(),10);this.data.dnd.active=true}}});t(function(){var m="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";t.vakata.css.add_sheet({str:m,title:"jstree"});k=t("<div />").attr({id:"jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter",function(o){k.hide();n.hide();o.preventDefault();o.stopImmediatePropagation();return false}).appendTo("body");n=t("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(o){if(f&&f.length){f.children("a").trigger(o);o.preventDefault();o.stopImmediatePropagation();return false}}).bind("mouseleave",function(r){var o=t(r.relatedTarget);if(o.is(".jstree")||o.closest(".jstree").length===0){if(f&&f.length){f.children("a").trigger(r);k.hide();n.hide();r.preventDefault();r.stopImmediatePropagation();return false}}}).appendTo("body");t(document).bind("drag_start.vakata",function(r,o){if(o.data.jstree){k.show();if(n){n.show()}}});t(document).bind("drag_stop.vakata",function(r,o){if(o.data.jstree){k.hide();if(n){n.hide()}}})})})(jQuery);(function(f){f.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;if(this.data.ui&&this.data.checkbox.noui){this.select_node=this.deselect_node=this.deselect_all=f.noop;this.get_selected=this.get_checked}this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",f.proxy(function(h,g){this._prepare_checkboxes(g.rslt.obj)},this)).bind("loaded.jstree",f.proxy(function(g){this._prepare_checkboxes()},this)).delegate((this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox"),"click.jstree",f.proxy(function(g){g.preventDefault();if(this._get_node(g.target).hasClass("jstree-checked")){this.uncheck_node(g.target)}else{this.check_node(g.target)}if(this.data.ui&&this.data.checkbox.noui){this.save_selected();if(this.data.cookies){this.save_cookie("select_node")}}else{g.stopImmediatePropagation();return false}},this))},defaults:{override_ui:false,two_state:false,real_checkboxes:false,checked_parent_open:true,real_checkboxes_names:function(g){return[("check_"+(g[0].id||Math.ceil(Math.random()*10000))),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(h,g){if(g.checked){this.check_node(h,false)}},_prepare_checkboxes:function(n){n=!n||n==-1?this.get_container().find("> ul > li"):this._get_node(n);if(n===false){return}var q,o=this,g,k=this._get_settings().checkbox.two_state,m=this._get_settings().checkbox.real_checkboxes,h=this._get_settings().checkbox.real_checkboxes_names;n.each(function(){g=f(this);q=g.is("li")&&(g.hasClass("jstree-checked")||(m&&g.children(":checked").length))?"jstree-checked":"jstree-unchecked";g.find("li").andSelf().each(function(){var t=f(this),r;t.children("a"+(o.data.languages?"":":eq(0)")).filter("li[rel!='style'] > a").not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(k?"jstree-unchecked":q);if(m){if(!t.children(":checkbox").length){r=h.call(o,t);t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+r[0]+"' name='"+r[0]+"' value='"+r[1]+"' />")}else{t.children(":checkbox").addClass("jstree-real-checkbox")}if(q==="jstree-checked"){t.children(":checkbox").attr("checked","checked")}}if(q==="jstree-checked"&&!k){t.find("li").addClass("jstree-checked")}})});if(!k){if(n.length===1&&n.is("li")){this._repair_state(n)}if(n.is("li")){n.each(function(){o._repair_state(this)})}else{n.find("> ul > li").each(function(){o._repair_state(this)})}n.find(".jstree-checked").parent().parent().each(function(){o._repair_state(this)})}},change_state:function(m,k){m=this._get_node(m);var g=false,h=this._get_settings().checkbox.real_checkboxes;if(!m||m===-1){return false}k=(k===false||k===true)?k:m.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state){if(k){m.removeClass("jstree-checked").addClass("jstree-unchecked");if(h){m.children(":checkbox").removeAttr("checked")}}else{m.removeClass("jstree-unchecked").addClass("jstree-checked");if(h){m.children(":checkbox").attr("checked","checked")}}}else{if(k){g=m.find("li").andSelf();if(!g.filter(".jstree-checked, .jstree-undetermined").length){return false}g.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(h){g.children(":checkbox").removeAttr("checked")}}else{g=m.find("li").andSelf();if(!g.filter(".jstree-unchecked, .jstree-undetermined").length){return false}g.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(h){g.children(":checkbox").attr("checked","checked")}if(this.data.ui){this.data.ui.last_selected=m}this.data.checkbox.last_selected=m}m.parentsUntil(".jstree","li").each(function(){var n=f(this);if(k){if(n.children("ul").children("li.jstree-checked, li.jstree-undetermined").length){n.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(h){n.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked")}return false}else{n.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(h){n.children(":checkbox").removeAttr("checked")}}}else{if(n.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length){n.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(h){n.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked")}return false}else{n.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(h){n.children(":checkbox").attr("checked","checked")}}}})}if(this.data.ui&&this.data.checkbox.noui){this.data.ui.selected=this.get_checked()}this.__callback(m);return true},check_node:function(h){if(this.change_state(h,false)){h=this._get_node(h);if(this._get_settings().checkbox.checked_parent_open){var g=this;h.parents(".jstree-closed").each(function(){g.open_node(this,false,true)})}this.__callback({obj:h})}},uncheck_node:function(g){if(this.change_state(g,true)){this.__callback({obj:this._get_node(g)})}},check_all:function(){var h=this,g=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");g.each(function(){h.change_state(this,false)});this.__callback()},uncheck_all:function(){var h=this,g=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");g.each(function(){h.change_state(this,true)});this.__callback()},is_checked:function(g){g=this._get_node(g);return g.length?g.is(".jstree-checked"):false},get_checked:function(h,g){h=!h||h===-1?this.get_container():this._get_node(h);return g||this._get_settings().checkbox.two_state?h.find(".jstree-checked"):h.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(h,g){h=!h||h===-1?this.get_container():this._get_node(h);return g||this._get_settings().checkbox.two_state?h.find(".jstree-unchecked"):h.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(m){m=this._get_node(m);if(!m.length){return}var k=this._get_settings().checkbox.real_checkboxes,h=m.find("> ul > .jstree-checked").length,g=m.find("> ul > .jstree-undetermined").length,n=m.find("> ul > li").length;if(n===0){if(m.hasClass("jstree-undetermined")){this.change_state(m,false)}}else{if(h===0&&g===0){this.change_state(m,true)}else{if(h===n){this.change_state(m,false)}else{m.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(k){m.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked")}}}}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var h=this,g=this.data.ui.to_select;g=f.map(f.makeArray(g),function(k){return"#"+k.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();f.each(g,function(k,m){h.check_node(m)});this.__callback()}else{this.__call_old()}},save_loaded:function(){var g=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){if(this.id){g.data.core.to_load.push("#"+this.id)}})}}});f(function(){var g=".jstree .jstree-real-checkbox { display:none; } ";f.vakata.css.add_sheet({str:g,title:"jstree"})})})(jQuery);(function(f){f.expr[":"].jstree_contains=function(h,k,g){return(h.textContent||h.innerText||"").toLowerCase().indexOf(g[3].toLowerCase())>=0};f.expr[":"].jstree_title_contains=function(h,k,g){return(h.getAttribute("title")||"").toLowerCase().indexOf(g[3].toLowerCase())>=0};f.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=f();if(this._get_settings().search.show_only_matches){this.get_container().bind("search.jstree",function(h,g){f(this).children("ul").find("li").hide().removeClass("jstree-last");g.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){f(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){f(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})}},defaults:{ajax:false,search_method:"jstree_contains",show_only_matches:false},_fn:{search:function(o,g){if(f.trim(o)===""){this.clear_search();return}var m=this.get_settings().search,k=this,h=function(){},n=function(){};this.data.search.str=o;if(!g&&m.ajax!==false&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=true;h=function(){};n=function(v,r,q){var u=this.get_settings().search.ajax.success;if(u){v=u.call(this,v,r,q)||v}this.data.search.to_open=v;this._search_open()};m.ajax.context=this;m.ajax.error=h;m.ajax.success=n;if(f.isFunction(m.ajax.url)){m.ajax.url=m.ajax.url.call(this,o)}if(f.isFunction(m.ajax.data)){m.ajax.data=m.ajax.data.call(this,o)}if(!m.ajax.data){m.ajax.data={search_string:o}}if(!m.ajax.dataType||/^json/.exec(m.ajax.dataType)){m.ajax.dataType="json"}f.ajax(m.ajax);return}if(this.data.search.result.length){this.clear_search()}this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(m.search_method)+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){k.open_node(this,false,true)});this.__callback({nodes:this.data.search.result,str:o})},clear_search:function(g){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=f()},_search_open:function(h){var n=this,g=true,m=[],k=[];if(this.data.search.to_open.length){f.each(this.data.search.to_open,function(o,q){if(q=="#"){return true}if(f(q).length&&f(q).is(".jstree-closed")){m.push(q)}else{k.push(q)}});if(m.length){this.data.search.to_open=k;f.each(m,function(o,q){n.open_node(q,function(){n._search_open(true)})});g=false}}if(g){this.search(this.data.search.str,true)}}}})})(jQuery);(function(f){f.vakata.context={hide_on_mouseleave:false,cnt:f("<div id='vakata-contextmenu' />"),vis:false,tgt:false,par:false,func:false,data:false,rtl:false,show:function(z,v,r,o,n,g,q){f.vakata.context.rtl=!!q;var m=f.vakata.context.parse(z),k,u;if(!m){return}f.vakata.context.vis=true;f.vakata.context.tgt=v;f.vakata.context.par=g||v||null;f.vakata.context.data=n||null;f.vakata.context.cnt.html(m).css({visibility:"hidden",display:"block",left:0,top:0});if(f.vakata.context.hide_on_mouseleave){f.vakata.context.cnt.one("mouseleave",function(h){f.vakata.context.hide()})}k=f.vakata.context.cnt.height();u=f.vakata.context.cnt.width();if(r+u>f(document).width()){r=f(document).width()-(u+5);f.vakata.context.cnt.find("li > ul").addClass("right")}if(o+k>f(document).height()){o=o-(k+v[0].offsetHeight);f.vakata.context.cnt.find("li > ul").addClass("bottom")}f.vakata.context.cnt.css({left:r,top:o}).find("li:has(ul)").bind("mouseenter",function(A){var t=f(document).width(),y=f(document).height(),x=f(this).children("ul").show();if(t!==f(document).width()){x.toggleClass("right")}if(y!==f(document).height()){x.toggleClass("bottom")}}).bind("mouseleave",function(h){f(this).children("ul").hide()}).end().css({visibility:"visible"}).show();f(document).triggerHandler("context_show.vakata")},hide:function(){f.vakata.context.vis=false;f.vakata.context.cnt.attr("class","").css({visibility:"hidden"});f(document).triggerHandler("context_hide.vakata")},parse:function(m,k){if(!m){return false}var n="",h=false,g=true;if(!k){f.vakata.context.func={}}n+="<ul>";f.each(m,function(o,q){if(!q){return true}f.vakata.context.func[o]=q.action;if(!g&&q.separator_before){n+="<li class='vakata-separator vakata-separator-before'></li>"}g=false;n+="<li class='"+(q._class||"")+(q._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(q.icon&&q.icon.indexOf("/")===-1){n+=" class='"+q.icon+"' "}if(q.icon&&q.icon.indexOf("/")!==-1){n+=" style='background:url("+q.icon+") center center no-repeat;' "}n+=">&#160;</ins><a href='#' rel='"+o+"'>";if(q.submenu){n+="<span style='float:"+(f.vakata.context.rtl?"left":"right")+";'>&raquo;</span>"}n+=q.label+"</a>";if(q.submenu){h=f.vakata.context.parse(q.submenu,true);if(h){n+=h}}n+="</li>";if(q.separator_after){n+="<li class='vakata-separator vakata-separator-after'></li>";g=true}});n=n.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");n+="</ul>";f(document).triggerHandler("context_parse.vakata");return n.length>10?n:false},exec:function(g){if(f.isFunction(f.vakata.context.func[g])){f.vakata.context.func[g].call(f.vakata.context.data,f.vakata.context.par);return true}else{return false}}};f(function(){var g="#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";f.vakata.css.add_sheet({str:g,title:"vakata"});f.vakata.context.cnt.delegate("a","click",function(h){h.preventDefault()}).delegate("a","mouseup",function(h){if(!f(this).parent().hasClass("jstree-contextmenu-disabled")&&f.vakata.context.exec(f(this).attr("rel"))){f.vakata.context.hide()}else{f(this).blur()}}).delegate("a","mouseover",function(){f.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");f(document).bind("mousedown",function(h){if(f.vakata.context.vis&&!f.contains(f.vakata.context.cnt[0],h.target)){f.vakata.context.hide()}});if(typeof f.hotkeys!=="undefined"){f(document).bind("keydown","up",function(h){if(f.vakata.context.vis){var k=f.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!k.length){k=f.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()}k.addClass("vakata-hover");h.stopImmediatePropagation();h.preventDefault()}}).bind("keydown","down",function(h){if(f.vakata.context.vis){var k=f.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!k.length){k=f.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()}k.addClass("vakata-hover");h.stopImmediatePropagation();h.preventDefault()}}).bind("keydown","right",function(h){if(f.vakata.context.vis){f.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");h.stopImmediatePropagation();h.preventDefault()}}).bind("keydown","left",function(h){if(f.vakata.context.vis){f.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");h.stopImmediatePropagation();h.preventDefault()}}).bind("keydown","esc",function(h){f.vakata.context.hide();h.preventDefault()}).bind("keydown","space",function(h){f.vakata.context.cnt.find(".vakata-hover").last().children("a").click();h.preventDefault()})}});f.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",f.proxy(function(g){g.preventDefault();if(!f(g.currentTarget).hasClass("jstree-loading")){this.show_contextmenu(g.currentTarget,g.pageX,g.pageY)}},this)).delegate("a","click.jstree",f.proxy(function(g){if(this.data.contextmenu){f.vakata.context.hide()}},this)).bind("destroy.jstree",f.proxy(function(){if(this.data.contextmenu){f.vakata.context.hide()}},this));f(document).bind("context_hide.vakata",f.proxy(function(){this.data.contextmenu=false},this))},defaults:{select_node:false,show_at_node:true,items:{create:{separator_before:false,separator_after:true,label:"Create",action:function(g){this.create(g)}},rename:{separator_before:false,separator_after:false,label:"Rename",action:function(g){this.rename(g)}},remove:{separator_before:false,icon:false,separator_after:false,label:"Delete",action:function(g){if(this.is_selected(g)){this.remove()}else{this.remove(g)}}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(g){this.cut(g)}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(g){this.copy(g)}},paste:{separator_before:false,icon:false,separator_after:false,label:"Paste",action:function(g){this.paste(g)}}}}}},_fn:{show_contextmenu:function(n,g,r){n=this._get_node(n);var m=this.get_settings().contextmenu,h=n.children("a:visible:eq(0)"),q=false,k=false;if(m.select_node&&this.data.ui&&!this.is_selected(n)){this.deselect_all();this.select_node(n,true)}if(m.show_at_node||typeof g==="undefined"||typeof r==="undefined"){q=h.offset();g=q.left;r=q.top+this.data.core.li_height}k=n.data("jstree")&&n.data("jstree").contextmenu?n.data("jstree").contextmenu:m.items;if(f.isFunction(k)){k=k.call(this,n)}this.data.contextmenu=true;f.vakata.context.show(k,h,g,r,this,n,this._get_settings().core.rtl);if(this.data.themes){f.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}}})})(jQuery);(function(f){f.jstree.plugin("types",{__init:function(){var g=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",f.proxy(function(){var m=g.types,k=g.type_attr,h="",n=this;f.each(m,function(o,q){f.each(q,function(t,r){if(!/^(max_depth|max_children|icon|valid_children)$/.test(t)){n.data.types.attach_to.push(t)}});if(!q.icon){return true}if(q.icon.image||q.icon.position){if(o=="default"){h+=".jstree-"+n.get_index()+" a > .jstree-icon { "}else{h+=".jstree-"+n.get_index()+" li["+k+'="'+o+'"] > a > .jstree-icon { '}if(q.icon.image){h+=" background-image:url("+q.icon.image+"); "}if(q.icon.position){h+=" background-position:"+q.icon.position+"; "}else{h+=" background-position:0 0; "}h+="} "}});if(h!==""){f.vakata.css.add_sheet({str:h,title:"jstree-types"})}},this)).bind("before.jstree",f.proxy(function(n,m){var k,h,r=this._get_settings().types.use_data?this._get_node(m.args[0]):false,q=r&&r!==-1&&r.length?r.data("jstree"):false;if(q&&q.types&&q.types[m.func]===false){n.stopImmediatePropagation();return false}if(f.inArray(m.func,this.data.types.attach_to)!==-1){if(!m.args[0]||(!m.args[0].tagName&&!m.args[0].jquery)){return}k=this._get_settings().types.types;h=this._get_type(m.args[0]);if(((k[h]&&typeof k[h][m.func]!=="undefined")||(k["default"]&&typeof k["default"][m.func]!=="undefined"))&&this._check(m.func,m.args[0])===false){n.stopImmediatePropagation();return false}}},this));if(e){this.get_container().bind("load_node.jstree set_type.jstree",f.proxy(function(n,m){var k=m&&m.rslt&&m.rslt.obj&&m.rslt.obj!==-1?this._get_node(m.rslt.obj).parent():this.get_container_ul(),o=false,h=this._get_settings().types;f.each(h.types,function(q,r){if(r.icon&&(r.icon.image||r.icon.position)){o=q==="default"?k.find("li > a > .jstree-icon"):k.find("li["+h.type_attr+"='"+q+"'] > a > .jstree-icon");if(r.icon.image){o.css("backgroundImage","url("+r.icon.image+")")}o.css("backgroundPosition",r.icon.position||"0 0")}})},this))}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:false,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(h,g){if(g.type&&this._get_settings().types.use_data){this.set_type(g.type,h)}},_get_type:function(g){g=this._get_node(g);return(!g||!g.length)?false:g.attr(this._get_settings().types.type_attr)||"default"},set_type:function(k,h){h=this._get_node(h);var g=(!h.length||!k)?false:h.attr(this._get_settings().types.type_attr,k);if(g){this.__callback({obj:h,type:k})}return g},_check:function(o,k,g){k=this._get_node(k);var q=false,r=this._get_type(k),n=0,m=this,u=this._get_settings().types,h=false;if(k===-1){if(!!u[o]){q=u[o]}else{return}}else{if(r===false){return}h=u.use_data?k.data("jstree"):false;if(h&&h.types&&typeof h.types[o]!=="undefined"){q=h.types[o]}else{if(!!u.types[r]&&typeof u.types[r][o]!=="undefined"){q=u.types[r][o]}else{if(!!u.types["default"]&&typeof u.types["default"][o]!=="undefined"){q=u.types["default"][o]}}}}if(f.isFunction(q)){q=q.call(this,k)}if(o==="max_depth"&&k!==-1&&g!==false&&u.max_depth!==-2&&q!==0){k.children("a:eq(0)").parentsUntil(".jstree","li").each(function(t){if(u.max_depth!==-1&&u.max_depth-(t+1)<=0){q=0;return false}n=(t===0)?q:m._check(o,this,false);if(n!==-1&&n-(t+1)<=0){q=0;return false}if(n>=0&&(n-(t+1)<q||q<0)){q=n-(t+1)}if(u.max_depth>=0&&(u.max_depth-(t+1)<q||q<0)){q=u.max_depth-(t+1)}})}return q},check_move:function(){if(!this.__call_old()){return false}var g=this._get_move(),o=g.rt._get_settings().types,r=g.rt._check("max_children",g.cr),q=g.rt._check("max_depth",g.cr),k=g.rt._check("valid_children",g.cr),n=0,u=1,h;if(k==="none"){return false}if(f.isArray(k)&&g.ot&&g.ot._get_type){g.o.each(function(){if(f.inArray(g.ot._get_type(this),k)===-1){u=false;return false}});if(u===false){return false}}if(o.max_children!==-2&&r!==-1){n=g.cr===-1?this.get_container().find("> ul > li").not(g.o).length:g.cr.find("> ul > li").not(g.o).length;if(n+g.o.length>r){return false}}if(o.max_depth!==-2&&q!==-1){u=0;if(q===0){return false}if(typeof g.o.d==="undefined"){h=g.o;while(h.length>0){h=h.find("> ul > li");u++}g.o.d=u}if(q-g.o.d<0){return false}}return true},create_node:function(m,n,h,v,q,u){if(!u&&(q||this._is_loaded(m))){var k=(typeof n=="string"&&n.match(/^before|after$/i)&&m!==-1)?this._get_parent(m):this._get_node(m),x=this._get_settings().types,t=this._check("max_children",k),r=this._check("max_depth",k),o=this._check("valid_children",k),g;if(typeof h==="string"){h={data:h}}if(!h){h={}}if(o==="none"){return false}if(f.isArray(o)){if(!h.attr||!h.attr[x.type_attr]){if(!h.attr){h.attr={}}h.attr[x.type_attr]=o[0]}else{if(f.inArray(h.attr[x.type_attr],o)===-1){return false}}}if(x.max_children!==-2&&t!==-1){g=k===-1?this.get_container().find("> ul > li").length:k.find("> ul > li").length;if(g+1>t){return false}}if(x.max_depth!==-2&&r!==-1&&(r-1)<0){return false}}return this.__call_old(true,m,n,h,v,q,u)}}})})(jQuery);(function(f){f.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(k,g,h){var m=this;this.load_node_html(k,function(){m.__callback({obj:m._get_node(k)});g.call(this)},h)},_is_loaded:function(g){g=this._get_node(g);return g==-1||!g||(!this._get_settings().html_data.ajax&&!f.isFunction(this._get_settings().html_data.data))||g.is(".jstree-open, .jstree-leaf")||g.children("ul").children("li").size()>0},load_node_html:function(n,g,k){var q,m=this.get_settings().html_data,h=function(){},o=function(){};n=this._get_node(n);if(n&&n!==-1){if(n.data("jstree-is-loading")){return}else{n.data("jstree-is-loading",true)}}switch(!0){case (f.isFunction(m.data)):m.data.call(this,n,f.proxy(function(r){if(r&&r!==""&&r.toString&&r.toString().replace(/^[\s\n]+$/,"")!==""){r=f(r);if(!r.is("ul")){r=f("<ul />").append(r)}if(n==-1||!n){this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{n.children("a.jstree-loading").removeClass("jstree-loading");n.append(r).children("ul").find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");n.removeData("jstree-is-loading")}this.clean_node(n);if(g){g.call(this)}}else{if(n&&n!==-1){n.children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading");if(m.correct_state){this.correct_state(n);if(g){g.call(this)}}}else{if(m.correct_state){this.get_container().children("ul").empty();if(g){g.call(this)}}}}},this));break;case (!m.data&&!m.ajax):if(!n||n==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(g){g.call(this)}break;case (!!m.data&&!m.ajax)||(!!m.data&&!!m.ajax&&(!n||n===-1)):if(!n||n==-1){q=f(m.data);if(!q.is("ul")){q=f("<ul />").append(q)}this.get_container().children("ul").empty().append(q.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(g){g.call(this)}break;case (!m.data&&!!m.ajax)||(!!m.data&&!!m.ajax&&n&&n!==-1):n=this._get_node(n);h=function(u,v,y){var r=this.get_settings().html_data.ajax.error;if(r){r.call(this,u,v,y)}if(n!=-1&&n.length){n.children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading");if(v==="success"&&m.correct_state){this.correct_state(n)}}else{if(v==="success"&&m.correct_state){this.get_container().children("ul").empty()}}if(k){k.call(this)}};o=function(y,u,r){var v=this.get_settings().html_data.ajax.success;if(v){y=v.call(this,y,u,r)||y}if(y===""||(y&&y.toString&&y.toString().replace(/^[\s\n]+$/,"")==="")){return h.call(this,r,u,"")}if(y){y=f(y);if(!y.is("ul")){y=f("<ul />").append(y)}if(n==-1||!n){this.get_container().children("ul").empty().append(y.children()).find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{n.children("a.jstree-loading").removeClass("jstree-loading");n.append(y).children("ul").find("li, a").filter(function(){return !this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");n.removeData("jstree-is-loading")}this.clean_node(n);if(g){g.call(this)}}else{if(n&&n!==-1){n.children("a.jstree-loading").removeClass("jstree-loading");n.removeData("jstree-is-loading");if(m.correct_state){this.correct_state(n);if(g){g.call(this)}}}else{if(m.correct_state){this.get_container().children("ul").empty();if(g){g.call(this)}}}}};m.ajax.context=this;m.ajax.error=h;m.ajax.success=o;if(!m.ajax.dataType){m.ajax.dataType="html"}if(f.isFunction(m.ajax.url)){m.ajax.url=m.ajax.url.call(this,n)}if(f.isFunction(m.ajax.data)){m.ajax.data=m.ajax.data.call(this,n)}f.ajax(m.ajax);break}}}});f.jstree.defaults.plugins.push("html_data")})(jQuery);(function(f){f.jstree.plugin("themeroller",{__init:function(){var g=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(h){if(!f(h.currentTarget).hasClass("jstree-loading")){f(this).addClass(g.item_h)}}).delegate("a","mouseleave.jstree",function(){f(this).removeClass(g.item_h)}).bind("init.jstree",f.proxy(function(k,h){h.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(h.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",f.proxy(function(k,h){this._themeroller(h.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",f.proxy(function(h){this._themeroller()},this)).bind("close_node.jstree",f.proxy(function(k,h){this._themeroller(h.rslt.obj)},this)).bind("delete_node.jstree",f.proxy(function(k,h){this._themeroller(h.rslt.parent)},this)).bind("correct_state.jstree",f.proxy(function(k,h){h.rslt.obj.children("ins.jstree-icon").removeClass(g.opened+" "+g.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(g.item_clsd,"").replace(g.item_open,"").replace(g.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(g.item_open+" "+g.item_clsd).addClass(g.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",f.proxy(function(k,h){h.rslt.obj.children("a").addClass(g.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",f.proxy(function(k,h){this.get_container().find("a."+g.item_a).removeClass(g.item_a).end().find("a.jstree-clicked").addClass(g.item_a)},this)).bind("dehover_node.jstree",f.proxy(function(k,h){h.rslt.obj.children("a").removeClass(g.item_h)},this)).bind("hover_node.jstree",f.proxy(function(k,h){this.get_container().find("a."+g.item_h).not(h.rslt.obj).removeClass(g.item_h);h.rslt.obj.children("a").addClass(g.item_h)},this)).bind("move_node.jstree",f.proxy(function(k,h){this._themeroller(h.rslt.o);this._themeroller(h.rslt.op)},this))},__destroy:function(){var g=this._get_settings().themeroller,h=["ui-icon"];f.each(g,function(m,k){k=k.split(" ");if(k.length){h=h.concat(k)}});this.get_container().removeClass("ui-widget-content").find("."+h.join(", .")).removeClass(h.join(" "))},_fn:{_themeroller:function(h){var g=this._get_settings().themeroller;h=!h||h==-1?this.get_container_ul():this._get_node(h).parent();h.find("li.jstree-closed").children("ins.jstree-icon").removeClass(g.opened).addClass("ui-icon "+g.closed).end().children("a").addClass(g.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(g.item_clsd,"").replace(g.item_open,"").replace(g.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(g.item_leaf+" "+g.item_open).addClass(g.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(g.closed).addClass("ui-icon "+g.opened).end().children("a").addClass(g.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(g.item_clsd,"").replace(g.item_open,"").replace(g.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(g.item_leaf+" "+g.item_clsd).addClass(g.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(g.closed+" ui-icon "+g.opened).end().children("a").addClass(g.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(g.item_clsd,"").replace(g.item_open,"").replace(g.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(g.item_clsd+" "+g.item_open).addClass(g.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});f(function(){var g=".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";f.vakata.css.add_sheet({str:g,title:"jstree"})})})(jQuery);(function(f){f.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",f.proxy(function(o,m){var g=[],k=true,n,h;if(m.func=="move_node"){if(m.args[4]===true){if(m.args[0].o&&m.args[0].o.length){m.args[0].o.children("a").each(function(){g.push(f(this).text().replace(/^\s+/g,""))});k=this._check_unique(g,m.args[0].np.find("> ul > li").not(m.args[0].o),"move_node")}}}if(m.func=="create_node"){if(m.args[4]||this._is_loaded(m.args[0])){n=this._get_node(m.args[0]);if(m.args[1]&&(m.args[1]==="before"||m.args[1]==="after")){n=this._get_parent(m.args[0]);if(!n||n===-1){n=this.get_container()}}if(typeof m.args[2]==="string"){g.push(m.args[2])}else{if(!m.args[2]||!m.args[2].data){g.push(this._get_string("new_node"))}else{g.push(m.args[2].data)}}k=this._check_unique(g,n.find("> ul > li"),"create_node")}}if(m.func=="rename_node"){g.push(m.args[1]);h=this._get_node(m.args[0]);n=this._get_parent(h);if(!n||n===-1){n=this.get_container()}k=this._check_unique(g,n.find("> ul > li").not(h),"rename_node")}if(!k){o.stopPropagation();return false}},this))},defaults:{error_callback:f.noop},_fn:{_check_unique:function(h,m,k){var g=[];m.children("a").each(function(){g.push(f(this).text().replace(/^\s+/g,""))});if(!g.length||!h.length){return true}g=g.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if((g.length+h.length)!=g.concat(h).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length){this._get_settings().unique.error_callback.call(null,h,m,k);return false}return true},check_move:function(){if(!this.__call_old()){return false}var h=this._get_move(),g=[];if(h.o&&h.o.length){h.o.children("a").each(function(){g.push(f(this).text().replace(/^\s+/g,""))});return this._check_unique(g,h.np.find("> ul > li").not(h.o),"check_move")}return true}}})})(jQuery);(function(f){f.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui){throw"jsTree wholerow: jsTree UI plugin not included."}this.data.wholerow.html=false;this.data.wholerow.to=false;this.get_container().bind("init.jstree",f.proxy(function(h,g){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",f.proxy(function(h,g){this._prepare_wholerow_span(g&&g.rslt&&g.rslt.obj?g.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",f.proxy(function(h,g){if(this.data.to){clearTimeout(this.data.to)}this.data.to=setTimeout((function(k,m){return function(){k._prepare_wholerow_ul(m)}})(this,g&&g.rslt&&g.rslt.obj?g.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",f.proxy(function(h,g){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",f.proxy(function(h,g){g.rslt.obj.each(function(){var k=g.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((f(this).offset().top-g.inst.get_container().offset().top+g.inst.get_container()[0].scrollTop)/g.inst.data.core.li_height),10))+")");k.children("a").attr("class",g.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",f.proxy(function(k,h){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(k.type==="hover_node"){var g=this.get_container().find(" > .jstree-wholerow li:visible:eq("+(parseInt(((h.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height),10))+")");g.children("a").attr("class",h.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(g){var h=f(g.currentTarget);if(g.target.tagName==="A"||(g.target.tagName==="INS"&&h.closest("li").is(".jstree-open, .jstree-closed"))){return}h.closest("li").children("a:visible:eq(0)").click();g.stopImmediatePropagation()}).delegate("li","mouseover.jstree",f.proxy(function(g){g.stopImmediatePropagation();if(f(g.currentTarget).children(".jstree-hovered, .jstree-clicked").length){return false}this.hover_node(g.currentTarget);return false},this)).delegate("li","mouseleave.jstree",f.proxy(function(g){if(f(g.currentTarget).children("a").hasClass("jstree-hovered").length){return}this.dehover_node(g.currentTarget)},this));if(c||e){f.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})}},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(g){g=!g||g==-1?this.get_container().find("> ul > li"):this._get_node(g);if(g===false){return}g.each(function(){f(this).find("li").andSelf().each(function(){var h=f(this);if(h.children(".jstree-wholerow-span").length){return true}h.prepend("<span class='jstree-wholerow-span' style='width:"+(h.parentsUntil(".jstree","li").length*18)+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var k=this.get_container().children("ul").eq(0),g=k.html();k.addClass("jstree-wholerow-real");if(this.data.wholerow.last_html!==g){this.data.wholerow.last_html=g;this.get_container().children(".jstree-wholerow").remove();this.get_container().append(k.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(k.parent()[0].scrollWidth).css("top",(k.height()+(c?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end())}}}});f(function(){var g=".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";if(a){g+=".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } "}if(c||e){g+=".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } "}f.vakata.css.add_sheet({str:g,title:"jstree"})})})(jQuery);(function(f){var g=["getChildren","getChildrenCount","getAttr","getName","getProps"],h=function(n,k){var m=true;n=n||{};k=[].concat(k);f.each(k,function(q,o){if(!f.isFunction(n[o])){m=false;return false}});return m};f.jstree.plugin("model",{__init:function(){if(!this.data.json_data){throw"jsTree model: jsTree json_data plugin not included."}this._get_settings().json_data.data=function(o,k){var m=(o==-1)?this._get_settings().model.object:o.data("jstree_model");if(!h(m,g)){return k.call(null,false)}if(this._get_settings().model.async){m.getChildren(f.proxy(function(n){this.model_done(n,k)},this))}else{this.model_done(m.getChildren(),k)}}},defaults:{object:false,id_prefix:false,async:false},_fn:{model_done:function(n,q){var k=[],m=this._get_settings(),o=this;if(!f.isArray(n)){n=[n]}f.each(n,function(t,v){var u=v.getProps()||{};u.attr=v.getAttr()||{};if(v.getChildrenCount()){u.state="closed"}u.data=v.getName();if(!f.isArray(u.data)){u.data=[u.data]}if(o.data.types&&f.isFunction(v.getType)){u.attr[m.types.type_attr]=v.getType()}if(u.attr.id&&m.model.id_prefix){u.attr.id=m.model.id_prefix+u.attr.id}if(!u.metadata){u.metadata={}}u.metadata.jstree_model=v;k.push(u)});q.call(null,k)}}})})(jQuery)})();(function(a){var c,f,e;c=["assert","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","time","timeEnd","trace","warn"];f=function(){};do{e=c.pop();if(!a[e]){a[e]=f}}while(c.length>0);window.console=a}(window.console||{}));(function(e,k,n,c){var o=new e.Deferred(),a,m,f,q=new e.Deferred(),g,h;e(function(){try{if(a.oauth2&&!a.oauth2.thisIsOauthFrame()){o.resolveWith(a,[a])}}catch(r){console.log(r)}});a={exposeJQuery:function(){return e},ready:function(r){if(arguments.length===0){return o.promise()}if(typeof r==="function"){o.done(r)}return this},includeCss:function(x,y){var t=new e.Deferred(),v=k.document.getElementsByTagName("head")[0],u=n.createElement("link"),r=function(){if(typeof y==="function"&&t.state()==="pending"){y()}t.resolve()};x+=(x.indexOf("?")>-1?"&":"?")+"_nch="+giscloud_config.nch;u.setAttribute("rel","stylesheet");u.setAttribute("type","text/css");u.setAttribute("href",x);u.onreadystatechange=function(){if(u.readyState==="complete"||u.readyState==="loaded"){r()}};if(u.addEventListener){u.addEventListener("load",function(){r()},false)}u.onload=function(){r()};v.appendChild(u);return t.promise()},includeJs:function(x,y){var t=new e.Deferred(),u=n.getElementsByTagName("head")[0],v=n.createElement("script"),r=function(){if(typeof y==="function"&&t.state()==="pending"){y()}t.resolve()};x+=(x.indexOf("?")>-1?"&":"?")+"_nch="+giscloud_config.nch;v.setAttribute("type","text/javascript");v.setAttribute("src",x);v.onreadystatechange=function(){if(v.readyState==="complete"||v.readyState==="loaded"){r()}};if(v.addEventListener){v.addEventListener("load",function(){r()},false)}v.onload=function(){r()};u.appendChild(v);return t.promise()},formats:{IFRAME:"iframe",HTML:"iframe",PNG:"png",JPEG:"jpg",SHAPEFILE:"shp",GPX:"gpx",MIF:"mif",GML:"gml",exportFormats:{SHAPEFILE:"shp",GPX:"gpx",MIF:"mif",GML:"gml"},renderFormats:{IFRAME:"iframe",PNG:"png",JPEG:"jpg"}},apiKey:function(r){if(typeof r=="string"){h=r;return this}else{return h}},logDeferredResults:function(u,t,r,B){var v,z=function(){console.log("DONE",arguments)},y=function(){console.log("FAIL",arguments)},x=function(){console.log("PROGRESS",arguments)};try{if(e.isFunction(u.done)&&e.isFunction(u.fail)){if(t!=null&&r==null&&B==null){B=t;t=null}v=u}else{if(r===c){r=k}if(t==null){t=[]}else{if(!e.isArray(t)){t=[t]}}v=u.apply(r,t)}if(e.isFunction(v.done)&&e.isFunction(v.fail)){v.done(z);v.fail(y);v.progress(x);if(B){v.done(function(C){if(typeof B=="string"){k[B]=C}else{B=C}})}}else{console.log("NOT DEFERRED",v)}}catch(A){console.log("ERROR",A,u,t,r)}},common:function(){return m}};f=function(){var r;if(q.state()==="pending"){r=function(){var t=m.restHost()+"/assets/api/1/gcremote.php?restUrl="+m.restHost()+"/1/";g=new easyXDM.Rpc({remote:t,onReady:function(){q.resolve(arguments)}},{remote:{ping:{},execute:{},getJSON:{},rest:{},restGet:{},restPost:{},restPut:{},restDelete:{}},local:{restUrl:function(){return m.rest.url()},pingback:function(u,v,x,y){console.log(JSON.stringify({pingOrigin:v,pingTime:y,pingbackOrigin:u,pingbackTime:x,duration:x-y}))}}})};if(typeof JSON!=="undefined"){r()}else{a.includeJs(m.apiHost()+"/libs/json2/json2.min.js").done(r)}}return q.promise()};a.pingRpc=function(){f().done(function(){g.ping(n.location,e.now())})};a.remoteGetJSON=function(t,v){var u,r;r=new e.Deferred();u=function(){g.getJSON(t,v,r.resolve,r.reject)};if(!!g){u()}else{f().done(u)}return r.promise()};a.sessid=function(){var t=n.cookie,r=t&&t.match&&t.match(/PHPSESSID=([^ ;]+)/);return r&&r[1]||null};a.construct=function(t,r){var u={};if(r){if(e.isArray(r)){e.each(r,function(v,x){e.extend(u,x)})}else{e.extend(u,r)}}u.higher=u;t.prototype=u;return t};m={restHost:function(){return giscloud_config.restHost()},apiHost:function(){return giscloud_config.apiHost()},apiHostname:function(){return giscloud_config.apiHostname()},authHost:function(){return giscloud_config.authHost()},liveSite:function(){return giscloud_config.liveSite()},appSite:function(){return giscloud_config.appSite()},isMobileBrowser:/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4)),clone:function(t){var r=function(){};e.extend(true,r.prototype,t);return new r()},oid:function(){var t=Math.random,v=Math.ceil,u=(e.now().toString()+v(t()*100000)).substr(3),x=v(t()*15);return u.substr(x)+u.substr(0,x)},setError:function(r,u,t){if(r.errors===c){r.errors=[]}r.errors.push({time:new Date(),src:u,msg:t})},highlight:function(t,v,u,r){t.modifyObject(v.toString(),{color:"selectcolor",alpha:100,from_color:13421772,glow:{color:65280,strength:2,blurX:10,blurY:10}},u===null?"":("layer"+u+"||"),r)},highlightMultiple:function(t,v,u,r){t.modifyObject(v.join(),{color:"selectcolor",alpha:100,from_color:13421772,glow:{color:65280,strength:2,blurX:10,blurY:10}},u===null?"":("layer"+u+"||"),r)},getHighlightAndSelectColors:function(r){var t;if(r&&r.length){t=a.Color.fromString(r);return[t.brighter(15).hex(),"#C9FFE5"]}return null},deferreds:{},refs:{},toXml:function(r,y){var v="",x,u,t;if(y===null||y===c||y===""){return"<"+r+"/>"}else{if(typeof y==="object"){v+="<"+r+">";if(e.isArray(y)){if(r[r.length-1]==="s"){t=r.substr(0,r.length-1)}else{t=r}for(x=0,u=y.length;x<u;x++){v+=this.toXml(t,y[x])}}else{for(x in y){if(y.hasOwnProperty(x)){v+=this.toXml(x,y[x])}}}v+="</"+r+">"}else{v+="<"+r+">"+y.toString()+"</"+r+">"}}return v},rest:(function(){var r=function(u){var v=u||{};if(v.sort){if(typeof v.sort==="string"||v.sort.length===c){v.order_by=v.sort}else{v.order_by=v.sort.join()}delete v.sort}if(v.page||v.perPage){v.page=v.page||1;v.perpage=v.perPage||10;delete v.perPage}if(v.field&&v.field.length&&v.value&&v.value.length){v.where=v.field+"='"+v.value+"'";delete v.field;delete v.value}return v},t=function(u){var x=n.location,v=x.protocol+"//"+x.host;if(a.forceLocal){return true}if(u&&x.protocol!=="https:"){return false}return m.liveSite().indexOf(v)===0||m.restHost().indexOf(v)===0};this.url=function(x){var y=n.location,v=y.protocol+"//"+y.host,u=m.liveSite().indexOf(v)===0?m.liveSite()+"rest/1/":m.restHost()+"/1/";if(typeof x==="string"){return u+x}else{return u}};this.local=function(B,y,x,A,u){var z,v;v=this.url(x);z=new e.Deferred();if(u&&v.indexOf("https:")!==0){v=v.replace("http:","https:");if(v.indexOf("?")>-1){v+="&api_sessid="+a.sessid()}}if(B==="get"||B==="GET"){e.ajax({url:v,type:"GET",cache:false,dataType:"json",data:A}).done(function(){var C=Array.prototype.slice.apply(arguments);z.resolve.apply(z,C)}).fail(function(){var C=Array.prototype.slice.apply(arguments);z.reject.apply(z,C)})}else{if(y==="application/json"&&e.isPlainObject(A)){A=JSON.stringify(A)}e.ajax({url:v,type:B,cache:false,dataType:"json",accept:"application/json",contentType:y||"application/x-www-form-urlencoded",data:A}).success(function(D,C,E){z.resolve(D,E.getResponseHeader("Location"))}).error(function(H,C,D){var F,E,G,I;if(H.getResponseHeader("Content-Type")==="application/json"){F=JSON.parse(H.responseText);E=F.code;G=F.msg;I=F.nested}else{if(H.getResponseHeader("Content-Type")==="application/json"){F=e(H.responseText);E=F.find("code").text();G=F.find("msg").text();I=F.find("nested").text()}}z.reject(H.status,C,D,E,G,I)})}return z.promise()};this.call=function(u,E,x,C,z){var y,D,v,A,B;x=r(x);v=a.oauth2.token();if(v){x.oauth_token=v}A=a.apiKey();if(A){x.api_key=A}if(t(z)){return this.local(u,C,E,x,z)}if(!A&&!v&&z){B=a.sessid();if(B){E+=(E.indexOf("?")===-1?"?":"&")+"api_sessid="+B}}D=new e.Deferred();y=function(){g.rest(u,C,E,x,v,A,function(F){D.resolve.apply(D,F)},function(){D.reject.apply(D,arguments&&arguments[0]&&arguments[0].message)})};if(!!g){y()}else{f().done(y)}return D.promise()};this.get=function(y,z){var x,u,v;z=r(z);v=a.oauth2.token();if(v){z.oauth_token=v}h=a.apiKey();if(h){z.api_key=h}if(t()){return this.local("GET",null,y,z)}u=new e.Deferred();x=function(){g.restGet(y,z,u.resolve,u.reject)};if(!!g){x()}else{f().done(x)}return u.promise()};return this}.apply({}))};if(e.fn.busy){e().busy("defaults",{img:m.apiHost()+"/assets/api/1/images/busy.gif"})}a.Promise=function(r){r=r||new e.Deferred();return r.promise()};a.xssSafe=function(r){return e("<div/>",{text:r}).html()};k.giscloud=a;k.out=function(){console.log(arguments)}})(jQuery.noConflict(true),window,window.document);fnCanvas2=function(m){var k=giscloud.exposeJQuery(),x=[],z=0,e={handlers:[]},C;function y(E){return typeof E=="string"&&parseInt(E.replace(/s(\d+)/,"$1"),10)}function g(E){return"s"+E}function n(E){if(E!=null){return giscloud.Color.fromHex(E).hex()}return null}function t(E){this.id=E;this.attributes={};this.removed=false;this.clear=function(){this.removed=true};this.wkt=function(){return C.currentShapeGeometry(true)};this.edit=function(){}}function D(){var E=x.length;x.push(new t(g(E)));z++;return E}function c(G){var F=x[G],E;if(F instanceof t){x.splice(G,1);z--}E=F.attributes;return E}function o(F){var E,G;G=F.geometries||F.polygons||F.rings||F.lines||F.points||null;if(G===null){G=m.toLeafletCoords(F.x,F.y,F.z);F.x=G.lng;F.y=G.lat}else{for(E in G){if(G.hasOwnProperty(E)){o(G[E])}}}}function f(G){var F,H,E;H=G.geometries||G.polygons||G.rings||G.lines||G.points||null;if(H===null){return m.toLeafletCoords(G.x,G.y,G.z)}E=[];for(F in H){if(H.hasOwnProperty(F)){E.push(f(H[F]))}}return E}function u(F,G){var E=f(F);if(F instanceof giscloud.geometry.Multipolygon){return new L.MultiPolygon(E,G)}else{if(F instanceof giscloud.geometry.Polygon){return new L.Polygon(E,G)}else{if(F instanceof giscloud.geometry.Multiline){return new L.MultiPolyline(E,G)}else{if(F instanceof giscloud.geometry.Line){return new L.Polyline(E,G)}else{G=G||{};G.icon=G.icon||(new L.Handler.PolyEdit()).options.icon;G.draggable=G.draggable||false;if(F instanceof giscloud.geometry.Multipoint){return new L.FeatureGroup(k.map(E,function(H){return new L.Marker(H,G)}),G)}else{if(F instanceof giscloud.geometry.Point){return new L.Marker(E,G)}else{return null}}}}}}}function A(F,G){var E,H;if(k.isArray(F)){return k.map(F,function(I){return[A(I,G)]})}else{if(F instanceof L.LatLng){H=m.fromLeafletCoords(F);if(G){H.z=H.z||0}return H}else{if(F instanceof L.Marker){return m.fromLeafletCoords(F.getLatLng())}else{if(F instanceof L.Polygon){E=F.getLatLngs();if(k.isArray(E[0])){return new giscloud.geometry.Polygon(k.map(E,function(I){return new giscloud.geometry.Line(k.map(I,function(J){return A(J,G)}))}))}return new giscloud.geometry.Polygon([new giscloud.geometry.Line(k.map(E,function(I){return A(I,G)}))])}else{if(F instanceof L.MultiPolygon){return new giscloud.geometry.Multipolygon(k.map(F._layers,function(I){return A(I,G)}))}else{if(F instanceof L.Polyline){return new giscloud.geometry.Line(k.map(F.getLatLngs(),function(I){return A(I,G)}))}else{if(F instanceof L.MultiPolyline){return new giscloud.geometry.Multiline(k.map(F._layers,function(I){return A(I,G)}))}else{if(F instanceof L.FeatureGroup){return new giscloud.geometry.GeometryCollection(k.map(F._layers,A))}else{return null}}}}}}}}}function r(G,E){var F=E&&E.points&&E.points.length;if(G!=null&&F){G.points=k.map(E.points,function(H){return m.toLeafletCoords(H.x,H.y,H.z)});G.draw()}}function h(G,F,H){var E,I;if(F.length){switch(G){case"point":I=m.fromLeafletCoords(F[0]);E=new giscloud.geometry.Point(I.x,I.y);break;case"line":I=k.map(F,function(K){var J=m.fromLeafletCoords(K);return new giscloud.geometry.Point(J.x,J.y)});E=new giscloud.geometry.Line(I);break;case"polygon":I=k.map(F,function(K){var J=m.fromLeafletCoords(K);return new giscloud.geometry.Point(J.x,J.y)});E=new giscloud.geometry.Polygon([new giscloud.geometry.Line(I)]);break}}if(!E){return null}return H?E.toOGC():E}function a(F,E){this.id=F;this.color=n(E.color)||"#ff0088";this.alpha=(E.alpha!=null)?E.alpha:1;this.width=(E.width!=null)?E.width:10;this.cursor=null;this.marker=null;if(this.alpha>1){this.alpha=this.alpha/100}}a.prototype={draw:function(){this.marker=new L.Marker(this.cursor,{icon:(new L.Handler.PolyEdit()).options.icon,draggable:false});this.marker.on("dragend",k.proxy(function(){this.cursor=this.marker.getLatLng()},this));m.exposeLeaflet().addLayer(this.marker)},clear:function(){m.exposeLeaflet().removeLayer(this.marker);this.marker=null;this.cursor=null},edit:function(E){if(E===false){this.marker.dragging.disable()}else{this.marker.dragging.enable()}},geom:function(){var F=this.cursor,E;if(F){E=A(F,this.hasZ);return E}return null},wkt:function(){var F=this.cursor,E;if(F){E=A(F,this.hasZ);return E?E.toOGC():""}return null},redraw:function(){var E=this.cursor;this.clear();this.cursor=E;this.draw()}};function q(F,E){this.id=F;this.color=n(E.color)||"#ff0088";this.alpha=(E.alpha!=null)?E.alpha:1;this.width=(E.width!=null)?E.width:1;this.cursor=null;this.lines=[];this.points=[];if(this.alpha>1){this.alpha=this.alpha/100}}q.prototype={currentLine:function(){return this.lines[this.lines.length-1]},draw:function(){var E=new L.Polyline(this.points,{color:this.color,opacity:this.alpha,width:this.width});this.lines.push(E);m.exposeLeaflet().addLayer(E)},addLine:function(){var E=new L.Polyline([this.cursor],{color:this.color,opacity:this.alpha,width:this.width});this.lines.push(E);m.exposeLeaflet().addLayer(E)},extendLine:function(){var E=this.currentLine();if(E){E.addLatLng(this.cursor)}},edit:function(E){var F=this.currentLine();if(F){if(E===false){F.editing.disable()}else{F.editing.enable()}}},geom:function(){var E=this.currentLine(),F;if(E){F=A(E,this.hasZ);return F}return null},wkt:function(){var E=this.currentLine(),F;if(E){F=A(E,this.hasZ);return F?F.toOGC():""}return null},redraw:function(){var E=this.currentLine(),F=new L.Polyline(E.getLatLngs(),{color:this.color,opacity:this.alpha,width:this.width});this.clear();this.lines.push(F);m.exposeLeaflet().addLayer(F)},clear:function(){var F,E;for(F=0,E=this.lines.length;F<E;F++){m.exposeLeaflet().removeLayer(this.lines[F]);this.lines[F]=null}this.lines=[];this.cursor=null}};function v(F,E){this.id=F;this.color=n(E.color)||"#ff0088";this.alpha=(E.alpha!=null)?E.alpha:1;this.width=(E.width!=null)?E.width:1;this.ring=null;this.polygon=null;if(this.alpha>1){this.alpha=this.alpha/100}}v.prototype={draw:function(){this.polygon=new L.Polygon(this.ring,{color:this.color,opacity:this.alpha,width:this.width});m.exposeLeaflet().addLayer(this.polygon)},clear:function(){m.exposeLeaflet().removeLayer(this.polygon);this.polygon=null;this.ring=null},edit:function(E){if(this.polygon){if(E===false){this.polygon.editing.disable()}else{this.polygon.editing.enable()}}},geom:function(){var E=this.ring,F;if(E){F=A(this.polygon,this.hasZ);return F}return null},wkt:function(){var E=this.ring,F;if(E){F=A(this.polygon,this.hasZ);return F?F.toOGC():""}return null},redraw:function(){var E=this.ring;this.clear();this.ring=E;this.draw()}};function B(F,E){this.id=F;this.color=n(E.color)||"#ff0088";this.alpha=(E.alpha!=null)?E.alpha:1;this.width=(E.width!=null)?E.width:1;this.shapes=null;this.featureGroup=null;this.type="multi";if(this.alpha>1){this.alpha=this.alpha/100}}B.prototype={draw:function(){this.featureGroup=new L.FeatureGroup(this.shapes,{color:this.color,opacity:this.alpha,width:this.width});m.exposeLeaflet().addLayer(this.featureGroup)},clear:function(){m.exposeLeaflet().removeLayer(this.featureGroup);this.shapes=null;this.featureGroup=null},edit:function(F){var E;if(this.shapes){if(F===false){E=function(H,G){if(G.editing){G.editing.disable()}else{if(G.dragging){G.dragging.disable()}else{if(G._layers){k.each(G._layers,E)}}}}}else{E=function(H,G){if(G.editing){G.editing.enable()}else{if(G.dragging){G.dragging.enable()}else{if(G._layers){k.each(G._layers,E)}}}}}k.each(this.shapes,E)}},redraw:function(){var E=this.shapes;this.clear();this.shapes=E;this.draw()},geom:function(){var E=A(this.shapes,this.hasZ);if(!E){return null}else{if(E instanceof giscloud.geometry.Multipoint||E instanceof giscloud.geometry.Multiline||E instanceof giscloud.geometry.Multipolygon){return E}else{if(E.length===1&&E[0] instanceof giscloud.geometry.Multipoint||E[0] instanceof giscloud.geometry.Multiline||E[0] instanceof giscloud.geometry.Multipolygon){return E[0]}}}switch(this.type){case"point":return new giscloud.geometry.Multipoint(E);case"line":return new giscloud.geometry.Multiline(E);case"polygon":return new giscloud.geometry.Multipolygon(E);default:return new giscloud.geometry.GeometryCollection(E)}},wkt:function(){var E=A(this.shapes,this.hasZ);if(!E){return null}else{if(E instanceof giscloud.geometry.Multipoint||E instanceof giscloud.geometry.Multiline||E instanceof giscloud.geometry.Multipolygon){return E.toOGC()}else{if(E.length===1&&E[0] instanceof giscloud.geometry.Multipoint||E[0] instanceof giscloud.geometry.Multiline||E[0] instanceof giscloud.geometry.Multipolygon){return E[0].toOGC()}}}switch(this.type){case"point":return new giscloud.geometry.Multipoint(E).toOGC();case"line":return new giscloud.geometry.Multiline(E).toOGC();case"polygon":return new giscloud.geometry.Multipolygon(E).toOGC();default:return new giscloud.geometry.GeometryCollection(E).toOGC()}}};C=(function(J){var O,I,E,K=(new L.Handler.PolyEdit()).options.icon,Q=[],H=[],R=false;function M(U){var T=new L.Marker(U,{icon:K});J.addLayer(T);H.push(T)}function P(){if(R==="line"){H[H.length-1].off("click",P)}else{if(R==="polygon"){H[0].off("click",P)}}C.end()}function F(U){var T=H.length;Q.push(U.latlng);M(U.latlng);if(R==="point"){C.end();return}else{if(R==="line"){if(T>0){H[T-1].off("click",P)}H[T].on("click",P);if(Q.length>=2){if(O){J.removeLayer(O)}O=new L.Polyline(Q);J.addLayer(O)}if(I){J.removeLayer(I);I=null}}else{if(R==="polygon"){if(T===0){H[0].on("click",P)}if(Q.length>=3){if(O){J.removeLayer(O)}O=new L.Polygon(Q,{stroke:false});J.addLayer(O)}if(I){I.setLatLngs(Q.concat([U.latlng]))}}}}}function N(T){var U=Q.length-1;if(U<0||R==="point"){return}if(R==="line"){if(!I){I=new L.Polyline([Q[U],T.latlng],{color:"black",weight:2,dashArray:"7, 9"});J.addLayer(I)}else{I.spliceLatLngs(1,1,T.latlng)}}else{if(R==="polygon"){if(!I){I=new L.Polyline([Q[U],T.latlng],{color:"black",weight:2,dashArray:"7, 9"});J.addLayer(I)}else{I.spliceLatLngs(U+1,1,T.latlng)}}else{return}}}function S(T){if(T.which===27){C.cancel()}else{if(T.which===13){C.end()}else{return true}}T.preventDefault();T.stopPropagation()}function G(){if(O){J.removeLayer(O)}if(I){J.removeLayer(I);I=null}k.map(H,function(T){J.removeLayer(T);T=null});H=[];Q=[];k(document).off("keyup",S);J.off("click",F)}return{currentShapeGeometry:function(T){if(R){return h(R,Q,T)}return null},start:function(T){J.doubleClickZoom.disable();R=T;J.on("click",F);J.on("mousemove",N);k(document).keyup(S);E=new k.Deferred();return E.promise()},end:function(T){if(E){E.resolve(Q,T);G()}return E.promise()},cancel:function(T){if(E){E.reject(T);G()}return E.promise()}}}(m.exposeLeaflet()));this.fn=m;this.viewer=m.exposeLeaflet();this.add=function(F){var E=D(),G=g(E);C.start(F).done(k.proxy(function(I,H){var J=h(F,I,true);if(J){this.deserializeGeometryOpenGISSimple({geom:J},G);if(!H){k(e).triggerHandler("add.fnCanvas2",[{id:G,geom:J,gtype:F}])}}else{if(x[E] instanceof t){c(E)}}},this)).fail(function(H){c(E);if(!H){k(e).triggerHandler("add.fnCanvas2",[{id:null,geom:null,gtype:F}])}});return G};this.endDraw=function(E){if(E&&E.cancel){C.cancel()}else{if(E&&E.noEvent){C.end(true)}else{C.end()}}};this.addEventListener=function(E,F){var G=function(){var H=Array.prototype.slice.call(arguments,1);return F.apply(this,H)};k(e).on(E+".fnCanvas2",G);e.handlers.push({original:F,wrapped:G})};this.removeEventListener=function(E,G){var H,F;k.each(e.handlers,function(I,J){if(J.original===G){F=I;H=J.wrapped}});if(F==null||e.handlers[F]==null){return}k(e).off(E+".fnCanvas2",H);delete e.handlers[F].wrapped;e.handlers.splice(F,1)};this.setAttributeGeometry=function(I,G,H,F){var E=x[y(I)];if(E){if(E instanceof t){E.attributes[G]=H}else{E[G]=H;if(!F){E.redraw()}}}return I};this.getAttributeGeometry=function(G,F){var E=x[y(G)];if(!E){return null}return E[F]};this.getGeometry=function(F){var E=x[y(F)];if(!E){return null}return E.geom()};this.newShape=function(G,J){var I,H,F,E;if(J!=null){H=y(J);F=x[H];if(F instanceof t){E={};k.extend(E,F.attributes,G);I=J;x[H]=new q(J,E);if(F.removed){this.remove(J)}}else{throw"Invalid ID for a reserved shape slot."}}else{I=g(z);x.push(new q(J,G));z++}return I};this.newLineShape=this.newShape;this.newPointShape=function(G,J){var I,H,F,E;if(J!=null){H=y(J);F=x[H];if(F instanceof t){E={};k.extend(E,F.attributes,G);I=J;x[H]=new a(J,G);if(F.removed){this.remove(J)}}else{throw"Invalid ID for a reserved shape slot."}}else{I=g(z);x.push(new a(J,G));z++}return I};this.newPolygonShape=function(G,J){var I,H,F,E;if(J!=null){H=y(J);F=x[H];if(F instanceof t){E={};k.extend(E,F.attributes,G);I=J;x[H]=new v(J,G);if(F.removed){this.remove(J)}}else{throw"Invalid ID for a reserved shape slot."}}else{I=g(z);x.push(new v(J,G));z++}return I};this.newMultiShape=function(G,J){var I,H,F,E;if(J!=null){H=y(J);F=x[H];if(F instanceof t){E={};k.extend(E,F.attributes,G);I=J;x[H]=new B(J,G);if(F.removed){this.remove(J)}}else{throw"Invalid ID for a reserved shape slot."}}else{I=g(z);x.push(new B(J,G));z++}return I};this.moveTo=function(I,E,H,G){var F=x[y(I)];if(F){G=(G!=null)?G:(F.hasZ?0:null);F.cursor=this.fn.toLeafletCoords(E,H,G);F.addLine();return I}};this.lineTo=function(I,E,H,G){var F=x[y(I)];if(F){G=(G!=null)?G:(F.hasZ?0:null);F.cursor=this.fn.toLeafletCoords(E,H,G);F.extendLine();return I}};this.remove=function(G){var F=y(G),E=x[F];if(E){E.clear();x[F]=null;return G}};this.removeAll=function(){var F,E;for(F=0,E=x.length;F<E;F++){this.remove(g(F))}};this.clear=this.removeAll;this.editGeometry=function(F){var E=x[y(F)];if(E){E.edit();return F}return null};this.editGeometryEnd=function(F){var E=x[y(F)];if(E){E.edit(false);return F}return null};this.redrawGeometry=function(F){var E=x[y(F)];if(E){E.redraw()}};this.serializeGeometryOpenGIS=function(F){var E=x[y(F)];if(E){return E.wkt()}return null};this.deserializeGeometryOpenGISSimple=function(F,J){var H=F&&F.geom,G=giscloud.geometry.fromOGC(H),E,I;if(G instanceof giscloud.geometry.Point){I=this.newPointShape(F,J);E=x[y(I)];E.cursor=this.fn.toLeafletCoords(G.x,G.y,G.z);E.hasZ=G.hasZ();E.draw()}else{if(G instanceof giscloud.geometry.Line){I=this.newLineShape(F,J);E=x[y(I)];E.hasZ=G.hasZ();r(E,G)}else{if(G instanceof giscloud.geometry.Multiline){I=this.newMultiShape(F,J);E=x[y(I)];E.shapes=[u(G)];E.type="line";E.hasZ=G.hasZ();E.draw()}else{if(G instanceof giscloud.geometry.Polygon){I=this.newPolygonShape(F,J);E=x[y(I)];E.ring=k.map(G.rings[0].points,function(K){return m.toLeafletCoords(K.x,K.y,K.z)});E.hasZ=G.hasZ();E.draw()}else{if(G instanceof giscloud.geometry.Multipolygon){I=this.newMultiShape(F,J);E=x[y(I)];E.shapes=[u(G)];E.type="polygon";E.hasZ=G.hasZ();E.draw()}else{if(G instanceof giscloud.geometry.GeometryCollection){I=this.newMultiShape(F,J);E=x[y(I)];E.shapes=k.map(G.geometries,u);E.hasZ=G.hasZ();E.draw()}else{throw"Cannot deserialize from OGC, unknown giscloud geometry type."}}}}}}return I};this.deserializeGeometryOpenGIS=this.deserializeGeometryOpenGISSimple};fnMarker2=function(m){var e=giscloud.exposeJQuery(),q={},o={},a={},r=[],k=0;this.fn=m;this.viewer=m.exposeLeaflet();this.markers=[];function n(u,t,v){var x=giscloud.md5(u);if(!q[x]){q[x]={loading:new e.Deferred(),Icon:null};if(t!=null&&v!=null){q[x].Icon=L.Icon.Label.extend({options:{iconUrl:u,shadowUrl:null,iconSize:new L.Point(t,v),iconAnchor:new L.Point(t/2,v/2),labelAnchor:new L.Point(Math.max(t,v)*1.5+5,0),wrapperAnchor:new L.Point(t,v)}});q[x].loading.resolve(q[x])}else{e.loadImage(u).done(function(z){var y=z.width,A=z.height;q[x].Icon=L.Icon.Label.extend({options:{iconUrl:u,shadowUrl:null,iconSize:new L.Point(y,A),iconAnchor:new L.Point(y/2,A/2),labelAnchor:new L.Point(Math.max(y,A)*1.5+5,0),wrapperAnchor:new L.Point(y,A)}});q[x].loading.resolve(q[x])})}}return q[x]}function g(v,t,u){if(t&&e.isFunction(t.on)&&u&&u.name&&e.isFunction(u.handler)){if(u.name==="poi_click"){t.on("click",e.proxy(function(){u.handler.call(this,{id:v,data:a[v],type:"poi_click"})}))}else{t.on(u.name,e.proxy(function(){var y=[{id:v,data:a[v],type:u.name}],x=Array.prototype.slice.call(arguments);u.handler.apply(this,y.concat(x))}))}}}function c(t){return typeof t=="string"&&parseInt(t.replace(/m(\d+)/,"$1"),10)}function h(x){var A=x.title,z=x.content,t=x.color,v=x.open,u=new giscloud.Color.fromHex(t),y="";if(A!=null){y+='<p class="gc-info-popup-title" style="background-color: '+t+"; color: "+((u.hsl()[2]>85)?"black":"white")+';">'+A+"</p>"}if(v&&z!=null){y+='<div class="gc-info-popup-content">'+z+"</div>"}return y}function f(t){}this.add=function(K,H,B,J,G,I,E){var z,u,D,v,C,A,t,F=this;if(K.x&&K.y){I=K.icon;J=K.title;G=K.content;B=K.color;E=K.open;H=K.y;K=K.x}E=!!E;if(B==null){B="#0097C6"}else{if(B instanceof giscloud.Color){B=B.hex()}else{B=giscloud.Color.fromHex(B).hex()}}z=this.fn.toLeafletCoords(K,H);u=new L.Popup({className:"gc-info-popup",minWidth:180,closeButton:true});u._fnMarker={x:K,y:H,color:B,title:J,content:G,icon:I,open:E};D=h(u._fnMarker);u.setLatLng(z);u.setContent(D);v="m"+k;k++;A=r.length;if(A){for(C=0;C<A;C++){t=r[C];if(t){g.call(this,v,u,t)}}}this.markers.push(u);this.viewer.addLayer(u);o[v]=new e.Deferred();o[v].resolve(u);e(u._container).on("mouseup mousedown mousemove mouseover",".leaflet-popup-close-button",function(x){x.stopPropagation()});e(u._wrapper).mousemove(function(x){x.stopPropagation()}).on("click",".gc-info-popup-title",function(){F.toggle(v)}).on("click",".gc-info-edit-link",function(){var y=e(this).parent(),x=y.find("[name=edit-layer-id]").val(),M=y.find("[name=edit-feature-id]").val();u.fire("gc-info-popup-edit-click",{layerId:x,featureId:M})});return v};this.setTitle=function(x,y){var v=c(x),t=this.markers[v],u;if(t){t._fnMarker.title=y;u=h(t._fnMarker);t.setContent(u)}return this};this.setContent=function(y,x){var v=c(y),t=this.markers[v],u;if(t){t._fnMarker.content=x;u=h(t._fnMarker);t.setContent(u)}return this};this.toggle=function(x){var v=c(x),t=this.markers[v],u;if(t){t._fnMarker.open=!t._fnMarker.open;u=h(t._fnMarker);t.setContent(u);e(this).triggerHandler("fnMarker.OpenClose",[x,t._fnMarker.open])}return this};this.remove=function(v){var u=c(v),t=this.markers[u];if(t){if(t._popupCloseHandler){e(this.viewer).off("popupClose.fnMarker",this._popupCloseHandler)}if(t._popupOpenHandler){e(this.viewer).off("popupOpen.fnMarker",this._popupOpenHandler)}this.viewer.removeLayer(t);this.markers[u]=null;delete o[v]}};this.removeAll=function(){e.each(this.markers,e.proxy(function(u,t){if(t instanceof L.Marker){this.removePoi("m"+u)}else{if(t instanceof L.Popup){this.remove("m"+u)}}},this))};this.closeAll=function(){e.each(this.markers,e.proxy(function(u,t){if(t instanceof L.Popup){this.remove("m"+u)}},this))};this.clear=this.closeAll;this.loadPoi=function(G,E,t,z,D,C,F){var u,B,v,A;B=this;u=new e.Deferred();v="m"+k;o[v]=new e.Deferred();a[v]=z;k++;A=n(t,C,F);A.loading.done(function(H){var K,x,I,y,J;K=B.fn.toLeafletCoords(G,E);if(z.hoverText){x=new L.Marker(K,{icon:new H.Icon(),title:z.hoverText})}else{x=new L.Marker(K,{icon:new H.Icon()})}if(z.popupContent){x.bindPopup(z.popupContent,{className:"gc-info-popup",autoPan:false});x._popupCloseHandler=function(M){if(M.popup===x._popup){e(B).triggerHandler("popupClose.fnMarker",[v])}};x._popupOpenHandler=function(M){if(M.popup===x._popup){e(B).triggerHandler("popupOpen.fnMarker",[v])}};B.viewer.on("popupclose",x._popupCloseHandler);B.viewer.on("popupopen",x._popupOpenHandler)}y=r.length;if(y){for(I=0;I<y;I++){J=r[I];if(J){g.call(B,v,x,J)}}}B.markers.push(x);B.viewer.addLayer(x);if(z.popupContent&&z.popupVisible){x.openPopup()}o[v].resolve(x)});return v};this.removePoi=function(v){var u,t;t=o[v];if(!t){console.log("Ready missing: ",v,o)}u=this;u.remove(v);delete a[v]};this.move=function(A,t,B,u){var z,v;v=o[A];if(v){z=this;v.done(function(x){var y;if(x&&x.setLatLng){y=z.fn.toLeafletCoords(t,B);x.setLatLng(y);if(x.setRotation){x.setRotation(u)}}})}};this.move2=this.move;this.attachLabel=function(u){var t=o[u.marker];if(t){t.done(function(v){if(v.setLabelText){v.setLabelText(u.data)}else{if(v.options.icon&&v.options.icon.setLabelText){v.options.icon.setLabelText(u.data)}else{e(v._icon).find(".leaflet-marker-iconlabel").html(u.data)}}})}};this.addEventListener=function(v,y){var x,u,t,z={name:v,handler:y};for(x=0,u=this.markers.length;x<u;x++){t=this.markers[x];if(t){g.call(this,"m"+x,t,z)}}r.push(z)}};fnTooltip2=function(r){var g=giscloud.exposeJQuery(),o=false,t=new L.DivIcon({className:"gc-map-tip"}),m=r.exposeLeaflet(),f={},y,h=new L.Marker(new L.LatLng(0,0),{icon:t,clickable:false});function v(){y=g("#simpleTooltip").length>0?g("#simpleTooltip"):g("<div/>").attr("id","simpleTooltip").appendTo(g("body"));r.addEventListener("load",q);r.addEventListener("reload",u);r.addEventListener("object_over",x);r.addEventListener("object_out",n);g(document).mousemove(function(z){y.offset({left:z.pageX+15,top:z.pageY-5})})}function x(B){var A=B.id.split("||"),G=A[0].substr(5);var z=f[G],C=B.object.attributes;if(!z||!C){return k()}var D=z.split(","),F="";for(var E=0;E<D.length;E++){F+=C[D[E]];if((E+1)<D.length){F+="<br/> "}}y.html(F).show()}function n(z){k()}function k(){y.hide()}function q(){var B,z,A,C,D;for(B=0,z=r.getLayerCount();B<z;B++){A=r.getLayer(B);D=A.id.substr(5)*1;if(A&&A.options&&A.options.tooltip){f[D]=A.options.tooltip;if(window.gcdatagrid){gcdatagrid.addField(D,A.options.tooltip)}}}}function u(){q()}function e(z){if(h&&h._icon){h._icon.innerHTML=z}}function a(z){if(!o){m.addLayer(h);o=true}e(z)}function c(z){if(h){h.setLatLng(z.latlng)}}this.show=function(z){m.on("mousemove",c);a(z)};this.hide=function(){k()};v()};fnAgent2=function(a){this.setData=function(c){};this.setZoom=function(c){}};(function(r,g,v,m){var h,f,q,o,k,u,z,e,y,x,A;var c;c=0;f=0;A=false;x=1;var n="http:///";if(v){n=v.appSite()}var C=n;function B(){if(f){return}q=r.L||giscloud.exposeLeaflet();f=1;fnLayerBasic={getId:function(){return this.id},disable:function(){this.visible=false;this.setVisible(false)},enable:function(){this.visible=true;this.setVisible(true)},getAlpha:function(){return Math.round(this.options.opacity*100)},setAlpha:function(K){if(flashnavigator.hasCanvas){this.setOpacity(K/100)}},getCurrentLevel:function(){return h.map._zoom},setSelectable:function(K){this._selectable=K;return 0},getSelectable:function(){return this._selectable},getVisibility:function(){return this.visible},getBound:function(K){return{xMin:this.source.xmin,xMax:this.source.xmax,yMin:this.source.ymin,yMax:this.source.ymax}},getData:function(K){return this.source},_loadTile:function(M,K){M._layer=this;M.onload=this._tileOnLoad;M.onerror=this._tileOnError;this._processTile(M,K,this._getZoomForUrl())},_processTile:function(M,K){M.src=this.getTileUrl(K)},redraw:function(){if(this.gcmap){this.gcmap.redraw()}},getRules:function(){return this.features},setRule:function(K,M){this.features[K]=M},resetRules:function(){this.features=[];for(var M=0;M<this.features_original.length;M++){var N={};for(var K in this.features_original[M]){N[K]=this.features_original[M][K]}this.features[M]=N}},setDynamicMode:function(K){if(this.gcmap){this.gcmap.url=this.gcmap.url_prefix+"/dyn,"+K+"/"}},setStyleOverride:function(K){if(this.gcmap){this.gcmap.overrideFunc=K}},reload:function(){if(this.gcmap){this.gcmap.reload()}},setVisible:function(K){if(this._container){this._container.style.display=K?"block":"none"}this._updateLayerCount(K);this.options.visible=K;if(this instanceof q.TileLayer){if(this.isTileLayer){this.viewer._layersForUpdateCount=1}this._update()}return this},getVisible:function(K){return this.options.visible},_updateLayerCount:function(K){if(this.options.visible!=K&&h.map.options.zoomAnimation&&q.TileLayer&&(this instanceof q.TileLayer)){if(K){h.map._tileLayersNum++}else{h.map._tileLayersNum--}}}};fnLayer2=q.TileLayer.extend(fnLayerBasic);fnLayer2.prototype.options.visible=true;fnLayer2.prototype._tileShouldBeLoadedOriginal=fnLayer2.prototype._tileShouldBeLoaded;fnLayer2.prototype._tileShouldBeLoaded=function(N,P){var M=P||this;if(!M.options.visible||(!P&&!this._tileShouldBeLoadedOriginal(N))){return false}var O=this._getZoomForUrl();var K=(1<<O);M.nxmin=(M.source.xmin-o.xmin)/o.max*K;M.tnxmin=Math.floor(M.nxmin);M.nxmax=(M.source.xmax-o.xmin)/o.max*K;M.tnxmax=Math.floor(M.nxmax);M.nymin=(o.ymax-M.source.ymax)/o.max*K;M.tnymin=Math.floor(M.nymin);M.nymax=(o.ymax-M.source.ymin)/o.max*K;M.tnymax=Math.floor(M.nymax);if(N.x>=M.tnxmin&&N.x<=M.tnxmax&&N.y>=M.tnymin&&N.y<=M.tnymax){return true}return false};fnLayer2.prototype._updateOriginalTileLayer=fnLayer2.prototype._update;fnLayer2.prototype._update=function(){this._updateOriginalTileLayer();if(this._tilesToLoad===0){this.fire("load")}};var H=0;fnTileLayerGroup=function(K){this.options=K;this.id=K.id;this.visible=K.visible;this.id=K.id;this.source=K.source;this.isGroupLayer=true;var M=K.group||"g0";this.groupId=M;this.groupIdIndex=0;fnTileLayerGroup.theTileLayer=fnTileLayerGroup.theTileLayer||{};this.setUniqueId=function(){this.uniqueId=H++};this.newTileLayer=function(){var P;var O=this.options;P=fnTileLayerGroup.theTileLayer[this.groupId]=this.tileLayer=new fnTileLayer(O);P.source={};P.options.visible=true;P.visible=true;P.options.opacity=1;P.id=P.options.id=this.groupId;P.isTileLayer=true;this.isRootLayer=true;P.gcmap.tileLayer=P;P.gcmap.processTiles=function(T,ab,aa,ac,X,R){var ad=ab.tiles[ac],ae;if(!ad){return 0}var S=ad.obj.tileLayer;var V,Q,Z,W=R?[aa]:aa,U=[],Y=ab.layers[ac].split(",");for(Z=0;Z<Y.length;Z++){U[Y[Z]]=W[X+Z]}Q=ad._drawn;ad._drawn=false;var X=0;for(Z=0;Z<S.group.length;Z++){V=U[S.group[Z].id];if(V&&V.tile){if(V.tile.type=="text"){X=100}else{if(V.tile.type=="point"){X=100}}}}for(Z=0;Z<S.group.length;Z++){V=U[S.group[Z].id];if(V){ad.layer=S.group[Z].id;ad.curLayerObj=S.group[Z];T(ad,V,S.group[Z],Q,X);ad._drawn=false}}ad._drawn=true;if(Q){S.gcmap.activeLayer=null;S.gcmap.redrawSingleTile(ad)}return Y.length};P.group=[];return P};this.cleanUpOnRemove=function(Q,R){if(!R){this.disable()}var P=[];for(var O=0;O<this.tileLayer.group.length;O++){if(this.tileLayer.group[O]!=this){P.push(this.tileLayer.group[O])}}this.tileLayer.group=P;this.tileLayer._resetGroup();if(P.length==0){delete fnTileLayerGroup.theTileLayer[this.tileLayer.id];this.tileLayer._map.removeLayer(this.tileLayer);return 1}return 0};this.setSelectable=function(O){this._selectable=O;return 0};this.getSelectable=function(O){return this._selectable};this.disable=function(){if(this.visible){this.visible=false;this.options.visible=false;this.tileLayer._resetGroup();this.redraw()}};this.enable=function(){if(!this.visible){this.visible=true;this.options.visible=true;this.setUniqueId();this.tileLayer.gcmap.activeLayer=null;this.tileLayer._partialGroup=[this];this.tileLayer._reloadGroupPartialy();giscloud.Html5SendRequests()}};this.getAlpha=function(O){return Math.round(this.options.opacity*100)};this.setAlpha=function(O){if(O/100==this.options.opacity){return}this.options.opacity=O/100;this.redraw()};this.redraw=function(){this.tileLayer.gcmap.activeLayer=this;this.tileLayer.redraw()};this.setZIndex=function(O){if(this.tileLayer._zIndexOffset==null){this.tileLayer.setZIndex(O);this.tileLayer._zIndexOffset=O-this.tileLayer.group.length}var P=O-1-this.tileLayer._zIndexOffset;this.tileLayer._shouldRedrawDueSort=this.tileLayer.group[P]!=this;this.tileLayer.group[P]=this};var N=fnTileLayerGroup.theTileLayer[M];if(!N){N=this.newTileLayer()}else{N._partialGroup=N._partialGroup||[];N._partialGroup.push(this);this.tileLayer=N}N.group.push(this);N._resetGroup();this.setUniqueId()};for(var E in fnLayerBasic){fnTileLayerGroup.prototype[E]=fnLayerBasic[E]}fnTileLayer=fnLayer2.extend({initialize:function(K){this.visible=K.visible;this.id=K.id;this.source=K.source;this.gcmap=new giscloud.Html5Map(K,this);this.gcmap.setBounds(o);this.gcmap.selectablePoly(0);this.gcmap.feature_filter=null;var M=this;this.gcmap.getCanvases=function(){return M._tiles};this.on("stoploadingtiles",function(){M.gcmap.resetLoader()});this.on("tileunload",function(N){N.tile.data=null;N.tile.lista=null;N.tile.styles=null;N.tile.fields=null});K.noWrap=true;q.Util.setOptions(this,K)},_createTileProto:function(){if(flashnavigator.hasCanvas){this._canvasProto=q.DomUtil.create("canvas","leaflet-tile leaflet-tile-loaded")}else{this._canvasProto=q.DomUtil.create("div","leaflet-tile leaflet-tile-loaded")}var K=this.options.tileSize;this._canvasProto.width=K;this._canvasProto.height=K},_createTile:function(){return this._canvasProto.cloneNode(false)},_processTile:function(N,K,M){N._layer=this;N.ontileload=function(){this._layer._tileOnLoad.call(this);if(this._layer._oldContainer){G(this)}this.ontileload=null};if(this.visible){this.gcmap.loadTile(N,K,M)}},redraw:function(){this.gcmap.redraw()},setFeatureFilter:function(K){this.gcmap.feature_filter=K},getFeature:function(K){return this.gcmap.getFeature(K)},_resetGroup:function(){if(!this.group){return}var S=this.group;var T=[];var Q=[];if(S.length>0){var M=S[0].source.xmin;var R=S[0].source.ymin;var P=S[0].source.xmax;var N=S[0].source.ymax;for(var O=0;O<S.length;O++){var K=S[O].source;if(K.xmin==K.xmax==K.ymin==K.ymax==0){continue}M=(K.xmin<M)?K.xmin:M;R=(K.ymin<R)?K.ymin:R;P=(K.xmax>P)?K.xmax:P;N=(K.ymax>N)?K.ymax:N;if(S[O].visible){T.push(S[O].options.modified);Q.push(S[O].options.id)}}this.source.xmin=M;this.source.ymin=R;this.source.xmax=P;this.source.ymax=N}this.gcmap.modified=T.join(",");this.gcmap.lid=Q.join(",");this.gcmap.activeLayer=null},_reloadGroupPartialy:function(){if(this._toBeLoaded){this._partialGroup=null;this._toBeLoaded=false;return}var K=this.group;this.group=this._partialGroup;this._partialGroup=null;this._resetGroup();this.reload();this.group=K;this._resetGroup()}});fnTileLayer.prototype._updateOriginalFnLayer=fnTileLayer.prototype._update;fnTileLayer.prototype._update=function(){this._updateOriginalFnLayer();this.viewer._layersForUpdateCount--;if(this.viewer._layersForUpdateCount===0){giscloud.Html5SendRequests();this.viewer._layersForUpdateCount=0}};fnTileLayerGroup.theTileLayer=null;function G(V){var Y=V._leaflet_pos.x;var X=V._leaflet_pos.y;var R=h.map._animateScale;if(!R){return}var O=Math.round(h.map._animateOrigin.x);var M=Math.round(h.map._animateOrigin.y);var W=V._layer._oldContainer.childNodes;for(var T=0,U=W.length;T<U;T++){if(!W[T]._drawn){continue}var S=(W[T]._leaflet_pos.x-O-W[T]._offset)*R+O;var Q=(W[T]._leaflet_pos.y-M-W[T]._offset)*R+M;var Z=W[T].width*R;var P={xmin:Y,ymin:X,xmax:Y+V.width-V._offset*2,ymax:X+V.height-V._offset*2};var N={xmin:S,ymin:Q,xmax:S+Z,ymax:Q+Z};if(F(P,N)){rect={xmin:D(P.xmin,N.xmin),ymin:D(P.ymin,N.ymin),xmax:J(P.xmax,N.xmax),ymax:J(P.ymax,N.ymax)};var K={x:Math.floor((rect.xmin-S)/R),y:Math.floor((rect.ymin-Q)/R),w:Math.ceil((rect.xmax-rect.xmin)/R),h:Math.ceil((rect.ymax-rect.ymin)/R),c:W[T]};var aa=K.c.getContext("2d");aa.clearRect(K.x,K.y,K.w,K.h)}}}function F(M,K){if(M.xmax<K.xmin||M.xmin>K.xmax||M.ymax<K.ymin||M.ymin>K.ymax){return false}return true}function D(M,K){if(M>K){return M}return K}function J(M,K){if(M<K){return M}return K}fnRasterLayer=fnLayer2.extend({_processTile:function(Q,N,P){var O=false;var S,M,K,R;S=R="0px";K=M="256px";if(N.x==this.tnxmin){S=Math.round((this.nxmin-this.tnxmin)*256)+"px";O=true}if(N.y==this.tnymin){R=Math.round((this.nymin-this.tnymin)*256)+"px";O=true}if(N.x==this.tnxmax){M=Math.round((this.nxmax-this.tnxmax)*256)+"px";O=true}if(N.y==this.tnymax){K=Math.round((this.nymax-this.tnymax)*256)+"px";O=true}if(O){Q.style.clip="rect("+R+","+M+","+K+","+S+")"}Q.src=this.getTileUrl(N,P)}});function I(Q,P,M){var N="";for(var O=M;O>0;O--){var R="0";var K=1<<(O-1);if((Q&K)!=0){R++}if((P&K)!=0){R++;R++}N+=R}return N}fnQuadLayer=fnLayer2.extend({_processTile:function(P,N,O){var K=this.options.subdomains,M=this.options.subdomains[(N.x+N.y)%K.length];P.src=this._url[(N.x+N.y)%this._url.length].replace("{s}",M).replace("{q}",I(N.x,N.y,O))}});fnWmsLayer=fnLayer2.extend({_processTile:function(Q,N,P){if(this.options.gctms){N.y=this._getWrapTileNum()-N.y-1}if(o.zoomOffset){P+=o.zoomOffset}var K=o.max/(1<<P);var M=o.xmin+K*N.x;var O=o.ymax-K*N.y;Q.src=this._url[(N.x+N.y)%this._url.length].replace("$x1",M).replace("$y1",O-K).replace("$x2",M+K).replace("$y2",O).replace("{z}",P).replace("{x}",N.x).replace("{y}",N.y).replace("$id",P).replace("$nx",N.x).replace("$ny",N.y)}});fnGoogleLayer=fnLayer2.extend({includes:q.Mixin.Events,initialize:function(K){K.zoomAnimation=false;q.Util.setOptions(this,K);h.map.copyrightControl.setPosition("topright");h.map.attributionControl.setPosition("topright");this._googleMapsApiLoaded=giscloud.Viewer.__googleMapsApiLoaded},onAdd:function(N,K){this._map=N;this._noScale=true;this._insertAtTheBottom=K;var M=this;this._initContainer();this._map.on({viewreset:this._resetCallback,moveend:this._update,move:this._update},this);if(!this.options.updateWhenIdle){this._limitedUpdate=q.Util.limitExecByInterval(this._update,150,this);N.on("move",this._limitedUpdate,this)}if(!r.google){if(!giscloud.fnGoogleLayerLoadCallback){giscloud.fnGoogleLayers=[];giscloud.fnGoogleLayerLoadCallback=function(){M._googleMapsApiLoaded.resolve();M._map.invalidateSize();for(var O=0;O<giscloud.fnGoogleLayers.length;O++){giscloud.fnGoogleLayers[O]._initMapObject()}r.setTimeout(function(){delete giscloud.fnGoogleLayerLoadCallback;delete giscloud.fnGoogleLayers;M._map.invalidateSize()},1)};giscloud.includeJs((r.location.protocol=="https:"?"https:":"http:")+"//maps.googleapis.com/maps/api/js?sensor=false&callback=giscloud.fnGoogleLayerLoadCallback")}giscloud.fnGoogleLayers.push(this)}else{setTimeout(function(){M._googleMapsApiLoaded.resolve()},500)}},onRemove:function(K){K._panes.tilePane.removeChild(this._container);K.off({viewreset:this._resetCallback,moveend:this._update,move:this._update},this);if(!this.options.updateWhenIdle){K.off("move",this._limitedUpdate,this)}this._container=null;this._map=null},_initContainer:function(){var K=this._map._panes.tilePane;if(!this._container||K.empty){this._container=q.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left");this._updateZIndex();K.appendChild(this._container);var M=this._map.getSize();this._container.style.width=M.x+"px";this._container.style.height=M.y+"px";if(this.options.opacity<1){this._updateOpacity()}}this.setVisible(this.options.visible)},setVisible:function(K){if(this._container){this._container.style.display=K?"block":"none";if(r.google&&!this._container.initMap&&K){this._container.initMap=true;this._initMapObject()}}this._updateLayerCount(K);this.options.visible=K;if(!K){if(this._google){delete this._google;this._google=null;this._container.initMap=false}}this._update();return this},_initMapObject:function(){var K=null;this._googleMapsApiLoaded.done(g.proxy(function(){if(this._map){this._lastzoom=this._map.getZoom();if(this._lastzoom>this.options.maxZoom){return}var M=this._map.getCenter();K=new google.maps.LatLng(M.lat,M.lng)}var P={center:K,zoom:this._lastzoom,mapTypeId:google.maps.MapTypeId[this.options.google_map_type],disableDefaultUI:true,keyboardShortcuts:false,draggable:false,disableDoubleClickZoom:true,scrollwheel:false,streetViewControl:false};if(flashnavigator.hasCanvas){P.backgroundColor="rgba(0,0,0,0)"}var O=new google.maps.Map(this._container,P);O.setTilt(0);this._google=O;var N=this;google.maps.event.addListenerOnce(O,"idle",function(){N.fire("load")});google.maps.event.addListenerOnce(O,"zoom_changed",function(R){var Q=O.getZoom();if(Q!=N._lastzoom){N._container.innerHTML=""}})},this))},_reset:function(K){this._initContainer()},_update:function(){var N=this._map.getZoom();if(!this._google||!this.options.visible||N>this.options.maxZoom){return}this._resize();var K=this._map.getCenter();var M=new google.maps.LatLng(K.lat,K.lng);var O={x:-this._map.getPanes().mapPane._leaflet_pos.x,y:-this._map.getPanes().mapPane._leaflet_pos.y};q.DomUtil.setPosition(this._container,O);this._google.setCenter(M);if(N!=this._lastzoom){this._google.setZoom(N);this._lastzoom=N}},_resize:function(){var K=this._map.getSize();if(this._container.style.width==K.x&&this._container.style.height==K.y){return}this._container.style.width=K.x+"px";this._container.style.height=K.y+"px";google.maps.event.trigger(this._google,"resize")},_addTile:function(){},_addTilesFromCenterOut:function(){}});if(flashnavigator.ready){flashnavigator.ready()}}fnViewer2=function(an,M,U){var ah,T,V,ad;ah=[];layers_feature_filter=[];ad=true;this.disableAnimation=function(){};this.setQuality=function(){};this.demodifyObjectsColor=function(){};this.modifyObject=function(aq,ap,aw,au,at,ar){for(var av in h.map._layers){if(h.map._layers[av].gcmap){h.map._layers[av].gcmap.modifyObject(aq,ap,aw,au,at,ar)}}};var af=this;h.map.on("move",function(){af._layersForUpdateCount=c});h.map.on("moveend",function(){af._layersForUpdateCount=c});h.map.on("viewreset",function(){af._layersForUpdateCount=c});h.map.on("zoomanim",function(){giscloud.html5ResetLoaders()});this.disablePanWithMiddleButton=function(){};this.enablePanWithMiddleButton=function(){};this.enableSelection=function(){giscloud.Html5MapSetSelection(true);ad=true};this.disableSelection=function(){giscloud.Html5MapSetSelection(false);ad=false};this.fireSelectAreaEvent=function(ar,aA,av){var at=(1<<h.map._zoom)*256;var ay=h.map.getPixelBounds();var az=Math.abs(aA.x-ar.x);var au=Math.abs(aA.y-ar.y);if(az>10&&au>10){var aq=o.xmin+o.max*(ar.x+h.map._mapPane._leaflet_pos.x+ay.min.x)/at;var ax=o.ymax-o.max*(ar.y+h.map._mapPane._leaflet_pos.y+ay.min.y)/at;var ap=o.xmin+o.max*(aA.x+h.map._mapPane._leaflet_pos.x+ay.min.x)/at;var aw=o.ymax-o.max*(aA.y+h.map._mapPane._leaflet_pos.y+ay.min.y)/at;aj("areaselection",{originalEvent:av,xMin:aq,yMin:ax,xMax:ap,yMax:aw})}};this.fireSelectAreaToolEvent=function(ar,aq,av){var ap=Math.abs(aq.x-ar.x);var at=Math.abs(aq.y-ar.y);if(ap>10&&at>10){var au=new q.LatLngBounds(h.map.layerPointToLatLng(ar),h.map.layerPointToLatLng(aq));h.map.fitBounds(au)}};this.setTool=function(ap){g("#flashcontent").removeClass("gc-edit-cursor");if(this._currentTool==="MeasureTool"){if(h.map.measure.enabled){h.map.measure.disable()}}if(this._currentTool==ap&&ap!=="MeasureTool"){return}h.map.boxZoom._onDone=null;h.map.boxZoom.force(false);if(ap=="SelectAreaTool"||ap=="AreaSelection"){h.map.dragging.disable();if(ap=="AreaSelection"){h.map.boxZoom._onDone=this.fireSelectAreaEvent}else{h.map.boxZoom._onDone=this.fireSelectAreaToolEvent}h.map.boxZoom.force(true);g("#flashcontent").addClass("gc-edit-cursor")}else{h.map.dragging.enable()}if(ap=="MeasureTool"){h.map.measure.enable();g("#flashcontent").addClass("gc-edit-cursor")}var aq={tool:ap,previous_tool:this._currentTool};this._currentTool=ap;aj("toolchange",aq)};this.src=function(){};this.enableAnimation=function(){};this.convertScale=function(ap){return k/ap};this.unload=function(){this._reloadBound=null;while(l=ah.pop()){if(l._updateLayerCount){l._updateLayerCount(true)}if(l.cleanUpOnRemove){l.cleanUpOnRemove(h.map,true)}else{h.map.removeLayer(l)}}c=0;h.map.setView(new q.LatLng(0,0),0,true)};this.reload=function(ap,aq){if(ah.length>0){this._reloadBound=this.getViewBound()}this.load(ap||T,true,aq)};this.setLayerFeatureFilter=function(aq,ar){layers_feature_filter[aq]=ar;var ap=this.getLayerByName(aq);if(ap&&ap.setFeatureFilter){ap.setFeatureFilter(ar)}};this.getLayerByName=function(aq){for(var ap=0;ap<ah.length;ap++){if(ah[ap].id==aq){return ah[ap]}}return 0};this.getLayerById=this.getLayerByName;this.getLayerCount=function(){return ah.length};this.getLayer=function(ap){return ah[ap]};this.setLayersOrder=function(ap){al(ap);giscloud.Html5SendRequests()};this.removeLayer=function(aq){var ap=ah[aq.refId];for(var ar=aq.refId;ar<ah.length-1;ar++){ah[ar]=ah[ar+1];ah[ar].refId=ar}if(ap.isTileLayer){c--}ah.length--;if(ap._updateLayerCount){ap._updateLayerCount(true)}if(ap.cleanUpOnRemove){if(ap.cleanUpOnRemove(h.map)){c--}}else{h.map.removeLayer(ap)}aj("layerRemoved",ap)};this.getViewBound=function(){var ap=h.map.getPixelBounds();var aq=o.max/(Math.pow(2,h.map._zoom)*256);var ar=new Object();ar.xMin=o.xmin+aq*ap.min.x;ar.yMin=o.ymax-aq*ap.max.y;ar.xMax=o.xmin+aq*ap.max.x;ar.yMax=o.ymax-aq*ap.min.y;return ar};this.setViewBound=function(ax,aC,aA,aE,av,ar){if(!ah[0]){return}ax*=1;aA*=1;aC*=1;aE*=1;if(!av){av=1}if(isNaN(ax)||isNaN(aC)||isNaN(aA)||isNaN(aE)){if(this._startBound&&!isNaN(this._startBound.xMin)&&!isNaN(this._startBound.xMax)&&!isNaN(this._startBound.yMin)&&!isNaN(this._startBound.yMax)){ax=this._startBound.xMin;aC=this._startBound.yMin;aA=this._startBound.xMax;aE=this._startBound.yMax}else{ax=o.xmin;aC=o.ymin;aA=o.xmax;aE=o.ymax}}var aI=o.max*2.5e-8;if(Math.abs(ax-aA)<aI){var au=o.max*0.000025;ax-=au;aA+=au}if(Math.abs(aC-aE)<aI){var au=o.max*0.000025;aC-=au;aE+=au}if(h.map._loaded&&!ar){var aB=(1<<h.map._zoom)*256;var aq=h.map.getPixelBounds();var aH=new q.LatLngBounds(this.toLeafletCoords(ax,aC),this.toLeafletCoords(aA,aE));h.map.fitBounds(aH)}else{var aB=(aA-ax>aE-aC)?aA-ax:aE-aC;var aw=h.map.getSize();var ay=h.map.getSize(),ap=h.map.getMinZoom(),az=h.map.getMaxZoom(),aF,aD,at;if(!az||az>E){az=E}do{ap++;var aG=Math.pow(2,ap)*256;aD={x:aA/o.max*aG,y:aC/o.max*aG};at={x:ax/o.max*aG,y:aE/o.max*aG};aF=new q.Point(aD.x-at.x,at.y-aD.y)}while((aF.x-ay.x<0.0001)&&(aF.y-ay.y<0.0001)&&(ap<=az));ap-=av;I((aA+ax)/2,(aE+aC)/2,ap)}};this.setViewBoundAnim=this.setViewBound;this.setScale=function(aq){var ap=this.getViewBound();this.setLocation((ap.xMin+ap.xMax)/2,(ap.yMin+ap.yMax)/2,aq)};this.toLeafletCoords=function(aq,av,au){var ap=(1<<h.map._zoom)*256,at=h.map.getPixelBounds(),aq=(aq-o.xmin)/o.max*ap-h.map._mapPane._leaflet_pos.x-at.min.x,av=(o.ymax-av)/o.max*ap-h.map._mapPane._leaflet_pos.y-at.min.y,ar=h.map.layerPointToLatLng(new q.Point(aq,av));if(au!=null){ar.z=au}return ar};this.fromLeafletCoords=function(av){var at=h.map.latLngToLayerPoint(av),aq=(1<<h.map._zoom)*256,ar=h.map.getPixelBounds(),ap=o.xmin+(at.x+h.map._mapPane._leaflet_pos.x+ar.min.x)/aq*o.max,au=o.ymax-(at.y+h.map._mapPane._leaflet_pos.y+ar.min.y)/aq*o.max;if(av.z!=null){return new giscloud.geometry.Point(ap,au,av.z)}return new giscloud.geometry.Point(ap,au)};this.setLocation=function(ap,ar,aq){if(h.map._loaded){if(!(aq>=0)){aq=h.map._zoom}h.map.setView(this.toLeafletCoords(ap,ar),aq)}else{if(aq){aq=Math.floor(Math.log(k/aq*o.max/256)/Math.log(2))}else{aq=h.map._zoom}I(ap,ar,aq)}};this.exposeLeaflet=function(){return h.map};this.invalidateSize=function(){h.map.invalidateSize()};function I(ap,au,at){var ar=h.map.getSize();h.map._zoom=at;var aq=o.max/(Math.pow(2,at)*256);ap=(ap-o.xmin)/aq-ar.x/2;au=(o.ymax-au)/aq-ar.y/2;h.map._initialTopLeftPoint=new q.Point(ap,au);q.DomUtil.setPosition(h.map._mapPane,new q.Point(0,0));h.map._tileLayersToLoad=h.map._tileLayersNum;if(h.map._tileBg){h.map._tileBg.innerHTML=""}h.map.fire("viewreset",{hard:true});h.map.fire("move");h.map.fire("zoomend");h.map.fire("moveend");if(!h.map._loaded){h.map._loaded=true;h.map.fire("load")}}function Y(ar){var ap=ar.length;for(var aq=0;aq<ap;aq++){if(ar[aq].nodeType==1){return ar[aq]}}return null}var H=[];var R=0;function Z(aq){R=H.length;if(R==0){aa(aq);return}var ap;while(ap=H.pop()){ap.img.onerror=ap.img.onload=function(){this.feature.predominantColor=this.feature.fillcolor;this.feature.iready=true;R--;if(R==0){aa(aq)}};ap.img.src=ap.url}}this.load=function(ap,ar,at){var aq=this;T=ap;this._is_reload=ar;this.reloadCallback=at;g.ajax({url:ap+(ap.indexOf("?")>-1?"&":"?")+"t="+(new Date()).getTime()+(ar?"&reload=1":""),context:this,success:function(aD){var aP="";var aE="";var aT=null;var aK=Y(aD.childNodes);var aH=aK.childNodes.length;var aA=100;var aS;if(aK.attributes){for(aS=0;aS<aK.attributes.length;aS++){if(aK.attributes[aS].name=="id"){aP=aK.attributes[aS].value}else{if(aK.attributes[aS].name=="unit"){aE=aK.attributes[aS].value;k=z[aE]}else{if(aK.attributes[aS].name=="maxzoom"){aA=parseInt(aK.attributes[aS].value,10)}}}}}this._mid=aP;var ay=[];y=[];var ax=false;var az=null;h.map.copyrightControl._attributions={};h.map.copyrightControl._update();this.copyright="";this.backgroundcolor=null;for(var aM=0;aM<aH;aM++){if(aK.childNodes[aM].tagName=="copyright"){this.copyright=giscloud.xssSafe(aK.childNodes[aM].text||aK.childNodes[aM].childNodes[1].textContent);h.map.copyrightControl._attributions={};h.map.copyrightControl.addAttribution("&copy; "+this.copyright)}else{if(aK.childNodes[aM].tagName=="sources"){am(aK.childNodes[aM].childNodes,y,ay)}else{if(aK.childNodes[aM].tagName=="bound"){var av=aK.childNodes[aM].attributes;aT={};for(aS=0;aS<av.length;aS++){if(av[aS].name=="xmin"){aT.xMin=parseFloat(av[aS].value)}else{if(av[aS].name=="ymin"){aT.yMin=parseFloat(av[aS].value)}else{if(av[aS].name=="xmax"){aT.xMax=parseFloat(av[aS].value)}else{if(av[aS].name=="ymax"){aT.yMax=parseFloat(av[aS].value)}}}}}ax=true}else{if(aK.childNodes[aM].tagName=="tile0"){az={};var aC=aK.childNodes[aM].attributes;for(aS=0;aS<aC.length;aS++){if(aC[aS].name=="originx"){az.originx=parseFloat(aC[aS].value)}else{if(aC[aS].name=="originy"){az.originy=parseFloat(aC[aS].value)}else{if(aC[aS].name=="resolution"){az.resolution=parseFloat(aC[aS].value)}else{if(aC[aS].name=="wmts"){az.wmts=aC[aS].value=="true"}}}}}}else{if(aK.childNodes[aM].tagName=="projection"){this.projection=aK.childNodes[aM].getAttribute("value")}else{if(aK.childNodes[aM].tagName=="epsg"){this.epsg=aK.childNodes[aM].getAttribute("value")}else{if(aK.childNodes[aM].tagName=="background"){this.backgroundcolor=aK.childNodes[aM].getAttribute("value")+"";if(this.backgroundcolor){this.backgroundcolor=this.backgroundcolor.replace("0x","#")}}}}}}}}}if(aE==="degree"){h.map.measure.options.calculateDistance=function(aZ,aV,aX,aU){var aY=aq.fromLeafletCoords(new q.LatLng(aZ,aV)),aW=aq.fromLeafletCoords(new q.LatLng(aX,aU));return h.map.measure._haversine(aY.y,aY.x,aW.y,aW.x)}}else{if(this.epsg==="900913"||this.epsg==="3857"){h.map.measure.options.calculateDistance=function(aX,aV,aW,aU){return h.map.measure._haversine(aX,aV,aW,aU)}}else{h.map.measure.options.calculateDistance=function(aZ,aV,aX,aU){var aY=aq.fromLeafletCoords(new q.LatLng(aZ,aV)),aW=aq.fromLeafletCoords(new q.LatLng(aX,aU));return Math.sqrt((aY.x-aW.x)*(aY.x-aW.x)+(aY.y-aW.y)*(aY.y-aW.y))};if(aE==="meter"){h.map.measure.options.labelFunction=function(aY,aX,aU,aW){var aV=aW/1000;if(aV>1000){return Math.round(aV)+"km"}else{if(aV>100){return Math.round(aV*10)/10+"km"}else{if(aV>10){return Math.round(aV*100)/100+"km"}else{return Math.round(aV*1000)+"m"}}}};h.map.measure.options.tipLabelFunction=function(){return this.options.labelFunction(null,null,null,this._current)}}else{h.map.measure.options.labelFunction=function(aY,aW,aU,aV){var aX;if(aV>1000){aX=Math.round(aV)}else{if(aV>100){return Math.round(aV*10)/10}else{if(aV>10){return Math.round(aV*100)/100}else{return Math.round(aV*1000)/1000}}}switch(aE){case"foot":case"us survey foot":case"foot_us":return aX+" ft";case"mile":return aX+" mi";case"inch":return aX+" in";case"yard":return aX+" yd";default:return aX+" "+aE}}}}}if(this.backgroundcolor){h.map._container.style.backgroundColor=this.backgroundcolor}else{h.map._container.style.backgroundColor="#ffffff"}if(!ax){aT={}}var aQ={};var aF;if(az&&!isNaN(az.originx)&&!isNaN(az.originy)&&!isNaN(az.resolution)){aF=az.resolution*256*(k/3779.527559055);if(az.wmts){if(az.originx==-180&&az.originy==90){aF=180*2;aQ.zoomOffset=-1}else{aF*=1.14687998/4096}aQ.ymin=az.originy-aF;aQ.ymax=az.originy}else{aQ.ymin=az.originy;aQ.ymax=az.originy+aF}aQ.xmin=az.originx;aQ.xmax=az.originx+aF;aQ.max=aF}else{if(Math.abs(k-420735083.313146)<0.00001){aF=180}else{aF=20037508.3427892*(k/3779.527559055)}aQ.xmin=-aF;aQ.ymin=-aF;aQ.xmax=aF;aQ.ymax=aF;for(var aM=0;aM<ay.length;aM++){if(aQ.xmin==m||ay[aM].xmin*1<aQ.xmin){aQ.xmin=ay[aM].xmin*1}if(aQ.ymin==m||ay[aM].ymin*1<aQ.ymin){aQ.ymin=ay[aM].ymin*1}if(aQ.xmax==m||ay[aM].xmax*1>aQ.xmax){aQ.xmax=ay[aM].xmax*1}if(aQ.ymax==m||ay[aM].ymax*1>aQ.ymax){aQ.ymax=ay[aM].ymax*1}}var aw=aQ.xmax-aQ.xmin;var au=aQ.ymax-aQ.ymin;if(au>aw){aw=au}aQ.max=aw}var aR=false;var aJ=["osm","bing","bing_sat","gmaps","gmaps_sat","gmaps_terr","mapquest-osm","mapquest-oarial","cloudmade_gray","maps_for_free_relief","cloudmade_night","tilejson","croatianq"];for(var aM=0;aM<ay.length;aM++){if(g.inArray(ay[aM].src,aJ)==-1){aR=true}}var aB=Math.floor(Math.log(k/(256/aQ.max)/aA)/Math.log(2));if(!this._is_reload||!o||o.xmin!=aQ.xmin||o.ymin!=aQ.ymin||o.xmax!=aQ.xmax||o.ymax!=aQ.ymax){this._reloadBound=null}o=aQ;for(var aM=0;aM<aH;aM++){if(aK.childNodes[aM].tagName=="layers"){J(aK.childNodes[aM].childNodes,y,aP,ah,aB)}}S(aP,ah,aB);for(var aM=0;aM<ah.length;aM++){if(ah[aM].has_icon&&ah[aM].features){for(var aO=0;aO<ah[aM].features.length;aO++){if(ah[aM].features[aO].icon){ah[aM].features[aO].icon_image=new Image();ah[aM].features[aO].icon_image.feature=ah[aM].features[aO];H.push({img:ah[aM].features[aO].icon_image,url:ah[aM].features[aO].icon})}}}}for(var aM=0;aM<ay.length;aM++){if(!ay[aM].visible||(g.inArray(ay[aM].src,aJ)>-1&&aR)||ax){continue}var aG=parseFloat(ay[aM].xmin);var aL=parseFloat(ay[aM].ymin);var aI=parseFloat(ay[aM].xmax);var aN=parseFloat(ay[aM].ymax);if(aG==0&&aL==0&&aI==0&&aN==0){continue}if(aT.xMin==m||aG<aT.xMin){aT.xMin=aG}if(aT.yMin==m||aL<aT.yMin){aT.yMin=aL}if(aT.xMax==m||aI>aT.xMax){aT.xMax=aI}if(aT.yMax==m||aN>aT.yMax){aT.yMax=aN}}this._startBound=aT;Z(this)}})};function al(aq){var at=[];if(fnTileLayerGroup.theTileLayer){for(var au in fnTileLayerGroup.theTileLayer){fnTileLayerGroup.theTileLayer[au]._zIndexOffset=null}var ar=false;var aw=null;var ay=null;for(var au=0;au<ah.length;au++){var av=ah[aq[au]];if(av.isGroupLayer){if((!ar&&ay)||(ar&&aw!=av.groupId)){av.cleanUpOnRemove(null,true);if(ar){av.groupIdIndex=ay.groupIdIndex;av.groupId="g"+av.groupIdIndex;av.options.group=av.groupId;av.tileLayer=ay.tileLayer;av.tileLayer._partialGroup=av.tileLayer._partialGroup||[];av.tileLayer._partialGroup.unshift(av)}else{av.groupIdIndex++;av.groupId="g"+av.groupIdIndex;av.options.group=av.groupId;av.newTileLayer()}av.visible=av.options.visible;av.tileLayer.group.unshift(av);av.tileLayer._resetGroup();av.setUniqueId()}aw=av.groupId;ay=av}ar=av.isGroupLayer}}for(var au=0;au<ah.length;au++){var av=ah[aq[au]];var ax=av._container||av.isGroupLayer;if(ax){av.setZIndex(ah.length-au)}at[au]=av}for(var au=0;au<ah.length;au++){ah[au]=at[ah.length-au-1];ah[au].refId=au}if(fnTileLayerGroup.theTileLayer){for(var au in fnTileLayerGroup.theTileLayer){var ap=fnTileLayerGroup.theTileLayer[au];if(!ap.viewer){ap.viewer=ap.group[0].viewer;ap._toBeLoaded=true;ap.addTo(h.map)}if(ap._shouldRedrawDueSort){ap._resetGroup();ap.redraw()}ap._reloadGroupPartialy()}}}function aa(av){var ax=[];var au=false;h.map.invalidateSize();if(!av._reloadBound){var ap=av._startBound;av.setViewBound(ap.xMin,ap.yMin,ap.xMax,ap.yMax)}av._layersForUpdateCount=0;for(var at=0;at<ah.length;at++){if(ah[at].should_add&&(ah[at].isTileLayer||ah[at].isRootLayer)){av._layersForUpdateCount++}}for(var at=0;at<ah.length;at++){ax.unshift(ah[at].refId);if(ah[at].should_add){ah[at].should_add=false;ah[at].viewer=av;if(!ah[at].isGroupLayer){ah[at].addTo(h.map)}au=true;ah[at].features_original=[];for(var ar=0;ar<ah[at].features.length;ar++){var aw={};for(var aq in ah[at].features[ar]){aw[aq]=ah[at].features[ar][aq]}ah[at].features_original[ar]=aw}if(h.map.options.zoomAnimation&&q.TileLayer&&(ah[at] instanceof q.TileLayer)){if(!ah[at].options.visible){h.map._tileLayersNum--}}}}if(h.map._loaded&&au){al(ax)}A=true;if(av._is_reload){aj("reload",{id:av._mid})}else{aj("load",{id:av._mid})}if(av.reloadCallback){av.reloadCallback();av.reloadCallback=null}}function am(aq,ay,at){for(var av=aq.length-1;av>=0;av--){var ap=aq[av];if(ap.tagName=="source"){var ar="";var az=new Array();for(var aA=0;aA<ap.attributes.length;aA++){var aB=ap.attributes[aA].name;if(aB=="id"){ar=ap.attributes[aA].value}if(aB=="xmin"||aB=="xmax"||aB=="ymin"||aB=="ymax"){az[aB]=parseFloat(ap.attributes[aA].value)}else{az[aB]=ap.attributes[aA].value}}ay[ar]=az;ay[ar].tileservers=[];for(var aw=ap.childNodes.length-1;aw>=0;aw--){if(ap.childNodes[aw].tagName=="tileservers"){var au=ap.childNodes[aw];if(au.attributes){for(var aA=0;aA<au.attributes.length;aA++){if(au.attributes[aA].name=="maxzoom"){ay[ar].maxzoom=parseInt(au.attributes[aA].value)}if(au.attributes[aA].name=="minzoom"){ay[ar].minzoom=parseInt(au.attributes[aA].value)}if(au.attributes[aA].name=="attribution"){ay[ar].attribution=au.attributes[aA].value}}}for(var ax=ap.childNodes[aw].childNodes.length-1;ax>=0;ax--){var au=ap.childNodes[aw].childNodes[ax];if(au.attributes){for(var aA=0;aA<au.attributes.length;aA++){if(au.attributes[aA].name=="value"){ay[ar].tileservers.push(au.attributes[aA].value)}}}}}if(ap.childNodes[aw].tagName=="tilepath"){var au=ap.childNodes[aw];if(au.attributes){for(var aA=0;aA<au.attributes.length;aA++){if(au.attributes[aA].name=="value"){ay[ar].tilepath=au.attributes[aA].value}}}}}at.push(ay[ar])}}}var P;var E=1;function J(ay,au,az,at,aw){P=[];for(var aq=ay.length-1;aq>=0;aq--){var av=ay[aq];if(av.tagName=="layer"){var ap={id:"",alpha:1,visible:true};if(av.attributes){for(var ax=0;ax<av.attributes.length;ax++){if(av.attributes[ax].name=="id"){ap.id=av.attributes[ax].value}else{if(av.attributes[ax].name=="src"){ap.src=av.attributes[ax].value}else{if(av.attributes[ax].name=="timestamp"){ap.timestamp=av.attributes[ax].value}else{if(av.attributes[ax].name=="offset"){ap.offset=av.attributes[ax].value}else{if(av.attributes[ax].name=="precision"){ap.precision=av.attributes[ax].value*1}else{if(av.attributes[ax].name=="dynamic"){ap.dynamic=av.attributes[ax].value*1}else{if(av.attributes[ax].name=="visible"){ap.visible=av.attributes[ax].value=="true"}else{if(av.attributes[ax].name=="alpha"){ap.alpha=parseInt(av.attributes[ax].value)/100}else{if(av.attributes[ax].name=="type"){ap.type=av.attributes[ax].value}else{if(av.attributes[ax].name=="format"){ap.format=av.attributes[ax].value}else{if(av.attributes[ax].name=="map"){ap.map=av.attributes[ax].value}else{if(av.attributes[ax].name=="fromlevel"){ap.fromlevel=parseInt(av.attributes[ax].value)}else{if(av.attributes[ax].name=="tolevel"){ap.tolevel=parseInt(av.attributes[ax].value)}else{if(av.attributes[ax].name=="tooltip"){ap.tooltip=av.attributes[ax].value}}}}}}}}}}}}}}}}ap.features=[];for(var ar=0;ar<av.childNodes.length;ar++){if(av.childNodes[ar].tagName=="features"){O(av.childNodes[ar].childNodes,ap)}}ap.xmin=au[ap.src].xmin;ap.ymin=au[ap.src].ymin;ap.xmax=au[ap.src].xmax;ap.ymax=au[ap.src].ymax;P.push(ap)}}}function ae(aq,ap){if(ap.id!=aq.id){return 0}else{aq.refId=ap.refId}if(ap.timestamp!=aq.timestamp){return 0}if(ap.xmin!=aq.xmin){return 0}if(ap.xmax!=aq.xmax){return 0}if(ap.ymin!=aq.ymin){return 0}if(ap.ymax!=aq.ymax){return 0}if(ap.features.length!=aq.features.length){return 0}return 2}function S(aI,ax,az){for(var aE=0;aE<P.length;aE++){P[aE].prev_layer=null}var aq=ax.length;for(var aH=0;aH<ax.length;aH++){var aF=ax[aH];var aB=true;for(var aE=0;aE<P.length;aE++){var aC=P[aE];if(ae(aC,aF.layer_info)){aB=false;aC.prev_layer=aF;aF.options.tooltip=aC.tooltip}}if(aB){if(aF.isTileLayer){c--}aq--;if(aF._updateLayerCount){aF._updateLayerCount(true)}if(aF.cleanUpOnRemove){if(aF.cleanUpOnRemove(h.map)){c--}}else{h.map.removeLayer(aF)}}}ax.length=0;add_index=0;for(var aE=0;aE<P.length;aE++){var aC=P[aE];if(aC.prev_layer){ax[aE]=aC.prev_layer;ax[aE].add_index=add_index++;continue}ax[aE]=null}var aA=false;var at=false;var ar=-1;for(var aE=0;aE<P.length;aE++){var aC=P[aE];if(aC.visible){y[aC.src].visible=true}if(!flashnavigator.hasCanvas){aC.alpha=100}var aw=y[aC.src].src;if(aw=="osm"||aw=="croatianq"||aw=="gmaps"||aw=="gmaps_sat"||aw=="gmaps_terr"||aw=="gmaps_hybrid"||aw=="bing"||aw=="bing_sat"||aw=="grajs"||aw=="maps_for_free_relief"||aw=="mapquest-osm"||aw=="mapquest-oarial"||aw=="cloudmade_gray"||aw=="cloudmade_night"||aw=="tilejson"){aA=true}if(ax[aE]){at=ax[aE].isGroupLayer;continue}if(aC.type=="raster"){var au={noWrap:true,visible:aC.visible,opacity:aC.alpha,maxZoom:az};if(!aC.format){aC.format="swf"}if(aC.fromlevel){au.minZoom=aC.fromlevel}if(aC.tolevel&&aC.tolevel<az){au.maxZoom=aC.tolevel}var av=new fnRasterLayer(C+"r/"+aC.timestamp+"/"+aI+"/"+aC.id+"/{z}/{x}/{y}."+aC.format,au);av.id=aC.id;av.source=y[aC.src]}else{if(aw=="osm"){var av=new fnLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:aC.visible?"<a href='http://www.openstreetmap.org/' target='_blank'>OpenStreetMap</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="cloudmade_gray"){var av=new fnLayer("http://{s}.tile.cloudmade.com/{key}/22677/256/{z}/{x}/{y}.png",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:(aC.visible?"Map data &copy; 2011 OpenStreetMap contributors, Imagery &copy; 2011 CloudMade":""),key:"d962ac9332ae40b29b77f41aa3b67ca9"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="cloudmade_night"){var av=new fnLayer("http://{s}.tile.cloudmade.com/{key}/65053/256/{z}/{x}/{y}.png",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:(aC.visible?"Map data &copy; 2011 OpenStreetMap contributors, Imagery &copy; 2011 CloudMade":""),key:"d962ac9332ae40b29b77f41aa3b67ca9"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="mapquest-osm"){var av=new fnLayer("http://otile{s}.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.jpg",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,subdomains:"1234",attribution:aC.visible?"<a href='http://developer.mapquest.com/' target='_blank'>MapQuest</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="mapquest-oarial"){var av=new fnLayer("http://oatile{s}.mqcdn.com/tiles/1.0.0/sat/{z}/{x}/{y}.jpg",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,subdomains:"1234",attribution:aC.visible?"<a href='http://developer.mapquest.com/' target='_blank'>MapQuest</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="croatianq"){var av=new fnLayer("http://dhwov6czq254q.cloudfront.net/gettile.php?t=tilestache88/{z}/{x}/{y}.png?v=1",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:aC.visible?" &copy; <a href='http://www.navteq.com' target='_blank'>NAVTEQ</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="italia"){var av=new fnLayer("http://webgis.regione.sardegna.it/tms/ortofoto2006_EPSG3003/{z}/{x}/{y}.jpg",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,continuousWorld:true,attribution:aC.visible?" &copy; <a href='http://www.italia' target='_blank'>NAVTEQ</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="grajs"){var av=new fnLayer("http://dhwov6czq254q.cloudfront.net/gettile.php?t=tilestache17403/{z}/{x}/{y}.png",{maxZoom:18,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:aC.visible?" &copy; <a href='http://www.grajsmape.com' target='_blank'>Grajs Mape</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="maps_for_free_relief"){var av=new fnLayer("http://maps-for-free.com/layer/relief/z{z}/row{y}/{z}_{x}-{y}.jpg",{maxZoom:11,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:aC.visible?" <a href='http://www.maps-for-free.com/html/about.html' target='_blank'>Maps-For-Free Relief</a>":""});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="gmaps"){av=new fnGoogleLayer({maxZoom:22,noWrap:true,visible:aC.visible,opacity:aC.alpha,google_map_type:"ROADMAP"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="gmaps_sat"){av=new fnGoogleLayer({maxZoom:22,noWrap:true,visible:aC.visible,opacity:aC.alpha,google_map_type:"SATELLITE"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="gmaps_terr"){av=new fnGoogleLayer({maxZoom:15,noWrap:true,visible:aC.visible,opacity:aC.alpha,google_map_type:"TERRAIN"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="gmaps_hybrid"){av=new fnGoogleLayer({maxZoom:20,noWrap:true,visible:aC.visible,opacity:aC.alpha,google_map_type:"HYBRID"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="bing"){var av=new fnQuadLayer((r.location.protocol=="https:"?"https:":"http:")+"//ecn.t{s}.tiles.virtualearth.net/tiles/r{q}?g=811&mkt=en-us&lbl=l1&stl=h&shading=hill&n=z",{minZoom:1,maxZoom:19,noWrap:true,visible:aC.visible,subdomains:"0123",opacity:aC.alpha,attribution:aC.visible?("<a href='http://maps.bing.com/' target='_blank'>Bing Maps</a>&nbsp;© NAVTEQ, © Microsoft Corporation"):""});av.id=aC.id;av.source=y[aC.src];h.map.options.minZoom=1}else{if(aw=="bing_sat"){var av=new fnQuadLayer((r.location.protocol=="https:"?"https:":"http:")+"//ak.t{s}.tiles.virtualearth.net/tiles/a{q}?g=1457&n=z",{minZoom:1,maxZoom:19,noWrap:true,visible:aC.visible,subdomains:"0123",opacity:aC.alpha,attribution:aC.visible?("<a href='http://maps.bing.com/' target='_blank'>Bing Maps Satellite</a>&nbsp;© Microsoft Corporation"):""});av.id=aC.id;av.source=y[aC.src];h.map.options.minZoom=1}else{if(aw=="wms"||(y[aC.src].tilepath||y[aC.src].tilepath=="")){var ap;if(y[aC.src].tilepath==""){ap=y[aC.src].tileservers}else{ap=y[aC.src].tileservers[0]+y[aC.src].tilepath}var av=new fnWmsLayer(ap,{maxZoom:az,noWrap:true,visible:aC.visible,subdomains:"0123",opacity:aC.alpha,gctms:y[aC.src].src==="tms"});av.id=aC.id;av.source=y[aC.src]}else{if(aw=="tilejson"){var aD=y[aC.src];var av=new fnLayer(aD.tileservers,{maxZoom:aD.maxzoom,noWrap:true,visible:aC.visible,opacity:aC.alpha,attribution:aD.attribution});av.id=aC.id;av.source=aD}else{var ay=flashnavigator.hasCanvas&&(r.fn&&fn.getMap&&fn.getMap()&&fn.getMap().options.MAP_ENGINE_MODE=="2");var av;if(ay){if(!at){ar++}av=new fnTileLayerGroup({mid:aC.map||aI,id:aC.id,modified:aC.timestamp,lmap:h.map,maxZoom:az,offset:aC.offset,visible:aC.visible,precision:aC.precision,cluster:aC.cluster,dynamic:aC.dynamic,opacity:aC.alpha,tooltip:aC.tooltip,source:y[aC.src],group:"g0"})}else{av=new fnTileLayer({mid:aC.map||aI,id:aC.id,modified:aC.timestamp,lmap:h.map,maxZoom:az,offset:aC.offset,visible:aC.visible,precision:aC.precision,cluster:aC.cluster,dynamic:aC.dynamic,opacity:aC.alpha,tooltip:aC.tooltip,source:y[aC.src],})}if(layers_feature_filter[aC.id]&&av.setFeatureFilter){av.setFeatureFilter(layers_feature_filter[aC.id])}if(!av.tileLayer){av.isTileLayer=true}if(!av.tileLayer||av.isRootLayer){c++}}}}}}}}}}}}}}}}}}}av.features=aC.features;av.has_icon=aC.has_icon;av.layer_info=aC;av.should_add=true;ax[aE]=av;at=av.isRootLayer}if(aA){h.map.options.crs=q.CRS.EPSG3857}else{h.map.options.crs=q.CRS.EPSG4326}for(var aG=0;aG<ax.length;aG++){ax[aG].refId=aG;if(ax[aG].options.maxZoom>az){ax[aG].options.maxZoom=az}}E=az}function O(au,aq){aq.features=new Array();for(var av=0;av<au.length;av++){var at=au[av];if(at.tagName!="feature"){continue}var aw={};if(at.attributes){for(var ap=0;ap<at.attributes.length;ap++){if(at.attributes[ap].name=="icon"){aw.icon=at.attributes[ap].value;aq.has_icon=true}else{if(at.attributes[ap].name=="outline"){aw.outline=at.attributes[ap].value}else{if(at.attributes[ap].name=="color"){aw.color=at.attributes[ap].value}else{if(at.attributes[ap].name=="strokecolor"){aw.strokecolor=at.attributes[ap].value}else{if(at.attributes[ap].name=="innerstrokecolor"){aw.innerstrokecolor=at.attributes[ap].value}else{if(at.attributes[ap].name=="fillcolor"){aw.fillcolor=at.attributes[ap].value}else{if(at.attributes[ap].name=="linewidth"){aw.linewidth=at.attributes[ap].value*1}else{if(at.attributes[ap].name=="innerlinewidth"){aw.innerlinewidth=at.attributes[ap].value*1}else{if(at.attributes[ap].name=="width"){aw.width=at.attributes[ap].value*1}else{if(at.attributes[ap].name=="anchor"){aw.anchor=at.attributes[ap].value}else{if(at.attributes[ap].name=="dx"){aw.dx=at.attributes[ap].value*1}else{if(at.attributes[ap].name=="dy"){aw.dy=at.attributes[ap].value*1}else{if(at.attributes[ap].name=="type"){aw.type=at.attributes[ap].value}else{if(at.attributes[ap].name=="text"||at.attributes[ap].name=="label"){}else{if(at.attributes[ap].name=="clustering"){aw.clustering=parseInt(at.attributes[ap].value)}else{if(at.attributes[ap].name=="fontname"){aw.fontname=at.attributes[ap].value}else{if(at.attributes[ap].name=="dashed"){aw.dashed=at.attributes[ap].value;if(aw.dashed){aw.dashed=aw.dashed.split(",");for(var ar=0;ar<aw.dashed.length;ar++){aw.dashed[ar]*=1}}}}}}}}}}}}}}}}}}}}}aq.features.unshift(aw)}}V=[];function aj(ar,aq){if(!V[ar]){return}for(var ap=0;ap<V[ar].length;ap++){V[ar][ap](aq)}}var K=0;h.map.on("dragstart",function(){K=1});h.map.on("dragend",function(){K=0});function W(aq){var ap=h.map.getPixelBounds();return{x:(ap.min.x+aq.layerPoint.x+h.map._mapPane._leaflet_pos.x)/256,y:(ap.min.y+aq.layerPoint.y+h.map._mapPane._leaflet_pos.y)/256}}var ag;function Q(az,aq,av){if(!A||!h.map._layers||h.map._layers.length==0){return 0}az.mp=W(az);ag=az.mp;var ay=Math.floor(az.mp.x);var aw=Math.floor(az.mp.y);az.offsetX=256*(az.mp.x-ay);az.offsetY=256*(az.mp.y-aw);az.showMousePointer=0;F=N;N=null;var au=false;var aA;for(var ap=ah.length-1;ap>=0;ap--){var ar=ah[ap].tileLayer||ah[ap];if(ar._tilesToLoad){au=true}if(ar._tiles&&ah[ap].options.visible&&ar._tiles[ay+":"+aw]&&ar._tiles[ay+":"+aw].obj){aA=ar._tiles[ay+":"+aw];az.currentTile=aA;var ax=aA.obj.parent;aA.layer=ah[ap].id;aA.curLayerObj=ah[ap];var at=aA.obj.onMouseMove(az,aq,av,ah[ap]);aA.obj.parent=ax;if(at){at._offset=az.currentTile._offset[aA.layer];at.coord=az.currentTile.coord;N=at;az.showMousePointer=1;return !(F&&at.c==F.c)}}}return !au}function ak(aq,ar,at){at=at||N;if(at&&V[ar]){var ap=(1<<h.map._zoom);var au={id:at.c?at.c.replace("_","||"):"",object:at};if(ag){au.x=o.xmin+o.max*ag.x/ap;au.y=o.ymax-o.max*ag.y/ap;if(at.coord){au.bounds={xmin:o.xmin+((au.object.b.xmin-at._offset)/256+at.coord.x)*o.max/ap,xmax:o.xmin+((au.object.b.xmax-at._offset)/256+at.coord.x)*o.max/ap,ymin:o.ymax-((au.object.b.ymax-at._offset)/256+at.coord.y)*o.max/ap,ymax:o.ymax-((au.object.b.ymin-at._offset)/256+at.coord.y)*o.max/ap}}}if(aq.ctrlKey){au.key=17}aj(ar,au);return}}var D=g(h.map._container);var N=null;var F=null;var ai;var X;var ab;var ao;function ac(){if(!Q(ab,true,10)){return}ak(ab,"object_click")}g(h.map._mapPane).on("touchstart",function(aq){if(aq.originalEvent.targetTouches.length!=1){return}ab=aq.originalEvent.targetTouches[0];X={x:ab.pageX,y:ab.pageY};ab.layerPoint=h.map.mouseEventToLayerPoint(ab);r.clearTimeout(ai);ai=r.setTimeout(ac,200);if(ab.layerPoint){ab.mp=W(ab);if(V.mousemove){var ap=(1<<h.map._zoom);aj("mousemove",{x:o.xmin+o.max*ab.mp.x/ap,y:o.ymax-o.max*ab.mp.y/ap})}}});g(h.map._mapPane).on("touchend",function(ap){r.clearTimeout(ai);if(ab){ac()}});g(h.map._mapPane).on("touchmove",function(at){var aq=at.originalEvent.targetTouches[0];var ar=Math.abs(aq.pageX-X.x);var ap=Math.abs(aq.pageY-X.y);if(ar>2||ap>2){ab=null;r.clearTimeout(ai)}});if(!v.isMobileBrowser){var G=null;h.map.on("mousemove",function(ar){if(!o||K){return 0}if(Q(ar)&&ad){if(ar.showMousePointer){h.map._container.style.cursor="pointer";ak(ar,"object_over");G=ar}else{if(!flashnavigator.hasCanvas&&(af._currentTool=="InfoTool"||af._currentTool=="SelectTool")){h.map._container.style.cursor="default"}else{h.map._container.style.cursor=""}if(G){ak(G,"object_out",F);G=null}}}if(ar.mp&&V.mousemove){var ap=(1<<h.map._zoom);var aq={x:o.xmin+o.max*ar.mp.x/ap,y:o.ymax-o.max*ar.mp.y/ap};aj("mousemove",aq)}ao=false});h.map.on("dblclick",function(ap){ak(ap,"object_dblclick")});D.mouseup(function(ap){if(ao){ak(ap,"object_click")}})}h.map.on("mousedown",function(ar){ao=true;if(!Q(ar)){return 0}if(V.mousedown){var ap=(1<<h.map._zoom);var aq={x:o.xmin+o.max*ar.mp.x/ap,y:o.ymax-o.max*ar.mp.y/ap};aj("mousedown",aq)}});this.addEventListener=function(ap,aq){if(ap=="scalechange"){if(!V.scalechange){V.scalechange=new Array();h.map.on("zoomend",function(at){var ar=new Object();if(o&&o.max){ar.zoom=Math.pow(2,h.map._zoom)*256/o.max}aj("scalechange",ar)})}}else{if(!V[ap]){V[ap]=new Array()}}V[ap].push(aq)};this.removeEventListener=function(aq,au){var at,ap,ar=V[aq];if(ar){for(at=0,ap=ar.length;at<ap;at++){if(ar[at]===au){ar.splice(at,1);at--;ap--}}}}};fnPrinter2=function(D){};fnBitmap2=function(D){};fnSlider2=function(D){};flashnavigator2={};flashnavigator2.html5=true;flashnavigator2.include=function(){};flashnavigator2.setOptions=function(D){flashnavigator2.extraOptions=D};flashnavigator2.container=function(E,D){var F={maxZoom:25,zoom:0,latloncrs:true,center:new giscloud.LonLat(0,0),host:C,background:"#fff",attribution:{prefix:"Powered by <a href='http://www.giscloud.com/' target='_blank'>GIS Cloud</a>"}};if(flashnavigator2.extraOptions&&flashnavigator2.extraOptions.lockZoom){F.lockZoom=true}h=new giscloud.Viewer.Leaflet(E,null,F);h.onViewerLoad=D;h.init.done(function(){B();h.onViewerLoad.onLoad()})};z=new Array();units_label=new Array();var t=3779.527559055;z.meter=t;units_label.meter="m";z.kilometer=t*1000;units_label.kilometer="km";z.centimeter=t*0.01;units_label.centimeter="cm";z.degree=t*111319.49079327357;units_label.degree="°";z.foot=t*0.3048;units_label.foot="ft";z.foot_us=t*0.30480061;units_label.foot_us="ft";z.mile=t*1609.344;units_label.mile="m";z.inch=t*0.0254;units_label.mile='"';z.yard=t*0.9144;z.link_ben=t*0.201167651;z.link_srs=t*0.201167651;z.ind_yard=t*0.914398554;z.srs_yard=t*0.914398415;z.fathom=t*1.8288;k=z.meter;u="meter";function a(I){try{var H=I.icon_image;var N=document.createElement("canvas");N.width=H.width;N.height=H.height;var Q=N.getContext("2d");Q.drawImage(H,0,0);var E=Q.getImageData(0,0,N.width,N.height);var M=E.data;var D=0,J=0,O=0;var K=0;for(var G=0,F=M.length;G<F;G+=4){if(M[G+3]>0){D+=M[G];J+=M[G+1];O+=M[G+2];K++}}return giscloud.Color.rgbToHex(Math.floor(D/K),Math.floor(J/K),Math.floor(O/K))}catch(P){return giscloud.Color.rgbToHex(255,255,255)}}flashnavigator=flashnavigator2;flashnavigator.html5Compatible=true;flashnavigator.hasCanvas=!!document.createElement("canvas").getContext;if(!flashnavigator.hasCanvas){giscloud.includeJs("/libs/raphael/raphael-min.js")}flashnavigator.ready=function(){fnLayer=fnLayer2;fnMarker=fnMarker2;fnAgent=fnAgent2;fnCanvas=fnCanvas2;fnPrinter=fnPrinter2;fnBitmap=fnBitmap2;fnTooltip=fnTooltip2;fnSlider=fnSlider2;fnKartehr=function(){this.liveSite=function(){}}};fnViewer=fnViewer2;flashnavigator.html5Enabled=true}(window,giscloud.exposeJQuery(),giscloud.common()));(function(c,a){giscloud.rest={get:c.proxy(a.rest.get,a.rest)}}(giscloud.exposeJQuery(),giscloud.common()));(function(o,g,u,h){var x,n,f,t,r,v,y,a,z,c,A,B=false,k=false,q=false;try{q=(o!==o.parent&&o.parent.giscloud&&o.parent.giscloud.oauth2&&o.name===o.parent.giscloud.oauth2.frameId())}catch(C){}if(q){if(document.location.search.indexOf("error=redirect_uri_mismatch")>-1){o.parent.giscloud.oauth2.uriMismatch(document.location)}else{x=document.location.href.match(/access_token=(\w+)/);n=x&&x[1];o.parent.giscloud.oauth2.setToken(n,document.location)}}else{if(document.location.search.indexOf("error=redirect_uri_mismatch")>-1){o.parent.giscloud.oauth2.uriMismatch(document.location)}else{f=u.authHost();giscloud.oauth2={token:function(e){if(e){n=e;return this}else{return n}},frameId:function(){return c},authorize:function(E,G,F){var D,m,e=u.oid();t=G;if(!B){giscloud.includeCss(u.apiHost()+"/assets/api/1/auth.css");B=true}if(n===h||n===null){r="win_"+e;c="frame_"+r;m=(o.location.protocol=="https:"?"https:":"http:")+"//"+o.location.hostname+o.location.pathname;v=f+"/oauth/authorize?client_id="+E+"&redirect_uri="+m+"?nch="+Math.random()+"&response_type=token&fr="+c;D=g('<iframe name="'+c+'" id="'+c+'" style="position:absolute;visibility:hidden;width:1px;height:1px;"></iframe>');if(F!==h){D.one("load",F)}g("body").append(D);D.attr("src",v+"&authorize=true")}return this},signIn:function(D){var e,m;D=D||{};if(typeof D.template==="string"){m=v+"&template="+D.template}else{m=v}if(typeof D.iframeContainer==="string"&&g("#"+D.iframeContainer).length>0){z=new g.Deferred();z.then(D.onSuccess,D.onCancel);if(a){a.destroy()}a=new easyXDM.Rpc({remote:m,container:g("#"+D.iframeContainer)[0],props:D.frameProperties,onReady:D.onReady,channel:c},{remote:{invalidCredentials:{}},local:{onCancel:function(){z.reject()},onAuthStart:function(){g("#"+c).one("load",function(){if(!n){a.invalidCredentials()}else{z.resolve()}})}}})}else{e="status=1, toolbar=1,  width=450, height=400";y=o.open(m,r,e)}},signOut:function(D){var m,e;m=g("#"+c);e=new g.Deferred();if(typeof D=="function"){e.done(D)}n=null;m.one("load",function(){e.resolve()});m.attr("src",f+"/oauth/sign_out?redirect_uri="+o.location.href);return e.promise()},setToken:function(e,m){n=e;if(y){y.close();y=null}if(typeof t=="function"){t(n)}if(m){m.href=f+"/oauth/blank"}this.button(A)},uriMismatch:function(e){k=true;if(e){e.href=f+"/oauth/blank"}if(typeof t=="function"){t()}},thisIsOauthFrame:function(){return q},button:function(m,D){var e,E;A=m;e=g("<div/>",{"class":"gc-auth-button"});if(k){e.addClass("gc-redirect-uri-mismatch");e.append("This is not a registered<br/>GIS Cloud app.")}else{if(n){e.addClass("gc-authorized");e.append("You are signed in. <a href='#'>Sign out.</a>");e.click(function(F){giscloud.oauth2.signOut();F.preventDefault()})}else{e.click(function(F){giscloud.oauth2.signIn(D);F.preventDefault()})}}if(m){E=g("#"+m);if(E.length){E.html("");E.append(e)}return this}else{return e}}}}}})(window,giscloud.exposeJQuery(),giscloud.common());(function(){giscloud.LonLat=function(c,a){if(c instanceof giscloud.LonLat){this.lon=c.lon;this.lat=c.lat}else{this.lon=isNaN(c)?null:c;this.lat=isNaN(a)?null:a}};giscloud.LonLat.prototype={toArray:function(){return[this.lon,this.lat]},toString:function(c){var a;if(c!==undefined){a=Math.pow(10,c);return(Math.round(this.lon*a)/a)+", "+(Math.round(this.lat*a)/a)}else{return this.lon+", "+this.lat}},clone:function(){return new giscloud.LonLat(this)},toBounds:function(a){a=(isNaN(a)||a===null)?0:a;return new giscloud.Bounds(this.lon-a,this.lat-a,this.lon+a,this.lat+a)},equals:function(a){return a instanceof giscloud.LonLat&&this.lon===a.lon&&this.lat===a.lat},valid:function(){return !(isNaN(this.lon)||isNaN(this.lat))}};giscloud.LonLat.parse=function(c){var a;if(typeof c==="string"){a=c.split(",");if(a.length===2){return new giscloud.LonLat(parseFloat(a[0]),parseFloat(a[1]))}}return null};giscloud.Bounds=function(f,a,c,e){if(f instanceof giscloud.Bounds){this.left=f.left;this.bottom=f.bottom;this.right=f.right;this.top=f.top}else{this.left=(typeof f==="number")?f:(parseFloat(f));this.bottom=(typeof a==="number")?a:(parseFloat(a));this.right=(typeof c==="number")?c:(parseFloat(c));this.top=(typeof e==="number")?e:(parseFloat(e))}};giscloud.Bounds.prototype={width:function(c,g){var a,e,f;if(c==null){if(isFinite(this.left)&&isFinite(this.right)){return Math.abs(this.right-this.left)}else{return null}}if(isFinite(this.left)&&isFinite(this.right)){a=Math.abs(this.right-this.left);e=(c-a)/2;this.left=this.left-e;this.right=this.right+e;if(g){f=this.height();this.height(f*c/a)}}return this},height:function(f,g){var c,e,a;if(f==null){if(isFinite(this.top)&&isFinite(this.bottom)){return Math.abs(this.top-this.bottom)}else{return null}}if(isFinite(this.top)&&isFinite(this.bottom)){c=Math.abs(this.top-this.bottom);e=(f-c)/2;this.bottom=this.bottom-e;this.top=this.top+e;if(g){a=this.width();this.width(a*f/c)}}return this},center:function(c){var a,f,k,g,e;if(this.isPoint()){if(c==null){return new giscloud.LonLat(this.left,this.bottom)}else{this.left=this.right=c.lon;this.top=this.bottom=c.lat;return this}}else{a=this.width();f=this.height();k=new giscloud.LonLat((this.left+a/2),(this.bottom+f/2));if(c==null){return k}else{g=c.lon-k.lon;e=c.lat-k.lat;this.left+=g;this.right+=g;this.top+=e;this.bottom+=e;return this}}},isPoint:function(){return this.left===this.right&&this.top===this.bottom},valid:function(){return !(isNaN(this.left)||isNaN(this.bottom)||isNaN(this.right)||isNaN(this.top))},include:function(c,a){a=(isNaN(a)||a===null)?0:a;if(c instanceof giscloud.LonLat){this.left=Math.min(c.lon-a,this.left);this.bottom=Math.min(c.lat-a,this.bottom);this.right=Math.max(c.lon+a,this.right);this.top=Math.max(c.lat+a,this.top)}else{if(c instanceof giscloud.Bounds){this.left=Math.min(c.left-a,this.left);this.bottom=Math.min(c.bottom-a,this.bottom);this.right=Math.max(c.right+a,this.right);this.top=Math.max(c.top+a,this.top)}}return this},clone:function(){return new giscloud.Bounds(this)},toArray:function(){return[this.left,this.bottom,this.right,this.top]},toString:function(c){var a;if(c!==undefined){a=Math.pow(10,c);return(Math.round(this.left*a)/a)+", "+(Math.round(this.bottom*a)/a)+(Math.round(this.right*a)/a)+", "+(Math.round(this.top*a)/a)}else{return this.left+", "+this.bottom+", "+this.right+", "+this.top}}};giscloud.Bounds.parse=function(c){var a;if(typeof c==="string"){a=c.split(",");if(a.length===4){return new giscloud.Bounds(parseFloat(a[0]),parseFloat(a[1]),parseFloat(a[2]),parseFloat(a[3]))}}return null}}());(function(){var a;giscloud.geometry={Point:function(c,f,e){this.x=c;this.y=f;if(e!=null){this.z=e}},Multipoint:function(c){this.points=c},Line:function(c){this.points=c},Multiline:function(c){this.lines=c},Polygon:function(c){this.rings=c},Multipolygon:function(c){this.polygons=c},GeometryCollection:function(c){this.geometries=c},hasZ:function(f){var e,c;if(f instanceof giscloud.geometry.Point&&f.x!=null&&f.y!=null){return f.z!=null}else{if(f instanceof giscloud.geometry.Multipoint&&f.points!=null){for(e=0,c=f.points.length;e<c;e++){if(f.points[e].hasZ()){return true}}return false}else{if(f instanceof giscloud.geometry.Line&&f.points!=null){for(e=0,c=f.points.length;e<c;e++){if(f.points[e].hasZ()){return true}}return false}else{if(f instanceof giscloud.geometry.Multiline&&f.lines!=null){for(e=0,c=f.lines.length;e<c;e++){if(f.lines[e].hasZ()){return true}}return false}else{if(f instanceof giscloud.geometry.Polygon&&f.rings!=null){for(e=0,c=f.rings.length;e<c;e++){if(f.rings[e].hasZ()){return true}}return false}else{if(f instanceof giscloud.geometry.Multipolygon&&f.polygons!=null){for(e=0,c=f.polygons.length;e<c;e++){if(f.polygons[e].hasZ()){return true}}return false}else{if(f instanceof giscloud.geometry.GeometryCollection&&f.geometries!=null){for(e=0,c=f.geometries.length;e<c;e++){if(f.geometries[e].hasZ()){return true}}return false}else{return null}}}}}}}},toOGC:function(v,u){var c,t,e,A,z,x,r,q,o,h,g,f;c=function(k){return(u||k.z==null)?k.x+" "+k.y:k.x+" "+k.y+" "+k.z};t=function(k){return k.join()};e=function(k){return k.join()};try{if(v instanceof giscloud.geometry.Point&&v.x!=null&&v.y!=null){return"POINT ("+c(v)+")"}else{if(v instanceof giscloud.geometry.Multipoint&&v.points!=null){A=[];for(r=0,o=v.points.length;r<o;r++){A.push("("+c(v.points[r])+")")}return"MULTIPOINT ("+A.join()+")"}else{if(v instanceof giscloud.geometry.Line&&v.points!=null){A=[];for(r=0,o=v.points.length;r<o;r++){A.push(c(v.points[r]))}return"LINESTRING ("+t(A)+")"}else{if(v instanceof giscloud.geometry.Multiline&&v.lines!=null){A=[];for(r=0,o=v.lines.length;r<o;r++){z=[];for(q=0,h=v.lines[r].points.length;q<h;q++){z.push(c(v.lines[r].points[q]))}A.push("("+t(z)+")")}return"MULTILINESTRING ("+t(A)+")"}else{if(v instanceof giscloud.geometry.Polygon&&v.rings!=null){A=[];for(r=0,o=v.rings.length;r<o;r++){z=[];for(q=0,h=v.rings[r].points.length;q<h;q++){z.push(c(v.rings[r].points[q]))}z.push(c(v.rings[r].points[0]));A.push("("+t(z)+")")}return"POLYGON ("+e(A)+")"}else{if(v instanceof giscloud.geometry.Multipolygon&&v.polygons!=null){A=[];for(r=0,h=v.polygons.length;r<h;r++){z=[];for(q=0,g=v.polygons[r].rings.length;q<g;q++){x=[];for(o=0,f=v.polygons[r].rings[q].points.length;o<f;o++){x.push(c(v.polygons[r].rings[q].points[o]))}x.push(c(v.polygons[r].rings[q].points[0]));z.push("("+t(x)+")")}A.push("("+e(z)+")")}return"MULTIPOLYGON ("+A.join()+")"}else{if(v instanceof giscloud.geometry.GeometryCollection&&v.geometries!=null){A=[];for(r=0,h=v.geometries.length;r<h;r++){A.push(v.geometries[r].toOGC())}return"GEOMETRYCOLLECTION ("+A.join()+")"}else{return null}}}}}}}}catch(y){return null}},fromOGC:function(x){var v,q,A,o,h,r,c,k,n,t,e,f,z,u,g,B,y;A=/^([A-Z]+)\s?(\([A-Ze\d.,()\s\-]*\))$/;o=x&&x.match&&x.match(A);h=o&&o[1];r=o&&o[2]&&o[2].replace(/\s+/g," ").replace(/, /g,",");if(h==null||r==null){return null}if(h==="GEOMETRYCOLLECTION"){o=r.match(/([A-Z]+\s?\([\-\d.e,( )]*\))(?=\s?,|\s?\)\s?$)/g);if(o===null){return[]}c=[];for(v=0,q=o.length;v<q;v++){c.push(giscloud.geometry.fromOGC(o[v]))}return new giscloud.geometry.GeometryCollection(c)}r=r.replace(/([\d.e\-]+ [\d.e\-]+( [\d.e\-]+)?)/g,"[$1]");c=[];v=0;u=function(){var C,m=[""],D=0;while(true){v++;C=r[v];if(C==="]"){break}else{if(C===" "){m.push("");D++;if(D>2){throw"Error parsing wkt: invalid value"}}else{m[D]+=C}}}return(m.length===3)?[parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])]:[parseFloat(m[0]),parseFloat(m[1])]};z=function(){var C,m=[];while(v<r.length){v++;C=r[v];switch(C){case"(":m.push(z());break;case",":break;case")":return m;case"[":m.push(u());break;default:throw"Error parsing wkt: invalid structure"}}return m};k=o&&z();if(k.length<1){throw"Error parsing wkt: invalid geometry"}g=function(m){if(m.length!==2&&m.length!==3){throw"Error parsing wkt: invalid geometry"}return new giscloud.geometry.Point(m[0],m[1],m[2])};B=function(m,F){var E,D,C;if(m.length===0){throw"Error parsing wkt: invalid geometry"}E=[];for(D=0,C=m.length-(F?1:0);D<C;D++){E.push(g(m[D]))}return new giscloud.geometry.Line(E)};y=function(m){var E,D,C;if(m.length===0){throw"Error parsing wkt: invalid geometry"}E=[];for(D=0,C=m.length;D<C;D++){E.push(B(m[D],true))}return new giscloud.geometry.Polygon(E)};switch(h){case"POINT":if(k.length>1){throw"Error parsing wkt: invalid point geometry"}return g(k[0]);case"MULTIPOINT":t=[];for(v=0,q=k.length;v<q;v++){if(k[v].length===2){t.push(g(k[v]))}else{if(k[v].length===1){t.push(g(k[v][0]))}else{throw"Error parsing wkt: invalid geometry"}}}return new giscloud.geometry.Multipoint(t);case"LINESTRING":return B(k);case"MULTILINESTRING":e=[];for(v=0,q=k.length;v<q;v++){e.push(B(k[v]))}return new giscloud.geometry.Multiline(e);case"POLYGON":return y(k);case"MULTIPOLYGON":f=[];for(v=0,q=k.length;v<q;v++){f.push(y(k[v]))}return new giscloud.geometry.Multipolygon(f);default:throw"Error parsing wkt: unknown geometry type"}return n},fromGeoJSON:function(c){if(typeof c=="string"){c=JSON.parse(c)}switch(c.type){case"Point":return new giscloud.geometry.Point(c.coordinates[0],c.coordinates[1]);case"LineString":return new giscloud.geometry.Line($.map(c.coordinates,function(e){return new giscloud.geometry.Point(e[0],e[1])}));case"Polygon":return new giscloud.geometry.Polygon($.map(c.coordinates,function(e){return new giscloud.geometry.Line($.map(e,function(f){return new giscloud.geometry.Point(f[0],f[1])}))}));default:return null}}};a=function(){this.toOGC=function(){return giscloud.geometry.toOGC(this)};this.hasZ=function(){return giscloud.geometry.hasZ(this)}};giscloud.geometry.Point.prototype=new a();giscloud.geometry.Multipoint.prototype=new a();giscloud.geometry.Line.prototype=new a();giscloud.geometry.Multiline.prototype=new a();giscloud.geometry.Polygon.prototype=new a();giscloud.geometry.Multipolygon.prototype=new a();giscloud.geometry.GeometryCollection.prototype=new a()})();(function(c,e,a,f){giscloud.Color=function(q,u,k,n){var A,F,H,I,E,G,B,C,y,x,J,o,D,z,t,m;if(q!==f&&typeof q=="number"){if(q>255){A=255}else{if(q<0){A=0}else{A=Math.round(q)}}D=true;z=true;m=true}else{t=true}if(u!==f&&typeof u=="number"){if(u>255){F=255}else{if(u<0){F=0}else{F=Math.round(u)}}D=true;z=true;m=true}else{t=true}if(k!==f&&typeof k=="number"){if(k>255){H=255}else{if(k<0){H=0}else{H=Math.round(k)}}D=true;z=true;m=true}else{t=true}if(n!==f&&typeof n=="number"){if(n>100){I=100}else{if(n<0){I=0}else{I=Math.round(n)}}}else{I=0}D=true;z=true;m=true;this.hex=function(){var v=arguments[0],r=/^((#)|(0x))?([a-f0-9]{3}$)|([a-f0-9]{6}$)/i,g;if(v&&typeof v=="string"){if(v.match(r)){g=giscloud.Color.hexToRgb(v);A=g[0];F=g[1];H=g[2];D=true;z=true;m=true;return this}else{return giscloud.Color.rgbToHex(this.rgb(),v)}}else{return giscloud.Color.rgbToHex(this.rgb(),v)}};this.rgb=function(){var g,h;if(arguments.length>0){for(g=0;g<3;g++){h=arguments[g];if(h!==f&&h!==null&&typeof h=="number"){if(h>255){h=255}else{if(h<0){h=0}else{h=Math.round(h)}}switch(g){case 0:A=h;break;case 1:F=h;break;case 2:H=h;break}D=true;z=true;m=true}}return this}else{if(t){if(!D){h=giscloud.Color.hslToRgb(E,G,C)}else{if(!z){h=giscloud.Color.hsvToRgb(E,B,y)}else{if(!m){h=giscloud.Color.labToRgb(x,J,o)}}}A=h[0];F=h[1];H=h[2];t=false}return[A,F,H]}};this.hsl=function(g){var h,r;if(arguments.length===3){for(h=0;h<3;h++){r=arguments[h];if(r!==f&&r!==null&&typeof r=="number"){if(h===0){if(r>=360){r-=360}else{if(r<0){r+=360}else{r=Math.round(r)}}E=r}else{if(r>100){r=100}else{if(r<0){r=0}}if(h===1){G=r}else{C=r}}t=true;z=true;m=true}}D=false;return this}else{if(D){if(!t){r=giscloud.Color.rgbToHsl(A,F,H)}else{if(!z){r=giscloud.Color.hsvToHsl(E,B,y)}else{if(!m){r=giscloud.Color.labToHsl(x,J,o)}}}E=r[0];G=r[1];C=r[2];D=false}if(g){return[Math.round(E),Math.round(G),Math.round(C)]}else{return[E,G,C]}}};this.hsv=function(g){var h,r;if(arguments.length===3){for(h=0;h<3;h++){r=arguments[h];if(r!==f&&r!==null&&typeof r=="number"){if(h===0){if(r>=360){r-=360}else{if(r<0){r+=360}else{r=Math.round(r)}}E=r}else{if(r>100){r=100}else{if(r<0){r=0}}if(h===1){B=r}else{y=r}}t=true;D=true;m=true}}z=false;return this}else{if(z){if(!t){r=giscloud.Color.rgbToHsv(A,F,H)}else{if(!D){r=giscloud.Color.hslToHsv(E,G,C)}else{if(!m){r=giscloud.Color.labToRgb(x,J,o)}}}E=r[0];B=r[1];y=r[2];z=false}if(g){return[Math.round(E),Math.round(B),Math.round(y)]}else{return[E,B,y]}}};this.lab=function(g){var h,r;if(arguments.length===3){for(h=0;h<3;h++){r=arguments[h];if(r!==f&&r!==null&&typeof r=="number"){if(h===0){x=r}else{if(h===1){J=r}else{o=r}}t=true;D=true;z=true}}m=false;return this}else{if(m){if(!t){r=giscloud.Color.rgbToLab(A,F,H)}else{if(!D){r=giscloud.Color.hslToLab(E,G,C)}else{if(!z){r.giscloud.Color.hsvToLab(E,B,y)}}}x=r[0];J=r[1];o=r[2];m=false}if(g){return[Math.round(x),Math.round(J),Math.round(o)]}else{return[x,J,o]}}};this.alpha=function(g){if(g!==f&&typeof g=="number"){if(g>100){I=100}else{if(g<0){I=0}else{I=Math.round(g)}}}else{return I}};this.brighter=function(h){var g=this.hsl();h=h||20;return giscloud.Color.fromHsl(g[0],g[1],g[2]+h)};this.darker=function(h){var g=this.hsl();h=h||20;return giscloud.Color.fromHsl(g[0],g[1],g[2]-h)};this.clone=function(){var g=this.rgb();return new giscloud.Color(g[0],g[1],g[2],I)};this.equals=function(h){var g;if(h instanceof giscloud.Color){g=h.rgb();return A===g[0]&&F===g[1]&&H===g[2]&&I===h.alpha()}else{return false}}};giscloud.Color.fromRgb=function(m,k,h){return new giscloud.Color(m,k,h)};giscloud.Color.fromHsl=function(n,m,g){var k=new giscloud.Color();k.hsl(n,m,g);return k};giscloud.Color.fromHsv=function(n,m,g){var k=new giscloud.Color();k.hsv(n,m,g);return k};giscloud.Color.fromLab=function(k,h,g){var m=new giscloud.Color();m.lab(k,h,g);return m};giscloud.Color.fromHex=function(h){var g=giscloud.Color.hexToRgb(h);return g&&new giscloud.Color(g[0],g[1],g[2])};giscloud.Color.fromRgbString=function(h){var k=/^rgb\((\d+)[,\s]*(\d+)[,\s]*(\d+)\)$/i,g=h&&h.match&&h.match(k);if(g&&g.length===4){return new giscloud.Color(parseInt(g[1]),parseInt(g[2]),parseInt(g[3]))}else{return null}};giscloud.Color.fromString=function(g){return giscloud.Color.fromRgbString(g)||giscloud.Color.fromHex(g)};giscloud.Color.hexToRgb=function(q){var o,n,k,h;if(typeof q=="string"){h=q.match(/^(?:#|0x)?(?:([a-f0-9]{1,2})([a-f0-9]{1,2})([a-f0-9]{1,2}))$/i);if(h&&h.length===4){o=parseInt(h[1],16);n=parseInt(h[2],16);k=parseInt(h[3],16);return[o,n,k]}else{return null}}else{if(typeof q=="number"){o=(q&16711680)>>16;n=(q&65280)>>8;k=(q&255);return(!isNaN(o+n+k)&&[o,n,k])||null}}};giscloud.Color.rgbToHex=function(q,o,h,t){var m,k,n;if(q.length&&q.length===3){if(typeof o=="string"){t=o}o=q[1];h=q[2];q=q[0]}m=(q>15)?q.toString(16):"0"+q.toString(16);k=(o>15)?o.toString(16):"0"+o.toString(16);n=(h>15)?h.toString(16):"0"+h.toString(16);if(t===f||t===null){t="#"}return t+m+k+n};giscloud.Color.rgbToHsl=function(n,o,A){var k,u,x,q,y,v,z,t,B,m;if(n.length&&n.length===3){k=n[0]/255;u=n[1]/255;x=n[2]/255}else{k=n/255;u=o/255;x=A/255}q=Math.min(k,u,x);y=Math.max(k,u,x);v=y-q;z=y+q;m=z/2;if(v===0){t=0;B=0}else{switch(y){case k:t=(u-x)/v;break;case u:t=2+(x-k)/v;break;case x:t=4+(k-u)/v;break}t=Math.min(Math.round(t*60),360);t=(t<0)?t+360:t;if(m<=0.5){B=v/z}else{B=v/(2-z)}}return[t,B*100,m*100]};giscloud.Color.hslToRgb=function(x,q,z){var k,u,y,v,t,m,o,A,n;if(x.length&&x.length===3){o=x[0]/360;A=x[1]/100;n=x[2]/100}else{o=x/360;A=q/100;n=z/100}if(A===0){k=u=y=Math.round(n*255);return[k,u,y]}else{t=(n<0.5)?n*(1+A):n+A-n*A;v=2*n-t;m=function(r,h,g){var B;if(g<0){g=g+1}else{if(g>1){g=g-1}}if(6*g<1){B=r+(h-r)*6*g}else{if(2*g<1){B=h}else{if(3*g<2){B=r+(h-r)*(2/3-g)*6}else{B=r}}}return B};k=m(v,t,o+1/3);u=m(v,t,o);y=m(v,t,o-1/3);return[Math.round(k*255),Math.round(u*255),Math.round(y*255)]}};giscloud.Color.rgbToHsv=function(m,n,z){var k,t,x,o,y,u,q,B,A;if(m.length&&m.length===3){k=m[0];t=m[1];x=m[2]}else{k=m;t=n;x=z}o=Math.min(k,t,x);y=Math.max(k,t,x);u=y-o;if(y===0){B=0}else{B=u/y*100}if(u===0){q=0}else{switch(y){case k:q=(t-x)/u;break;case t:q=2+(x-k)/u;break;case x:q=4+(k-t)/u;break}q=Math.min(Math.round(q*60),360);q=(q<0)?q+360:q}A=y/255*100;return[q,B,A]};giscloud.Color.hsvToRgb=function(o,n,x){var r,k,g,A,z,m,B,y;if(o.length&&o.length===3){m=o[0];B=o[1]/100;y=o[2]/100}else{m=o;B=n/100;y=x/100}z=Math.floor(m/60)%6;r=m/60-Math.floor(m/60);k=Math.round(255*y*(1-B));g=Math.round(255*y*(1-(B*r)));A=Math.round(255*y*(1-(B*(1-r))));y=Math.round(255*y);switch(z){case 0:return[y,A,k];case 1:return[g,y,k];case 2:return[k,y,A];case 3:return[k,g,y];case 4:return[A,k,y];case 5:return[y,k,g]}};giscloud.Color.hslToHsv=function(k,o,q){var n,m,g;if(k.length&&k.length===3){n=k[0];m=k[1];g=k[2]}else{n=k;m=o;g=q}return giscloud.Color.rgbToHsv(giscloud.Color.hslToRgb(n,m,g))};giscloud.Color.hsvToHsl=function(k,o,q){var n,m,g;if(k.length&&k.length===3){n=k[0];m=k[1];g=k[2]}else{n=k;m=o;g=q}return giscloud.Color.rgbToHsl(giscloud.Color.hsvToRgb(n,m,g))};giscloud.Color.hsvToLab=function(k,o,q){var n,m,g;if(k.length&&k.length===3){n=k[0];m=k[1];g=k[2]}else{n=k;m=o;g=q}return giscloud.Color.rgbToLab(giscloud.Color.hsvToRgb(n,m,g))};giscloud.Color.hslToLab=function(k,o,q){var n,m,g;if(k.length&&k.length===3){n=k[0];m=k[1];g=k[2]}else{n=k;m=o;g=q}return giscloud.Color.rgbToLab(giscloud.Color.hslToRgb(n,m,g))};giscloud.Color.rgbToXyz=function(k,m,v){var h,n,t,u,q,o;if(k.length&&k.length===3){h=k[0]/255;n=k[1]/255;t=k[2]/255}else{h=k/255;n=m/255;t=v/255}if(h>0.04045){h=Math.pow((h+0.055)/1.055,2.4)}else{h=h/12.92}if(n>0.04045){n=Math.pow((n+0.055)/1.055,2.4)}else{n=n/12.92}if(t>0.04045){t=Math.pow((t+0.055)/1.055,2.4)}else{t=t/12.92}h=h*100;n=n*100;t=t*100;u=h*0.4124+n*0.3576+t*0.1805;q=h*0.2126+n*0.7152+t*0.0722;o=h*0.0193+n*0.1192+t*0.9505;return[u,q,o]};giscloud.Color.xyzToRgb=function(k,q,o){var n,m,h;if(k.length&&k.length===3){q=k[1]/100;o=k[2]/100;k=k[0]/100}else{k=k/100;q=q/100;o=o/100}n=k*3.2406+q*-1.5372+o*-0.4986;m=k*-0.9689+q*1.8758+o*0.0415;h=k*0.0557+q*-0.204+o*1.057;if(n>0.0031308){n=1.055*Math.pow(n,1/2.4)-0.055}else{n=12.92*n}if(m>0.0031308){m=1.055*Math.pow(m,1/2.4)-0.055}else{m=12.92*m}if(h>0.0031308){h=1.055*Math.pow(h,1/2.4)-0.055}else{h=12.92*h}n=n*255;m=m*255;h=h*255;return[n,m,h]};giscloud.Color.labToXyz=function(m,k,h){var g,o,n;if(m.length&&m.length===3){k=m[1];h=m[2];m=m[0]}o=(m+16)/116;g=k/500+o;n=o-h/200;if(o*o*o>0.008856){o=o*o*o}else{o=(o-16/116)/7.787}if(g*g*g>0.008856){g=g*g*g}else{g=(g-16/116)/7.787}if(n*n*n>0.008856){n=n*n*n}else{n=(n-16/116)/7.787}g=95.047*g;o=100*o;n=108.883*n;return[g,o,n]};giscloud.Color.xyzToLab=function(h,o,n){var m,k,g;if(h.length&&h.length===3){o=h[1];n=h[2];h=h[0]}h=h/95.047;o=o/100;n=n/108.883;if(h>0.008856){h=Math.pow(h,1/3)}else{h=(7.787*h)+(16/116)}if(o>0.008856){o=Math.pow(o,1/3)}else{o=(7.787*o)+(16/116)}if(n>0.008856){n=Math.pow(n,1/3)}else{n=(7.787*n)+(16/116)}m=(116*o)-16;k=500*(h-o);g=200*(o-n);return[m,k,g]};giscloud.Color.rgbToLab=function(n,m,h){var k=giscloud.Color.rgbToXyz(n,m,h);return giscloud.Color.xyzToLab(k)};giscloud.Color.labToRgb=function(k,h,g){var m=giscloud.Color.labToXyz(k,h,g);return giscloud.Color.xyzToRgb(m)};giscloud.Color.labToHsl=function(k,h,g){var m=giscloud.Color.labToXyz(k,h,g);return giscloud.Color.rgbToHsl(giscloud.Color.xyzToRgb(m))};giscloud.Color.labToHsl=function(k,h,g){var m=giscloud.Color.labToXyz(k,h,g);return giscloud.Color.rgbToHsv(giscloud.Color.xyzToRgb(m))};giscloud.Color.randomHue=function(g,h){return giscloud.Color.fromHsv(Math.round(Math.random()*360),g,h)};giscloud.Color.range=function(u,t,y,r){var o,g,n,x,z,k,h,q=[];if(u instanceof giscloud.Color&&t instanceof giscloud.Color&&y>=2){if(y===2){return[u.clone(),t.clone()]}else{d=[];k=(r||"hsl cw").match(/^((\w+)?\s)?(ccw$|cw$)/);if(k){r=k[2]||"hsl";h=k[3]}else{h="cw"}if(r==="rgb"){g=u.rgb();n=t.rgb();d=[(n[0]-g[0])/(y-1),(n[1]-g[1])/(y-1),(n[2]-g[2])/(y-1),(n[3]-g[3])/(y-1)]}else{if(r==="hsv"){g=u.hsv();n=t.hsv()}else{g=u.hsl();n=t.hsl()}if(h==="cw"){d=[(n[0]>=g[0])?(n[0]-g[0])/(y-1):(360-g[0]+n[0])/(y-1),(n[1]-g[1])/(y-1),(n[2]-g[2])/(y-1),(n[3]-g[3])/(y-1)]}else{d=[(n[0]<g[0])?(n[0]-g[0])/(y-1):(n[0]-g[0]-360)/(y-1),(n[1]-g[1])/(y-1),(n[2]-g[2])/(y-1),(n[3]-g[3])/(y-1)]}}g.push(u.alpha());n.push(t.alpha());z=[g[0],g[1],g[2],g[3]];for(o=0;o<y;o++){if(r==="rgb"){q.push(new giscloud.Color(z[0],z[1],z[2],z[3]))}else{if(r==="hsv"){x=new giscloud.Color.fromHsv(z[0],z[1],z[2]);x.alpha(z[3]);q.push(x.clone())}else{x=new giscloud.Color.fromHsl(z[0],z[1],z[2]);x.alpha(z[3]);q.push(x.clone())}}z[0]+=d[0];z[1]+=d[1];z[2]+=d[2];z[3]+=d[3]}return q}}else{return null}};giscloud.Color.hexNrToString=function(g,h){if(typeof g=="number"){return(h||"")+(16777216|g).toString(16).substr(1)}else{return null}};giscloud.Color.hexStringToNr=function(k,h){var g;if(typeof k=="string"&&k){h=h||"#";g=new RegExp("^(?:"+h+"|0x)?([a-f0-9]{3})([a-f0-9]{3})?$","i");return parseInt(k.replace(g,"$1$2"),16)}else{return NaN}}})(window,giscloud.exposeJQuery(),giscloud.common());(function(e,g,c,h){var a,f=new giscloud.Color(255,180,0);giscloud.FlagMarker=function(o,v,q,n){var t=v||"",x=q||"",m=(n&&n instanceof giscloud.Color)?n:f,u=(o&&o instanceof giscloud.LonLat)?o:null,k=true,r=function(){var A,z=this.sig,y;y=c.markers&&c.markers[z];if(z&&y){A=y.id;if(A!==h&&A!==null){y.m.remove(A)}if(k&&u){y.id=y.m.add(u.lon,u.lat,m.hex("0x"),t,x,null,y.open)}else{y.id=null}}};this.title=function(){var y;if(arguments.length>0){t=arguments[0];if(this.sig){y=c.markers[this.sig].id;if(y){c.markers[this.sig].m.setTitle(y,t)}}return this}else{return t}};this.content=function(){var y;if(arguments.length>0){x=arguments[0];if(this.sig){y=c.markers[this.sig].id;if(y){c.markers[this.sig].m.setContent(y,x)}}return this}else{return x}};this.color=function(){var y=arguments[0];if(arguments.length>0){if(y&&y instanceof giscloud.Color&&!y.equals(m)){m=(y)?y:f;r.call(this)}return this}else{return m}};this.visible=function(y){if(arguments.length>0){if(y!==k){k=!!y;r.call(this)}return this}else{return k}};this.position=function(){var y=arguments[0];if(arguments.length>0){if(y&&!y.equals(u)){u=(y instanceof giscloud.LonLat)?y:null;r.call(this)}return this}else{return u}}};giscloud.Marker=function(k,m){var n;m=m||{};n={location:k||null,title:m.title==null?null:m.title,content:m.content==null?null:m.content,visible:m.visible===false?false:true,icon:m.icon||null,popup:m.popup===true?true:false,color:m.color||f.clone(),marker:this};this.title=a.call(this,n,"title");this.content=a.call(this,n,"content");this.location=a.call(this,n,"location");this.visible=a.call(this,n,"visible");this.popup=a.call(this,n,"popup");this.icon=a.call(this,n,"icon")};a=function(n,o,k){var m=this;return function(t,r){var q;if(t===h){return n[o]}else{if(k&&!k(t)){throw {msg:"Invalid value for "+(o||"???"),target:m}}else{q=n[o];n[o]=t;if(!r){g(m).triggerHandler("stateChanged",[{property:o,oldValue:q,newValue:t,state:n}])}return m}}}}})(window,giscloud.exposeJQuery(),giscloud.common());(function(c,a){giscloud.resources={byId:function(k,f,h){var e="resources/"+k,g=new c.Deferred();f=f||{};if(typeof f==="function"){h=f;f=null}else{h=h||f.callback}a.rest.get(e,f).done(function(){var o=arguments[0],n;try{n=o;if(typeof h=="function"){h(n)}g.resolve(n)}catch(m){g.reject()}}).fail(function(){g.reject()});return g.promise()},update:function(h,g){var e=new c.Deferred(),f=this;if(h==null){return this.create(g)}a.rest.call("PUT","resources/"+h,JSON.stringify(g),"application/json").done(function(){e.resolveWith(f)}).fail(function(){e.rejectWith(f,arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(h,f){if(!giscloud.oauth2||giscloud.oauth2.thisIsOauthFrame()){return}var k,n,e,g,c,m,a;k=h.address;e={};m={};a={};c=h({});n=new h.Deferred();k.init(function(o){h.extend(m,o.parameters);for(p in m){if(m.hasOwnProperty(p)){m[p]=unescape(m[p])}}n.resolve()});k.externalChange(function(A){var v,t,o,u,y,x,r,q,z;r=function(C,B){return h.map(B,function(E,D){if(C[D]===f){return D}else{return null}})};q=function(C,B){return r(B,C)};z=function(C,B){return h.map(B,function(E,D){if(C[D]!==E){C[D]=E;return D}else{return null}})};a=A.parameters;for(o in a){if(a.hasOwnProperty(o)){a[o]=unescape(a[o])}}y=r(m,a);x=q(m,a);for(v=0,t=y.length;v<t;v++){m[y[v]]=unescape(a[y[v]])}for(v=0,t=x.length;v<t;v++){delete m[x[v]]}u=z(m,a);for(v=0,t=y.length;v<t;v++){o=y[v];c.triggerHandler(o,[{type:"add",param:o,value:giscloud.address.param(o)}])}for(v=0,t=x.length;v<t;v++){o=x[v];c.triggerHandler(o,[{type:"remove",param:o}])}for(v=0,t=u.length;v<t;v++){o=u[v];c.triggerHandler(o,[{type:"change",param:o,value:giscloud.address.param(o)}])}});giscloud.address={registerParam:function(o){if(e[o.name]){throw {msg:"Param by that name already exists",data:o}}e[o.name]={name:o.name,query:o.query||o.name,serialize:o.serialize,deserialize:o.deserialize};if(o.onChange){this.change(o.name,o.onChange)}this.param(o.name,k.parameter(o.query));return this},param:function(r,q){var t,o=e[r];if(q===f){t=m[r];if(t==null){return null}else{if(o&&o.deserialize){return o.deserialize(unescape(t))}else{return unescape(t)}}}else{if(o&&o.serialize){t=o.serialize(q)}else{t=(typeof q==="string")?q:q.toString()}m[r]=t;k.parameter(r,t);return this}},change:function(q,o){c.on(q,o)},init:n.promise()}}(giscloud.exposeJQuery()));(function(c,a){giscloud.addressmodels={list:function(f){var e="addressmodels.json",g=new c.Deferred();a.rest.get(e,f).done(function(h){if(h&&h.data&&h.data.length>0){var k=0;for(k;k<h.data.length;k++){h.data[k].definition=JSON.decode(h.data[k].definition)}}g.resolve(h)}).fail(function(){g.reject()});return g.promise()},create:function(g,h){var f="addressmodels.json",e=new c.Deferred(),k={name:g,definition:(typeof h==="string")?h:JSON.stringify(h)};a.rest.call("post",f,k,"application/json").done(function(m,n){e.resolve(n&&n.match&&n.match(/addressmodels\/(\d+)/)[1])}).fail(function(){e.reject()});return e.promise()},update:function(f,h,k){var g="addressmodels/"+f+".json",e=new c.Deferred(),m={name:h,definition:(typeof k==="string")?k:JSON.stringify(k)};a.rest.call("put",g,m,"application/json").then(e.resolve,e.reject);return e.promise()},remove:function(g){var e=new c.Deferred(),f=this;a.rest.call("DELETE","addressmodels/"+g).done(function(){e.resolveWith(f)}).fail(function(){e.rejectWith(f,arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(a){giscloud.Queue=function(o){var m=0,c=o.slice(),x=(this===giscloud)?{}:this,f=new a.Deferred(),v=[],n=[],q=[],u=null,k={},z=function(){return k},e=Array.prototype.slice;function t(){f.resolveWith(x,[q,n])}function h(){f.rejectWith(x,[q])}function y(){n.push(e.apply(arguments));q=n[n.length-1]}function r(){f.notifyWith(x,(u!=null)?[u].concat(n[m-1]):n[m-1])}function g(){var E=a.isArray(c[m].params)?q.concat(c[m].params):q,B=a.isFunction(c[m])?c[m]:c[m].func,A=a.isFunction(c[m])?x:c[m].context,D=a.isFunction(c[m])?null:c[m].msg,C=B.apply(A,E);if(C===k){t()}else{v.push(C);m++;u=D;C.always(y,r).done(g).fail(h)}}c.push(z);g();x.results=function(){return n};x.promises=function(){return v};return f.promise(x)}}(giscloud.exposeJQuery()));(function(c,e,a,f){giscloud.maps={list:function(h,m){var g="maps",k=new e.Deferred();if(typeof h==="function"){m=h;h=null}else{m=m||(h&&h.callback)}a.rest.get(g,h).done(function(){var n=arguments[0],q=[];try{e.each(n.data,function(){q.push(new giscloud.Map(this))});if(typeof m=="function"){m(q)}k.resolve(q)}catch(o){k.reject()}}).fail(function(){k.reject()});return k.promise()},byId:function(o,h,n,m){var g="maps/"+o,k=new e.Deferred();if(typeof h==="function"){n=h;h=null}else{n=n||(h&&h.callback)}a.rest.get(g,h).done(function(){var r=arguments[0],t;try{t=m?r:new giscloud.Map(r);if(typeof n=="function"){n(t)}k.resolve(t)}catch(q){k.reject()}}).fail(function(){k.reject()});return k.promise()},remove:function(g){return a.rest.call("DELETE","maps/"+g)},update:function(h,g){return a.rest.call("PUT","maps/"+h,a.toXml("map",g),"text/xml")},create:function(h){var g=new e.Deferred();a.rest.call("post","maps/",a.toXml("map",h),"text/xml").fail(g.reject).done(function(o,n){var k=n&&n.match(/maps\/(\d+)/);if(k&&k[1]!=null){g.resolve(k[1])}else{g.reject()}});return g.promise()},users:function(n){var h,g,k,m={owner:null,editors:[],viewers:[]};g=a.rest.get("maps/"+n,{expand:"owner"}).done(function(o){m.owner={id:o.owner.id,username:o.owner.username}});k=a.rest.get("maps/"+n+"/sharing").done(function(o){if(o&&o.data&&o.data.length){e.each(o.data,function(q,r){if(r.view==="t"){m.viewers.push({id:r.user_id,username:r.username})}if(r.edit==="t"){m.editors.push({id:r.user_id,username:r.username})}})}});h=e.when(g,k);return h.pipe(function(){return m}).promise()},reset:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("DELETE","map_cache/"+m+"/2/",k?{layers:k.join()}:null).done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()}}})(window,window.giscloud.exposeJQuery(),window.giscloud.common());(function(c,e,a,f){giscloud.layers={list:function(h,m){var g="layers",k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h=null}else{m=m||h.callback}a.rest.get(g,h).done(function(){var n=arguments[0],q=[];try{e.each(n.data,function(){q.push(new giscloud.Layer(this))});if(typeof m=="function"){m(q)}k.resolve(q)}catch(o){k.reject()}}).fail(function(){k.reject()});return k.promise()},byId:function(n,h,m){var g="layers/"+n,k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h=null}else{m=m||h.callback}a.rest.get(g,h).done(function(){var r=arguments[0],o;try{o=new giscloud.Layer(r);if(typeof m=="function"){m(o)}k.resolve(o)}catch(q){k.reject()}}).fail(function(){k.reject()});return k.promise()},byMapId:function(k,h,n){var g="maps/"+k+"/layers",m=new e.Deferred();h=h||{};if(typeof h==="function"){n=h;h=null}else{n=n||h.callback}a.rest.get(g,h).done(function(){var o=arguments[0],r=[];try{e.each(o.data,function(){r.push(new giscloud.Layer(this))});if(typeof n=="function"){n(r)}m.resolve(r)}catch(q){m.reject()}}).fail(function(){m.reject()});return m.promise()},remove:function(k){var g=new e.Deferred(),h=this;a.rest.call("DELETE","layers/"+k).done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},update:function(m,k){var g=new e.Deferred(),h=this;if(m==null){return this.create(k)}a.rest.call("PUT","layers/"+m,JSON.stringify(k),"application/json").done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},create:function(k){var g=new e.Deferred(),h=this;delete k.id;delete k.modified;delete k.created;delete k.accessed;a.rest.call("POST","layers/",JSON.stringify(k),"application/json").done(function(q,o){var n=o&&o.match(/layers\/(\d+)/);g.resolveWith(h,[n&&n[1]])}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},reset:function(h,k){var g=new e.Deferred(),m=this;a.rest.call("DELETE","map_cache/"+h+"/2?layers="+k.join()).done(function(){g.resolveWith(m)}).fail(function(){g.rejectWith(m,arguments)});return g.promise()},render:function(n,m,k,g){var h=a.rest.url()+"layers/"+n+"/render."+m+"?invalidate=true";if(k&&g){h+="&width="+k+"&height="+g}return h},"export":function(m,k,h){var g=a.rest.url()+"layers/"+m+"/export."+k;if(h){g+=".zip"}return g},attributeOps:{distinct:function(g,m,k){var h="layers/"+g+"/attributeops/distinct.json";k=k||{perpage:10,page:1};k.attribute=m;return a.rest.get(h,k).pipe(function(n){return n},function(){return null}).promise()}}}})(window,window.giscloud.exposeJQuery(),window.giscloud.common());(function(e,f,c,g){function a(n){var k,m,h={};for(m in n){if(n.hasOwnProperty(m)){k=m.replace(".","\\.");h[k]=n[m]}}return h}giscloud.features={byLayer:function(h,m,o){var k="layers/"+h+"/features",n=new f.Deferred();m=m||{};if(typeof m==="function"){o=m;m=null}else{o=o||m.callback}c.rest.get(k,m).done(function(u){var q=u,r=[];try{f.each(q.data,function(){this.layerId=h;r.push(new giscloud.Feature(this))});if(typeof o=="function"){o(r)}n.resolve(r)}catch(t){n.reject()}}).fail(function(){n.reject()});return n.promise()},byId:function(h,o,m,q){var k="layers/"+h+"/features/"+o,n=new f.Deferred();m=m||{};if(typeof m==="function"){q=m;m=null}else{q=q||m.callback}c.rest.get(k,m).done(function(v){var u=v,r;u.layerId=h;try{r=new giscloud.Feature(u);if(typeof q=="function"){q(r)}n.resolve(r)}catch(t){n.reject()}}).fail(function(){n.reject()});return n.promise()},byBounds:function(h,n,m,q){var k="layers/"+h+"/features",o=new f.Deferred();m=m||{};if(typeof m==="function"){q=m;m={}}else{q=q||m.callback}m.bounds=n.toString();c.rest.get(k,m).done(function(v){var r=v,t=[];try{f.each(r.data,function(){this.layerId=h;t.push(new giscloud.Feature(this))});if(typeof q=="function"){q(t)}o.resolve(t)}catch(u){o.reject()}}).fail(function(){o.reject()});return o.promise()},remove:function(h,n){var k=new f.Deferred(),m=this;c.rest.call("DELETE","layers/"+h+"/features/"+n).done(function(){k.resolveWith(m)}).fail(function(){k.rejectWith(m,arguments)});return k.promise()},update:function(h,r,q,n){var k=new f.Deferred(),o=this,m;if(q&&q.geometry){if(q.geometry.toOGC){q.geometry=q.geometry.toOGC()}}if(r==null){return this.create(h,q,n)}m="layers/"+h+"/features/"+r;if(n){m+="?"+f.map(n,function(u,t){return t+"="+u}).join("&")}c.rest.call("PUT",m,JSON.stringify(q),"application/json").done(function(){k.resolveWith(o,[r])}).fail(function(){k.rejectWith(o,arguments)});return k.promise()},create:function(h,q,n){var k=new f.Deferred(),o=this,m="layers/"+h+"/features/";if(n){m+="?"+f.map(n,function(t,r){return r+"="+t}).join("&")}c.rest.call("post",m,JSON.stringify(q),"application/json").done(function(v,t,u){var x=t||u.getResponseHeader("Location"),r=x&&x.match(/features\/(\d+)/);k.resolveWith(o,[r&&r[1]])}).fail(function(){k.rejectWith(o,arguments)});return k.promise()},email:function(k){var h="layers/"+k.layer_id+"/features/email",n=new f.Deferred(),m=this;if(!k||!k.layer_id||!k.feature_ids||(!k.usernames&&!k.emails)){return n.reject()}k.feature_ids=(jQuery.type(k.feature_ids)=="array")?k.feature_ids.join():k.feature_ids;k.usernames=(jQuery.type(k.usernames)=="array")?k.usernames.join():k.usernames;k.emails=(jQuery.type(k.emails)=="array")?k.emails.join():k.emails;c.rest.get(h,k).done(function(o){n.resolve()}).fail(function(o){var q=f.parseJSON(o.responseText);n.rejectWith(m,[o,q])});return n.promise()}}}(window,window.giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a,e){giscloud.search={features:function(m,f,g,h,n){var k;h=h||{};if(typeof h==="function"){n=h;h=null}else{n=n||h.callback}h.query=m;h.fields=f&&f.toString();if(g){if(g instanceof giscloud.LonLat){h.x=g.lon;h.y=g.lat}else{if(g.x!=null&&g.y!=null){h.x=g.x;h.y=g.y}}}k=new c.Deferred();a.rest.get("search",h).done(function(o){var q=[];try{c.each(o.data,function(){q.push(new giscloud.Feature(this))});k.resolve(q)}catch(r){k.reject()}}).fail(function(){k.reject()});if(n){k.done(n)}return k.promise()}}}(giscloud.exposeJQuery(),giscloud.common()));(function(g,k){var a,f,e,h=["id","created","lastlog","modified","username","file_feature_count","db_feature_count","feature_count_limit","storage_raster","storage_raster_limit","subscriptions","resource"],c=["created","lastlog","modified"],m=["language",{field:"firstname",alias:"firstName"},{field:"lastname",alias:"lastName"},"active","email","info","phone","mobile","company",{field:"web",alias:"website"},"roles","options"];giscloud.User=function(o){var q,n,r;for(q=0,n=h.length;q<n;q++){r=h[q];this[r.alias||r]=a(r.field||r,o)}for(q=0,n=m.length;q<n;q++){r=m[q];this[r.alias||r]=f(r.field||r,o)}for(q=0,n=c.length;q<n;q++){r=c[q];o[r.field||r]=e(o[r.field||r])}};giscloud.User.prototype={update:function(){var o,n,r,q;q={};for(o=0,n=m.length;o<n;o++){r=m[o];q[r.field||r]=this[r.alias||r]()}return giscloud.users.update(this.id(),q)},remove:function(){return giscloud.users.remove(this.id())},unsubscribe:function(n){return giscloud.users.unsubscribe(this.id(),n)},optionByName:function(n,o){return giscloud.options.byName(this.id(),n,o)}};e=function(o){var n=new Date(o*1000);if(n&&!isNaN(n.getTime())){return n}else{return o}};a=function(o,n){return function(){return n[o]}};f=function(q,n,o){return function(r){if(r!==k){n[q]=r;return o}else{return n[q]}}}}(giscloud.exposeJQuery()));(function(c,e,a,f){giscloud.users={list:function(h,m){var g="users",k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}h.expand="roles, options";a.rest.get(g,h).done(function(o){var q,n,t=[];try{for(q=0,n=o.data.length;q<n;q++){if(o.data[q].options&&o.data[q].options.length){o.data[q]._options={};e.each(o.data[q].options,function(v,u){o.data[v]._options[u.name]=u.value});o.data[q].options=o.data[q]._options;delete o.data[q]._options}else{o.data[q].options=null}t.push(new giscloud.User(o.data[q]))}if(typeof m=="function"){m(t)}k.resolve(t)}catch(r){k.reject()}}).fail(function(){k.reject()});return k.promise()},byId:function(n,h,m){var g="users/"+n,k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}h.expand="roles,options,subscriptions,resource";a.rest.get(g,h).done(function(q){var o;try{if(q.options&&q.options.length){q._options={};e.each(q.options,function(u,t){q._options[t.name]=t.value});q.options=q._options;delete q._options}else{q.options=null}o=new giscloud.User(q);if(typeof m=="function"){m(o)}k.resolve(o)}catch(r){k.reject()}}).fail(function(){k.reject()});return k.promise()},current:function(h,m){var g="users/current",k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}h.expand="roles,options";a.rest.get(g,h).done(function(o){var n;try{if(o.options&&o.options.length){o._options={};e.each(o.options,function(t,r){o._options[r.name]=r.value});o.options=o._options;delete o._options}else{o.options=null}n=new giscloud.User(o);if(typeof m=="function"){m(n)}k.resolve(n)}catch(q){k.reject()}}).fail(function(){k.reject()});return k.promise()},remove:function(k){var g=new e.Deferred(),h=this;a.rest.call("DELETE","users/"+k).done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},unsubscribe:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("DELETE","users/"+m+"/subscriptions/"+k).done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},update:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("PUT","users/"+m,JSON.stringify(k),"application/json").done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},create:function(k){var g=new e.Deferred(),h=this;a.rest.call("post","users/",JSON.stringify(k),"application/json").done(function(q,o){var n=o&&o.match(/users\/(\d+)/);g.resolveWith(h,[n&&n[1]])}).fail(function(){g.rejectWith(h,arguments)});return g.promise()}}}(window,giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.userOptions={userId:function(){return"current"},list:function(){var e="users/"+this.userId()+"/options.json";return a.rest.get(e).pipe(function(f){return f.data})},byId:function(f){var e="users/"+this.userId()+"/options/"+f+".json";return a.rest.get(e).promise()},byName:function(e){return this.byId(e)},create:function(f,h){var e="users/"+this.userId()+"/options.json",g={name:f,value:h||null};return a.rest.call("post",e,g,"application/json").pipe(function(k,m){return m&&m.match&&m.match(/options\/(\d+)/)[1]})},update:function(e,g,k){var f="users/"+this.userId()+"/options/"+e+".json",h={name:(typeof k==="undefined")?e:g,value:(typeof k==="undefined")?g:k};return a.rest.call("put",f,h,"application/json").promise()},remove:function(f){var e="users/"+this.userId()+"/options/"+f+".json";return a.rest.call("DELETE",e).promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.keys={add:function(h){var f="keys.json",e=new c.Deferred(),g="";if(h!=null&&typeof h==="string"){g=JSON.encode({key_desc:h})}a.rest.call("post",f,g,"application/json",true).done(function(k,m){e.resolve({id:m&&m.match&&m.match(/keys\/(\d+)/)[1],key:k.value})}).fail(function(){e.reject()});return e.promise()},remove:function(g){var e=new c.Deferred(),f=this;a.rest.call("DELETE","keys/"+g).done(function(){e.resolveWith(f)}).fail(function(){e.rejectWith(f,arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,e,a,f){giscloud.plans={list:function(h,m){var g="plans",k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}a.rest.get(g,h).done(function(o){var q,n,t=[];try{for(q=0,n=o.data.length;q<n;q++){if(o.data[q].options&&o.data[q].options.length){o.data[q]._options={};e.each(o.data[q].options,function(v,u){o.data[v]._options[u.name]=u.value});o.data[q].options=o.data[q]._options;delete o.data[q]._options}else{o.data[q].options=null}t.push(o.data[q])}if(typeof m=="function"){m(t)}k.resolve(t)}catch(r){k.reject()}}).fail(function(){k.reject()});return k.promise()},create:function(h){var g=new e.Deferred();a.rest.call("post","plans",h,"application/json").done(function(o,n){var k=n&&n.match(/plans\/(\w+)/);g.resolve([k&&k[1]])}).fail(function(){g.reject(arguments)});return g.promise()},remove:function(h){var g=new e.Deferred();a.rest.call("DELETE","plans/"+h).done(function(){g.resolve()}).fail(function(){g.reject()});return g.promise()},update:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("PUT","plans/"+m,JSON.stringify(k),"application/json").done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},byId:function(n,h,m){var g="plans/"+n,k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}a.rest.get(g,h).done(function(o){var r;try{if(o.options&&o.options.length){o._options={};e.each(o.options,function(u,t){o._options[t.name]=t.value});o.options=o._options;delete o._options}else{o.options=null}r=o;if(typeof m=="function"){m(r)}k.resolve(r)}catch(q){k.reject()}}).fail(function(){k.reject()});return k.promise()}}}(window,giscloud.exposeJQuery(),window.giscloud.common()));(function(c,e,a,f){giscloud.appinstances={list:function(h,m){var g="appinstances",k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}a.rest.get(g,h).done(function(q){var r,o,n=[];try{for(r=0,o=q.data.length;r<o;r++){n.push(q.data[r])}if(typeof m=="function"){m(n)}k.resolve(n)}catch(t){k.reject()}}).fail(function(){k.reject()});return k.promise()},create:function(h){var g=new e.Deferred();a.rest.call("post","appinstances",h,"application/json").done(function(o,n){var k=n&&n.match(/appinstances\/(\w+)/);g.resolve([k&&k[1]])}).fail(function(){g.reject(arguments)});return g.promise()},remove:function(h){var g=new e.Deferred();a.rest.call("DELETE","appinstances/"+h).done(function(){g.resolve()}).fail(function(){g.reject()});return g.promise()},update:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("PUT","appinstances/"+m,JSON.stringify(k),"application/json").done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},byId:function(n,h,m){var g="appinstances/"+n,k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}a.rest.get(g,h).done(function(o){var r;try{r=o;if(typeof m=="function"){m(r)}k.resolve(r)}catch(q){k.reject()}}).fail(function(){k.reject()});return k.promise()}}}(window,giscloud.exposeJQuery(),window.giscloud.common()));(function(c,e,a,f){giscloud.announcements={list:function(h,m){var g="announcements",k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}a.rest.get(g,h).done(function(o){var q,n,t=[];try{if(typeof m=="function"){m(t)}k.resolve(o)}catch(r){k.reject()}}).fail(function(){k.reject()});return k.promise()},create:function(h){var g=new e.Deferred();a.rest.call("post","announcements",h,"application/json").done(function(o,n){var k=n&&n.match(/announcements\/(\w+)/);g.resolve([k&&k[1]])}).fail(function(){g.reject(arguments)});return g.promise()},remove:function(h){var g=new e.Deferred();a.rest.call("DELETE","announcements/"+h).done(function(){g.resolve()}).fail(function(){g.reject()});return g.promise()},update:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("PUT","announcements/"+m,JSON.stringify(k),"application/json").done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},byId:function(n,h,m){var g="announcements/"+n,k=new e.Deferred();h=h||{};if(typeof h==="function"){m=h;h={}}else{m=m||h.callback}a.rest.get(g,h).done(function(o){var q;try{q=o;if(typeof m=="function"){m(q)}k.resolve(q)}catch(r){k.reject()}}).fail(function(){k.reject()});return k.promise()}}}(window,giscloud.exposeJQuery(),window.giscloud.common()));(function(c,e,a,f){giscloud.plansubscriptions={remove:function(k){var g=new e.Deferred(),h=this;a.rest.call("DELETE","plansubscriptions/"+k).done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},create:function(k){var g=new e.Deferred(),h=this;a.rest.call("post","plansubscriptions/",JSON.stringify(k),"application/json").done(function(q,o){var n=o&&o.match(/plansubscriptions\/(\d+)/);g.resolveWith(h,[n&&n[1]])}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},update:function(m,k){var g=new e.Deferred(),h=this;a.rest.call("PUT","plansubscriptions/"+m,JSON.stringify(k),"application/json").done(function(){g.resolveWith(h)}).fail(function(){g.rejectWith(h,arguments)});return g.promise()},}}(window,giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.forms={byId:function(f,e){return a.rest.get("forms/"+f+".json",e||{}).then(function(g){return g})},byLayerAndId:function(e,g,f){return a.rest.get("layers/"+e+"/forms/"+g+".json",f||{}).then(function(h){return h})},create:function(g,h){var f="forms.json",e=new c.Deferred(),k={name:g,definition:(typeof h==="string")?h:JSON.stringify(h)};a.rest.call("post",f,k,"application/json").done(function(m,n){e.resolve(n&&n.match&&n.match(/forms\/(\d+)/)[1])}).fail(function(){e.reject()});return e.promise()},update:function(m,g,h){var f="forms/"+m+".json",e=new c.Deferred(),k={name:g,definition:(typeof h==="string")?h:JSON.stringify(h)};a.rest.call("put",f,k,"application/json").then(e.resolve,e.reject);return e.promise()},setLayerMappings:function(e,k,m){var g="layers/"+e+"/forms/"+k+".json",f=new c.Deferred(),h={};if(m!=null){h.mappings=m}a.rest.call("put",g,h,"application/json").done(function(){f.resolve()}).fail(function(){f.reject()});return f.promise()},remove:function(g){var e=new c.Deferred(),f=this;a.rest.call("DELETE","forms/"+g).done(function(){e.resolveWith(f)}).fail(function(){e.rejectWith(f,arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.tables={list:function(f){var e="tables",g=new c.Deferred();a.rest.get(e,f).done(function(h){g.resolve(h)}).fail(function(){g.reject()});return g.promise()},byName:function(f){var e="tables/"+f,g=new c.Deferred();a.rest.get(e).done(function(h){g.resolve(h)}).fail(function(){g.reject()});return g.promise()},remove:function(f){var e=new c.Deferred();a.rest.call("DELETE","tables/"+f).done(function(){e.resolve()}).fail(function(){e.reject()});return e.promise()},create:function(f){var e=new c.Deferred();if(!f){return}if(f.geometry==="line"||f.geometry==="LINE"){f.geometry="LINESTRING"}a.rest.call("post","tables",a.toXml("table",f),"text/xml").done(function(k,h){var g=h&&h.match(/tables\/(\w+)/);e.resolve([g&&g[1]])}).fail(function(){e.reject(arguments)});return e.promise()},join:function(f,o,u,q,e,m,v){var h=new c.Deferred(),x=f.table||f,n=o.table||o,r=!!f.readOnly,t=!!o.readOnly,g="tables/"+x+"/join.json",k={table:n,name:u,on:q,id_fields:e,source_read_only:r,target_read_only:t};if(m&&c.isArray(m.source)&&c.isArray(m.target)){k.fields=m}if(typeof v==="string"){k.join_type=v}a.rest.get(g,k,"application/json").done(function(B,A,C){var z=C.getResponseHeader("Location"),y=z&&z.match(/tables\/(\w+)/);h.resolve([y&&y[1]])}).fail(function(){h.reject(arguments)});return h.promise()},query:function(f,h){var e="tables/"+f+"/query.json?orm="+h.toString(),g=new c.Deferred();a.rest.get(e).done(function(k){g.resolve(k)}).fail(function(){g.reject()});return g.promise()},}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.bookmarks={list:function(f){var e="bookmarks",g=new c.Deferred();a.rest.get(e,f).done(function(h){g.resolve(h)}).fail(function(){g.reject()});return g.promise()},byMapId:function(g,f,k){var e="maps/"+g+"/bookmarks",h=new c.Deferred();a.rest.get(e,f).done(function(m){h.resolve(m)}).fail(function(){h.reject()});return h.promise()},remove:function(f){var e=new c.Deferred();a.rest.call("DELETE","bookmarks/"+f).done(function(){e.resolve()}).fail(function(){e.reject()});return e.promise()},create:function(f){var e=new c.Deferred();if(!f){return}a.rest.call("post","bookmarks",a.toXml("bookmark",f),"text/xml").done(function(k,h){var g=h&&h.match(/bookmarks\/(\w+)/);e.resolve([g&&g[1]])}).fail(function(){e.reject(arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.organizations={list:function(f){var e="organizations",g=new c.Deferred();a.rest.get(e,f).done(function(h){g.resolve(h)}).fail(function(){g.reject()});return g.promise()},byId:function(k,f,h){var e="/organizations/"+k,g=new c.Deferred();a.rest.get(e,f).done(function(m){g.resolve(m)}).fail(function(){g.reject()});return g.promise()},remove:function(f){var e=new c.Deferred();a.rest.call("DELETE","organizations/"+f).done(function(){e.resolve()}).fail(function(){e.reject()});return e.promise()},create:function(f){var e=new c.Deferred();if(!f){return}a.rest.call("post","organizations",a.toXml("organization",f),"text/xml").done(function(k,h){var g=h&&h.match(/organizations\/(\w+)/);e.resolve([g&&g[1]])}).fail(function(){e.reject(arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,e,a,f){giscloud.tasks={list:function(g){g=g||{};return a.rest.get("tasks",g).pipe(function(h){if(h&&h.data){if(h.data.length===0){return[]}return e.map(h.data,function(k){return new giscloud.Task(k)})}return null},function(){return null}).promise()},byType:function(h,g){g=g||{};g.type=h;return this.list(g)},byId:function(k,h){var g="tasks/"+k;h=h||{};return a.rest.get(g,h).pipe(function(n){try{return new giscloud.Task(n)}catch(m){return null}},function(){return null}).promise()},remove:function(g){return a.rest.call("DELETE","tasks/"+g).pipe(function(){return null},function(){return null}).promise()},create:function(k,h){var g="tasks/";if(h){g+="?"+e.map(h,function(n,m){return m+"="+n}).join("&")}if(k.id!=null){delete k.id}return a.rest.call("post",g,JSON.stringify(k),"application/json").pipe(function(r,o,q){var t=o||q.getResponseHeader("Location"),n=t&&t.match(/tasks\/(\d+)/);return n&&n[1]},function(){return null}).promise()}}}(window,window.giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.permissions={READ:"READ",EDIT:"EDIT",EDIT_MOBILE:"EDIT_MOBILE",EDIT_WITH_SHARE:"EDIT_WITH_SHARE"}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a,e){giscloud.Query=function(f){this.table=f;this.actions=[]};giscloud.Query.prototype={where:function(g,f,h){this.actions.push(["where",[g,f,h]]);return this},equalTo:function(f,g){return this.where(f,"=",g)},notEqualTo:function(f,g){return this.where(f,"<>",g)},greaterThan:function(f,g){return this.where(f,">",g)},greaterThanOrEqualTo:function(f,g){return this.where(f,">=",g)},lessThan:function(f,g){return this.where(f,"<",g)},lessThanOrEqualTo:function(f,g){return this.where(f,"<=",g)},limit:function(f){this.actions.push(["limit",[f]]);return this},offset:function(f){this.actions.push(["offset",[f]]);return this},ascending:function(f){this.actions.push(["order_by",[f,"ASC"]]);return this},descending:function(f){this.actions.push(["order_by",[f,"DESC"]]);return this},find:function(){this.promise=giscloud.tables.query(this.table,this.toString());return this},first:function(){this.actions.push(["find"]);this.promise=giscloud.tables.query(this.table,this.toString());return this},count:function(){this.actions.push(["count_all"]);this.promise=giscloud.tables.query(this.table,this.toString());return this},done:function(f){return this.promise.done(f)},each:function(f){return this.promise.done(function(g){c.each(g.data,f)})},toString:function(){return JSON.stringify(this.actions)}}})(giscloud.exposeJQuery(),giscloud.common());(function(c,a){giscloud.options={list:function(f){var e;f=f||{};if(f.resource&&f.id){e=f.resource+"/"+f.id+"/options";delete f.resource;delete f.id}else{e="options"}return a.rest.get(e,f).promise()},byId:function(k,f,h){var e="options/"+k,g=new c.Deferred();f=f||{};if(typeof f==="function"){h=f;f=null}else{h=h||f.callback}a.rest.get(e,f).done(function(){var o=arguments[0],m;try{m=o;if(typeof h=="function"){h(m)}g.resolve(m)}catch(n){g.reject()}}).fail(function(){g.reject()});return g.promise()},byName:function(e,h,k){var f="users/"+e+"/options",g=new c.Deferred();a.rest.get(f).done(function(){var o=arguments[0],m=[];try{c.each(o.data,function(q,r){if(r.name==h){m.push(r)}});if(typeof k=="function"){k(m)}g.resolve(m)}catch(n){g.reject()}}).fail(function(){g.reject()});return g.promise()},update:function(m,g,k){var e=new c.Deferred(),h=this,f=g.resource+"/"+g.id+"/options/"+m;if(m==null){return this.create(g,k)}a.rest.call("PUT",f,JSON.stringify(k),"application/json").done(function(){e.resolveWith(h)}).fail(function(){e.rejectWith(h,arguments)});return e.promise()},remove:function(f){var e=new c.Deferred();a.rest.call("DELETE","options/"+f).done(function(){e.resolve()}).fail(function(){e.reject()});return e.promise()},create:function(g,h){var e=new c.Deferred(),f=g.resource+"/"+g.id+"/options";if(!h){return}a.rest.call("post",f,h,"application/json").done(function(o,n){var k=n&&n.match(/options\/(\w+)/);e.resolve([k&&k[1]])}).fail(function(){e.reject(arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.datasources={list:function(f){var e="datasources",g=new c.Deferred();a.rest.get(e,f).done(function(h){g.resolve(h)}).fail(function(){g.reject()});return g.promise()},byId:function(k,f,h){var e="datasources/"+k,g=new c.Deferred();f=f||{};if(typeof f==="function"){h=f;f=null}else{h=h||f.callback}a.rest.get(e,f).done(function(){var o=arguments[0],m;try{m=new giscloud.datasources.Datasource(o);if(typeof h=="function"){h(m)}g.resolve(m)}catch(n){g.reject()}}).fail(function(){g.reject()});return g.promise()},update:function(h,g){var e=new c.Deferred(),f=this;if(h==null){return this.create(g)}a.rest.call("PUT","datasources/"+h,JSON.stringify(g),"application/json").done(function(){e.resolveWith(f)}).fail(function(){e.rejectWith(f,arguments)});return e.promise()},remove:function(f){var e=new c.Deferred();a.rest.call("DELETE","datasources/"+f).done(function(){e.resolve()}).fail(function(){e.reject()});return e.promise()},create:function(f){var e=new c.Deferred();if(!f){return}a.rest.call("post","datasources",f,"application/json").done(function(k,h){var g=h&&h.match(/datasources\/(\w+)/);e.resolve([g&&g[1]])}).fail(function(){e.reject(arguments)});return e.promise()},share:function(k,f){var e=new c.Deferred(),g=this;var h=f;a.rest.call("post","resources/"+k+"/permission",JSON.stringify(h),"application/json").done(function(q,o){var n=o&&o.match(/sharing\/(\w+)/);e.resolveWith(g,[n&&n[1]])}).fail(function(){e.rejectWith(g,arguments)});return e.promise()},unshare:function(g,h){var e=new c.Deferred(),f=this;a.rest.call("DELETE","resources/"+g+"/permission/"+h).done(function(){e.resolve()}).fail(function(){e.reject()});return e.promise()},columns:function(g,f,k){var e,h=new c.Deferred();if(c.isNumeric(g)){e="datasources/"+g+"/columns"}else{e="datasources/columns?source="+g}f=f||{};if(typeof f==="function"){k=f;f=null}else{k=k||f.callback}a.rest.get(e,f).done(function(){var n=arguments[0];try{if(typeof k=="function"){k(n)}h.resolve(n)}catch(m){h.reject()}}).fail(function(){h.reject()});return h.promise()},addColumn:function(g,h){var f,e=new c.Deferred();if(!h){return}if(c.isNumeric(g)){f="datasources/"+g+"/columns"}else{f="datasources/columns?source="+g}a.rest.call("post",f,a.toXml("column",h),"text/xml").done(function(o,n){var k=n&&n.match(/datasources\/(\w+)/);e.resolve([k&&k[1]])}).fail(function(){e.reject.apply(e,arguments)});return e.promise()},dropColumn:function(g,k){var f,e=new c.Deferred(),h=this;if(!k){return}if(c.isNumeric(g)){f="datasources/"+g+"/columns"}else{f="datasources/columns?source="+g}a.rest.call("DELETE",f,a.toXml("column",k),"text/xml").done(function(){e.resolveWith(h)}).fail(function(){e.reject(arguments)});return e.promise()},updateColumn:function(g,k){var f,e=new c.Deferred(),h=this;if(!k){return}if(c.isNumeric(g)){f="datasources/"+g+"/columns"}else{f="datasources/columns?source="+g}a.rest.call("PUT",f,a.toXml("column",k),"text/xml").done(function(){e.resolveWith(h)}).fail(function(){e.reject(arguments)});return e.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(a,e,f){var c;giscloud.datasources.Datasource=function(g){c=g;if(c){this.id=c.id;this.resource_id=c.resource_id;this.name=c.name;this.owner=c.owner_id;this.type=c.type;this.epsg=c.epsg*1;this.proj4=c.proj4;this.description=c.description;this.copyright=c.copyright;if(c.type!=15){this.params=e.parseJSON(c.params)}if(c.x_min&&c.x_max&&c.y_min&&c.y_max){this.bounds=new giscloud.Bounds(c.x_min,c.y_min,c.x_max,c.y_max)}}else{c={}}this.share=function(k,h){return giscloud.datasources.share(this.id,k,h)};this.remove=function(){return giscloud.datasources.remove(this.id)};this.update=function(k){return;var h;c.data=this.data;h=this.bounds;that=this;if(h){c.__x_min=(h&&h.left);c.__y_min=(h&&h.bottom);c.__x_max=(h&&h.right);c.__y_max=(h&&h.top)}if(this.id!=null){return giscloud.datasources.update(this.id,c)}else{return giscloud.datasources.update(c.id,c).done(function(m){that.id=m})}};this.clone=function(){return giscloud.datasources.create(c.data)}}})(window,window.giscloud.exposeJQuery());(function(e,a){var c=null;giscloud.datasources.apollo={browse:function(h,g){var f;if(typeof h==="string"){if(c!=null){f="datasources/"+c+"/apollo/"+h}else{f="apollo/"+h}}else{if(h.datasource!=null){f="datasources/"+h.datasource+"/apollo/"+h.resource}else{if(c!=null){f="datasources/"+c+"/apollo/"+h.resource}else{f="apollo/"+h.resource}}}return a.rest.get(f,g).promise()},thumbnailUrl:function(g){var f;if(typeof g==="string"){if(c!=null){f="datasources/"+c+"/apollo/"+g}else{f="apollo/"+g}}else{if(g.datasource!=null){f="datasources/"+g.datasource+"/apollo/"+g.resource}else{if(c!=null){f="datasources/"+c+"/apollo/"+g.resource}else{f="apollo/"+g.resource}}}return a.rest.url(f+"/thumbnail")},datasource:function(f){if(f===undefined){return c}c=f;return this},processes:{list:function(g){var f="datasources/"+c+"/apollo/processes";return a.rest.get(f,g).pipe(function(h){if(h&&h.data){return e.map(h.data,function(k){return new giscloud.datasources.apollo.ApolloProcess(k)})}return null},function(){return null}).promise()},getDescription:function(h,g){var f="datasources/"+c+"/apollo/processes/"+h;return a.rest.get(f,g).pipe(function(k){return k},function(){return null}).promise()},execute:function(k,h,g){var f="datasources/"+c+"/apollo/processes/"+k+"/execute.json";return a.rest.call("post",f,JSON.stringify(h),"application/json",g).pipe(function(q,o){var n=o&&o.match(/tasks\/(\w+)/);return n&&n[1]},function(){return null})}}}}(giscloud.exposeJQuery(),giscloud.common()));(function(a){giscloud.datasources.apollo.ApolloProcess=function(c){this.id=c.Identifier;this.title=c.Title;this["abstract"]=c.Abstract;this.description=null};giscloud.datasources.apollo.ApolloProcess.prototype={getDescription:function(e){var f=this,c=new a.Deferred();giscloud.datasources.apollo.processes.getDescription(this.id,e).then(function(g){if(g){f.description=g}else{f.description=null}c.resolveWith(f,f.description)},function(){c.rejectWith(f)});return c.promise()},execute:function(e,c){return giscloud.datasources.apollo.processes.execute(this.id,e,c)},status:function(){}}})(giscloud.exposeJQuery());(function(e,a){var c=null;giscloud.datasources.sfdc={checkAuth:function(f){var h,g;if(f!=null){h="datasources/"+f+"/sfdc/oauth.json"}else{if(c!=null){h="datasources/"+c+"/sfdc/oauth.json"}else{throw"No datasource id"}}g=new e.Deferred();a.rest.get(h,options).fail(g.reject).done(function(k){if(k.access_token){g.resolve(k)}else{g.reject(k)}});return g.promise()},get:function(h,g){var f;if(typeof h==="string"){if(c!=null){f="datasources/"+c+"/sfdc/"+h}else{throw"No datasource id"}}else{if(h.datasource!=null){f="datasources/"+h.datasource+"/sfdc/"+h.resource}else{if(c!=null){f="datasources/"+c+"/sfdc/"+h.resource}else{throw"No datasource id"}}}return a.rest.get(f,g).promise()},datasource:function(f){if(f===undefined){return c}c=f;return this}}}(giscloud.exposeJQuery(),giscloud.common()));(function(c,a){giscloud.datasources.wms={getCapabilities:function(e,f){var k=new c.Deferred(),g,h;g=fno.liveSite+"modules_gc/layer/cwms.php";h={task:"getcapabilities",module:"wms",wms:e,version:f?f:"1.1"};c.ajax({url:g,type:"GET",cache:false,dataType:"json",data:h}).done(function(){var m=Array.prototype.slice.apply(arguments);k.resolve.apply(k,m)}).fail(function(){var m=Array.prototype.slice.apply(arguments);k.reject.apply(k,m)});return k.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.spatialrelationship={within:function(m,k,f,e,h){var g="geometry/within",n=new c.Deferred();h=h||{};h.layer1_id=m;h.layer2_id=f;h.feature1_id=k;h.feature2_id=e;a.rest.get(g,h).done(function(q,t,o){n.resolve(o.status==201)}).fail(function(){n.reject()});return n.promise()},intersects:function(m,k,f,e,h){var g="geometry/intersects",n=new c.Deferred();h=h||{};h.layer1_id=m;h.layer2_id=f;h.feature1_id=k;h.feature2_id=e;a.rest.get(g,h).done(function(q,t,o){n.resolve(o.status==201)}).fail(function(){n.reject()});return n.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(c,e,f){function a(g){if(g==null){return null}if(typeof g==="string"){try{return JSON.parse(g)}catch(h){return null}}else{return g}}giscloud.Layer=function(g){e.extend(this,{id:g.id,name:g.name||null,owner:g.owner,source:a(g.source),datasourceId:g.datasource_id,columns:g.columns||null,onscale:g.onscale||null,offscale:g.offscale||null,label:g.label||null,textfield:g.textfield||null,styles:a(g.styles),alpha:g.alpha||null,encoding:g.encoding||null,margin:g.margin||null,created:(g.created&&new Date(g.created*1000))||null,visible:g.visible||null,lock:g.lock||null,raster:g.raster||null,grp:g.grp||null,exportable:g.exportable||null,parent:g.parent||null,tooltip:g.tooltip||null,label_placement:a(g.label_placement),mapId:g.map_id||null,type:g.type||null,order:g.order,useInfoWindow:(g.use_info_window!=null)?g.use_info_window:false,modified:(g.modified&&new Date(g.modified*1000))||null,form:g.form||null,bounds:new giscloud.Bounds(g.x_min,g.y_min,g.x_max,g.y_max)});this.copyStylesFrom=function(h){var k,m,o,n;n=this;k=new e.Deferred();m=this.styles;giscloud.layers.byId(h).done(function(q){o=q.styles;n.styles=o;k.resolve({newStyles:o,oldStyles:m})}).fail(function(){k.reject()});return k.promise()};this.remove=function(){return giscloud.layers.remove(this.id)};this.update=function(){var h;g.name=this.name||null;g.source=(this.source&&JSON.stringify(this.source))||null;g.datasource_id=this.datasourceId||null;g.columns=this.columns||null;g.onscale=this.onscale||null;g.offscale=this.offscale||null;g.label=this.label||null;g.textfield=this.textfield||null;g.alpha=this.alpha||null;g.encoding=this.encoding||null;g.margin=this.margin||null;g.visible=this.visible||null;g.lock=this.lock||null;g.raster=this.raster||null;g.grp=this.grp||null;g.exportable=this.exportable||null;g.parent=this.parent||null;g.tooltip=this.tooltip||null;g.label_placement=(this.label_placement&&JSON.stringify(this.label_placement))||null;g.styles=(this.styles&&JSON.stringify(this.styles))||null;g.map_id=this.mapId||null;g.type=this.type||null;g.order=this.order||null;g.form=this.form;g.use_info_window=(this.useInfoWindow!=null)?this.useInfoWindow:null;h=this.bounds;if(h&&h.valid()){g.x_min=h.left;g.y_min=h.bottom;g.x_max=h.right;g.y_max=h.top}return giscloud.layers.update(g.id,g)};this.clone=function(){var h={};e.extend(h,g);delete h.id;return giscloud.layers.create(h)};this.reset=function(){return giscloud.layers.reset(this.mapId,[this.id])}}}(window,window.giscloud.exposeJQuery()));(function(a,c,e){giscloud.Feature=function(g){var f=g;if(f){this.id=(f.__id!=null)?f.__id:f.id;this.created=new Date(f.__created*1000);this.modified=new Date(f.__modifed*1000);this.owner=f.__owner;this.layerId=(f.__layerId!=null)?f.__layerId:(f.__layer_id||f.layerId);this.geometry=f.__geometry||f.geometry||null;this.bounds=new giscloud.Bounds(f.__xmin,f.__ymin,f.__xmax,f.__ymax);this.data=f.data||{};this.meta=f.meta}else{f={}}this.remove=function(){return giscloud.features.remove(this.layerId,this.id)};this.update=function(k){var h;f.layerId=this.layerId;f.data=this.data;f.geometry=this.geometry;h=this.bounds;that=this;delete f.__geometry;if(h){f.__x_min=(h&&h.left);f.__y_min=(h&&h.bottom);f.__x_max=(h&&h.right);f.__y_max=(h&&h.top)}if(this.id!=null){return giscloud.features.update(f.layerId,this.id,f,k)}else{return giscloud.features.update(f.layerId,null,f,k).done(function(m){that.id=m})}};this.clone=function(){return giscloud.features.create(this.layerId,{data:f.data,geometry:f.geometry})}}})(window,window.giscloud.exposeJQuery());(function(c,e,a,f){giscloud.ViewerLayer=function(h){var g,k;if(h){this.id=parseInt(h.getId().replace(/layer(\d+)/,"$1"),10);k=h.getData();this.sourceId=k&&k.srcId;this.source=k&&k.src;g=h.getBound();this.bounds=g&&new giscloud.Bounds(g.xMin,g.yMin,g.xMax,g.yMax);this.instance=h}else{throw"Invalid arguments."}};e.extend(giscloud.ViewerLayer.prototype,{visible:function(){var g=arguments[0];if(e.type(g)=="boolean"){if(g){this.instance.enable()}else{this.instance.disable()}return this}else{return this.instance.getVisibility()}},selectable:function(){var g=arguments[0];if(e.type(g)=="boolean"){this.instance.setSelectable(g);return this}else{return this.instance.getSelectable()}},opacity:function(){var g=arguments[0];if(e.type(g)=="number"){this.instance.setAlpha(g);return this}else{return this.instance.getAlpha()}}})})(window,giscloud.exposeJQuery(),giscloud.common());(function(c,e,a,f){giscloud.ViewerSelection=function(o){var k={},h=o,g={},n=0,m=a.oid();if(o&&o.constructor===giscloud.Viewer){e.extend(this,{add:function(t,q,r){if(k[q]===f){k[q]=[]}if(e.inArray(k[q],t)===-1){k[q].push(t);n++;if(!r){e(g).triggerHandler("featureAdd",[{featureId:t,layerId:q},this])}}return this},remove:function(u,r){var t,q=k[r];if(q!==f){t=e.inArray(u,q);if(t>-1){q.splice(t,1);n--;e(g).triggerHandler("featureRemove",[{featureId:u,layerId:r},this])}}return this},toggle:function(r,q){if(this.isSelected(r,q)){this.remove(r,q)}else{this.add(r,q)}return this},clear:function(q){if(q!==f&&k[q]!==f){n-=k[q].length;delete k[q]}else{n=0;k={}}e(g).triggerHandler("selectionClear",[this]);return this},isSelected:function(r,q){return k[q]!==f&&e.inArray(r,k[q])>-1},selected:function(t){var q=[],u=this.add,r=true;if(e.isArray(t)){if(n>0){this.clear()}e.each(t,function(v,x){u(x.featureId,x.layerId,r)});e(g).triggerHandler("multipleFeaturesAdd",[e.map(t,function(v){return{featureId:v.featureId,layerId:v.layerId}}),this]);return this}e.each(k,function(v){e.each(this,function(){q.push({featureId:this,layerId:v})})});return q},count:function(){return n},bind:function(q,t){var r=this,u;if(q&&typeof q=="string"&&typeof t=="function"){u=function(){t.apply(r,Array.prototype.slice.call(arguments,1))};e(g).on(q,u);if(!t.gcunbind){t.gcunbind={}}t.gcunbind[m+q]=u}return this},unbind:function(q,r){var t;if(q&&typeof q=="string"&&typeof r=="function"){t=r.gcunbind&&r.gcunbind[m+q];if(t){e(g).off(q,t)}}return this},featureAdd:function(q){return this.bind("featureAdd",q)},featureRemove:function(q){return this.bind("featureRemove",q)},selectionClear:function(q){return this.bind("selectionClear",q)}})}else{throw"Invalid constructor arguments."}}})(window,giscloud.exposeJQuery(),giscloud.common());(function(g,f,h,a,e){var m=/^layer(\d+)\|\|(\d+)$/,k,c,o,n;giscloud.Viewer=function(){var y=this,t=arguments,x=h.oid(),r={},q,u,v;if(typeof t[0]==="string"){this.containerId=q=t[0];this.mapId=u=t[1];v=t[2]||{};this.initializing=new f.Deferred();this.loading=new f.Deferred();this.layersLoading=new f.Deferred();k(q,v).done(function(z){var A,B=new a(z);B.plugins={};B.plugins.marker=new fnMarker(B);B.plugins.kartehr=new fnKartehr(B);B.plugins.canvas=new fnCanvas(B);B.plugins.tooltip=new fnTooltip(B);B.plugins.kartehr.liveSite("http://www.mapcow.org/");if(v.scalebar){B.plugins.scalebar=new fnScalebar(B)}if(v.slider){B.plugins.slider=new fnSlider(B)}B.enablePanWithMiddleButton();y.instance=B;y.initializing.resolveWith(y,[]);B.addEventListener("layerRemoved",f.proxy(o,y));B.addEventListener("load",function(){var C;if((giscloud&&giscloud.layers&&y.mapId!=null)&&!v.dontWaitForLayers){C=giscloud.layers.byMapId(y.mapId,{expand:"columns"})}else{C=(new f.Deferred()).resolve(null)}C.always(function(D){if(v.dontWaitForLayers){if(giscloud&&giscloud.layers&&y.mapId!=null){giscloud.layers.byMapId(y.mapId,{expand:"columns"}).done(function(E){n(y,E);y.layersLoading.resolveWith(y,[E])}).fail(y.layersLoading.reject)}}n(y,D);if(D){y.layersLoading.resolveWith(y,[D])}y.graphic=new giscloud.Graphic(y);if(!y.selection){y.selection=new giscloud.ViewerSelection(y);y.selection.featureAdd(function(E){h.highlight(y.instance,E.featureId,E.layerId,false);f(r).triggerHandler("selectionChange",{action:"add",feature:E})});y.selection.bind("multipleFeaturesAdd",function(E){var I={},G,F,H;for(G=0,F=E.length;G<F;G++){H=E[G].layerId;if(I[H]===e){I[H]=[E[G].featureId]}else{I[H].push(E[G].featureId)}}for(H in I){if(I.hasOwnProperty(H)){h.highlightMultiple(y.instance,I[H],H,false)}}f(r).triggerHandler("selectionChange",{action:"add",feature:E})});y.selection.featureRemove(function(G,E){var F=f.map(E.selected(),function(H){return"layer"+H.layerId+"||"+H.featureId}).join();h.highlight(y.instance,F,null,true);f(r).triggerHandler("selectionChange",{action:"remove",feature:G})});y.selection.selectionClear(function(){y.instance.modifyObject(null,{},null,true);f(r).triggerHandler("selectionChange",{action:"clear"})})}if(g.Proj4js){Proj4js.defs.GC_MAP_CURRENT=y.instance.projection;y.projection=new Proj4js.Proj("GC_MAP_CURRENT")}else{y.projection=y.instance.projection}y.loading.resolveWith(y,[]);f(r).triggerHandler("loaded",[y]);f(r).triggerHandler("ready",[y])})});B.addEventListener("reload",function(){var C;if((giscloud&&giscloud.layers&&y.mapId!=null)&&!v.dontWaitForLayers){C=giscloud.layers.byMapId(y.mapId,{expand:"columns"})}else{C=(new f.Deferred()).resolve(null)}C.always(function(D){if(v.dontWaitForLayers){if(giscloud&&giscloud.layers&&y.mapId!=null){giscloud.layers.byMapId(y.mapId,{expand:"columns"}).done(function(E){n(y,E);y.layersLoading.resolveWith(y,[E])}).fail(y.layersLoading.reject)}}n(y,D);if(D){y.layersLoading.resolveWith(y,[D])}Proj4js.defs.GC_MAP_CURRENT=y.instance.projection;y.projection=new Proj4js.Proj("GC_MAP_CURRENT");y.loading.resolveWith(y,[]);f(r).triggerHandler("reloaded",[y])})});if(y.instance.setLayerFeatureFilter&&flashnavigator.extraOptions){for(A in flashnavigator.extraOptions.data){y.instance.setLayerFeatureFilter("layer"+A,flashnavigator.extraOptions.data[A])}}if(u){y.loadMap(u)}f(r).triggerHandler("init",[y])})}else{h.setError(this,"constructor","Invalid constructor arguments")}this.activeLayer=null;this.markers=[];this.editing=null;f.extend(this,{bind:function(z,B){var A=this,C;if(z&&typeof z==="string"&&typeof B==="function"){switch(z){case"mouseDown":C=function(D){B.call(A,new giscloud.LonLat(D.x,D.y))};this.initializing.done(function(){A.instance.addEventListener("mousedown",C)});break;case"mouseMove":C=function(D){B.call(A,new giscloud.LonLat(D.x,D.y))};this.initializing.done(function(){A.instance.addEventListener("mousemove",C)});break;case"scaleChange":C=function(D){B.call(A,A.instance.convertScale(D.zoom))};this.initializing.done(function(){A.instance.addEventListener("scalechange",C)});break;case"featureClick":C=function(E){var D=E.id.match(m);var F={layerId:parseInt(D[1],10),featureId:parseInt(D[2],10),key:E.key,attributes:(E.object?E.object.attributes:E.attributes)};B.call(A,F)};this.initializing.done(function(){A.instance.addEventListener("object_click",C)});break;case"featureDoubleclick":C=function(E){var D=E.id.match(m);B.call(A,{layerId:parseInt(D[1],10),featureId:parseInt(D[2],10),key:E.key,attributes:(E.object?E.object.attributes:E.attributes)})};this.initializing.done(function(){A.instance.addEventListener("object_dblclick",C)});break;case"featureOver":C=function(E){var D=E.id.match(m);B.call(A,{layerId:parseInt(D[1],10),featureId:parseInt(D[2],10),key:E.key,attributes:(E.object?E.object.attributes:E.attributes)})};this.initializing.done(function(){A.instance.addEventListener("object_over",C)});break;case"featureOut":C=function(E){var D=E.id.match(m);B.call(A,{layerId:parseInt(D[1],10),featureId:parseInt(D[2],10),key:E.key,attributes:(E.object?E.object.attributes:E.attributes)})};this.initializing.done(function(){A.instance.addEventListener("object_out",C)});break;default:C=function(){var D=Array.prototype.slice.call(arguments,1);B.apply(A,D)};f(r).on(z,C);break}if(!B.gcunbind){B.gcunbind={}}B.gcunbind[x+z]=C}return this},unbind:function(z,B){var A=this,C;if(z&&typeof z==="string"&&typeof B==="function"){C=B.gcunbind&&B.gcunbind[x+z];if(C){switch(z){case"mouseDown":this.initializing.done(function(){A.instance.removeEventListener("mousedown",C)});break;case"mouseMove":this.initializing.done(function(){A.instance.removeEventListener("mousemove",C)});break;case"scaleChange":this.initializing.done(function(){A.instance.removeEventListener("scalechange",C)});break;case"featureClick":this.initializing.done(function(){A.instance.removeEventListener("object_click",C)});break;case"featureDoubleclick":this.initializing.done(function(){A.instance.removeEventListener("object_dblclick",C)});break;case"featureOver":this.initializing.done(function(){A.instance.removeEventListener("object_over",C)});break;case"featureOut":this.initializing.done(function(){A.instance.removeEventListener("object_out",C)});break;default:f(r).off(z,C);break}}}return this}})};f.extend(giscloud.Viewer.prototype,{loadMap:function(u,x){var r,t,q=this.instance;if(!q){h.setError(this,"loadMap","No viewer instance.");return this}if(!u){h.setError(this,"loadMap","Invalid map id.");return this}r=h.liveSite()+"maps/map"+u+".xml";if(giscloud.oauth2){t=giscloud.oauth2.token();if(t){r+="?oauth_token="+t}}if(this.loading.state()!=="pending"){this.loading=new f.Deferred()}if(this.layersLoading.state()!=="pending"){this.layersLoading=new f.Deferred()}q.src(true);q.load(r,false,x);this.mapId=u;return this},reloadMap:function(){var r,t,q=this.instance;if(!q){h.setError(this,"reloadMap","No viewer instance.");return this}if(!this.mapId){h.setError(this,"reloadMap","Invalid map id.");return this}r=h.liveSite()+"maps/map"+this.mapId+".xml";t=giscloud.oauth2.token();if(t){r+="?oauth_token="+t}if(this.loading.state()!=="pending"){this.loading=new f.Deferred()}if(this.layersLoading.state()!=="pending"){this.layersLoading=new f.Deferred()}q.reload(r);return this},ready:function(q){return this.bind("ready",q)},init:function(q){return this.bind("init",q)},mouseDown:function(q){return this.bind("mouseDown",q)},mouseMove:function(q){return this.bind("mouseMove",q)},scaleChange:function(q){return this.bind("scaleChange",q)},featureClick:function(q){return this.bind("featureClick",q)},featureDoubleclick:function(q){this.initializing.done(function(){this.instance.addEventListener("object_dblclick",function(t){var r=t.id.match(m);q({layerId:r[1],featureId:r[2],key:t.key,attributes:(t.object?t.object.attributes:t.attributes)})})});return this},featureOver:function(q){this.initializing.done(function(){this.instance.addEventListener("object_over",function(t){var r=t.id.match(m);q({layerId:r[1],featureId:r[2],key:t.key,attributes:(t.object?t.object.attributes:t.attributes)})})});return this},featureOut:function(q){this.initializing.done(function(){this.instance.addEventListener("object_out",function(t){var r=t.id.match(m);q({layerId:r[1],featureId:r[2],key:t.key,attributes:(t.object?t.object.attributes:t.attributes)})})});return this},selectionChange:function(q){return this.bind("selectionChange",q)},container:function(q){if(q===e){return f("#"+this.containerId)[0]}else{f("#"+q).append(f("#"+this.containerId).detach());this.containerId=q;return this}},width:function(){var q=f("#"+this.containerId);if(arguments[0]){q.width(arguments[0]);return this}else{return q.width()}},height:function(){var q=f("#"+this.containerId);if(arguments[0]){q.height(arguments[0]);return this}else{return q.height()}},bounds:function(r){if(r!==e){this.loading.done(function(){this.instance.setViewBound(r.left,r.bottom,r.right,r.top,true)});return this}else{var q=this.instance.getViewBound();return new giscloud.Bounds(q.xMin,q.yMin,q.xMax,q.yMax)}},center:function(q,r){if(q!==e){if(!q||!(q instanceof giscloud.LonLat)){throw"Parameter 'center' should be a giscloud.LonLat instance."}else{this.loading.done(function(){var t=this.bounds(),v,u,x=t&&t.center();if(x){this.instance.setLocation(q.lon,q.lat,r)}else{throw"Viewer bounds are not set."}});return this}}else{return this.bounds().center()}},scale:function(q){if(q!==e){if(!isFinite(q)){throw"Parameter 'scale' should be a finite number."}else{this.loading.done(function(){this.instance.setScale(q)});return this}}else{return this.instance.getScale()}},showLayer:function(r){var q=f.data(this,"layerIndex")[r.toString()];this.layers[q]&&this.layers[q].visible(true);this.showLayerLabels(r);return this},hideLayer:function(r){var q=f.data(this,"layerIndex")[r.toString()];this.layers[q]&&this.layers[q].visible(false);this.hideLayerLabels(r);return this},showLayerLabels:function(t){var q="llayer"+t,r=this.instance.getLayerByName(q);if(r){r.enable()}},hideLayerLabels:function(t){var q="llayer"+t,r=this.instance.getLayerByName(q);if(r){r.disable()}},layerById:function(r){if(this.loading.state()==="resolved"){var q=f(this).data("layerIndex")[r];if(isFinite(q)){return this.layers[q]}else{return null}}},showTip:function(r){var q=this;this.initializing.done(function(){q.instance.plugins.tooltip.show(r)});return this},hideTip:function(){var q=this;this.initializing.done(function(){q.instance.plugins.tooltip.hide()});return this},addMarker:function(q){this.loading.done(function(){var r=this.instance.plugins.marker,y,x,z,v,u,t;u=function(G,C,E,B,A,D){var F;E=E||"";B=B?t(E,B):"";if(C.url!=null){return D.loadPoi(G.lon,G.lat,C.url,{hoverText:E,popupContent:B,popupVisible:A},true,C.width,C.height)}F=D.loadPoi(G.lon,G.lat,C,{hoverText:E,popupContent:B,popupVisible:A},true);return F};t=function(B,A){return f("<div/>").append(B?f("<div/>",{"class":"gc-info-popup-title"}).html(B):null,A?f("<div/>",{"class":"gc-info-popup-content"}).html(A):null).html()};v=function(C,B){var E=this.instance.plugins.marker,D=B.state,A=D.marker,H=A._id||null,F=B.newValue,G=A.location();if(B.oldValue===F){return}switch(B.property){case"location":if(F&&F instanceof giscloud.LonLat&&F.valid()&&A.visible()){if(H){E.move(H,F.lon,F.lat)}else{A._id=u(F,A.icon(),A.title(),A.content(),A.popup(),E)}}else{H&&E.removePoi(H);A._id=null}break;case"visible":if(F&&G&&G instanceof giscloud.LonLat&&G.valid()){A._id=u(G,A.icon(),A.title(),A.content(),A.popup(),E)}else{H&&E.removePoi(H);A._id=null}break;case"popup":if(H){E.removePoi(H);A._id=u(G,A.icon(),A.title(),A.content(),F,E)}break;case"title":if(H){E.removePoi(H);A._id=u(G,A.icon(),F,A.content(),A.popup(),E)}break;case"content":if(H){E.removePoi(H);A._id=u(G,A.icon(),A.title(),F,A.popup(),E)}break;case"icon":if(H){E.removePoi(H);A._id=u(G,F,A.title(),A.content(),A.popup(),E)}break;default:}};if(q instanceof giscloud.Marker){z=q.location();x=q.visible();ico=q.icon()||null;this.markers.push(q);f(q).on("stateChanged",f.proxy(v,this));q._popupCloseHandler=function(){q.popup(false,true)};q._popupOpenHandler=function(){q.popup(true,true)};f(r).on("popupClose.fnMarker",q._popupCloseHandler).on("popupOpen.fnMarker",q._popupOpenHandler);if(x&&z&&z instanceof giscloud.LonLat&&z.valid()){q._id=u(z,ico,q.title(),q.content(),q.popup(),r)}}else{if(q instanceof giscloud.FlagMarker){y=q.sig;if(y&&h.markers[y].m){throw"This marker has already been added to a viewer."}else{q.sig="m"+h.oid();y=q.sig;if(!h.markers){h.markers={}}h.markers[y]={m:r};x=q.visible();z=q.position();if(x&&z){h.markers[y].id=r.add(z.lon,z.lat,q.color().hex("0x"),q.title(),q.content(),null,true)}else{h.markers[y].id=null}this.markers.push(q);h.markers[y].open=true;h.markers[y].openCloseHandler=function(A,C,B){if(h.markers[y]){h.markers[y].open=B}};f(r).on("fnMarker.OpenClose",h.markers[y].openCloseHandler)}}else{throw"Not a giscloud marker."}}});return this},removeMarker:function(q){this.loading.done(function(){var r=this.instance.plugins.marker,t;if(q instanceof giscloud.Marker){if(q._id){f(r).off("popupClose.fnMarker",q._popupCloseHandler).off("popupOpen.fnMarker",q._popupOpenHandler);q._popupCloseHandler=null;q._popupOpenHandler=null;r.removePoi(q._id)}t=f.inArray(q,this.markers);if(t>-1){this.markers.splice(t,1)}}else{if(q instanceof giscloud.FlagMarker){if(q.sig&&h.markers[q.sig].m===r){h.markers[q.sig].m.remove(h.markers[q.sig].id);f(r).off("fnMarker.OpenClose",h.markers[q.sig].openCloseHandler);delete h.markers[q.sig].openCloseHandler;delete h.markers[q.sig];t=f.inArray(q,this.markers);if(t>-1){this.markers.splice(t,1)}delete q.sig}else{throw"This is not a marker which belongs to this viewer."}}else{throw"Not a giscloud marker."}}});return this},fullExtent:function(){var q=this;this.loading.done(function(){q.instance.setViewBound()});return this},measure:function(){var q=this;this.loading.done(function(){q.select(false);q.instance.setTool("MeasureTool")});return this},areaZoom:function(){var q=this;this.loading.done(function(){q.select(false);q.instance.setTool("SelectAreaTool")});return this},pan:function(){var q=this;this.loading.done(function(){q.select(false);q.instance.setTool("DragTool")});return this},zoomToLayer:function(q){var r=this;this.loading.done(function(){var t=r.layerById(q);if(t){r.bounds(t.bounds)}});return this},select:function(q){var t=this,r;if(q){this.instance.setTool("DragTool");this.instance.enableSelection();r=f(this).data("selectFeatureClickCallback");if(!r){r=function(v){var u=v.id.match(m),C=parseInt(u[2],10),A=parseInt(u[1],10),B=v.key===17,z=t.selection,y=t.instance,x=function(F,E,D){h.highlight(y,F,E,D)};if(B){if(z.isSelected(C,A)){y.demodifyObjectsColor();z.remove(C,A);f.each(t.selection.selected().slice(0),function(){var E=this.featureId.toString(),D=this.layerId.toString();x(E,D,false)})}else{x(C,A,false);z.add(C,A)}}else{if(z.isSelected(C,A)&&z.count()===1){y.demodifyObjectsColor();z.remove(C,A)}else{z.clear();x(C,A,true);z.add(C,A)}}};f(this).data("selectFeatureClickCallback",r)}this.instance.addEventListener("object_click",r)}else{this.instance.disableSelection();this.instance.removeEventListener("object_click",f(this).data("selectFeatureClickCallback"))}return this},selectFeature:function(r,z,t){var x=this.selection,q=x.isSelected(z,r),y=parseInt(z,10),v=parseInt(r,10),u=this;t=(t===false)?false:true;this.loading.done(function(){if(q&&!t){u.instance.demodifyObjectsColor();x.remove(y,v);f.each(x.selected().slice(0),function(){var B=this.featureId.toString(),A=this.layerId.toString();h.highlight(u.instance,B,A,false)})}else{if(!q&&t){h.highlight(u.instance,y,v,false);x.add(y,v)}}});return this},selectFeaturesByBounds:function(r,t,q){this.loading.done(function(){var u=this;if(q){this.instance.demodifyObjectsColor();this.selection.clear()}if(r!==null||r!==e){giscloud.features.byBounds(r,t).done(function(y){var x,v;for(x=0,v=y.length;x<v;x++){if(y[x].id!==e){u.selectFeature(r,y[x].id,true)}}})}})},editFeature:function(r,y,u){var v=this,x=this.editing,t,q;if(c(x)){t=f.proxy(x.fail,x);this.editCancel()}else{t=f.proxy(this.loading.done,this.loading)}q=new f.Deferred();u=u||{};t(function(){if(r==null||v.layerById(r)==null){q.reject("Invalid layer id");return}if(y==null){return}v.select(false);q.always(function(){v.select(true)});giscloud.features.byId(r,y,{geometry:"wkt"}).fail(function(){q.reject("Unknown feature")}).done(function(A){var z=giscloud.geometry.fromOGC(A.geometry),B=z&&new giscloud.GraphicFeature(z);if(!B){q.reject("Invalid feature geometry");return}v.graphic.add(B).edit(B).fail(function(){q.reject("Cancelled")}).done(function(C){giscloud.features.update(A.layerId,A.id,{geometry:C.toOGC()},{use_map_srid:true}).done(function(){if(u.dontReset){q.resolve()}else{giscloud.layers.reset(v.mapId,[r]).always(function(){q.resolve()}).done(function(){v.instance.reload()})}}).fail(function(){q.reject("Error updating feature")})});q.always(function(){v.graphic.remove(B)})})});this.editing=q;return q.promise()},editAccept:function(){if(c(this.editing)){this.graphic.editAccept()}return this},editCancel:function(){if(c(this.editing)){this.graphic.editCancel()}return this},filterFeatures:function(q,r){var t=this;this.loading.done(function(){var u,v;if(q){u="layer"+q,t.instance.setLayerFeatureFilter(u,r);v=t.instance.getLayerByName(u);if(v){v.redraw()}labelLayerName="llayer"+q,labelLayerObject=t.instance.getLayerByName(labelLayerName);if(labelLayerObject){t.instance.setLayerFeatureFilter(labelLayerName,r);labelLayerObject.redraw()}}})}});giscloud.Viewer.__googleMapsApiLoaded=new f.Deferred;c=function(q){return q&&q.state()==="pending"};n=function(y,u){var q,z,A,x,v,r,t,C=/^layer(\d+)$/,B=y.instance;layerIndex={};y.layers=[];try{for(x=0,v=B.getLayerCount();x<v;x++){z=B.getLayer(x);q=z.getId();r=q.match(C);if(r){q=r[1];layerIndex[q]=x;t=new giscloud.ViewerLayer(z);y.layers.push(t)}}v=u&&u.length;if(v){for(x=0;x<v;x++){A=u[x];z=y.layers[layerIndex[A.id]];if(z){z.name=A.name;z.type=A.type;z.source=A.source.src;z.sourceType=A.source.type;z.datasourceId=A.datasourceId;z.columns=A.columns;z.selectable(A.lock==null||A.lock!=="t");z.visible(A.visible==="t");z.opacity(parseInt(A.alpha,10)||100)}}}}catch(D){console.log(D)}f.data(y,"layerIndex",layerIndex)};o=function(t){var v=t&&t.id.match(/^layer(\d+)$/)[1],r=f.data(this,"layerIndex"),u=r[v],q;if(!isNaN(u)){this.layers.splice(u,1);r={};for(u=0,q=this.layers.length;u<q;u++){r[this.layers[u].id]=u}f.data(this,"layerIndex",r)}};k=function(q,u,v){var t="tooltip,marker,kartehr,canvas",r=new f.Deferred();u=u||{};if(u.scalebar){t+=",scalebar"}if(u.slider){t+=",slider"}flashnavigator.include(t);flashnavigator.setOptions(u);if(h.deferreds.flashnavigator===e){h.deferreds.flashnavigator={}}h.deferreds.flashnavigator[q]=r;r.done(v||null);flashnavigator.container(q,{onLoad:function(x){r.resolve(x)}});return r}})(window,giscloud.exposeJQuery(),giscloud.common(),fnViewer);(function(h,e,k,c){var f,g,q,n,o,m,a;k.deferreds.leafletLoading=new e.Deferred();if(h.L&&h.L.Map){m=h.L;k.deferreds.leafletLoading.resolve()}giscloud.exposeLeaflet=function(){return m};giscloud.Viewer.Leaflet=function(y,A,B){var z,r,v,u,x,t;z=this;u=k.oid();r={options:B};v={};r.layers=[];if(k.deferreds.leafletLoading.state()!=="resolved"){giscloud.includeJs(k.liveSite()+"libs/leaflet-git/"+giscloud_config.leafletScript(),function(){if(h.L){m=h.L;k.deferreds.leafletLoading.resolve()}else{k.deferreds.leafletLoading.reject();k.deferreds.leafletLoading=new e.Deferred()}});if(!a){if(e.browser.msie&&parseFloat(e.browser.version)<9&&!("opacity" in document.createElement("div").style)){t=e.when(giscloud.includeCss(k.liveSite()+"libs/leaflet-git/leaflet.css"),giscloud.includeCss(k.liveSite()+"libs/leaflet-git/leaflet.ie.css"),giscloud.includeCss(k.liveSite()+"assets/api/1/css/gc-leaflet.css"))}else{t=e.when(giscloud.includeCss(k.liveSite()+"libs/leaflet-git/leaflet.css"),giscloud.includeCss(k.liveSite()+"assets/api/1/css/gc-leaflet.css"))}t.done(function(){a=true})}}this.init=new e.Deferred();this.init.done(function(){var D,C;z.map=r.map;z.layer=r.layer;z.instance=r.map;if(B.address&&B.address.read){D=giscloud.address.param("center");C=giscloud.address.param("zoom")}if(D!=null){z.center(D)}if(C!=null){z.zoom(C)}r.map.on("zoomend",function(){e(v).triggerHandler("scaleChanged")})});k.deferreds.leafletLoading.done(function(){if(giscloud.address){g(r,z,z.init.promise())}f(r,B.host||k.appSite(),y,A,B);z.init.resolveWith(z)});this.bind=function(C,E){var D,F;if(typeof E!=="function"){throw"Handler is not a function!"}switch(C){case"click":D="click";break;case"mouseDown":D="mousedown";break;case"doubleClick":D="dblclick";break;case"mouseMove":D="mousemove";break;default:F=function(){E.apply(z,Array.prototype.slice.call(arguments,1))};e(v).on(C,F);E[C+u]=F;return this}F=function(G){E.apply(z,[new giscloud.LonLat(G.latlng.lng,G.latlng.lat)])};r.map.on(D,F);E[C+u]=F;return this};this.unbind=function(C,E){var D,F;if(typeof E!=="function"){throw"Handler is not a function!"}F=E[C+u];if(!F){return this}switch(C){case"click":D="click";break;case"mouseDown":D="mousedown";break;case"doubleClick":D="dblclick";break;case"mouseMove":D="mousemove";break;default:e(v).off(C,F);delete E[C+u];return this}r.map.off(D,F);delete E[C+u];return this};e.each(["click","doubleClick","mouseMove","mouseDown"],function(C,D){z[D]=function(E){z.bind(D,E)}});this.bounds=function(C){if(C==null){C=r.map.getBounds();return C&&new giscloud.Bounds(C._southWest.lng,C._southWest.lat,C._northEast.lng,C._northEast.lat)}else{r.map.fitBounds(new m.LatLngBounds(new m.LatLng(C.bottom,C.left),new m.LatLng(C.top,C.right)));return this}};this.center=function(D,C){if(D==null){D=r.map.getCenter();return D&&new giscloud.LonLat(D.lng,D.lat)}else{r.map.setView(new h.L.LatLng(D.lat,D.lon),r.map.getZoom(),C);return this}};this.zoom=function(D,C){if(D==null){return r.map.getZoom()}else{r.map.setView(r.map.getCenter(),D,C);return this}};this.addMarker=function(C,D,G){var H,E,F;D=D||"defaultMarkerLayer";if(e(C).data(u+"_"+D)!==c){throw {msg:"Marker already present on the "+D+".",target:this,param:C}}H="m"+k.oid();e(C).data(u+"_"+D,H);if(r.markerLayers[D]===c){F=new m.FeatureGroup();r.markerLayers[D]=F;if(G!==false){r.map.addLayer(F)}}else{F=r.markerLayers[D]}E=q(C.location(),C.title(),C.content(),C.icon());C.openPopup=function(I){if(E._popup){E.openPopup()}else{if(C.firstLoad){C.firstLoad()}else{throw"No popup, sorry."}}};C.draggable=function(I){if(I===c){return E.dragging.enabled()}else{if(I===false){E.dragging.disable();I=e(E).data("ondrag");I&&E.off("dragend",I)}else{E.dragging.enable();E.on("dragend",I);e(E).data("ondrag",I)}}};E.on("dragend",function(){C.location(new giscloud.LonLat(this._latlng.lng,this._latlng.lat),true)});E.on("click",(function(I){return function(){I.triggerHandler("click",[I[0]])}}(e(C))));r.markers[H]=E;if(C.visible()){F.addLayer(E)}e(C).on("stateChanged",function(J,I){o.call(C,I,E,F)});return this};this.removeMarker=function(C,D){var E;D=D||"defaultMarkerLayer";E=e(C).data(u+"_"+D);if(E&&r.markers[E]){r.markerLayers[D].removeLayer(r.markers[E]);delete r.markers[E];e(C).removeData(u+"_"+D);delete C.openPopup}return this};this.markerLayers=function(){return e.map(r.markerLayers,function(D,C){return C})};this.showMarkerLayer=function(C){var D;C=C||"defaultMarkerLayer";D=r.markerLayers[C];D&&r.map.addLayer(D)};this.hideMarkerLayer=function(C){var D;C=C||"defaultMarkerLayer";D=r.markerLayers[C];D&&r.map.removeLayer(D)}};f=function(t,u,F,y,E){var v,B,A,r,D,C,x;if(y){if(E.timestamp){if(E.timestamp==="auto"){C="map.modified"}else{C=E.timestamp}}else{Math.round(e.now()/1000)}v=u+"rt/"+C+"/"+y+"/{z}/{x}/{y}.png";B=new m.TileLayer(v,{minZoom:1,maxZoom:E.maxZoom||20})}D={defaultMarkerLayer:new m.FeatureGroup()};try{A=[];B&&A.push(B);E.basemap&&A.push(new m.TileLayer(E.basemap.url,E.basemap.options));A.push(D.defaultMarkerLayer);x={layers:A,worldCopyJump:false};if(t.options.latloncrs){x.crs=m.CRS.EPSG4326}if(t.options.lockZoom){e.extend(x,{touchZoom:false,scrollWheelZoom:false,doubleClickZoom:false,zoomControl:false})}r=new m.Map(F,x);r.copyrightControl=new m.Control.Attribution();r.copyrightControl._onLayerAdd=e.noop;r.copyrightControl._onLayerRemove=e.noop;r.copyrightControl.setPrefix("").setPosition("bottomleft").addTo(r);r.attributionControl.setPrefix((E.attribution&&E.attribution.prefix)||"").addAttribution(E.attribution&&E.attribution.text);if(E.background){if(E.background.hex){e(".leaflet-container").css("background-color",E.background.hex())}else{e(".leaflet-container").css("background-color",E.background)}}E.center=E.center||(E.address&&E.address.read&&giscloud.address.param("center"));E.zoom=E.zoom||(E.address&&E.address.read&&giscloud.address.param("zoom"));if(E.center&&E.zoom){r.setView(new m.LatLng(E.center.lat,E.center.lon),E.zoom,true)}else{if(E.bounds){r.fitBounds(new m.LatLngBounds(new m.LatLng(E.bounds.bottom,E.bounds.left),new m.LatLng(E.bounds.top,E.bounds.right)))}}t.map=r;t.layers=A;t.markerLayers=D;t.markers={}}catch(z){throw {name:"Leaflet error on viewer init.",err:z}}};g=function(u,t,v){var y,r,x=giscloud.address;r=(u.options&&u.options.address)||{read:false,write:false};x.registerParam({name:"center",query:"c",serialize:function(z){return z.toString(5)},deserialize:function(B){var z;try{z=B.split(",");return new giscloud.LonLat(parseFloat(z[0]),parseFloat(z[1]))}catch(A){return null}}});x.registerParam({name:"zoom",query:"z",deserialize:function(A){try{return parseInt(A,10)}catch(z){return null}}});y=function(){if(r.read){x.change("center",function(A,z){var B=z.value;if(B&&B.valid()){t.center(B,true)}});x.change("zoom",function(A,z){t.zoom(z.value,true)})}if(r.write){u.map.on("moveend",function(){x.param("center",t.center());x.param("zoom",t.zoom())})}};if(v&&v.done){v.done(y)}else{y()}};q=function(t,y,v,u){var r,x;x=new m.LatLng(t.lat,t.lon);r=new m.Marker(x,u&&{icon:u});n(y,v&&(v.value||v),r);if(r&&v&&v.action){v.action(r)}return r};n=function(v,u,r){var t;if(v||u){t="<h1>"+(v||"")+"</h1><p>"+(u||"")+"</p>";r.bindPopup(t,{maxWidth:500,minWidth:100})}return r};o=function(r,t,u){var v;switch(r.property){case"visible":t.setVisible(r.newValue);break;case"location":t.setLatLng(new m.LatLng(r.newValue.lat,r.newValue.lon));break;case"title":case"content":v=r.state.content;n(r.state.title,v&&(v.value||v),t);if(v&&v.action){v.action(t)}break;case"icon":t.setIcon(r.newValue);break;default:console.log(r.property,"Not yet implemented.");break}}}(window,giscloud.exposeJQuery(),giscloud.common()));(function(c,e,a,g){var f={};giscloud.Graphic=function(t){var u=this,v={},q={},o=a.oid(),B=false,n=false,m,k,y,h,r,A,z,x;r=function(C){var E,D;if(!B){e.each(v,function(F,G){if(G.gid===C.name){E=G.feat;return null}});if(C.type==="click"){D="click"}else{if(C.type==="mouseover"){D="mouseOver"}else{if(C.type==="mouseout"){D="mouseOut"}}}if(D&&E){e(q).triggerHandler(D,[E]);e(E).triggerHandler(D)}}};A=function(D){var H=v[this.id],F=H&&H.gid,G,E,C;if(m&&F){C=D&&D.toOGC();if(C){m.remove(F);H.gid=null;if(D instanceof giscloud.geometry.Point||D instanceof giscloud.geometry.Multipoint){G=new giscloud.GraphicStyle("point")}else{if(D instanceof giscloud.geometry.Line||D instanceof giscloud.geometry.Multiline){G=new giscloud.GraphicStyle("line")}else{if(D instanceof giscloud.geometry.Polygon||D instanceof giscloud.geometry.Multipolygon){G=new giscloud.GraphicStyle("polygon")}else{G=new giscloud.GraphicStyle()}}}E=H.feat.style();E.fill=G.fill?E.fill||G.fill:null;E.size=G.size?E.size||G.size:null;H.feat.style(E);F=m.deserializeGeometryOpenGIS({geom:C,color:E.color.hex("0x"),fillcolor:E.fill&&E.fill.hex("0x"),alpha:(E.fill&&(E.color.alpha()<E.fill.alpha()))?E.fill.alpha():E.color.alpha(),width:E.size,size:E.size});H.gid=F}}};z=function(D){var E=v[this.id],C=E&&E.gid;if(m&&C){m.setAttributeGeometry(C,"color",D.color.hex("#"));if(D.fill){m.setAttributeGeometry(C,"fillcolor",D.fill.hex("#"))}if(D.size){m.setAttributeGeometry(C,"size",D.size);m.setAttributeGeometry(C,"width",D.size)}}};x=function(E){var D=v[this.id],C=D&&D.gid;if(m&&C){m.setGeometryVisible(C,E.toString())}};t.initializing.done(function(){m=t.instance.plugins.canvas;m.addEventListener("click",r);m.addEventListener("mouseover",r);m.addEventListener("mouseout",r)});k=this.features=[];this.bind=function(C,D){var E=this,F=function(){var G=Array.prototype.slice.call(arguments,1);D.apply(E,G)};e(q).on(C,F);if(!D.gcunbind){D.gcunbind={}}D.gcunbind[o+C]=F;return this};this.unbind=function(C,E){var D=this,F;F=E.gcunbind&&E.gcunbind[o+C];e(q).off(C,F);return this};this.draw=function(D,G,F){var C,E=this;if(y&&y.state()==="pending"){m.endDraw()}if(D===false){return y.promise()}else{h=function(H){var I;if(H&&H.geom){I=new giscloud.GraphicFeature(giscloud.geometry.fromOGC(H.geom));if(I){v[I.id]={gid:C,feat:I,ind:E.features.length};z.call(I,I.style());E.features.push(I);I.bind("geometryChanged",A);I.bind("styleChanged",z);I.bind("visibilityChanged",x);y.resolveWith(E,[I])}else{y.rejectWith(E,[])}}else{y.rejectWith(E,[])}B=false};if(D==="point"||D==="line"||D==="polygon"){y=new e.Deferred();m.addEventListener("add",h);y.always(function(){m.removeEventListener("add",h)});if(typeof G==="function"){y.done(G)}if(typeof F==="function"){y.fail(F)}C=m.add(D);B=true;return y.promise()}else{throw"Invalid type. Use 'point', 'line' or 'polygon'."}}};this.cancelDraw=function(){if(y&&y.state()==="pending"){m.endDraw({cancel:true});y.reject()}return this};this.add=function(C){var D=this;t.initializing.done(function(){var G,E,F;if(C.constructor===giscloud.GraphicFeature){E=C.toOGC();if(E){F=C.style();G=m.deserializeGeometryOpenGIS({geom:E,color:F.color&&F.color.hex("0x"),fillcolor:F.fill&&F.fill.hex("0x"),alpha:(F.fill&&(F.color.alpha()<F.fill.alpha()))?F.fill.alpha():F.color.alpha(),width:F.size,size:F.size});v[C.id]={gid:G,feat:C,ind:D.features.length};D.features.push(C);C.bind("geometryChanged",A);C.bind("styleChanged",z);C.bind("visibilityChanged",x)}}});return this};this.edit=function(F){var E,C=v[F.id],D=this;if(!C){throw"Unknown graphic feature."}if(n&&n.state()==="pending"){this.cancel()}E=m.getGeometry?m.getGeometry(C.gid):giscloud.geometry.fromOGC(m.serializeGeometryOpenGIS(C.gid));n=(new e.Deferred()).done(function(){var G=m.getGeometry?m.getGeometry(C.gid):giscloud.geometry.fromOGC(m.serializeGeometryOpenGIS(C.gid));F.geometry(G)}).fail(function(){F.geometry(E)});m.editGeometry(C.gid);return n.pipe(function(){return F},function(){return F})};this.editAccept=function(){if(n&&n.state()==="pending"){n.resolve()}return this};this.editCancel=function(){if(n&&n.state()==="pending"){n.reject()}return this};this.remove=function(C){var D=this;t.initializing.done(function(){var E;if(C.constructor===giscloud.GraphicFeature){C=C.id}E=v[C];if(E!==g){m.remove(E.gid);D.features.splice(E.ind,1);E.feat.unbind("geometryChanged",A);E.feat.unbind("styleChanged",z);E.feat.unbind("visibilityChanged",x);delete v[C];E=null}});return this};this.clear=function(){if(m){if(y&&y.state()==="pending"){m.endDraw()}m.clear();e.each(this.features,function(C,D){D.unbind("geometryChanged",A);D.unbind("styleChanged",z);D.unbind("visibilityChanged",x)});this.features=[];v={}}return this}};giscloud.GraphicFeature=function(h,m){var n=a.oid(),q,k,o=true;if(!m||m.constructor!==giscloud.GraphicStyle){if(h instanceof giscloud.geometry.Point||h instanceof giscloud.geometry.Multipoint){k=new giscloud.GraphicStyle("point")}else{if(h instanceof giscloud.geometry.Line||h instanceof giscloud.geometry.Multiline){k=new giscloud.GraphicStyle("line")}else{if(h instanceof giscloud.geometry.Polygon||h instanceof giscloud.geometry.Multipolygon){k=new giscloud.GraphicStyle("polygon")}else{k=new giscloud.GraphicStyle()}}}}else{k=m}q=h;this.geometry=function(r){if(r){q=r;e(this).triggerHandler("geometryChanged",[q]);return this}else{return q}};this.style=function(r){if(r){k=r;e(this).triggerHandler("styleChanged",[k]);return this}else{return k}};this.visibility=function(r){if(typeof r==="boolean"){o=r;e(this).triggerHandler("visibilityChanged",[o]);return this}else{return o}};this.id="graphic"+n;this.bind=function(r,t){var u=this,v=function(){var x=Array.prototype.slice.call(arguments,1);t.apply(u,x)};e(this).on(r,v);if(!t.gcunbind){t.gcunbind={}}t.gcunbind[n+r]=v;return this};this.unbind=function(r,t){var u;u=t.gcunbind&&t.gcunbind[n+r];e(this).off(r,u);return this};this.toOGC=function(){if(q){return q.toOGC()}else{return null}}};giscloud.GraphicStyle=function(){var h=arguments[0];if(typeof h==="string"){switch(h){case"point":e.extend(true,this,f.pointStyle);break;case"line":e.extend(true,this,f.lineStyle);break;case"polygon":e.extend(true,this,f.polygonStyle);break;default:break}}else{this.color=(h.color!==g&&h.color.constructor===giscloud.Color)?h.color:null;this.fill=(h.fill!==g&&h.fill.constructor===giscloud.Color)?h.fill:null;this.size=(typeof h.size==="number")?h.size:null}};f={pointStyle:new giscloud.GraphicStyle({color:new giscloud.Color(0,0,0,100),fill:new giscloud.Color(255,0,0,100),size:10}),lineStyle:new giscloud.GraphicStyle({color:new giscloud.Color(0,0,0,100),size:1}),polygonStyle:new giscloud.GraphicStyle({color:new giscloud.Color(0,0,0,100),fill:new giscloud.Color(255,0,0,100)})}})(window,giscloud.exposeJQuery(),giscloud.common());(function(e,c){var h,g,a,f=/[a-z0-9._%+\-]+@[a-z0-9.\-]+/i;if(c){h=c.exposeJQuery();g=c.common().md5}else{h=e.jQuery;g=e.md5}a={hash:function(k){if(typeof k==="string"){return g(k.toLowerCase())}else{return null}},url:function(m,k,o){var n,q;if(f.test(m)){n=this.hash(m)}else{n=m}if(typeof k!=="number"){k=80}if(o){q="https:"}else{q=(e.location.protocol=="https:"?"https:":"http:")}return q+"//www.gravatar.com/avatar/"+n+"?r=g&s="+k},image:function(q,n,k,r){var o,m;m=h("<img/>",{src:this.url(q,n,r)});if(k){o=h("#"+k)}if(o&&o.length===1){o.append(m)}return m}};if(c){c.gravatar=a}else{e.gravatar=a}}(window,typeof giscloud!=="undefined"?giscloud:null));(function(c,e,a,f){giscloud.Map=function(){var q=this,m=arguments,n=m.length,k={},o=a.oid(),r,h;e.extend(this,{id:null,name:null,description:null,owner:null,active:null,copyright:null,proj4:null,units_proj4:null,units:null,maxzoom:null,share:null,mobileacess:null,bgcolor:null,wmsaccess:null,modified:null,accessed:null,created:null,visited:null,bounds:null});if(typeof m[0]=="number"){this.id=m[0];this.refresh(m[2],m[1])}else{if(typeof m[0]=="object"){r=m[0];this.id=parseInt(r.id,10);this.name=r.name;this.description=r.description;this.owner=r.owner;this.active=r.active;this.copyright=r.copyright;this.proj4=r.proj4;this.units=r.units;this.units_proj4=r.units_proj4;this.maxzoom=r.maxzoom;this.share=r.share;this.mobileacess=r.mobileacess;this.bgcolor=r.bgcolor;this.wmsaccess=r.wmsaccess;this.modified=new Date(r.modified*1000);this.accessed=new Date(r.accessed*1000);this.created=new Date(r.created*1000);this.visited=isNaN(r.visited)?null:parseInt(r.visited,10);if(r.options){this.options=r.options}if(r.bounds){try{h=r.bounds&&e.parseJSON(r.bounds)}catch(g){h=null}if(h){this.bounds=new giscloud.Bounds(parseFloat(h.xmin),parseFloat(h.ymin),parseFloat(h.xmax),parseFloat(h.ymax))}}if(m[1]){this.refreshLayers(m[2])}e.extend(true,this,{remove:function(){return giscloud.maps.remove(this.id)},update:function(){var t;r.name=this.name;if(this.bounds){t={xmin:this.bounds.left,ymin:this.bounds.bottom,xmax:this.bounds.right,ymax:this.bounds.top}}if(JSON===f){giscloud.includeJs((c.location.protocol=="https:"?"https:":"http:")+"//giscloud.local/libs/json2/json2.min.js").done(function(){r.bounds=JSON.stringify(t);return giscloud.maps.update(r.id,r)})}else{r.bounds=JSON.stringify(t)}r.description=this.description;r.active=this.active;r.copyright=this.copyright;r.proj4=this.proj4;r.units=this.units;r.units_proj4=this.units_proj4;r.maxzoom=this.maxzoom;r.share=this.share;r.mobileacess=this.mobileacess;r.bgcolor=this.bgcolor;r.wmsaccess=this.wmsaccess;return giscloud.maps.update(r.id,r)},clone:function(){var t={};e.extend(t,r);delete t.id;return giscloud.maps.create(t)},users:function(){var t,u,v={owner:null,editors:[],viewers:[]};if(typeof this.owner==="object"){v.owner={id:this.owner.id,username:this.owner.username}}else{v.owner=this.owner}u=a.rest.get("maps/"+this.id+"/sharing").done(function(x){if(x&&x.data&&x.data.length){e.each(x.data,function(y,z){if(z.view==="t"){v.viewers.push({id:z.user_id,username:z.username})}if(z.edit==="t"){v.editors.push({id:z.user_id,username:z.username})}})}});t=e.when(u);return t.pipe(function(){return v}).promise()}})}else{a.setError(this,"constructor","Invalid constructor arguments")}}};e.extend(giscloud.Map.prototype,{refresh:function(n,k){var h=this,m=this.id,g=function(o){if(typeof n=="function"){n(o)}};if(typeof m===f||m===null){a.setError(this,"refresh","Map id is not set.")}else{giscloud.maps.byId(m,function(o){h.name=o.name;h.description=o.description;h.owner=o.owner;h.active=o.active;h.copyright=o.copyright;h.proj4=o.proj4;h.units=o.units;h.units_proj4=o.units_proj4;h.maxzoom=o.maxzoom;h.share=o.share;h.mobileacess=o.mobileacess;h.bgcolor=o.bgcolor;h.wmsaccess=o.wmsaccess;h.modified=new Date(o.modified);h.accessed=new Date(o.accessed);h.created=new Date(o.created);if(o.bounds){b=o.bounds&&e.parseJSON(o.bounds);if(b){h.bounds=new giscloud.Bounds(parseFloat(b.xmin),parseFloat(b.ymin),parseFloat(b.xmax),parseFloat(b.ymax))}}if(k){h.refreshLayers(g)}else{g(h)}},true)}return this},refreshLayers:function(k){var g=this,h=this.id;if(!isFinite(h)){a.setError(this,"refreshLayers","Map id is not set.")}else{giscloud.layers.byMapId(h,function(m){g.layers=m;if(typeof k=="function"){k(g)}})}return this},reset:function(g){return giscloud.maps.reset(this.id,g)},imageUrl:function(h,g){if(typeof h!=="number"&&typeof g!=="number"){h=400;g=400}return a.rest.url("maps/"+this.id+"/render.png?width="+h+"&height="+g+"&timestamp="+this.modified)},iframeUrl:function(n,g){var k,h,q,m,o;if(typeof n==="object"){h=n}k=a.rest.url("maps/"+this.id+"/render.iframe");if(h){q=[];for(m in h){if(h.hasOwnProperty(m)){o=(h[m]!=null)?h[m].toString():"";q.push(m+"="+o)}}k+=q.length>0?"?"+q.join("&"):""}else{if(typeof n==="number"&&typeof g==="number"){k+="?width="+n+"&height="+g}}return k}})})(window,giscloud.exposeJQuery(),giscloud.common());(function(c,a,e){giscloud.Task=function(f){c.extend(this,{id:f&&f.id||null,owner:f&&f.owner_id||null,type:f&&f.task_type_id||null,params:f&&f.params||null,alternateEmail:f&&f.alternate_email||null,status:f&&!isNaN(f.status)?f.status:null,priority:f&&!isNaN(f.priority)?f.priority:null,appId:f&&!isNaN(f.appId)?f.gc_app_id:null,timeSpent:f&&!isNaN(f.time_spent)?f.time_spent:null,requested:f&&!isNaN(f.timestamp_requested)&&new Date(f.timestamp_requested)||null,processed:f&&!isNaN(f.timestamp_processed)&&new Date(f.timestamp_processed)||null,scheduled:f&&!isNaN(f.timestamp_scheduled)&&new Date(f.timestamp_scheduled)||null})};giscloud.Task.prototype={create:function(f){return giscloud.tasks.create({task_type_id:this.type,alternate_email:this.alternateEmail,gc_app_id:this.appId,priority:this.priority,params:f||this.params})},remove:function(){return giscloud.tasks.remove(this.id)}}})(giscloud.exposeJQuery(),giscloud.common());(function(c,e,a,f){giscloud.ui={Toolbar:function(y){var r=this,o,h,q=y.viewer,g=a.oid(),u={},z,x=[],n={},v=function(A){var k="gctoolbar_"+g+"_"+A.name,B;B=e("<div/>",{id:k,"class":y.type==="vertical"?"gc-toolbar-placeholder gc-toolbar-placeholder-vertical":"gc-toolbar-placeholder gc-toolbar-placeholder-horizontal"});B.appendTo(z);A.render(k);u[A.name]=k},t=function(k){var A=x.length>0?x[x.length-1]:null,B;if(A){B=r.tools[A];B.deactivate()}x.push(k.name);if(x.length>99){x.shift()}e(n).triggerHandler("toolChange",[B,k])},m=function(){var k=x.length>0?x[x.length-1]:null;if(k){r.tools[k].activate()}};if(!a.toolbarCssIncluded){giscloud.includeCss(a.apiHost()+"/assets/api/1/css/toolbar.css");a.toolbarCssIncluded=true}this.viewer=q;this.tools={};if(y.container){z=e("#"+y.container);z.addClass("gc-toolbar");if(y.type==="vertical"){z.addClass("gc-toolbar-vertical")}else{z.addClass("gc-toolbar-horizontal")}}this.add=function(){var C,A,B,D=true;for(C=0,A=arguments.length;C<A;C++){B=arguments[C];if(B&&B instanceof giscloud.ui.Toolbar.Tool){if(!B.toolbar||B.toolbar!==this){B.toolbar=this}else{D=false}this.tools[B.name]=B;B.bind("activation",t);B.bind("deactivation",m);if(y.container&&D){v(B)}}}return this};if(y.defaultTools){for(o=0,h=y.defaultTools.length;o<h;o++){this.add(giscloud.ui.defaultTools.tool(y.defaultTools[o]))}if(e.inArray("pan",y.defaultTools)>-1){this.tools.pan.activate()}}this.remove=function(k){var A=e.inArray(k,x);if(A>-1&&A===x.length-1){this.deactivateTool()}else{if(A>-1){x.splice(A,1)}}delete this.tools[k];if(u[k]){e("#"+u[k]).remove();delete u[k]}return this};this.bind=function(k,B){var A=this,C;if(k&&typeof k=="string"&&typeof B=="function"){C=function(){var D=Array.prototype.slice.call(arguments,1);B.apply(A,D)};e(n).on(k,C);if(!B.gcunbind){B.gcunbind={}}B.gcunbind[g+k]=C}return this};this.unbind=function(k,A){var B;if(k&&typeof k=="string"&&typeof A=="function"){B=A.gcunbind&&A.gcunbind[g+k];if(B){e(n).off(k,B)}}return this};this.toolChange=function(k){return this.bind("toolChange",k)}}};giscloud.ui.Toolbar.Tool=function(g,r){var o,q,k=false,n,t,h=a.oid(),m={};this.name=g;this.isToggle=function(){return n};this.isActive=function(){return k};this.toolbar=r.toolbar;this.viewer=r.viewer;o=r.actions.activation;q=r.actions.deactivation;n=r.toggle;this.activate=function(z){var v=this,x=(this.toolbar&&this.toolbar.viewer)||this.viewer,u=Array.prototype.slice.call(arguments,0),y="gctool_"+this.name+"_"+h;if(!k&&x){x.initializing.done(function(){if(r.instant){u.splice(0,0,this);o.apply(this,u)}else{k=true;e("#"+y).addClass(r.styles.active||"gc-tool-active");if(!z){e(m).triggerHandler("activation",[v])}if(o){u.splice(0,0,this);o.apply(v,u)}}})}return this};this.deactivate=function(z){var v=this,x=(this.toolbar&&this.toolbar.viewer)||this.viewer,u=Array.prototype.slice.call(arguments,0),y="gctool_"+this.name+"_"+h;if(k&&x){x.initializing.done(function(){k=false;e("#"+y).removeClass(r.styles.active||"gc-tool-active");if(q){u.splice(0,0,this);q.apply(v,u)}if(!z){e(m).triggerHandler("deactivation",[v])}})}return this};this.render=function(u){var D=this,F=r.styles||{},v="gctool_"+this.name+"_"+h,E,A,x,B,C,z,y;if(!a.toolbarCssIncluded){giscloud.includeCss(a.apiHost()+"/assets/api/1/css/toolbar.css");a.toolbarCssIncluded=true}t=e("#"+u);t.html("");if(F.icon){E="gctoolicon_"+this.name+"_"+h;C=e("<img/>",{id:E,src:F.icon,alt:F.caption||""});if(F.iconHover){A="gctoolicon_hover_"+this.name+"_"+h;z=e("<img/>",{id:A,src:F.iconHover,alt:F.caption||"",css:{display:"none"}})}if(F.iconActive){x="gctoolicon_active_"+this.name+"_"+h;y=e("<img/>",{id:x,src:F.iconActive,alt:F.caption||"",css:{display:"none"}})}}B=e("<div/>",{id:v,"class":F.cssClass||"gc-tool",title:F.caption||"",mouseover:function(G){e(this).addClass(F.hover||"gc-tool-hover");if(z){z.show();y.hide();C.hide()}G.stopPropagation();G.preventDefault()},mouseout:function(G){e(this).removeClass(F.hover||"gc-tool-hover");if(z){z.hide();if(k){y.show();C.hide()}else{y.hide();C.show()}}G.stopPropagation();G.preventDefault()},click:function(G){if(r.instant){D.activate()}else{if(k&&n){D.deactivate()}else{if(!k){D.activate()}}G.stopPropagation();G.preventDefault()}}});if(E){B.append(C);if(x){B.append(y)}if(A){B.append(z)}}else{if(F.caption&&F.showCaption){B.append(F.caption)}else{B.append("&nbsp;")}}B.appendTo("#"+u);return this};this.bind=function(u,x){var v=this,y;if(u&&typeof u=="string"&&typeof x=="function"){y=function(){var z=Array.prototype.slice.call(arguments,1);x.apply(v,z)};e(m).on(u,y);if(!x.gcunbind){x.gcunbind={}}x.gcunbind[h+u]=y}return this};this.unbind=function(u,v){var x;if(u&&typeof u=="string"&&typeof v=="function"){x=v.gcunbind&&v.gcunbind[h+u];if(x){e(m).off(u,x)}}return this}};giscloud.ui.defaultTools={pan:function(){return new giscloud.ui.Toolbar.Tool("pan",{styles:{caption:"Pan",showCaption:false,cssClass:"gc-tool-pan",active:"gc-tool-pan-active",hover:"gc-tool-pan-hover"},actions:{activation:function(g){g.pan()}}})},zoom:function(){return new giscloud.ui.Toolbar.Tool("zoom",{styles:{caption:"Zoom",showCaption:false,cssClass:"gc-tool-zoom",active:"gc-tool-zoom-active",hover:"gc-tool-zoom-hover"},actions:{activation:function(g){g.areaZoom()}}})},full:function(){return new giscloud.ui.Toolbar.Tool("full",{styles:{caption:"Full",showCaption:false,cssClass:"gc-tool-full",active:"gc-tool-full-active",hover:"gc-tool-full-hover"},actions:{activation:function(g){g.fullExtent()}},instant:true})},measure:function(){return new giscloud.ui.Toolbar.Tool("measure",{styles:{caption:"Measure",showCaption:false,cssClass:"gc-tool-measure",active:"gc-tool-measure-active",hover:"gc-tool-measure-hover"},actions:{activation:function(g){g.measure()}}})},select:function(){return new giscloud.ui.Toolbar.Tool("select",{styles:{caption:"Select",showCaption:false,cssClass:"gc-tool-select",active:"gc-tool-select-active",hover:"gc-tool-select-hover"},actions:{activation:function(g){g.select(true)}}})},info:function(){return new giscloud.ui.Toolbar.Tool("info",{styles:{caption:"Select",showCaption:false,cssClass:"gc-tool-info",active:"gc-tool-info-active",hover:"gc-tool-info-hover"},actions:{activation:function(g){g.select(true)}}})},areaSelect:function(){var h=a.oid(),g=function(m){var k=new giscloud.Bounds(parseFloat(m.xMin),parseFloat(m.yMin),parseFloat(m.xMax),parseFloat(m.yMax)),n=a.refs[h];a.refs[h].selectFeaturesByBounds(n.activeLayer,k)};return new giscloud.ui.Toolbar.Tool("areaSelect",{styles:{caption:"Select area",showCaption:false,cssClass:"gc-tool-areaselect",active:"gc-tool-areaselect-active",hover:"gc-tool-areaselect-hover"},actions:{activation:function(k){k.loading.done(function(){var m=this.instance;a.refs[h]=this;m.addEventListener("areaselection",g);m.setTool("AreaSelection")})},deactivation:function(k){k.loading.done(function(){this.instance.removeEventListener("areaselection",g);this.instance.setTool("DragTool");delete a.refs[h]})}}})},pickCoordinates:function(){var g;function h(k){g.coordinates=k;g.deactivate()}g=new giscloud.ui.Toolbar.Tool("pickCoordinates",{styles:{caption:"Coordinate picker",showCaption:false,cssClass:"coordinate-tool",active:"coordinate-tool-active",hover:"coordinate-tool-hover"},actions:{activation:function(k){this.coordinates=null;k.loading.done(function(){e(k.container()).addClass("gc-cursor-crosshair");k.bind("mouseDown",h)})},deactivation:function(k){k.loading.done(function(){k.unbind("mouseDown",h);e(k.container()).removeClass("gc-cursor-crosshair")})}}});return g},selectExtent:function(){var n,C,H,D,R,J,aa,B,v,S,Z,P,K,ab,k,U,W,t={color:"#0033ff",weight:4,opacity:1},y={color:"#33ff33",weight:8},T=function(ac){n={};H=ac.viewer;D=H.instance,C=D.exposeLeaflet();R=new L.DivIcon({className:"gc-select-extent-label"});n.dragging=C.dragging.enabled();C.dragging.disable();C.on("mousedown",G);e(H.container()).addClass("gc-cursor-crosshair")},M=function(){x();C.off("mousedown",G).off("mousemove",r).off("mousedown",x).off("mousemove",m).off("mousemove",o).off("mousemove",g).off("mousemove",h);e(H.container()).removeClass("gc-cursor-crosshair")},G=function(ac){var ae=ac.latlng,ad=new L.LatLngBounds(ae,ae);B=ae.lat;v=ae.lng;C.off("mousedown",G);C.off("mousedown",x);C.on("mousemove",r);e(document).on("mouseup",z);aa=new L.Rectangle(ad).addTo(C)},r=function(ac){var ad=X(ac.latlng);aa.setBounds(ad);Y(ad)},z=function(){C.off("mousemove",r);e(document).off("mouseup",z);C.on("mousedown",x);C.on("mousedown",G);Q()},Y=function(ag){var ay=ag.getCenter(),af=ag.getNorthEast(),ao=ag.getSouthWest(),aq=af.lat,aw=af.lng,am=ao.lat,aj=ao.lng,ah=D.fromLeafletCoords(af),ak=D.fromLeafletCoords(ao),al=ah.y,an=ah.x,ax=ak.y,ar=ak.x,ai=new L.LatLng(aq,ay.lng),ad=new L.LatLng(ay.lat,aw),av=new L.LatLng(ay.lat,aj),ae=new L.LatLng(am,ay.lng),au,ac,ap,at;if(S==null){S=new L.Marker(ai,{icon:R,html:al}).addTo(C);Z=new L.Marker(ad,{icon:R,html:an}).addTo(C);K=new L.Marker(av,{icon:R,html:ar}).addTo(C);P=new L.Marker(ae,{icon:R,html:ax}).addTo(C)}else{S.setLatLng(ai)._icon.innerHTML=al;Z.setLatLng(ad)._icon.innerHTML=an;K.setLatLng(av)._icon.innerHTML=ar;P.setLatLng(ae)._icon.innerHTML=ax}au=e(S._icon);ac=e(Z._icon);ap=e(K._icon);at=e(P._icon);au.css("margin-left",au.outerWidth()/-2).css("margin-top",-25);ac.css("margin-left",5).css("margin-top",ac.outerHeight()/-2);ap.css("margin-left",ap.outerWidth()*-1-5).css("margin-top",ap.outerHeight()/-2);at.css("margin-left",at.outerWidth()/-2).css("margin-top",5)},q=function(){if(S==null){return}C.removeLayer(S);C.removeLayer(Z);C.removeLayer(K);C.removeLayer(P);S=null;Z=null;K=null;P=null},Q=function(){var ae=aa.getBounds(),ag=ae.getNorthEast(),ac=ae.getSouthWest(),ad=new L.LatLng(ag.lat,ac.lng),af=new L.LatLng(ac.lat,ag.lng);aa.setStyle({stroke:false});ab=new L.Polyline([ad,ag],t).addTo(C).on("mouseover",O).on("mouseout",u).on("mousedown",F);k=new L.Polyline([af,ag],t).addTo(C).on("mouseover",O).on("mouseout",u).on("mousedown",F);U=new L.Polyline([ac,ad],t).addTo(C).on("mouseover",O).on("mouseout",u).on("mousedown",F);W=new L.Polyline([ac,af],t).addTo(C).on("mouseover",O).on("mouseout",u).on("mousedown",F)},O=function(ac){var ad=ac.target;if(J){return}C.removeLayer(ad).addLayer(ad);ac.target.setStyle(y)},u=function(ac){ac.target.setStyle(t)},F=function(ac){var ad=ac.target;if(J){return}J=ad;ad.off("mouseover",O).off("mouseout",u);e(document).on("mouseup",V);switch(ad){case ab:C.on("mousemove",m);break;case k:C.on("mousemove",o);break;case U:C.on("mousemove",g);break;case W:C.on("mousemove",h);break}},V=function(){e(document).off("mouseup",V);switch(J){case ab:C.off("mousemove",m);break;case k:C.off("mousemove",o);break;case U:C.off("mousemove",g);break;case W:C.off("mousemove",h);break}J.on("mouseover",O).on("mouseout",u);J=null},m=function(ac){var af=aa.getBounds(),ai=af.getNorthEast(),ah=af.getSouthWest(),ag=C.latLngToContainerPoint(ah),ad=ac.containerPoint.y,ae=ag.y;if(ad>ae-y.weight){return}af=new L.LatLngBounds(new L.LatLng(ac.latlng.lat,ai.lng),ah);aa.setBounds(af);Y(af);I(af)},o=function(ac){var af=aa.getBounds(),ai=af.getNorthEast(),ah=af.getSouthWest(),ag=C.latLngToContainerPoint(ah),ad=ac.containerPoint.x,ae=ag.x;if(ad<ae+y.weight){return}af=new L.LatLngBounds(new L.LatLng(ai.lat,ac.latlng.lng),ah);aa.setBounds(af);Y(af);I(af)},g=function(ac){var af=aa.getBounds(),ai=af.getSouthWest(),ah=af.getNorthEast(),ag=C.latLngToContainerPoint(ah),ad=ac.containerPoint.x,ae=ag.x;if(ad>ae-y.weight){return}af=new L.LatLngBounds(ah,new L.LatLng(ai.lat,ac.latlng.lng));aa.setBounds(af);Y(af);I(af)},h=function(ac){var af=aa.getBounds(),ai=af.getSouthWest(),ah=af.getNorthEast(),ag=C.latLngToContainerPoint(ah),ad=ac.containerPoint.y,ae=ag.y;if(ad<ae+y.weight){return}af=new L.LatLngBounds(ah,new L.LatLng(ac.latlng.lat,ai.lng));aa.setBounds(af);Y(af);I(af)},I=function(ae){var ag=ae.getNorthEast(),ac=ae.getSouthWest(),ad=new L.LatLng(ag.lat,ac.lng),af=new L.LatLng(ac.lat,ag.lng);ab.setLatLngs([ad,ag]);k.setLatLngs([af,ag]);U.setLatLngs([ac,ad]);W.setLatLngs([ac,af])},N=function(){if(ab==null){return}C.removeLayer(ab);C.removeLayer(k);C.removeLayer(U);C.removeLayer(W);ab=null;k=null;U=null;W=null},x=function(){if(aa==null){return}q();N();C.removeLayer(aa);B=null;v=null;aa=null},X=function(ae){var ac=new L.LatLng(Math.min(B,ae.lat),Math.min(v,ae.lng)),ad=new L.LatLng(Math.max(B,ae.lat),Math.max(v,ae.lng));return new L.LatLngBounds(ac,ad)},E=function(){var ac=aa&&aa.getBounds(),ag,aj,ah,af,ak,ad,ai,ae;if(ac==null){return null}ag=ac.getNorthEast();aj=ac.getSouthWest();ah=D.fromLeafletCoords(ag);af=D.fromLeafletCoords(aj);ak=ah.y;ad=ah.x;ai=af.y;ae=af.x;return new giscloud.Bounds(ae,ai,ad,ak)},A=function(){n.dragging?C.dragging.enable():C.dragging.disable()};return new giscloud.ui.Toolbar.Tool("selectExtent",{extent:null,styles:{caption:c.gclang&&gclang["Select extent"]||"Select extent",showCaption:false,cssClass:"gc-tool-selectextent",active:"gc-tool-selectextent-active",hover:"gc-tool-selectextent-hover"},actions:{activation:function(ad){var ac=this;this.extent=null;ad.loading.done(function(){T(ac)})},deactivation:function(ad){var ac=this;ad.loading.done(function(){ac.extent=E();M();A()})}}})},tool:function(g){switch(g){case"pan":return this.pan();case"zoom":return this.zoom();case"full":return this.full();case"measure":return this.measure();case"select":return this.select();case"info":return this.info();case"areaSelect":return this.areaSelect();case"selectExtent":return this.selectExtent();default:return null}}}})(window,giscloud.exposeJQuery(),giscloud.common());(function(k,h,m,f){var e,c,n,g,a,o,q;giscloud.ui.LayerList=function(A,t){var C=this,x=m.oid(),z={},B,u,G,F,v,r,E,y,D;giscloud.layers.byMapId(A.mapId).done(function(H){B=H;u={};h.each(B,function(I,J){u[J.id.toString()]=J});G=e(H,t,x,A);G.on({"before.jstree":function(){},"check_node.jstree":function(I,J){F(J.rslt.obj[0].id)},"uncheck_node.jstree":function(I,J){v(J.rslt.obj[0].id)},"check_all.jstree":function(I,J){r()},"uncheck_all.jstree":function(I,J){E()},"select_node.jstree":function(J,K){var I=K.rslt.obj[0].id.split("_");h(z).triggerHandler("select",["select",I[1],I[2],u[I[2]]])},"unselect_node.jstree":function(J,K){var I=K.rslt.obj[0].id.split("_");h(z).triggerHandler("unselect",["unselect",I[1],I[2],u[I[2]]])},"dblclick.jstree":function(K){var I=h(K.target).closest("li"),J=I.attr("id").split("_");h(z).triggerHandler("dblclick",["dblclick",J[1],J[2],u[J[2]]])}});h("#"+t).on("move_node.jstree",function(){var I=o(G),J={};h.each(A.layers,function(K,M){J[M.id]=M.instance.refId});A.instance.setLayersOrder(h.map(I,function(K){return J[K.id]}))})});this.bind=function(H,I){var J=this,K=function(){var M=Array.prototype.slice.call(arguments,1);I.apply(J,M)};h(z).on(H,K);if(!I.gcunbind){I.gcunbind={}}I.gcunbind[x+H]=K;return this};this.unbind=function(H,I){var J;J=I.gcunbind&&I.gcunbind[x+H];h(z).off(H,J);return this};this.select=function(H){if(H){if(!h.isArray(H)){H=[H]}h.each(H,function(I,J){var K;if(!(J instanceof giscloud.Layer)){J=u[J]}K=x+(J.type==="folder"?"_folder_":"_layer_")+J.id;G.jstree("select_node","#"+K)})}return this};this.unselect=function(H){if(H){if(!h.isArray(H)){H=[H]}h.each(H,function(I,J){var K;if(!(J instanceof giscloud.Layer)){J=u[J]}K=x+(J.type==="folder"?"_folder_":"_layer_")+J.id;G.jstree("deselect_node","#"+K)})}return this};this.selected=function(){return h.map(G.jstree("get_selected"),function(H){var I=H.id.split("_");return u[I[2]]})};this.check=function(H){if(H){if(!h.isArray(H)){H=[H]}h.each(H,function(I,J){var K;if(!(J instanceof giscloud.Layer)){J=u[J]}K=x+(J.type==="folder"?"_folder_":"_layer_")+J.id;G.jstree("check_node","#"+K)})}return this};this.uncheck=function(H){if(H){if(!h.isArray(H)){H=[H]}h.each(H,function(I,J){var K;if(!(J instanceof giscloud.Layer)){J=u[J]}K=x+(J.type==="folder"?"_folder_":"_layer_")+J.id;G.jstree("uncheck_node","#"+K)})}return this};this.checkAll=function(){G.jstree("check_all");return this};this.uncheckAll=function(){G.jstree("uncheck_all");return this};this.layers=function(){return B};this.width=function(H){if(H===f){return h("#"+t).width()}h("#"+t).width(H);return this};this.height=function(H){if(H===f){return h("#"+t).height()}h("#"+t).height(H);return this};this.layersOrder=function(){return o(G)};F=function(M){var K,J,I,H=M.split("_");if(H[1]==="layer"){A.showLayer(H[2])}else{I=y(M);if(I){for(K=0,J=I.length;K<J;K++){A.showLayer(I[K])}}}};v=function(M){var K,J,I,H=M.split("_");if(H[1]==="layer"){A.hideLayer(H[2])}else{I=y(M);if(I){for(K=0,J=I.length;K<J;K++){A.hideLayer(I[K])}}}};r=function(){h.each(A.layers,function(H,I){I.visible(true)})};E=function(){h.each(A.layers,function(H,I){I.visible(false)})};y=function(I){var H=[];h("#"+I).find("li[rel!='style']").each(function(J,K){if(this.id.indexOf("folder")===-1){H.push(this.id.split("_")[2])}});return a(H)};D=function(J,I){var H=A.layerById(J);if(H){H.selectable(I)}}};e=function(y,u,x,z){var t,r=c(y,x),v={plugins:["themes","json_data","checkbox","ui","types","dnd"],types:{max_depth:-2,max_children:-2,valid_children:["layer","folder"],types:{layer:{valid_children:["style"]},folder:{valid_children:["layer","folder"]},style:{valid_children:[],start_drag:false,move_node:false,hover_node:false,dehover_node:false,select_node:false}}},json_data:{data:r},themes:{url:m.apiHost()+"/libs/jstree/rc3/themes/giscloud/style.css",theme:"giscloud",dots:false},ui:{selected_parent_close:false},core:{animation:0}};t=h("#"+u).on("loaded.jstree",function(A){q(h(A.target),z)}).jstree(v);return t};c=function(A,u){var B,y,D,v,r,x,z,E=[],t={},C=[];if(!A){return{}}for(B=0,y=A.length;B<y;B++){D=A[B];v=null;if(D.type==="folder"){r="folder"+D.id;if(t[r]){t[r].obj=D;v=t[r]}else{v={id:r,obj:D,nodes:[]};t[r]=v}}else{r="layer"+D.id;v={id:r,obj:D}}if(D.parent===null){E.push(v)}else{z="folder"+D.parent;if(!t[z]){t[z]={id:D.parent,obj:null,nodes:[]}}t[z].nodes.push(v)}}x=function(G){var F;F=G.sort(g);return h.map(F,function(H){var I;if(H.nodes){return{data:{title:H.obj.name,icon:n("folder")},children:x(H.nodes),attr:{rel:"folder",id:u+"_folder_"+H.obj.id,"class":"jstree-undetermined"}}}else{I=H.obj.styles;if(I&&I.length>1){return{data:{title:H.obj.name,icon:n(null,"multi")},attr:{rel:"layer",id:u+"_layer_"+H.obj.id,"class":H.obj.visible==="t"?"jstree-checked":""},children:h.map(I,function(J){return{data:{title:(J.showlabel?J.label:J.expression)||"",icon:n("geometry",J.symbol||((J.galleryUrl||J.url)&&J)||{type:H.obj.type,color:J.color,border:J.bordercolor})},attr:{rel:"style","class":"jstree-style-node"}}})}}else{I=I&&I[0];return{data:{title:H.obj.name,icon:n(H.obj.type,I&&(I.symbol||((I.galleryUrl||I.url)&&I)||{type:H.obj.type,color:I.color,border:I.bordercolor}))},attr:{rel:"layer",id:u+"_layer_"+H.obj.id,"class":H.obj.visible==="t"?"jstree-checked":""}}}}})};C=x(E);return C};g=function(v,u){var t,r;if(typeof v.obj.order==="string"){t=parseInt(v.obj.order,10);r=parseInt(u.obj.order,10)}else{t=v.obj.order;r=u.obj.order}return r-t};o=function(r,t){var u=0,v=function(x){return h.map(x.find("ul:first").children(),function(z){var A=h(z),y;if(A.is("[rel='folder']")){return v(A)}else{if(t){return u++}else{y=z.id.split("_");return{id:y[2],type:y[1],order:u++}}}})};return v(r)};a=function(x){var u,t,v,r=[];for(u=0,t=x.length;u<t;u++){v=x[u];if(Object.prototype.toString.call(v)==="[object Array]"){r=r.concat(a(v))}else{r.push(v)}}return r};n=function(t,u){var r,v=(k.location.protocol=="https:"?"https:":"http:");if(u==="multi"){r="/assets/images/layertree/color_swatch.gif"}else{switch(t){case"folder":r="/assets/images/layertree/folder.gif";break;case"raster":r="/assets/images/image.gif";break;case"wms":case"tile":r="/assets/images/world.gif";break;case"point":case"line":case"polygon":case"geometry":if(u.galleryUrl){r=u.galleryUrl.replace(/^.*rest/i,"")}else{if(u.url){r="/assets/icon.php?p="+encodeURI(u.url)}else{r="/assets/icon.php?type="+u.type+"&color="+u.color+"&border="+u.border+"&bw=0&size=10"}}break;default:return null}}return m.apiHost().replace("http:",v)+r};q=function(r,u){var t=r.find("li[rel='layer']");t.each(function(y,z){var B=z.id,A=B&&B.split("_"),v=A&&A.length&&A[2],x=u.layerById(v);if(!x||!x.selectable||h.inArray(x.type,["point","line","polygon"])===-1){return}h("<ins/>",{"class":(x.selectable()?"jstree-no-lock-icon":"jstree-lock-icon"),click:function(F){if(!u){return}var D=h(F.target),E=D.closest("li"),C=E.attr("id").split("_");if(D.hasClass("jstree-lock-icon")){u.layerById(C[2]).selectable(true);D.addClass("jstree-no-lock-icon");D.removeClass("jstree-lock-icon")}else{u.layerById(C[2]).selectable(false);D.addClass("jstree-lock-icon");D.removeClass("jstree-no-lock-icon")}F.stopPropagation();F.preventDefault()}}).insertAfter(h(z).find("a > ins.jstree-checkbox"))})}}(window,giscloud.exposeJQuery(),giscloud.common()));(function(c,e,a,f){giscloud.ddupload=(function(g){var o=this,q,u,h,t=true,n,k,m,v,r;this.init=function(x){if(!o.support()){return false}h=["Drop your files to upload to GIS Cloud"];if(e(".gc-drag-n-drop-strip").length==0){e("<div class='gc-drag-n-drop-strip gc-drag-n-drop-strip-top' ></div>").appendTo(g);e("<div class='gc-drag-n-drop-strip gc-drag-n-drop-strip-bottom' ></div>").appendTo(g);e("<div class='gc-drag-n-drop-strip gc-drag-n-drop-strip-left' ></div>").appendTo(g);e("<div class='gc-drag-n-drop-strip gc-drag-n-drop-strip-right' ></div>").appendTo(g)}n=e('<div class="gc-uploader" ><div class="gc-uploader-status" ></div></div>').appendTo("body");k=n.children(".gc-uploader-status");m=e('<div class="gc-upload-progress-bar" ></div></div>').appendTo(n);n.click(function(){o.hide()});e("body").click(function(){o.hide(true)});g.bind({dragover:function(y){o.dropZoneEnter(y);return false},dragleave:function(y){o.dropZoneLeave(y)},dragend:function(y){o.dropZoneLeave(y,true);return false},drop:function(A){A.preventDefault();o.dropZoneLeave(A,true);if(!t){return}var z=A.originalEvent.dataTransfer.files;o.files=[];for(var y=0;y<z.length;y++){o.files.push(z[y])}g.trigger("uploadstart",o.files);o.files_uploaded=[];o.num_of_files_for_upload=o.files.length;o.num_of_files_uploaded=0;o.startUpload()}});o.upload_dir("")};this.setMessage=function(x){h[0]=x};this.upload_dir=function(x){u=x;q=a.rest.url()+"storage/fs"+u};this.support=function(){return !!c.FormData&&("upload" in new XMLHttpRequest)};this.accept=function(x){t=x};this.dropZoneEnter=function(x){g.trigger("dropzoneenter",[x]);if(t){this.dropZoneGreen()}else{this.dropZoneRed()}e(".gc-drag-n-drop-strip").addClass("hover");giscloud.ui.alert.show(h[0])};this.dropZoneLeave=function(z,y,x){if(y||(z.originalEvent.screenX==0&&z.originalEvent.screenY==0)){e(".gc-drag-n-drop-strip").removeClass("hover");if(!x){giscloud.ui.alert.hide()}}};this.dropZoneRed=function(y,x){e(".gc-drag-n-drop-strip").addClass("red");giscloud.ui.alert.color("red")};this.dropZoneGreen=function(y,x){e(".gc-drag-n-drop-strip").removeClass("red");giscloud.ui.alert.color("green")};this.hide=function(x){o.dropZoneLeave(null,true,x);if(!r){n.fadeOut()}else{if(!x){alert("Upload in progress...")}}};this.abortUpload=function(x){o.dropZoneLeave(null,true);if(v){v.abort()}};this.startUpload=function(){var x=jQuery.map(o.files,function(y){return y.name});giscloud.log.push("upload_start",{type:"dnd",count:x.length,files:x.join()});this.uploadRemainingFiles()};this.uploadRemainingFiles=function(){if(o.files.length>0){o.uploadFile(o.files.pop())}else{k.html("Uploaded "+o.num_of_files_uploaded+" files. ");e('<a href="javascript:;" >Hide</a>').appendTo(k).click(o.hide);giscloud.log.push("upload_completed",{type:"dnd",uploaded:o.num_of_files_uploaded});g.trigger("uploadcomplete",[u,o.files_uploaded])}};this.uploadFile=function(x){if(!x){return}var y=new FormData();y.append("file",x);k.html("Uploading '"+x.name+"'... ");e('<a href="javascript:;" >Cancel</a>').appendTo(k).click(o.abortUpload);n.fadeIn();if(1){v=new XMLHttpRequest();v.open("POST",q);v.onload=function(z){r=false;if(z.currentTarget.status!=201){giscloud.log.push("upload_error",{type:"dnd",error:z.currentTarget.statusText});k.html("<span class='gc-red' >Upload error: "+z.currentTarget.statusText+"</span>");return}giscloud.log.push("upload_file_completed",{type:"dnd",file:x.name});o.files_uploaded.push(x);o.num_of_files_uploaded++;o.uploadRemainingFiles();m.progressbar({value:100})};v.onabort=function(){k.html("Uploading canceled. ");giscloud.log.push("upload_aborted",{type:"dnd"});e('<a href="javascript:;" >Hide</a>').appendTo(k).click(o.hide);m.progressbar({value:0});r=false};if(1){v.upload.onprogress=function(A){if(A.lengthComputable){var z=(A.loaded/A.total*100|0);m.progressbar({value:z})}}}giscloud.log.push("upload_file",{type:"dnd",file:x.name});r=true;v.send(y)}};this.init()})})(window,window.giscloud.exposeJQuery(),window.giscloud.common());(function(k){var f;var h=[0,3614090360,3905402710,606105819,3250441966,4118548399,1200080426,2821735955,4249261313,1770035416,2336552879,4294925233,2304563134,1804603682,4254626195,2792965006,1236535329,4129170786,3225465664,643717713,3921069994,3593408605,38016083,3634488961,3889429448,568446438,3275163606,4107603335,1163531501,2850285829,4243563512,1735328473,2368359562,4294588738,2272392833,1839030562,4259657740,2763975236,1272893353,4139469664,3200236656,681279174,3936430074,3572445317,76029189,3654602809,3873151461,530742520,3299628645,4096336452,1126891415,2878612391,4237533241,1700485571,2399980690,4293915773,2240044497,1873313359,4264355552,2734768916,1309151649,4149444226,3174756917,718787259,3951481745],y=[[0,7,1],[1,12,2],[2,17,3],[3,22,4],[4,7,5],[5,12,6],[6,17,7],[7,22,8],[8,7,9],[9,12,10],[10,17,11],[11,22,12],[12,7,13],[13,12,14],[14,17,15],[15,22,16]],v=[[1,5,17],[6,9,18],[11,14,19],[0,20,20],[5,5,21],[10,9,22],[15,14,23],[4,20,24],[9,5,25],[14,9,26],[3,14,27],[8,20,28],[13,5,29],[2,9,30],[7,14,31],[12,20,32]],t=[[5,4,33],[8,11,34],[11,16,35],[14,23,36],[1,4,37],[4,11,38],[7,16,39],[10,23,40],[13,4,41],[0,11,42],[3,16,43],[6,23,44],[9,4,45],[12,11,46],[15,16,47],[2,23,48]],q=[[0,6,49],[7,10,50],[14,15,51],[5,21,52],[12,6,53],[3,10,54],[10,15,55],[1,21,56],[8,6,57],[15,10,58],[6,15,59],[13,21,60],[4,6,61],[11,10,62],[2,15,63],[9,21,64]];function x(A,C,B){return(A&C)|(~A&B)}function u(A,C,B){return(A&B)|(C&~B)}function r(A,C,B){return A^C^B}function o(A,C,B){return C^(A|~B)}var n=[[x,y],[u,v],[r,t],[o,q]];function e(A){return String.fromCharCode(A&255)+String.fromCharCode((A>>>8)&255)+String.fromCharCode((A>>>16)&255)+String.fromCharCode((A>>>24)&255)}function a(A){return A.charCodeAt(0)|(A.charCodeAt(1)<<8)|(A.charCodeAt(2)<<16)|(A.charCodeAt(3)<<24)}function c(A){while(A<0){A+=4294967296}while(A>4294967295){A-=4294967296}return A}function z(I,O,D,C,A){var H,G,F,E,B,N,K,M,J;H=C[0];G=C[1];F=C[2];E=C[3];B=A[0];N=A[1];K=A[2];J=D(O[G],O[F],O[E]);M=O[H]+J+I[B]+h[K];M=c(M);M=((M<<N)|(M>>>(32-N)));M+=O[G];O[H]=c(M)}function g(H){var C,N,B,O,M,K,I,J,A,G,E,D,F;B=[1732584193,4023233417,2562383102,271733878];M=H.length;K=M&63;I=(K<56)?(56-K):(120-K);if(I>0){H+="\x80";for(G=0;G<I-1;G++){H+="\x00"}}H+=e(M*8);H+=e(0);M+=I+8;C=[0,1,2,3];N=[16];O=[4];for(D=0;D<M;D+=64){for(G=0,E=D;G<16;G++,E+=4){N[G]=H.charCodeAt(E)|(H.charCodeAt(E+1)<<8)|(H.charCodeAt(E+2)<<16)|(H.charCodeAt(E+3)<<24)}for(G=0;G<4;G++){O[G]=B[G]}for(G=0;G<4;G++){J=n[G][0];A=n[G][1];for(E=0;E<16;E++){z(N,O,J,C,A[E]);F=C[0];C[0]=C[3];C[3]=C[2];C[2]=C[1];C[1]=F}}for(G=0;G<4;G++){B[G]+=O[G];B[G]=c(B[G])}}return e(B[0])+e(B[1])+e(B[2])+e(B[3])}function m(D){var C,B,E;var A;A=g(D);B="";for(C=0;C<16;C++){E=A.charCodeAt(C);B+="0123456789abcdef".charAt((E>>4)&15);B+="0123456789abcdef".charAt(E&15)}return B}f=function(A){return m(A.toString())};giscloud.md5=f;if(k){k.md5=f}else{window.md5=f}}(typeof giscloud!=="undefined"?giscloud.common():null));if(!window.giscloud){window.giscloud={};giscloud.common=function(){return null}}(function(window,$,common,undefined){var giscloud_url="http:///";if(common){giscloud_url=common.appSite()}var giscloud_tile_url=(giscloud_config.tileSite())?giscloud_config.tileSite():giscloud_url;var isWebKit=(navigator.userAgent.indexOf("WebKit")>0);var tile_buffer=new Array();var isMouseDown;var fields;var _selectablePoly;var bounds;var selectionEnabled=false;var laycount=0;var loader_id=0;var active_loaders={};var tile_request={};var tile_req=[];var tile_req_seq=0;giscloud.Html5MapRefreshUrls=function(){giscloud_url=common.appSite();giscloud_tile_url=giscloud_config.tileSite()?giscloud_config.tileSite():giscloud_url};giscloud.Html5MapSetSelection=function(v){selectionEnabled=v};giscloud.html5ResetLoaders=function(){var r;for(r in active_loaders){if(!active_loaders[r]){continue}if(active_loaders[r].dest){active_loaders[r].dest._layer._tileOnError.call(active_loaders[r].dest)}if(active_loaders[r].abort){active_loaders[r].abort()}active_loaders[r]=null}loader_id++;tile_req=[];tile_request={}};giscloud.Html5Map=function(o,parent){_init(o,this);this.parent=parent;giscloud.Html5SendRequests=function(){sendRequests()};this._layer=o;laycount++;function _getTile(coord,zoom,ownerDocument,that){var m=Math.pow(2,zoom);var y=coord.y;if(y<0||y>=m){return ownerDocument.createElement("div")}var x=coord.x%m;var tile=jsonCanvas(ownerDocument,that);var uri=zoom+"/"+x+"/"+y;if(that.url){var tileurl=that.url+uri;if(fields){ajaxLoader(drawGeomCanvas,tileurl+".json?fields="+fields,tile.c,uri)}else{ajaxLoader(drawGeomCanvas,tileurl+".json",tile.c,uri)}}else{tile_buffer.push({tile:tile.c,uri:uri})}return tile}function sendRequests(){var r;while(r=tile_req.shift()){if(r.that.url2){ajaxLoader(drawTile,r.that.url2+tile_request[r.uri].timestamps.join(",")+"/"+r.that.mid+"/"+tile_request[r.uri].layers.join(",")+"/"+r.uri_for_request+".json",r.tile,r.uri)}else{if(r.that.url3){ajaxLoader(drawTile,r.that.url3+tile_request[r.uri].timestamps.join(",")+"/"+r.that.mid+"/"+tile_request[r.uri].layers.join(",")+"/dyn,"+r.that.t+"/"+r.uri_for_request+".json",r.tile,r.uri)}else{tile_buffer.push({tile:tile,uri:uri})}}}}function _loadTile(tile,coord,zoom,that){var uri="";if(that.feature_filter){uri=that.feature_filter.attributes+"/";tile.feature_filter_attributes=that.feature_filter.attributes}else{tile.feature_filter_attributes=null}uri+=zoom+"/"+coord.x+"/"+coord.y;tile.obj=that;tile.zoom=zoom;tile.coord=coord;tile._loader_id=loader_id;tile.uri_for_request=uri;uri+="/"+that.mid;tile.uri=uri;if(tile.obj.parent.group){var lids=[];var timestamps=[];for(var i=0;i<tile.obj.parent.group.length;i++){if(tile.obj.parent._tileShouldBeLoaded(coord,tile.obj.parent.group[i])){lids.push(tile.obj.parent.group[i].options.id);timestamps.push(tile.obj.parent.group[i].options.modified)}}if(lids.length==0){return}that.lid=lids.join(",");that.modified=timestamps.join(",")}if(!tile_request[uri]){tile_req_seq++;tile_request[uri]={tiles:[],layers:[],timestamps:[],seq:tile_req_seq,present:{}};tile_req.push({coord:coord,tile:tile,that:that,uri:uri,uri_for_request:tile.uri_for_request})}if(!tile_request[uri].present[that.lid]){tile_request[uri].tiles.push(tile);tile_request[uri].layers.push(that.lid);tile_request[uri].timestamps.push(that.modified);tile_request[uri].present[that.lid]=true}}function ajaxLoader(func,url,dest,uri){if(document.getElementById){var x=(window.XDomainRequest)?new XDomainRequest():new XMLHttpRequest();if(window.XDomainRequest){x.xdomain=1}}if(x){x.tile_request=tile_request[uri];tile_request[uri]=null;x.seq=x.tile_request.seq;x.dest=dest;active_loaders[x.seq]=x;x.onreadystatechange=function(){var el=el||{};if(x.xdomain||x.readyState==4){var d=0;var el;if(x.xdomain||x.status==200){el=x.dest;if(x.responseText&&x.responseText[0]!="<"&&x.responseText!="[0]"){if(window.JSON){d=window.JSON.parse(x.responseText)}else{d=eval("("+x.responseText+")")}}}if(d&&d.length&&!el.obj.dynamic){var tiles=x.tile_request.tiles;var offset=0;for(var i=0;i<tiles.length;i++){var tile=tiles[i];if(tile.obj&&tile.obj.processTiles){offset+=tile.obj.processTiles(func,x.tile_request,d,i,offset)}else{if(d[i]){func(tile,d[i],tile.obj.parent)}}if(tile&&tile.ontileload){tile.ontileload()}}}else{if(el){if(el.obj&&el.obj.processTiles){el.obj.processTiles(func,x.tile_request,d,0,0,true)}else{if(d){func(el,d,el.obj.parent)}}if(el.ontileload){el.ontileload()}}}if(active_loaders[this.seq]){delete active_loaders[this.seq]}}};if(x.xdomain){x.onerror=function(){if(active_loaders[this.seq]){delete active_loaders[this.seq]}};x.ontimeout=function(){if(active_loaders[this.seq]){delete active_loaders[this.seq]}};x.onprogress=function(){};x.onload=x.onreadystatechange}x.open("GET",url);x._url=url;x.send()}}this._loadTile=_loadTile;this.setFields=function(_fields){fields=_fields};this.getTile=function(coord,zoom,ownerDocument){return _getTile(coord,zoom,ownerDocument,this)};this.loadTile=function(tile,coord,zoom){_loadTile(tile,coord,zoom,this)};this.selectablePoly=function(v){_selectablePoly=v};this.setBounds=function(b){bounds=b};this.onMouseMove=function(evt,force,offset,layer){if(layer._selectable){return checkForEvent(evt,force,offset)}else{return false}};this.onMouseUp=function(evt){};this.onMouseDown=function(evt){};this.modifyObject=function(a,b,c,d,e,f){var a0=a;a=new String(a).split(",");if(!c){c=""}var color;if(isNaN(b.color)){color=b.color}else{color="#"+b.color.toString(16)}if(this.parent.group){var sign=a0+color+c+d+e+f;if(this.modify_sign==sign){return}this.modify_sign=sign}var h=new Object();h.color=color;h.linewidth=1;var toClear=null;var toClearLayers=null;if(d){toClear=this.modifier;toClearLayers=this.modifier_layers;this.modifier={}}this.modifier_layers={};for(var i=0;i<a.length;i++){if(a[i]==""){continue}var layer=(c+a[i]).split("||")[0];var key=(c+a[i]).replace("||","_");this.modifier[key]=h;this.modifier_layers[layer]=1}if(!this.parent.group){if(toClearLayers){for(var layer in toClearLayers){drawAcrossTiles(this,toClear,layer)}}for(var layer in this.modifier_layers){drawAcrossTiles(this,toClear,layer)}}else{this.activeLayer=null;this.redraw()}toClear=null};this.redraw=function(){var current_filter_attributes=null;if(this.feature_filter&&this.feature_filter.attributes){current_filter_attributes=this.feature_filter.attributes}redraw(this,current_filter_attributes)};this.redrawSingleTile=function(tile){var current_filter_attributes=null;if(this.feature_filter&&this.feature_filter.attributes){current_filter_attributes=this.feature_filter.attributes}redrawSingleTile(this,tile,current_filter_attributes)};this.reload=function(){var c=this.getCanvases();for(var i in c){if(c[i].coord){c[i].styles=null;_loadTile(c[i],c[i].coord,c[i].zoom,this)}}};this.resetLoader=function(){giscloud.html5ResetLoaders()};this.getFeature=function(feature){var f=feature.replace("||","_");var c=this.getCanvases();for(var i in c){if(c[i].fields&&c[i].fields[f]){return c[i].fields[f]}}};this.initStyles=function(){var c=this.getCanvases();for(var i in c){initStyles(c[i])}};return this};function _init(o,that){if(o.map){that.gmap=1;that.tileSize=new google.maps.Size(256,256)}that.modifier={};that.hoverStyle={fill:"rgba(255,0,0,0.8)",stroke:"rgba(255,0,0,0.8)"};that.mid=o.mid;that.timestamp=o.timestamp;that.lid=o.id;that.lmap=o.lmap;fields="";that.map=o.map;if(o.tooltip){that.tooltip=document.createElement("div");that.tooltip.style.position="absolute";that.tooltip.style.padding="1px";that.tooltip.style.border="1px solid #CCC";that.tooltip.style.backgroundColor="#FAF3A9";that.tooltip.style.zIndex=1000;document.body.appendChild(that.tooltip);giscloud.Html5MapTooltip=that.tooltip}_selectablePoly=0;$(document).mousedown(function(evt){isMouseDown=true});$(document).mouseup(function(evt){isMouseDown=false});if(!o.modified){ajaxLoader(getTimestamp,giscloud_url+"rest/1/maps/"+mid+"/get_modified_timestamp.json?"+Math.random(),that)}else{getTimestamp(that,o)}}function InsidePolygon(d,x,y){var counter=0;var i;var xinters;var p1,p2;var N=d.length/2;p1x=d[0];p1y=d[1];for(i=1;i<=N;i++){p2x=d[2*(i%N)];p2y=d[2*(i%N)+1];if(y>minn(p1y,p2y)){if(y<=maxx(p1y,p2y)){if(x<=maxx(p1x,p2x)){if(p1y!=p2y){xinters=(y-p1y)*(p2x-p1x)/(p2y-p1y)+p1x;if(p1x==p2x||x<=xinters){counter++}}}}}p1x=p2x;p1y=p2y}if(counter%2==0){return 0}else{return 1}}function TouchesPath(d,x,y,r){var i;var N=d.length;var p1x=d[0];var p1y=d[1];for(var i=2;i<N;i+=2){var p2x=d[i];var p2y=d[i+1];var dirx=p2x-p1x;var diry=p2y-p1y;var diffx=x-p1x;var diffy=y-p1y;var t=1*(diffx*dirx+diffy*diry*1)/(dirx*dirx+diry*diry*1);if(t<0){t=0}if(t>1){t=1}var closestx=p1x+t*dirx;var closesty=p1y+t*diry;var dx=x-closestx;var dy=y-closesty;if((dx*dx+dy*dy)<=r*r){return 1}p1x=p2x;p1y=p2y}return 0}function checkForEvent(evt,force,delta){if(!force&&isMouseDown){return}var c=evt.currentTile;if(!c.data){return}var x,y;if(evt.offsetX>=0){x=evt.offsetX;y=evt.offsetY}else{x=evt.layerX;y=evt.layerY}x+=c._offset[c.layer];y+=c._offset[c.layer];return handleEvent(c,x,y,evt,delta)}var hoverModifier={};function handleEvent(c,x,y,evt,delta){if(!selectionEnabled||c.data_type[c.layer]=="text"){return false}var cc=c;var d=0;if(c.data){d=c.data[c.layer]}if(!d){return false}var r=4;if(!delta){delta=0}if(c.data_type[c.layer]=="point"){r=delta}var xr=x+r;var xl=x-r;var yt=y-r;var yb=y+r;var minpoint_dist=100000;var last_point_index=-1;var candidate=-1;var i;var shouldRedraw=false;for(i=d.length-1;i>=0;i--){if(d[i].visible&&xr>=d[i].b.xmin&&xl<=d[i].b.xmax&&yb>=d[i].b.ymin&&yt<=d[i].b.ymax&&(d[i].ispoint||(d[i].ispoly&&!d[i].ispoint&&InsidePolygon(d[i].p,x,y))||(!d[i].ispoly&&!d[i].ispoint&&TouchesPath(d[i].p,x,y,r)))){if(d[i].ispoint){var dist=pointDistance(d[i].x,d[i].y,x,y);if(dist<minpoint_dist){candidate=i;minpoint_dist=dist}}else{candidate=i}}}if(candidate>=0){var elem=null;var firstElem=candidate;elem=d[candidate];var selected=d[firstElem];if(flashnavigator.hasCanvas){if(hoverModifier.isset){if(c.obj._hoveredElement===selected.c&&c.layer===hoverModifier.layer){if(c.fields&&c.fields[elem.c]){elem.attributes=c.fields[elem.c]}return elem}shouldRedraw=clearHover()||shouldRedraw}if(!c.obj.modifier[selected.c]){var style_index=0;if(selected.ispoint){style_index=selected.i}else{style_index=selected.s}c.styles=c.styles_data[c.layer];hoverModifier.isset=true;hoverModifier.color=c.styles[style_index].highlightcolor;hoverModifier.hover=true;hoverModifier.orig=c.obj.modifier[selected.c];hoverModifier.orig_obj=c.obj;hoverModifier.orig_key=selected.c;hoverModifier.layer=c.layer;hoverModifier.layerObj=c.curLayerObj;c.obj.modifier[selected.c]=hoverModifier;c.obj._hoveredElement=selected.c;shouldRedraw=drawAcrossTiles(c.obj,true)||shouldRedraw}else{c.obj._hoverModifier=null}}if(c.fields&&c.fields[elem.c]){elem.attributes=c.fields[elem.c]}if(shouldRedraw){c.obj.redraw()}return elem}if(flashnavigator.hasCanvas&&hoverModifier.isset&&c.layer===hoverModifier.layer){shouldRedraw=clearHover()||shouldRedraw}if(shouldRedraw){c.obj.redraw()}return false}function setupTile(el,data){if(!el.dyndata){return}el.styles=el.curLayerObj.features;var g=data.geom;var c=0;var s;var sindex;var l=null;var slen=0;if(data.tile){l=data.tile.l;slen=l.length-1}var style=0;var id;for(var i=0,len=g.length;i<len;i++){var c=g[i].c.split("_")[1];if(el.dyndata[c]){g[i].dyn=el.dyndata[c]}}for(var i=0;i<slen;i+=5){if(l[i]<0){id=-l[i];style=l[i+1];i++}else{id=l[i]}var x=l[i+1];var y=l[i+2];var dx=l[i+3];var dy=l[i+4];var o={p:[x,y,x+dx,y+dy],id:id,s:style,c:el._layer.id+"_"+id,px:true};if(el.dyndata[o.id]>=0){o.dyn=el.dyndata[o.id]}g.push(o)}data.geom.sort(function(a,b){return b.dyn-a.dyn});el.pixels2=null;if(data.tile){data.tile.pixels=null}}function drawTile(el,data,layer,dontRender,offset){el.curLayerObj=layer;el.layer=el.layer||el.obj.parent.id;el.data=el.data||{};el.data_type=el.data_type||{};el._offset=el._offset||{};el._canvas_offset=el._canvas_offset||0;if(offset){expandCanvas(el,offset)}if(loader_id===el._loader_id){el._offset[el.layer]=0;if(flashnavigator.hasCanvas){ctx=el.getContext("2d");if(el._drawn&&!dontRender){ctx.clearRect(0,0,el.width,el.height)}}el._drawn=true;if(el._layer.options.dynamic&&data[1]){el.dyndata=data[1];data=data[0]}if(data.tile){if(data.tile.type=="text"){el.data[el.layer]=data.tile.data;el.fields=data.fields;drawText(el,dontRender);data.geom=null}if(data.tile.type=="point"){el.data[el.layer]=data.tile.data;el.fields=data.fields;parsePoint(el,data);el.styles=data.styles;initStyles(el);drawPoint(el);data.geom=null}}if(data.geom){setupTile(el,data);el.styles=data.styles;initStyles(el);if(!flashnavigator.hasCanvas){el.img=L.DomUtil.create("img","",el);el.img_url=el.obj.url+el.zoom+"/"+el.coord.x+"/"+el.coord.y+".png";el.img.src=el.img_url}drawGeom(el,data,dontRender)}}data.tile=null;data.fields=null;data=null}function setupPaperOverlay(el){el.overlay=L.DomUtil.create("div","",el);el.overlay.style.position="absolute";el.overlay.style.top="0px";el.overlay.style.left="0px";el.overlay.style.width=el.width;el.overlay.style.height=el.height}function newCanvas(oldCanvas){var newCanvas=document.createElement("canvas");newCanvas.width=oldCanvas.width;newCanvas.height=oldCanvas.height;return newCanvas}function redrawSingleTile(that,tile,current_filter_attributes){var o=tile,ctx,w;if(current_filter_attributes!=o.feature_filter_attributes){that._loadTile(o,o.coord,o.zoom,that);return true}var b_layer=o.layer;var b_layerObj=o.curLayerObj;if(o.getContext){ctx=o.getContext("2d");ctx.clearRect(0,0,o.width,o.height)}if(that.parent.group){if(!o.obj.activeLayer||o.activeLayerId!=o.obj.activeLayer.uniqueId){if(o.obj.activeLayer){o.activeLayerId=o.obj.activeLayer.uniqueId}else{o.activeLayerId=null}o.canvasCachePre=newCanvas(o);o.canvasCachePost=newCanvas(o);o.forceCtx=o.canvasCachePre.getContext("2d");for(var j=0;j<that.parent.group.length;j++){if(o.obj.activeLayer==that.parent.group[j]){o.forceCtx=o.canvasCachePost.getContext("2d");continue}if(that.parent.group[j].visible){o.layer=that.parent.group[j].id;o.curLayerObj=that.parent.group[j];redrawTile(o)}}}o.forceCtx=null;ctx.globalAlpha=1;ctx.drawImage(o.canvasCachePre,0,0);if(o.obj.activeLayer&&o.obj.activeLayer.visible){o.layer=o.obj.activeLayer.id;o.curLayerObj=o.obj.activeLayer;redrawTile(o)}ctx.globalAlpha=1;ctx.drawImage(o.canvasCachePost,0,0)}else{redrawTile(o)}o.layer=b_layer;o.curLayerObj=b_layerObj;return false}function redraw(that,current_filter_attributes){var c=that.getCanvases();var should_send_req=false;for(var i in c){should_send_req=redrawSingleTile(that,c[i],current_filter_attributes)||should_send_req}if(should_send_req){giscloud.Html5SendRequests()}}function redrawTile(o){if(!o._drawn||!o.data){return}if(o.data_type[o.layer]=="text"){drawText(o)}else{if(o.data_type[o.layer]=="point"){if(!o.obj.parent.group){w=o.width;o.width=1;o.width=w}o._original=null;drawPoint(o)}else{drawGeomInternal(o)}}}function drawAcrossTiles(that,toClear){if(that.parent.group){that.activeLayer=hoverModifier.isset?hoverModifier.layerObj:null;return true}var i;var c=that.getCanvases();for(i in c){toClear&&clearTile(c[i]);drawTileUsingModifier(c[i],that)}return false}function clearTile(tile){if(tile._modified&&tile._original){ctx=tile.getContext("2d");rectCrop(tile._invalidateRect,0,ctx.canvas.width);var w=tile._invalidateRect.xmax-tile._invalidateRect.xmin;var h=tile._invalidateRect.ymax-tile._invalidateRect.ymin;if(w>0&&h>0){var offset=tile._canvas_offset-tile._offset[tile.layer];ctx.clearRect(offset+tile._invalidateRect.xmin,offset+tile._invalidateRect.ymin,w,h);ctx.drawImage(tile._original,offset+tile._invalidateRect.xmin,offset+tile._invalidateRect.ymin,w,h,offset+tile._invalidateRect.xmin,offset+tile._invalidateRect.ymin,w,h)}tile._invalidateRect=null;tile._modified=false}if(tile._modified&&tile.img&&tile.data_type[tile.layer]!="point"){if(tile.img.src!=tile.img_url){tile.img.src=tile.img_url}tile._invalidateRect=null;tile._modified=false}}function drawTileUsingModifier(tile,that){if(!tile.lista){return}if(!tile.getContext){return drawTileUsingModifierNonCanvas(tile,that)}var ctx,id,j,lst,use_custom_renderer,layer;tile._path=null;ctx=null;use_custom_renderer=giscloud.mapFeatureRenderer!=null;var lista=tile.lista[tile.layer];for(id in that.modifier){if(!that.modifier[id]||!lista||!lista[id]||lista[id].length==0){continue}lst=lista[id];layer=id.split("_")[0];if(!tile.data[layer]){continue}tile.styles=tile.styles_data[layer];if(!tile._original){tile._original=document.createElement("canvas");tile._original.width=tile.width;tile._original.height=tile.height;tile._original.getContext("2d").drawImage(tile,0,0)}if(!ctx){ctx=tile.forceCtx||tile.getContext("2d");if(tile._canvas_offset&&tile.obj.parent.group){ctx.beginPath();ctx.rect(tile._canvas_offset,tile._canvas_offset,256,256);ctx.clip()}}for(j in lst){var d=tile.data[layer][lst[j]];if(!d||!d.b){continue}tile._modified=true;var offset=0;if(d.ispoint){drawImage(tile,that,ctx,d,null,that.modifier[id])}else{finishPoly(tile,ctx);var s=overrideStyle(tile.styles[d.s],that.modifier[id]);offset=0;if(use_custom_renderer){var w={};for(var k in s){w[k]=s[k]}s=w;giscloud.mapFeatureRendererHighlight(d,s)}s.linewidth&&(offset=s.linewidth);s.width&&(offset+=s.width);drawCanvasPolygon(tile,ctx,d.p,s,d.s,id,null,1,use_custom_renderer)}if(!tile._invalidateRect){tile._invalidateRect={};rectAssign(tile._invalidateRect,d.b,offset)}else{rectUnion(tile._invalidateRect,d.b,offset)}}}if(ctx){finishPoly(tile,ctx)}}function clearHover(){var o_obj=hoverModifier.orig_obj;var shouldRedraw=false;if(o_obj.modifier[hoverModifier.orig_key]&&o_obj.modifier[hoverModifier.orig_key].hover){if(hoverModifier.orig){o_obj.modifier[hoverModifier.orig_key]=hoverModifier.orig}else{o_obj.modifier[hoverModifier.orig_key]=null}shouldRedraw=drawAcrossTiles(o_obj,true)}hoverModifier.isset=false;return shouldRedraw}function drawTileUsingModifierNonCanvas(tile,that){var use_custom_renderer=giscloud.mapFeatureRenderer!=null;var mod_ids_used={};var mod_ids_grouped={};var override_style="";var lista=tile.lista[tile.layer];for(id in that.modifier){if(!that.modifier[id]||!lista||!lista[id]||lista[id].length==0){continue}lst=lista[id];for(j in lst){var d=tile.data[tile.layer][lst[j]];if(!d||!d.b){continue}tile._modified=true;var offset=0;if(d.ispoint){drawImageAsDOM(tile,d,null,that.modifier[id])}else{var s=overrideStyle(tile.styles[d.s],that.modifier[id]);offset=0;if(use_custom_renderer){var w={};for(var k in s){w[k]=s[k]}s=w;giscloud.mapFeatureRendererHighlight(d,s)}s.linewidth&&(offset=s.linewidth);s.width&&(offset+=s.width);var i=id.split("_")[1];if(!mod_ids_used[i]){mod_ids_used[i]=1;override_style="000000,0,";if(s.strokecolor){override_style+=s.strokecolor.substr(1)+","+s.linewidth+","}else{override_style+="000000,0,"}if(s.fillcolor){override_style+=s.fillcolor.substr(1)}else{override_style+="000000"}if(!mod_ids_grouped[override_style]){mod_ids_grouped[override_style]=[]}mod_ids_grouped[override_style].push(i)}}}}var s="";for(var i in mod_ids_grouped){s+=i+","+mod_ids_grouped[i].join(",")+";"}if(s){tile.img.src=tile.img_url+"?override_style="+s}}function overrideStyle(orig,o){var r={};if(o.color){var color;if(o.color==="selectcolor"){color=orig.selectcolor}else{color=o.color}r.color=color;if(orig.strokecolor){if(orig.type!="polygon"){r.strokecolor=color}else{r.strokecolor=orig.strokecolor}}if(orig.fillcolor){r.fillcolor=color}}else{if(orig.strokecolor&&o.strokecolor){r.strokecolor=o.strokecolor}else{r.strokecolor=orig.strokecolor}if(orig.fillcolor&&o.fillcolor){r.fillcolor=o.fillcolor}else{r.fillcolor=orig.fillcolor}r.innerlinewidth=orig.innerlinewidth}if(o.dashed){r.dashed=o.dashed}else{r.dashed=orig.dashed}r.linewidth=orig.linewidth;r.type=orig.type;r.visible=orig.visible;return r}function adjustLegacyStyles(styles){for(var i=0,len=styles.length;i<len;i++){if(styles[i].lw*1>0){styles[i].linewidth=styles[i].lw*1}if(styles[i].iw*1>0){styles[i].innerlinewidth=styles[i].iw*1}styles[i].fillcolor=styles[i].f;styles[i].strokecolor=styles[i].s;if(styles[i].i){styles[i].innerstrokecolor=styles[i].i}if(styles[i].f){styles[i].type="polygon"}}}function initStyles(el){el.styles_data=el.styles_data||{};if(el.styles){adjustLegacyStyles(el.styles)}else{el.styles=el.curLayerObj.features}for(var i=0,len=el.styles.length;i<len;i++){if(el.styles[i].type=="polygon"){if(!el.styles[i].linewidth){el.styles[i].linewidth=1}if(el.styles[i].fillcolor){el.styles[i].predominantColor=el.styles[i].fillcolor}else{el.styles[i].predominantColor=el.styles[i].strokecolor}}else{if(el.styles[i].innerstrokecolor&&el.styles[i].innerlinewidth>0){el.has_inner_line=true}}if(!el.styles[i].predominantColor){if(el.styles[i].strokecolor){el.styles[i].predominantColor=el.styles[i].strokecolor}else{if(el.styles[i].color){el.styles[i].predominantColor=el.styles[i].color}else{el.styles[i].predominantColor="#000000"}}}var c=common.getHighlightAndSelectColors(el.styles[i].predominantColor);el.styles[i].highlightcolor=c[0];el.styles[i].selectcolor=c[1]}el.styles_data[el.layer]=el.styles}function drawGeom(el,data,dontRender){var geom=data.geom;el.lista=el.lista||{};el.data=el.data||{};el.data_type=el.data_type||{};el.pixels=el.pixels||{};el.data[el.layer]=geom;if(!el.lista[el.layer]){el.lista[el.layer]=[]}el.data_type[el.layer]="geom";el.fields=data.fields;var lista=el.lista[el.layer];var that=el.obj;var len=geom.length;var sindex=-1;var s=null;var object,g;var i,j,glen,b;var offset=0;var precision=0;if(el._layer.options.offset){offset=el._layer.options.offset}if(el._layer.options.precision){precision=el._layer.options.precision}if(data.tile&&data.tile.pixels){el.pixels[el.layer]=data.tile.pixels;data.tile.pixels=null}var has_fields=0;if(data.fields){has_fields=1}for(i=len-1;i>=0;i--){object=geom[i];if(object.s>=0){sindex=object.s}else{object.s=sindex}b={};if(!lista[object.c]){lista[object.c]=[]}lista[object.c].push(i);if(sindex!=-1){s=el.styles[sindex]}if(s.type=="polygon"){object.ispoly=1}if(!object.initialized){var g=object.p;glen=g.length;if(precision>0){for(j=0;j<glen;j++){g[j]/=precision}}if(offset>0){doOffset(object,offset)}g=object.p;b={};b.xmin=b.xmax=g[0];b.ymin=b.ymax=g[1];for(j=2;j<glen;j+=2){if(g[j]<b.xmin){b.xmin=g[j]}else{if(g[j]>b.xmax){b.xmax=g[j]}}if(g[j+1]<b.ymin){b.ymin=g[j+1]}else{if(g[j+1]>b.ymax){b.ymax=g[j+1]}}}b.xmin=Math.floor(b.xmin);b.ymin=Math.floor(b.ymin);b.xmax=Math.ceil(b.xmax);b.ymax=Math.ceil(b.ymax);object.initialized=true;object.b=b;object.visible=true;if(has_fields){object.data=el.fields[object.c]}}}el.data[el.layer]=geom;geom=null;data.geom=null;data.style=null;if(!dontRender){drawGeomInternal(el)}}function drawGeomInternal(el){var geom,ctx,len,user_custom_renderer;if(!el.data){return}geom=el.data[el.layer];el.styles=el.styles_data[el.layer];el._original=null;if(!geom){return}var filter=null;if(el.obj.feature_filter&&el.obj.feature_filter.filter){filter=el.obj.feature_filter.filter}if(el.getContext){ctx=el.forceCtx||el.getContext("2d");if(el._canvas_offset){ctx.save();ctx.beginPath();ctx.rect(el._canvas_offset,el._canvas_offset,256,256);ctx.clip()}if(el.curLayerObj.isGroupLayer){ctx.globalAlpha=el.curLayerObj.options.opacity}else{ctx.globalAlpha=1}len=geom.length;if(el.pixels[el.layer]){drawPixels(ctx,el,!(el.obj.parent.group))}use_custom_renderer=giscloud.mapFeatureRenderer!=null;for(i=len-1;i>=0;i--){object=geom[i];sindex=object.s;if(sindex!=-1){s=el.styles[sindex]}if(use_custom_renderer){var w={};for(var k in s){w[k]=s[k]}s=w;giscloud.mapFeatureRenderer(object,s)}object.curs=s;if(!filter||(object.data&&filter(object.data))){object.visible=true;drawCanvasPolygon(el,ctx,object.p,object.curs,object.s,el.lastP,null,1,use_custom_renderer)}else{object.visible=false}}finishPoly(el,ctx);if(el.has_inner_line){for(i=len-1;i>=0;i--){object=geom[i];drawCanvasPolygon(el,ctx,object.p,object.curs,object.s,el.lastP,null,2,use_custom_renderer)}finishPoly2(el,ctx)}}if(el.obj.modifier){drawTileUsingModifier(el,el.obj)}if(el._canvas_offset){ctx.restore()}}function drawCanvasPolygon(el,ctx,d,c,cindex,id,clear,mode,forcerender){if(c.visible===false){return}var len,j;if(el.last_c&&el.last_c_index!=cindex||forcerender){if(mode!=2){finishPoly(el,ctx)}else{finishPoly2(el,ctx)}}if(!el._path){if(clear){ctx.globalCompositeOperation="destination-out"}ctx.lineCap="round";ctx.lineJoin="round";ctx.beginPath();el._path=1;el.last_c=c;el.last_c_index=cindex}len=d.length;if(el._canvas_offset){var offset=el._canvas_offset;ctx.moveTo(offset+d[0],offset+d[1]);for(j=2;j<len;j+=2){ctx.lineTo(offset+d[j],offset+d[j+1])}}else{ctx.moveTo(d[0],d[1]);for(j=2;j<len;j+=2){ctx.lineTo(d[j],d[j+1])}}if(clear){finishPoly(el,ctx);ctx.globalCompositeOperation="source-over"}el.lastP=id}function finishPoly(el,ctx){if(!el.last_c){return}var c=el.last_c;if(c.icon&&c.icon_image){if(!c.pattern){c.pattern=ctx.createPattern(c.icon_image,"repeat")}ctx.fillStyle=c.pattern;ctx.fill()}else{if(c.fillcolor){ctx.fillStyle=c.fillcolor;ctx.fill()}}if(c.strokecolor&&c.linewidth>0){if(c.dashed){if(ctx.setLineDash){ctx.setLineDash(c.dashed)}else{ctx.mozDash=c.dashed;ctx.webkitLineDash=c.dashed}}ctx.lineWidth=c.linewidth;ctx.strokeStyle=c.strokecolor;ctx.stroke();if(c.dashed){if(ctx.setLineDash){ctx.setLineDash([])}else{ctx.mozDash=[];ctx.webkitLineDash=[]}}}el.last_c=null;el.last_c_index=null;el._path=0}function finishPoly2(el,ctx){var el=ctx.canvas;if(!el.last_c){return}var c=el.last_c;if(c.innerstrokecolor){if(c.dashed){if(ctx.setLineDash){ctx.setLineDash(c.dashed)}else{ctx.mozDash=c.dashed;ctx.webkitLineDash=c.dashed}}ctx.strokeStyle=c.innerstrokecolor;ctx.lineWidth=c.innerlinewidth;ctx.stroke();if(c.dashed){if(ctx.setLineDash){ctx.setLineDash([])}else{ctx.mozDash=[];ctx.webkitLineDash=[]}}}el.last_c=null;el.last_c_index=null;el._path=0}function parsePoint(el,data){var offset=10;var i,d;var has_fields=0;var f;i=0;while(1){f=el.curLayerObj.features[i++];if(!f){break}if(f.clustering>offset){offset=f.clustering}}if(el._canvas_offset>offset){offset=el._canvas_offset}expandCanvas(el,offset);el.data_type[el.layer]="point";var tileData=el.data[el.layer];el.lista=el.lista||{};if(!el.lista[el.layer]){el.lista[el.layer]=[]}var lista=el.lista[el.layer];if(data.fields){has_fields=1}for(i=0;i<tileData.length;i++){d=tileData[i];d.x=offset+Math.round(((d.x-bounds.xmin)/bounds.max*Math.pow(2,el.zoom)-el.coord.x)*256);d.y=offset+Math.round(((bounds.ymax-d.y)/bounds.max*Math.pow(2,el.zoom)-el.coord.y)*256);d.id=d.id.replace("||","_");d.c=d.id;d.ispoint=true;if(has_fields){d.data=data.fields[d.id]}if(!lista[d.c]){lista[d.c]=[]}lista[d.c].push(i)}}function drawPoint(el,use_modifier){if(!flashnavigator.hasCanvas){drawPointDOM(el,use_modifier);return}var ctx=el.forceCtx||el.getContext("2d");if(el.curLayerObj.isGroupLayer){ctx.globalAlpha=el.curLayerObj.options.opacity}else{ctx.globalAlpha=1}var f=null;if(el.obj.feature_filter&&el.obj.feature_filter.filter){f=el.obj.feature_filter.filter}var data=el.data[el.layer];for(var i=0;i<data.length;i++){drawImage(el,el.obj,ctx,data[i],f)}if(el.obj.modifier){drawTileUsingModifier(el,el.obj)}}function getImageOverlay(imgs,modifier,d,layer){var c;var key=modifier.color;if(d.cl>0){key+="_cluster"}if(imgs.icon_image_overlay&&imgs.icon_image_overlay[key]){c=imgs.icon_image_overlay[key]}else{c=document.createElement("canvas");c.width=d.b.xmax-d.b.xmin;c.height=d.b.ymax-d.b.ymin;var ic_ctx=c.getContext("2d");drawPointCanvas(ic_ctx,d,layer,imgs,0,0,true);ic_ctx.globalAlpha=0.7;var style=overrideStyle(imgs,modifier);ic_ctx.fillStyle=style.color;ic_ctx.beginPath();ic_ctx.rect(0,0,c.width,c.height);ic_ctx.globalCompositeOperation="source-in";ic_ctx.fill();if(!imgs.icon_image_overlay){imgs.icon_image_overlay=[]}imgs.icon_image_overlay[key]=c}return c}function drawImage(el,obj,ctx,d,f,modifier){if(!f){if(obj.feature_filter&&obj.feature_filter.filter){f=obj.feature_filter.filter}}var imgs=el.curLayerObj.features[d.i];if(imgs.iready&&(!f||(d.data&&f(d.data)))){img=imgs.icon_image;d.b={xmin:Math.floor(d.x-img.width/2),ymin:Math.floor(d.y-img.height/2),xmax:d.x+img.width/2,ymax:d.y+img.height/2};drawPointCanvas(ctx,d,obj._layer,imgs);if(modifier){var c=getImageOverlay(imgs,modifier,d,obj._layer);ctx.drawImage(c,d.b.xmin,d.b.ymin,d.b.xmax-d.b.xmin,d.b.ymax-d.b.ymin)}d.visible=true}else{d.visible=false}}function drawPointCanvas(ctx,d,layer,object,x,y,overlay){if(!d.b){return}if(x==undefined){x=d.b.xmin}if(y==undefined){y=d.b.ymin}if(!overlay||!d.cl||!object.clustering){ctx.drawImage(object.icon_image,x,y)}if(d.cl&&object.clustering>0){var cluster=object.clustering;var text=d.cl+1;ctx.save();ctx.textAlign="center";ctx.textBaseline="middle";var cx=x+(d.b.ymax-d.b.ymin*1)/2;var cy=y+(d.b.ymax-d.b.ymin*1)/2;ctx.beginPath();ctx.arc(cx,cy,cluster-2,0,2*Math.PI,false);ctx.fillStyle=object.predominantColor;ctx.fill();ctx.lineWidth=2;ctx.strokeStyle="#003300";ctx.stroke();if(!overlay){ctx.lineWidth=1;ctx.fillStyle="#fff";ctx.strokeStyle="#000";ctx.strokeText(text,cx,cy);ctx.fillText(text,cx,cy);if(img.width/2<cluster){d.b.xmin=Math.floor(d.x-cluster);d.b.xmax=d.x+cluster}if(img.height/2<cluster){d.b.ymin=Math.floor(d.y-cluster);d.b.ymax=d.y+cluster}}ctx.restore()}}function drawPointDOM(el,use_modifier){var f=null;if(el.obj.feature_filter&&el.obj.feature_filter.filter){f=el.obj.feature_filter.filter}var data=el.data[el.layer];for(var i=0;i<data.length;i++){drawImageAsDOM(el,data[i],f)}}function drawImageAsDOM(el,d,f,modifier){if(modifier){return}var obj=el.obj;if(!f){if(obj.feature_filter&&obj.feature_filter.filter){f=obj.feature_filter.filter}}var imgs=el.curLayerObj.features[d.i];if(imgs.iready&&(!f||(d.data&&f(d.data)))){img=imgs.icon_image;d.b={xmin:Math.floor(d.x-img.width/2),ymin:Math.floor(d.y-img.height/2),xmax:d.x+img.width/2,ymax:d.y+img.height/2};drawPointAsDOM(el,d,obj._layer,imgs);if(modifier){}d.visible=true}else{d.visible=false}}function drawPointAsDOM(el,d,layer,object,x,y,overlay){if(!d.b){return}if(x==undefined){x=d.b.xmin}if(y==undefined){y=d.b.ymin}if((!overlay||!d.cl||!object.clustering)&&!d.cl){var cont=L.DomUtil.create("img","",el);cont.style.position="absolute";cont.style.left=d.b.xmin+"px";cont.style.top=d.b.ymin+"px";cont.src=object.icon}if(d.cl&&object.clustering>0){if(!el.paper){setupPaperOverlay(el);el.paper=Raphael(el.overlay,el.width,el.height)}var cluster=object.clustering;var text=d.cl+1;var cx=x+(d.b.ymax-d.b.ymin*1)/2;var cy=y+(d.b.ymax-d.b.ymin*1)/2;el.paper.circle(cx,cy,cluster-2).attr({fill:object.predominantColor,"stroke-width":2,stroke:"#003300"});if(!overlay){el.paper.text(cx,cy,text).attr({"stroke-width":1,stroke:"#fff"});if(img.width/2<cluster){d.b.xmin=Math.floor(d.x-cluster);d.b.xmax=d.x+cluster}if(img.height/2<cluster){d.b.ymin=Math.floor(d.y-cluster);d.b.ymax=d.y+cluster}}}}function drawText(el){var filter=null;if(el.obj.feature_filter&&el.obj.feature_filter.filter){filter=el.obj.feature_filter.filter}var fields=el.fields;var d=100;if(el._canvas_offset>d){d=el._canvas_offset}expandCanvas(el,d);el.data_type[el.layer]="text";var data=el.data[el.layer];var dlen=data.length;if(dlen<1){return}if(!el.getContext){drawTextDOM(el,data,filter);return}var ctx=el.forceCtx||el.getContext("2d");ctx.lineWidth=3;ctx.lineCap="round";ctx.lineJoin="round";var last_feature_id=-1;var dx,dy,fs_with_margin;for(var i=0;i<dlen;i++){if(last_feature_id!=data[i].i&&data[i].i>=0){last_feature_id=data[i].i;var f=el.curLayerObj.features[data[i].i];if(f.outline){ctx.strokeStyle="#"+f.outline.substr(2)}if(f.color){ctx.fillStyle="#"+f.color.substr(2)}else{ctx.fillStyle="#000"}dx=0;dy=0;f.dx&&(dx=f.dx);f.dy&&(dy=f.dy);ctx.textAlign="center";ctx.textBaseline="middle";var al=f.anchor;if(al){if(al=="TL"){ctx.textBaseline="top";ctx.textAlign="left"}else{if(al=="T"){ctx.textBaseline="top"}else{if(al=="TR"){ctx.textBaseline="top";ctx.textAlign="right"}else{if(al=="R"){ctx.textAlign="right"}else{if(al=="BR"){ctx.textBaseline="bottom";ctx.textAlign="right"}else{if(al=="B"){ctx.textBaseline="bottom"}else{if(al=="BL"){ctx.textBaseline="bottom";ctx.textAlign="left"}else{if(al=="L"){ctx.textAlign="left"}}}}}}}}}var fontname="arial";if(f.fontname){fontname=f.fontname}ctx.font=data[0].fs+"px "+fontname;fs_with_margin=data[0].fs*1+2}var text=data[i].text;text=text.split("\n");var p=data[i].p;var plen=p.length;for(var k=0;k<plen;k++){if(filter){var itemdata=null;if(fields&&p[k][4]){itemdata=fields[p[k][4].replace("||","_")]}if(!itemdata||!filter(itemdata)){continue}}for(var j=0;j<text.length;j++){ctx.save();ctx.translate(p[k][0]+d+dx,p[k][1]+d+dy+fs_with_margin*j);ctx.rotate(p[k][2]/180*Math.PI);if(f.outline){ctx.strokeText(text[j],0,0)}ctx.fillText(text[j],0,0);ctx.restore()}}}}function drawTextDOM(el,data,filter){var d=el._offset[el.layer];var dx=0;var dy=0;var fields=el.fields;var dlen=data.length;var last_feature_id=-1;var fill,vertical_offset,offsetX,fontname,halign;for(var i=0;i<dlen;i++){if(last_feature_id!=data[i].i&&data[i].i>=0){var f=el.curLayerObj.features[data[i].i];if(f.color){fill="#"+f.color.substr(2)}else{fill="#000"}vertical_offset=Math.ceil(data[0].fs/2);var al=f.anchor;halign=-1;dx=dy=0;f.dx&&(dx=f.dx);f.dy&&(dy=f.dy);dy-=vertical_offset;if(al){if(al=="TL"){dy+=vertical_offset;halign=0}else{if(al=="T"){dy+=vertical_offset}else{if(al=="TR"){dy+=vertical_offset;halign=2}else{if(al=="R"){halign=2}else{if(al=="BR"){dy-=vertical_offset;halign=2}else{if(al=="B"){dy-=vertical_offset}else{if(al=="BL"){dy-=vertical_offset;halign=0}else{if(al=="L"){halign=0}}}}}}}}}offsetX=0;fontname="Arial";if(f.fontname){fontname=f.fontname}}var text=data[i].text;var p=data[i].p;var plen=p.length;for(var k=0;k<plen;k++){if(filter){var itemdata=null;if(fields&&p[k][4]){itemdata=fields[p[k][4].replace("||","_")]}if(!itemdata||!filter(itemdata)){continue}}var o=L.DomUtil.create("span","",el);o.style.fontWeight="bold";o.style.color=fill;o.style.fontSize=data[0].fs+"px";o.style.fontFamily=fontname;o.innerText=text;offsetX=halign*o.offsetWidth/2;o.style.position="absolute";o.style.left=(p[k][0]+d+dx+offsetX)+"px";o.style.top=(p[k][1]+d+dy)+"px"}}}function drawPixels(ctx,data,renderDirectOnTile){var tmp_canvas=null,original_ctx;if(!renderDirectOnTile){tmp_canvas=newCanvas(ctx.canvas);original_ctx=ctx;ctx=tmp_canvas.getContext("2d")}var imgd=ctx.createImageData(ctx.canvas.width,ctx.canvas.height);var pix=imgd.data;var px=data.pixels[data.layer];var slen=px.length;var c=0;var r,g,b,k,i;r=g=b=0;for(i=1;i<slen;i++){if(px[i]<0){k=px[i];if(px[i+1]==0){i++;r=px[++i];g=px[++i];b=px[++i]}while(k++){pix[c*4]=r;pix[c*4+1]=g;pix[c*4+2]=b;pix[c*4+3]=255;c++}}else{c+=px[i]}}ctx.putImageData(imgd,0,0);if(!renderDirectOnTile){original_ctx.drawImage(tmp_canvas,0,0)}}function expandCanvas(el,d){var c,ctx;el._offset[el.layer]=d;el.activeLayerId=null;if(d<=el._canvas_offset){return}el.style.marginLeft="-"+d+"px";el.style.marginTop="-"+d+"px";if(!el.getContext){el.style.width=el.width+"px";el.style.height=el.height+"px"}else{c=newCanvas(el);ctx=c.getContext("2d");ctx.drawImage(el,0,0)}el.width=el._layer.options.tileSize+d*2;el.height=el._layer.options.tileSize+d*2;if(ctx){ctx=el.getContext("2d");ctx.drawImage(c,d,d)}el._canvas_offset=d}function rectUnion(a,b,offset){if(b.xmin-offset<a.xmin){a.xmin=b.xmin-offset}if(b.ymin-offset<a.ymin){a.ymin=b.ymin-offset}if(b.xmax+offset>a.xmax){a.xmax=b.xmax+offset}if(b.ymax+offset>a.ymax){a.ymax=b.ymax+offset}}function rectCrop(a,min,max){var i;for(i in a){if(a[i]<min){a[i]=min}else{if(a[i]>max){a[i]=max}}}}function rectAssign(a,b,offset){a.xmin=b.xmin-offset;a.ymin=b.ymin-offset;a.xmax=b.xmax+offset;a.ymax=b.ymax+offset}function pointDistance(x1,y1,x2,y2){var dx=x1-x2;var dy=y1-y2;return Math.sqrt(dx*dx+dy*dy)}function vector(x,y){return{x:x,y:y}}function vectorAdd(V1,V2){return vector(V1.x+V2.x,V1.y+V2.y)}function vectorSub(V1,V2){return vector(V1.x-V2.x,V1.y-V2.y)}function scalarMul(s,V){return vector(s*V.x,s*V.y)}function length(V){return Math.sqrt(V.x*V.x+V.y*V.y)}function normalize(V){return scalarMul(1/length(V),V)}function offset(d,P1,P2){var O,OP1,OP2;O=scalarMul(d,normalize(vector(P1.y-P2.y,P2.x-P1.x)));OP1=vectorAdd(O,P1);OP2=vectorAdd(O,P2);return[OP1,OP2]}function intersectLines(p1,p2,p3,p4,dist){var dx1=p2.x-p1.x;var dx2=p4.x-p3.x;var dy1=p2.y-p1.y;var dy2=p4.y-p3.y;var den=dx1*dy2-dy1*dx2;if(den<0.0001){return p3}var ub=(dx1*(p1.y-p3.y)-dy1*(p1.x-p3.x))/den;if(ub*Math.sqrt(dx2*dx2+dy2*dy2)>dist){return p3}else{return{x:p3.x+ub*dx2,y:p3.y+ub*dy2}}}function doOffset(element,dist){if(!element.px){var a=element.p;var len=a.length;var v0=vector(a[0],a[1]);var p1;var p2=null;for(var i=2;i<len;i+=2){var v1=v0;var v2=vector(a[i],a[i+1]);v0=v2;var o=offset(dist/10,v1,v2);if(p2){p1=intersectLines(p1,p2,o[0],o[1],dist)}else{p1=o[0]}p2=o[1];a[i-2]=Math.round(p1.x*10)/10;a[i-1]=Math.round(p1.y*10)/10;p1=o[0]}a[len-2]=Math.round(p2.x*10)/10;a[len-1]=Math.round(p2.y*10)/10}}function maxx(a,b){if(a>b){return a}return b}function minn(a,b){if(a<b){return a}return b}function getTimestamp(el,d){if(el.lid){if(d.dynamic){el.url_prefix=giscloud_tile_url+"d/"+d.modified+"/"+el.mid+"/"+el.lid;var t=new Date().getTime();el.url=giscloud_tile_url+"d/"+d.modified+"/"+el.mid+"/"+el.lid+"/dyn,"+t+"/";el.url3=giscloud_tile_url+"d/";el.t=t;el.modified=d.modified;el.dynamic=true}else{var tile_prefix;if(giscloud.app&&giscloud.app.option("DISABLE_CORS")){tile_prefix="dt/"}else{tile_prefix="t/"}el.url=giscloud_tile_url+tile_prefix+d.modified+"/"+el.mid+"/"+el.lid+"/";el.url2=giscloud_tile_url+tile_prefix;el.modified=d.modified}}else{if(fields){el.url=giscloud_tile_url+"vt3/"+d.modified+"/"+el.mid+"/"+fields+"/"}else{el.url=giscloud_tile_url+"vt2/"+d.modified+"/"+el.mid+"/"}}var t;while(t=tile_buffer.pop()){if(fields){ajaxLoader(drawGeomCanvas,el.url+t.uri+".json?fields="+fields,t.tile,t.uri)}else{ajaxLoader(drawGeomCanvas,el.url+t.uri+".json",t.tile,t.uri)}}if(el.map){el.map.getDiv().firstChild.firstChild.firstChild.firstChild.style.zIndex=150}}function jsonCanvas(ownerDocument,obj){var d=ownerDocument.createElement("div");var c=ownerDocument.createElement("canvas");d.appendChild(c);d.c=c;c.od=ownerDocument;c.setAttribute("width",256);c.setAttribute("height",256);c.setAttribute("style","position:relative");c.style.position="relative";c.obj=obj;if(window.G_vmlCanvasManager){G_vmlCanvasManager.initElement(c)}google.maps.event.addDomListener(c,"mousemove",function(evt){checkForEvent(evt)});return d}function intersects(a,b){if(a.xmax<b.xmin||a.xmin>b.xmax||a.ymax<b.ymin||a.ymin>b.ymax){return false}return true}function intersects_array_element(a,b){for(var i=0;i<a.length;b++){if(intersects(a[i],b)){return true}}return false}})(window,giscloud.exposeJQuery(),giscloud.common());(function(c,e,a,f){giscloud.proxy={call:function(k,h,n){var g="proxy",m=new e.Deferred();h=h||{};if(typeof h==="function"){n=h;h={}}else{n=n||h.callback}h.url=k;a.rest.get(g,h).done(function(o){try{if(typeof n=="function"){n(o)}m.resolve(users)}catch(q){m.reject()}}).fail(function(){m.reject()});return m.promise()}}}(window,giscloud.exposeJQuery(),window.giscloud.common()));(function(c,a){giscloud.geoutils={featuresAtPoint:function(e,h,g,o){var m=new c.Deferred(),f="geo_utils/features_at_point.json?",k={},n=(e&&e instanceof giscloud.LonLat)?e:null;if(!n||!h){return}if(typeof g==="function"){o=g;g=null}else{o=o||(g&&g.callback)}f+="point_x="+n.lon;f+="&point_y="+n.lat;f+="&layer_id="+h.join(",");if(g&&g.srid){f+="&srid="+g.srid}if(g&&g.buffer){f+="&buffer="+g.buffer}a.rest.get(f).done(function(){var q=arguments[0],r=[];try{c.each(q,function(){r.push(new giscloud.Feature(this))});m.resolve(r)}catch(t){m.reject()}}).fail(function(){m.reject()});if(o){m.done(o)}return m.promise()},featuresAtPointForMap:function(e,g,f){var h=new c.Deferred();giscloud.layers.byMapId(g,function(o){var k,n=new Array();try{c.each(o,function(q,r){n.push(r.id)});giscloud.geoutils.featuresAtPoint(e,n,k,function(q){try{h.resolve(q)}catch(r){h.reject()}})}catch(m){h.reject()}});return h.promise()}}}(giscloud.exposeJQuery(),window.giscloud.common()));(function(h,f,k,c){var n,g,m,a=[],e="red";giscloud.ui.alert={show:function(r,q,o){if(g!=null){clearTimeout(g)}if(o&&n.html()){a.push({msg:n.html(),color:e,duration:m})}n.html(r).css("margin-left",-0.5*n.outerWidth()).fadeIn("fast");if(!isNaN(q)){g=setTimeout(f.proxy(giscloud.ui.alert.hide,giscloud.ui.alert),q)}m=q;return this},hide:function(){var o;if(a.length){o=a.pop();n.hide();return this.color(o.color).show(o.msg,o.duration)}else{n.fadeOut("fast")}return this},color:function(o){e=n.hasClass("gc-green-alert")?"green":"red";if(o==="green"){n.addClass("gc-green-alert");n.removeClass("gc-red-alert")}else{if(o==="red"){n.addClass("gc-red-alert");n.removeClass("gc-green-alert")}}return this},red:function(){return this.color("red")},green:function(){return this.color("green")},get:function(){return{msg:n.html(),color:n.hasClass("gc-red-alert")?"red":"green"}}};giscloud.ui.redAlert=function(q,o){return giscloud.ui.alert.color("red").show(q,o)};giscloud.ui.greenAlert=function(q,o){return giscloud.ui.alert.color("green").show(q,o)};giscloud.ready().done(function(){n=f("<div class='gc-alert'></div>").appendTo(f("body"))})})(window,giscloud.exposeJQuery(),giscloud.common());(function(a){giscloud.ui.ProjectionPicker=function(h,v){var k=this,o,u,m,q=[],r,e,f,c,n,g={my:"left top",at:"left bottom",collision:"none"},t=[{epsg:900913,title:"EPSG:900913 Global Mercator(e.g. Google projection)",proj4:"+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"},{epsg:4326,title:"EPSG:4326 WGS84",proj4:"+proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"}];this.options=v;k.init=function(){if(v&&!v.no_title){var A=v.title||"Choose projection";h.html(A)}u=a("<div/>",{"class":"gc-projectionpicker"});var E=a("<div/>",{text:"Last used spatial projection","class":"gc-header"});var B=a("<ul/>",{"class":"gc-list"});var y=a("<div/>",{"class":"gc-aux-menu"});a("body").append(u);u.append(E,B,y);e=u.find(".gc-aux-menu");var z=a("<span/>",{text:"Projection is not on the list? Look up the full list.","class":"gc-comment"});var D=a("<a/>",{text:"Open projection form","class":"gc-projection-form linkbutton"});e.append(z,D);r=u.find(".gc-projection-form");m=u.find(".gc-list");a(h).click(k.open);r.click(k.openProjectionForm);a(document).mouseup(function(F){if(f&&!u.is(F.target)&&a(h).has(F.target).length===0&&u.has(F.target).length===0){k.close()}});a(document).keyup(function(F){if(F.keyCode==27){k.close()}});var x;if(a.cookie){x=(a.cookie("gc-projection-last-used")&&a.cookie("gc-projection-last-used").length)?a.parseJSON(a.cookie("gc-projection-last-used")):null}x=x&&x.length?x:t;a.each(x,function(G,F){k.addProjection(F)});if(v&&v.hidden_fields){var C=h.parents("form:first");c=C.find("input[name='epsg']").first();n=C.find("input[name='proj4']").first();if(c.length&&n.length){k.select({epsg:c.val(),proj4:n.val()})}else{c=a("<input type='hidden' name='epsg' />");C.prepend(c);n=a("<input type='hidden' name='proj4' />");C.prepend(n)}}if(v&&v.default_proj){k.select(v.default_proj)}};k.openProjectionForm=function(x){showProjections({proj4:a("proj4").value},function(y){if(!y||!y.proj4){return}k.setProjTitle(y);k.select(y)});k.close()},k.setProjTitle=function(x){if(x.title){return}x.title="EPSG:"+(x.epsg>0?x.epsg:"Unknown");if(x.name){x.title+=" "+x.name}},k.active=function(){return o},k.unselect=function(x){if(v&&!v.no_title){var y=(v&&v.title)||"Choose projection";h.html(y)}h.attr("title","");if(c&&n){c.val(null);n.val(null)}o=null;k.close();m.find("li").removeClass("gc-active")},k.select=function(x){if(!x||!a.isNumeric(x.epsg)){return}k.setProjTitle(x);if(k.options&&!k.options.no_title){h.html(x.title)}h.attr("title","EPSG:"+x.epsg+" Proj4: "+x.proj4);if(c&&n){c.val(x.epsg);n.val(x.proj4)}o=x;k.close();k.addProjection(x,true);a.each(m.find("li").removeClass("gc-active"),function(z,y){var y=a(y),A=y.data("proj");if(A&&A.epsg==x.epsg){y.addClass("gc-active")}});if(x.epsg>0){a.each(q,function(y,z){if(z.epsg==x.epsg){q.splice(y,1);q.splice(0,0,x)}});k.saveCookie()}h.trigger("select",x)},k.addProjection=function(x,A){if(!x||!(x.epsg>0)){return}var z=false;a.each(q,function(B,C){if(C.epsg==x.epsg){z=true}});if(z){return}k.setProjTitle(x);var y=a("<li/>",{text:x.title,title:x.proj4});y.click(function(){k.select(x,true)});if(A){m.prepend(y);q.splice(0,0,x)}else{m.append(y);q.push(x)}y.data("proj",x);q=a(q).slice(0,10);k.saveCookie()},k.saveCookie=function(){if(!a.cookie){return}var x=[];a.each(q,function(y,z){x.push({epsg:z.epsg,proj4:z.proj4,title:z.title})});a.cookie("gc-projection-last-used",JSON.stringify(x))},k.open=function(x){u.show();h.addClass("gc-hover");f=true;u.position(a.extend({of:h},g))};k.close=function(x){u.hide();h.removeClass("gc-hover");f=false};k.init()};a(function(){})}(giscloud.exposeJQuery()));(function(c,e,a,f){if(!giscloud.ui.columns){giscloud.ui.columns={}}giscloud.ui.columns.filterDropdown=function(o,m){var h,n,k,g=e(this);m.page=m.page?m.page:1;m.perpage=m.perpage?m.perpage:10;e(o).find(".gc-list").empty();e(o).find(".gc-dropdown-list").hide();k=e(o).find(".gc-pagination-list").addClass("gc-hidden");e(o).loader();giscloud.layers.attributeOps.distinct(m.layer_id,m.column,m).done(function(y){e(o).loader("hide");var t,q,x,v,u,z,r;h=Math.ceil(y.total/m.perpage),n=y.page;u=n+" / "+h;t=e(o).find(".gc-list");x=e(o).find(".gc-dropdown-list").show();v=e(o).find(".gc-page-stats");v=e(o).find(".gc-page-stats");z=e(o).find(".gc-arrow-left");r=e(o).find(".gc-arrow-right");if(!t.length){t=e("<ul/>").addClass("gc-list");x=e("<div/>").addClass("gc-dropdown-list");k=e("<div/>").addClass("gc-pagination-list gc-hidden").css("margin","10px 0 0 0");z=e("<div/>").addClass("gc-icon gc-arrow-left gc-pointer");r=e("<div/>").addClass("gc-icon gc-arrow-right gc-pointer").css("float","right").css("margin","0");v=e("<div/>").addClass("gc-comment gc-page-stats").css("float","left").css("margin","3px 0 0 17px").css("font-size",10);e(o).append(x);e(o).append(k);x.append(t);k.append(z);k.append(v);k.append(r)}z.unbind();r.unbind();z.click(function(){if(n<=1){return}m.page--;m.dontUnbind=true;giscloud.ui.columns.filterDropdown(o,m)});r.click(function(){if(n>=h){return}m.page++;m.dontUnbind=true;giscloud.ui.columns.filterDropdown(o,m)});if(h==1){}else{k.removeClass("gc-hidden");v.html(u)}q=e("<li/>").addClass("gc-item gc-pointer").html("<a class='deletebutton' >Clear filter</a>");q.click(function(){g.trigger("item-click",[{value:null,column:m.column}])});t.append(q);e.each(y.data,function(A,B){q=e("<li/>").addClass("gc-item gc-pointer").html(B);q.click(function(){g.trigger("item-click",[{value:B,column:m.column}])});t.append(q)});g.trigger("done")});if(m&&!m.dontUnbind){g.unbind("item-click")}return g}})(window,giscloud.exposeJQuery(),giscloud.common());(function(c){function a(f,k,h){var g,e=[{header:f,dataIndex:f,hidden:true}];for(g in k){if(g===f){continue}if(k.hasOwnProperty(g)){if(g==="bounds"||g==="layerId"||g=="data"||g=="meta"){continue}e.push({header:h&&h[g]||g,dataIndex:g,hidden:false})}}return e}giscloud.ui.search={overrideDefaultBehaviour:function(){if(gcapp&&gcapp.gcsearch){gcapp.gcsearch.addEvent("start",function(e){e.preventDefault=true;c(giscloud.ui.search).triggerHandler("search",[e.value])});gcapp.gcsearch.addEvent("searchchange",function(e){e.preventDefault=true;if(e.key==="enter"){c(giscloud.ui.search).triggerHandler("start",[e.value])}});gcapp.gcsearch.addEvent("searchclick",function(e){e.preventDefault=true;c(giscloud.ui.search).triggerHandler("resultClick",[e.data])})}},clearResults:function(){gcapp.gcsearch.searchResultGrid.removeAll()},displayResults:function(g,f,h){var e;if(!c.isArray(g)||g.length===0){return this}if(f==null){f="__id"}e=a(f,g[0],h);g=c.map(g,function(m){var k=c.extend({__id:m[f]},m);if(k.bounds){c.extend(k,{__xmin:k.bounds.left,__xmax:k.bounds.right,__ymin:k.bounds.bottom,__ymax:k.bounds.top})}return k});gcapp.gcsearch.searchResultGrid.setData({data:g,page:1,total:g.length},e);gcapp.gcsearch.searchResultGrid.refreshHeight();if(gcapp.rightcolumn){gcapp.rightcolumn.expand()}if(gcapp.rpanel){gcapp.rpanel.showSearchTab()}else{c("#searchtab").removeClass("hidden")}gcapp.gcsearch.__open=true;return this}}}(giscloud.exposeJQuery()));(function(h){var I,o,F,x,u,P,n,D="<a href='javascript:;' onclick='return giscloud.ui.edit.editAccept()'>"+gclang.Save_changes+"</a><a href='javascript:;' onclick='return giscloud.ui.edit.editCancel()'>"+gclang.Cancel+"</a>",G=gclang.Editing_feature+"<br/>"+D;function c(R,Q){return giscloud.ui.alert.color("red").show(R,Q)}function k(R,Q){return giscloud.ui.alert.color("green").show(R,Q)}function m(){x={}}function H(U){var T,S,R=giscloud.ui.map.instance,Q=R.getLayerCount();for(T=0;T<Q;T++){S=R.getLayer(T);if(S.id==="layer"+U){return S}}return null}function v(Q){var S=H(Q.id),Q=fnl.getLayerById(Q.id),R=Q.sourcetype||Q.sourceType;return gcapp.isEditable(Q,true)&&S&&S.getSelectable()&&R==="pg"&&gcapp.selo.options.editable}function K(){var S,R,Q;if(gcapp.gclayer.llist){S=gcapp.gclayer.llist.getSelected();R=S&&S.data,Q=R&&v(R)}else{R=giscloud.ui.map.layerById(giscloud.ui.map.activeLayer);Q=R&&v(R)}if(Q){return{id:R.id,type:R.tip||R.type}}return null}function O(R){var Q=h.map(giscloud.ui.map.layers,function(S){var T={layerId:S.id,status:S.selectable()};console.log(S.id,S,v(S));S.selectable(v(S));return T});if(!R){u=Q}}function e(){return O(true)}function t(){h.each(u,function(R,S){var Q=giscloud.ui.map.layerById(S.layerId);Q&&Q.selectable(S.status)})}function C(){giscloud.ui.map.reloadMap();gcdatagrid.refresh()}function N(){k(gclang.form_saving);giscloud.ui.customForm.disable()}function M(){k(gclang.form_saving_done,2000);giscloud.layers.reset(giscloud.ui.map.mapId,[F.id]).done(C,giscloud.ui.customForm.close,P.resolve)}function y(){c(gclang.form_input_error,2000);giscloud.ui.customForm.enable()}function J(Q){var S=h("#gc-edit-latlon-input > input"),R=h(Q.target).is("button"),U=/^\s*(-?\d*.?\d+)\s*[\s,]\s*(-?\d*.?\d+)\s*$/,T=S.val().match(U);if(T&&T.length===3){if(!R){h("#gc-edit-latlon-input > button").prop("disabled",false)}if(R||Q.type==="keyup"&&Q.which===13){g(T[1],T[2])}}else{h("#gc-edit-latlon-input > button").prop("disabled",true)}}function g(T,V){var R=giscloud.ui.map.instance.projection,U=new Proj4js.Proj("EPSG:4326"),S,Q=new Proj4js.Point(parseFloat(V),parseFloat(T));Proj4js.defs.CURRENT=R;S=new Proj4js.Proj("CURRENT");Proj4js.transform(U,S,Q);n=new giscloud.geometry.Point(Q.x,Q.y);giscloud.ui.map.graphic.cancelDraw()}function r(){h("<div/>",{id:"gc-edit-latlon-input"}).append(h("<input/>",{placeholder:"GPS: Lat, Lon"}).on("change keyup",J),h("<button/>",{text:"OK",disabled:true}).on("click",J)).appendTo("body").offset(function(){var Q=h(giscloud.ui.map.container()).offset();return{top:Q.top,left:Q.left+giscloud.ui.map.width()/2+100}})}function q(Q){giscloud.ui.customForm.open({layerId:F.id}).done(function(R){R.trigger("setFeatureGeometry.gc-custom-form",Q.geometry().toOGC()).trigger("setRestParams.gc-custom-form",{use_map_srid:true}).on({"submitStart.gc-custom-form":N,"submitSuccess.gc-custom-form":M,"submitFailure.gc-custom-form":y,"close.gc-custom-form":P.reject});n=null}).fail(P.reject)}function a(){if(n){q({geometry:function(){return n}})}P.reject()}function E(Q){giscloud.ui.map.unbind("featureClick",B);giscloud.ui.map.select(false);console.log(Q);k(G);giscloud.ui.map.editFeature(Q.layerId,Q.featureId).always(function(){o=false;gcapp.gcmap.options.dontShowInfo=false;giscloud.ui.alert.hide();t()}).then(P.resolve,P.reject)}function B(Q){if(typeof x.beforeEdit==="function"){h.when(x.beforeEdit(Q)).fail(function(R){if(!R){giscloud.ui.edit.editCancel()}}).done(function(R){if(R===false){giscloud.ui.edit.editCancel()}else{if(R===true){}else{if(R!==undefined){E(R)}else{E(Q)}}}})}else{E(Q)}}function f(Q){if(Q.tool==="SelectTool"||Q.tool==="InfoTool"){giscloud.ui.edit.editCancel()}}function z(R){var Q;giscloud.ui.map.selection.clear();gcapp.gcmap.options.dontShowInfo=false;o=false;t();k(gclang.PleaseWait);Q=h.map(R.featureIds||[],function(S){return giscloud.features.remove(R.layerId,S)});h.when.apply(h,Q).done(function(){giscloud.layers.reset(giscloud.ui.map.mapId,[R.layerId]).done(function(){k(gclang.Successfully_deleted_,3000);C();P.resolve()})}).fail(function(){c(gclang.AnErrorOccurred,3000);P.reject()})}function A(){var Q;if(gcapp.selo.selectionCount()===0){giscloud.ui.edit.deleteCancel();return}Q={layerId:gcapp.selo.selection.lid,featureIds:gcapp.selo.selection.fids};if(typeof x.beforeDelete==="function"){h.when(x.beforeDelete(Q)).fail(function(R){if(!R){giscloud.ui.edit.deleteCancel()}}).done(function(R){if(R===false){giscloud.ui.edit.editCancel()}else{if(R===true){}else{if(R!==undefined){z(R)}else{z(Q)}}}})}else{z(Q)}}giscloud.ui.edit={addFeature:function(){var Q=K();if(I||o){return}if(Q){F=Q;k(gclang["addfeature_message_"+Q.type]+"<br/><br/><a href='javascript:;' onclick='giscloud.ui.edit.addCancel(); return false;'>"+gclang.Cancel+"</a>");if(Q.type==="point"){r();n=null}I=true;P=new h.Deferred();h(giscloud.ui.map.container()).addClass("gc-edit-cursor");gcapp.gcmap.marker.clear();gcapp.gcmap.dontShowInfo=true;giscloud.ui.map.select(false);P.always(function(){gcapp.gcmap.dontShowInfo=false;giscloud.ui.map.select(true);giscloud.ui.map.graphic.clear();I=false});giscloud.ui.map.graphic.draw(Q.type).then(q,a).always(function(){giscloud.ui.alert.hide();h(giscloud.ui.map.container()).removeClass("gc-edit-cursor");h("#gc-edit-latlon-input").remove()})}else{c(gclang.addfeature_message_select_layer,3000);return(new h.Deferred()).reject().promise()}return P.promise()},addCancel:function(){giscloud.ui.map.graphic.cancelDraw();P.reject()},editFeature:function(Q){x=Q||{};if(I||o){return}o=true;P=new h.Deferred();gcapp.gcmap.options.dontShowInfo=true;gcapp.gcmap.marker.clear();gcapp.gctoolbar.addEvent("toolchange",f);P.always(function(){gcapp.gctoolbar.removeEvent("toolchange",f)});O();if(x.layerId&&x.featureId){B({layerId:x.layerId,featureId:x.featureId})}else{k((x.message||gclang.editfeature_choose_feature_message)+"<br/><br/><a href='javascript:;' onclick='giscloud.ui.edit.editCancel(); return false;'>"+gclang.Cancel+"</a>");giscloud.ui.map.featureClick(B)}P.always(m);return P.promise()},editCancel:function(){giscloud.ui.map.editCancel();o=false;gcapp.gcmap.options.dontShowInfo=false;giscloud.ui.map.unbind("featureClick",B);giscloud.ui.alert.hide();t();P.reject()},editAccept:function(){giscloud.ui.map.editAccept();k(gclang.PleaseWait)},deleteFeature:function(Q){x=Q||{};if(I||o){return}o=true;P=new h.Deferred();k((x.message||gclang.deletefeature_choose_feature_message)+"<br/><br/><a href='javascript:;' onclick='giscloud.ui.edit.deleteAccept(); return false;'>"+gclang.Delete_features+"</a><a href='javascript:;' onclick='giscloud.ui.edit.deleteCancel(); return false;'>"+gclang.Cancel+"</a>");P.always(m);gcapp.gcmap.options.dontShowInfo=true;gcapp.gcmap.marker.clear();gcapp.gctoolbar.addEvent("toolchange",e);P.always(function(){gcapp.gctoolbar.removeEvent("toolchange",e)});if(gcapp.selo.selectionCount()!==0){if(!v(giscloud.ui.map.layerById(gcapp.selo.selection.lid))){gcapp.selo.clearSelection()}}O();return P.promise()},deleteAccept:function(){A()},deleteCancel:function(){o=false;gcapp.gcmap.options.dontShowInfo=false;giscloud.ui.alert.hide();t();P.reject()}}}(giscloud.exposeJQuery()));(function(k){var c,o,m,a,n="<a href='javascript:;' onclick='return giscloud.ui.selectExtent.accept()'>"+gclang.Accept+"</a><a href='javascript:;' onclick='return giscloud.ui.selectExtent.cancel()'>"+gclang.Cancel+"</a>",u=gclang.Select_extent_message+"<br/><br/>"+n;function h(x,v){return giscloud.ui.alert.color("green").show(x,v)}function t(){var v=k.map(giscloud.ui.map.layers,function(x){var y={layerId:x.id,status:x.selectable()};x.selectable(false);return y});o=v}function f(){k.each(o,function(x,y){var v=giscloud.ui.map.layerById(y.layerId);v&&v.selectable(y.status)})}function g(){if(a.activeTool){gcapp.gctoolbar.setTool(a.activeTool)}gcapp.gcmap.options.dontShowInfo=a.dontShowInfo}function r(v){if(v.tool==="SelectTool"||v.tool==="InfoTool"){a.activeTool=null;giscloud.ui.selectExtent.cancel()}}function e(){m=giscloud.ui.defaultTools.selectExtent();m.viewer=giscloud.ui.map}function q(v){if(v.extent){c.resolve(v.extent)}else{c.reject()}}giscloud.ui.selectExtent={start:function(){if(!giscloud.ui.map||giscloud.ui.map.loading.state()!=="resolved"){giscloud.ui.alert.color("red").show("A map needs to be opened to select an extent.",2000);return k.Deferred().reject()}c=new k.Deferred();a={activeTool:gcapp.gctoolbar.active,dontShowInfo:gcapp.gcmap.options.dontShowInfo};gcapp.gcmap.options.dontShowInfo=true;gcapp.gcmap.marker.clear();gcapp.gctoolbar.addEvent("toolchange",r);c.always(function(){g();f();gcapp.gctoolbar.removeEvent("toolchange",r)});t();h(u);if(!m){e()}m.activate();m.bind("deactivation",q);return c.promise()},cancel:function(){m.unbind("deactivation",q);m.deactivate();giscloud.ui.alert.hide();c.reject()},accept:function(){m.deactivate();giscloud.ui.alert.hide()}}}(giscloud.exposeJQuery()));(function(a){giscloud.ui.id=(function(){var c=a.now();return function(f,g,e){return[f||"",c++,g||""].join(e||"")}}());giscloud.ui.dataGrid={refresh:function(){gcdatagrid.refresh();return this},show:function(){gcapp.dataPanel.expand();return this},hide:function(){gcapp.dataPanel.expand();return this}};giscloud.ui.layerList={refresh:function(c){if(gcapp.gclayer){gcapp.gclayer.loadLayerList(c)}},selected:function(f){var e,c;if(f===undefined){e=gcapp.gclayer.llist.getSelected();c=e&&e.data;return c&&c.id||null}else{gcapp.gclayer.llist.selectByID(f);return this}}};giscloud.ui.openMap=function(c){gcproject.mapChange(c);return this};giscloud.ui.checkLogin=function(){if(user&&user.id&&user.id!=-1&&fno||fno.gcinit_auth.logged){return true}giscloud.ui.alert.color("red").show(gclang.Not_logged_in_warning,3000);return false};giscloud.ui.fullScreen=(function(){var c=[];return function(e){e=e||{};if(e==="close"){formManager.closeFullpage(c.length&&c.pop()||null);if(a("div.gc-full-page").length===0){c=[]}return giscloud.ui}if(e.id==null){e.id=giscloud.ui.id("fullscreen")}c.push(e.id);return formManager.fullpage(e)||giscloud.ui}}());giscloud.ui.newWindow=(function(e){var c={};function f(k,g,h){return(function(){var n,m=15000;if(!k){g.reject();return}if(h.focus==="immediately"){k.focus()}else{if(h.focus==="afterLoad"){g.done(function(){k.focus()})}}n=setInterval(function(){var q=k&&k.document&&e(k.document),o=h.check?h.check(q):true;if(o&&q&&q.length){clearInterval(n);n=null;g.resolve(q)}},100);setTimeout(function(){if(n!==null){clearInterval(n);g.reject()}},m)})}return(function(k){var n,h,o,g=new e.Deferred,m={focus:"immediately"};k=e.extend(m,k||{});if(k.check&&typeof k.check==="string"){o=k.check.toString();k.check=function(q){return q&&!!e(o,q).html()}}if(k.id==null){k.id=giscloud.ui.id("newWindow")}else{if(c[k.id]&&k.clear){n=c[k.id];if(n&&n.document){e("html",n.document).remove()}}}if(k.url){h=k.url}else{h=document.location.origin||(function(q){return q.protocol+"//"+q.host}(document.location));if(k.view){if(!giscloud||!giscloud.app||!giscloud.app.loadView){throw"fullpage: no view handling method available."}h+="/appinstance/view/"+k.view}}n=window.open(h,k.id,"menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes");if(!n){return g.reject().promise()}c[k.id]=n;setTimeout(f(n,g,k),10);return g.promise()})}(a));giscloud.ui.apollo=(function(){var c,f,e;return{catalogBrowser:{open:function(g){formManager.closeAll();apollobrowserform=formManager.open({fid:"apollobrowserform",overlay:false,dragable:true,fdata:{dsid:g||null,width:783,results_height:320},title:"ERDAS APOLLO Browser",minimize:true,width:800,height:500,url:fno.liveSite+"datasource/browser_apollo",buttons:[{html:gclang.close,click:"giscloud.ui.apollo.catalogBrowser.close();"}]})},close:function(){if(apollobrowserform){apollobrowserform.close();apollobrowserform=null}}},processingList:{open:function(){formManager.closeAll();apolloprocessingform=formManager.open({fid:"apolloprocessingform",overlay:false,dragable:true,fdata:{},title:"Apollo Processing",minimize:true,width:800,height:500,url:fno.liveSite+"datasource/processing_apollo",buttons:[{html:gclang.close,click:"giscloud.ui.apollo.processingList.close();"}]})},close:function(){if(apolloprocessingform){apolloprocessingform.close();apolloprocessingform=null}}},runningProcessingJobsList:{open:function(){c=formManager.open({fid:"launchedprocesses",overlay:false,dragable:true,title:"APOLLO Processes",width:700,height:340,url:fno.liveSite+"apollo/processes_list",buttons:[{html:gclang.close,click:"giscloud.ui.apollo.runningProcessingJobsList.close('launchedprocesses');"}]});c.addEvent("close",function(){clearInterval(gcapp.refreshLaunchedInterval);gcapp.processesList=null});gcapp.refreshLaunchedInterval=setInterval(function(){gcapp.processesList&&gcapp.processesList.refresh()},2000)},close:function(){if(c){c.close();c=null}}},launchProcessingForm:{open:function(g,h,m){var k=fno.liveSite+"/rest/1/datasources/"+g+"/apollo/processes/"+h+"/form.html";if(m){k+="?map_id="+m}f=formManager.open({fid:"launchprocess",overlay:false,dragable:true,title:"Launch process execution",width:550,height:340,url:k,buttons:[{html:gclang.close,click:"formManager.close('launchprocess')"},{html:"Launch","class":"bluebutton",click:"giscloud.ui.apollo.launchProcessingForm.submit();"}]});a(document).one("formReady.gc-dyn-form",function(n,o){e=o;a(e).on("submitStart.gc-custom-form",function(){giscloud.ui.alert.color("green").show("Launching process...");f.disable()}).on("submitFailure.gc-custom-form",function(){giscloud.ui.alert.color("red").show("Failed to start processing.",2000);f.enable()}).on("submitSuccess.gc-custom-form",function(){giscloud.ui.alert.hide();giscloud.ui.apollo.launchProcessingForm.close();giscloud.ui.apollo.runningProcessingJobsList.open()})})},submit:function(){if(!e){return}e.submit()},close:function(){formManager.close("launchprocess");f=null}}}}())})(giscloud.exposeJQuery());(function(window,$,common,undefined){giscloud.help=function(){if(giscloud.help.def){return showHelp(giscloud.help.def.giscloud)}return""};giscloud.help.ignore=[];giscloud.help.category=[];giscloud.help.objects=[];giscloud.help.namespaces={};function findCategory(cat){var category=giscloud.help.category;for(var i in category){if(!category.hasOwnProperty(i)){continue}if(i.indexOf("*")>0){var re=new RegExp(i);if(cat.match(re)){return category[i]}}}if(category[cat]){return category[cat]}}var classes=[];function listApi(root,parent){var objects=giscloud.help.objects;var ignore=giscloud.help.ignore;var namespaces=giscloud.help.namespaces;var category=giscloud.help.category;var output={};output.category=findCategory(root);try{eval('var desc = giscloud.help.def["'+root+'"].desc');output.desc=desc}catch(e){}if(!output.desc){output.desc=""}var s=[];var def=[];var types=[];var property_ref=[];var ns;try{ns=eval(root)}catch(e){return""}var nextlevel=[];var methods=[];var methods_map={};var properties=[];var properties_map=[];for(var i in ns){if(!ns.hasOwnProperty(i)){continue}if(typeof ns[i]=="function"){if(i[0]===i[0].toUpperCase()){if(ignore[root+"."+i]){continue}classes.push({ref:ns[i],name:root+"."+i});s.push(root+"."+i);def[root+"."+i]=[];if(objects[root+"."+i]){obj=objects[root+"."+i]}else{try{obj=new ns[i]({})}catch(e){console.log("error ",root+"."+i)}}for(var p in obj){def[root+"."+i].push(p);types[root+"."+i+"."+p]={type:typeof obj[p],ref:obj[p]}}def[root+"."+i].sort()}}}s.sort();for(var i=0;i<s.length;i++){var name=s[i];var name_def='["'+name.substr(0,name.lastIndexOf("."))+'"]'+name.substr(name.lastIndexOf("."));var cl={"class":name};var p=def[s[i]];try{eval("var desc = giscloud.help.def"+name_def+".desc");cl.desc=desc}catch(e){}if(!cl.desc){cl.desc=""}cl.category=findCategory(name);try{eval("var _example = giscloud.help.def"+name_def+"._example");cl._example=_example}catch(e){}cl._constructor={params:"",usage:"",desc:""};try{eval("var _constructor = giscloud.help.def"+name_def+"._constructor");if(_constructor.params){cl._constructor.params=_constructor.params}if(_constructor.usage){cl._constructor.usage=_constructor.usage}if(_constructor.desc){cl._constructor.desc=_constructor.desc}}catch(e){}for(var j=0;j<p.length;j++){if(types[s[i]+"."+p[j]].type=="function"){if(ignore[s[i]+"."+p[j]]){continue}var m={};try{eval("var desc = giscloud.help.def"+name_def+"._methods."+p[j]);m.params=desc.params;m.returns=desc.returns;m.desc=desc.desc}catch(e){m.params="";m.returns="";m.desc=""}if(!cl._methods){cl._methods={}}cl._methods[p[j]]=m}}for(var j=0;j<p.length;j++){if(types[s[i]+"."+p[j]].type!="function"){if(ignore[s[i]+"."+p[j]]){continue}var type=types[s[i]+"."+p[j]];var property={ref:type.ref};try{eval("var desc = giscloud.help.def"+name_def+"._properties."+p[j]);property.type=desc.type;property.desc=desc.desc}catch(e){property.type="";property.desc=""}if(!cl._properties){cl._properties={}}cl._properties[p[j]]=property}}output[name.substr(name.lastIndexOf(".")+1)]=cl}for(var i in ns){if(!ns.hasOwnProperty(i)){continue}if(typeof ns[i]=="function"){if(i[0]!=i[0].toUpperCase()){if(ignore[root+"."+i]){continue}m={};try{eval('var desc = giscloud.help.def["'+root+'"]._methods.'+i);m.params=desc.params;m.returns=desc.returns;m.desc=desc.desc}catch(e){m.params="";m.returns="";m.desc=""}methods_map[i]=m;methods.push(i)}}else{if(giscloud.help.include_namespace[root+"."+i]){if(ignore[root+"."+i]){continue}nextlevel.push(root+"."+i)}else{if(ignore[root+"."+i]){continue}var property={};try{eval('var desc = giscloud.help.def["'+root+'"]._properties.'+i);property.type=desc.type;property.desc=desc.desc}catch(e){property.type="";property.desc=""}properties_map[i]=property;properties.push(i)}}}namespaces[root]=output;nextlevel.sort();for(var i=0;i<nextlevel.length;i++){listApi(nextlevel[i],output)}methods.sort();properties.sort();if(methods.length>0){output._methods={};for(var i=0;i<methods.length;i++){output._methods[methods[i]]=methods_map[methods[i]]}}if(properties.length>0){output._properties={};for(var i=0;i<properties.length;i++){output._properties[properties[i]]=properties_map[properties[i]]}}}function generateCharSpace(ch,n){var s="";for(var i=0;i<n;i++){s+=ch}return s}function makeMultiLine(line,limit,prefix){var multiLine="";var originalLine=line;var nextLineMin=0;while(originalLine.length+nextLineMin>limit){while(line.length+nextLineMin>limit){line=line.substr(0,line.lastIndexOf(" "))}if(multiLine){multiLine+="\n"+generateCharSpace(" ",prefix+3)}multiLine+=line;originalLine=originalLine.substr(line.length);line=originalLine;nextLineMin=prefix}if(multiLine){multiLine+="\n"+generateCharSpace(" ",prefix+3)}multiLine+=originalLine;return multiLine}function formatMethod(name,method,maxMethodLen,maxParamLen){var params=method.params||"";var desc=method.desc||"";var line="\t"+name+generateCharSpace(" ",maxMethodLen-name.length)+params+generateCharSpace(" ",maxParamLen-params.length)+desc;return makeMultiLine(line,100,maxMethodLen+maxParamLen)+"\n"+generateCharSpace(" ",4)+generateCharSpace("-",100)+"\n"}function showHelp(ns){var help="\n";if(ns._example){help+="Example:\n\n";help+=ns._example;help+="\n"}if(ns._methods){help+="Methods:\n\n";var maxMethodLen=0;var maxParamLen=0;for(var i in ns._methods){if(i.length>maxMethodLen){maxMethodLen=i.length}if(ns._methods[i].params&&ns._methods[i].params.length>maxParamLen){maxParamLen=ns._methods[i].params.length}}maxMethodLen+=3;maxParamLen+=3;for(var i in ns._methods){help+=formatMethod(i,ns._methods[i],maxMethodLen,maxParamLen)}}var classes="";for(var i in ns){if(i[0]!="_"&&i[0]===i[0].toUpperCase()){if(!classes){classes+="Classes:\n\n"}classes+="\t"+i+"\n"}}help+=classes;return help}function findHelpItem(root,ns,n){if(n>5){return}for(var i in root){if(!root.hasOwnProperty(i)){continue}if(i[0]=="_"||i=="category"){continue}if(root[i]._methods&&(ns+i)!="giscloud"){var obj="";if(root[i]["class"]){obj='["'+ns.substr(0,ns.length-1)+'"].'+i}else{obj='["'+ns+i+'"]'}try{eval(ns+i+".help = function() { return showHelp(giscloud.help.def"+obj+"); }")}catch(e){}}var t=typeof root[i];var k=n;if(!k){k=0}findHelpItem(root[i],ns+i+".",k+1)}}function findClassType(property){for(var c=0;c<classes.length;c++){if(property instanceof classes[c].ref){return classes[c].name}}return null}giscloud.help.load=function(){giscloud.includeJs("/assets/api/1/help.def.js",function(){findHelpItem(giscloud.help.def,"")})};giscloud.help.write=function(){giscloud.includeJs("/assets/api/1/help.def.js",function(){giscloud.help.init();listApi("giscloud");for(var i in giscloud.help.namespaces){var ns=giscloud.help.namespaces[i];for(var p in ns._properties){eval("var property = "+i+"."+p+";");var type=findClassType(property);if(type){ns._properties[p].type=type}}for(var k in ns){if(!ns[k]||!ns[k]["class"]){continue}var cl=ns[k];for(var p in cl._properties){var type=typeof cl._properties[p].ref;if(type!="undefined"){var gc_type=findClassType(cl._properties[p].ref);if(gc_type){cl._properties[p].type=gc_type}else{type=type[0].toUpperCase()+type.slice(1);cl._properties[p].type=type}}delete cl._properties[p].ref}}}jQuery.ajax({type:"POST",url:"/scripts/write-jsapi-docs.php",processData:false,contentType:"application/json",data:JSON.stringify(giscloud.help.namespaces)})})};giscloud.help.stats=function(){giscloud.includeJs("/assets/api/1/help.def.js",function(){var totalMethods=0;var definedMethods=0;var totalProperties=0;var definedProperties=0;for(var i in giscloud.help.def){var ns=giscloud.help.def[i];if(ns._methods){for(var m in ns._methods){var data=ns._methods[m];totalMethods++;if(data.desc){definedMethods++}else{console.log(m)}}}if(ns._properties){for(var m in ns._properties){var data=ns._properties[m];totalProperties++;if(data.desc){definedProperties++}}}for(var c in ns){if(!ns[c]["class"]){continue}for(var m in ns[c]._methods){var data=ns[c]._methods[m];totalMethods++;if(data.desc){definedMethods++}else{console.log(m)}}for(var m in ns[c]._properties){var data=ns[c]._properties[m];totalProperties++;if(data.desc){definedProperties++}}}}console.log("Total methods: "+totalMethods+" (defined "+definedMethods+", "+Math.round(definedMethods/totalMethods*100)+"%)");console.log("Total properties: "+totalProperties+" (defined "+definedProperties+", "+Math.round(definedProperties/totalProperties*100)+"%)")})};giscloud.help.init=function(){var ignore=giscloud.help.ignore=[];var category=giscloud.help.category=[];var objects=giscloud.help.objects=[];var ns=giscloud.help.include_namespace={};giscloud.help.namespaces={};classes=[];ns.giscloud=1;ns["giscloud.address"]=1;ns["giscloud.addressmodels"]=1;ns["giscloud.bookmarks"]=1;ns["giscloud.datasources"]=1;ns["giscloud.datasources.wms"]=1;ns["giscloud.date"]=1;ns["giscloud.features"]=1;ns["giscloud.formats"]=1;ns["giscloud.formats.exportFormats"]=1;ns["giscloud.formats.renderFormats"]=1;ns["giscloud.forms"]=1;ns["giscloud.geometry"]=1;ns["giscloud.geoutils"]=1;ns["giscloud.keys"]=1;ns["giscloud.layers"]=1;ns["giscloud.layers.attributeOps"]=1;ns["giscloud.maps"]=1;ns["giscloud.oauth2"]=1;ns["giscloud.options"]=1;ns["giscloud.permissions"]=1;ns["giscloud.proxy"]=1;ns["giscloud.rest"]=1;ns["giscloud.search"]=1;ns["giscloud.spatialrelationship"]=1;ns["giscloud.tables"]=1;ns["giscloud.tasks"]=1;ns["giscloud.ui"]=1;ns["giscloud.ui.alert"]=1;ns["giscloud.ui.columns"]=1;ns["giscloud.ui.dataGrid"]=1;ns["giscloud.ui.edit"]=1;ns["giscloud.ui.layerList"]=1;ns["giscloud.ui.selectExtent"]=1;ns["giscloud.userOptions"]=1;ns["giscloud.users"]=1;ns["giscloud.ui.defaultTools"]=1;ns["giscloud.ui.customForm"]=1;ns["giscloud.ui.search"]=1;ignore["giscloud.Html5Map"]=1;ignore["giscloud.Html5MapSetSelection"]=1;ignore["giscloud.help.write"]=1;ignore["giscloud.wms"]=1;ignore["giscloud.datasources.apollo"]=1;ignore["giscloud.ui.apollo"]=1;ignore["giscloud.html5ResetLoaders"]=1;ignore["giscloud.Html5MapRefreshUrls"]=1;ignore["giscloud.gravatar"]=1;ignore["giscloud.ddupload"]=1;ignore["giscloud.construct"]=1;ignore["giscloud.contextMenu"]=1;ignore["giscloud.log"]=1;ignore["giscloud.logDeferredResults"]=1;ignore["giscloud.md5"]=1;ignore["giscloud.pingRpc"]=1;ignore["giscloud.remoteGetJSON"]=1;ignore["giscloud.Layer.offscale"]=1;ignore["giscloud.Layer.onscale"]=1;ignore["giscloud.Layer.grp"]=1;ignore["giscloud.Layer.raster"]=1;ignore["giscloud.Layer.textfield"]=1;ignore["giscloud.Layer.label"]=1;ignore["giscloud.Layer.label_placement"]=1;ignore["giscloud.Map.mobileacess"]=1;ignore["giscloud.Query.actions"]=1;ignore["giscloud.Query.table"]=1;ignore["giscloud.ViewerLayer.instance"]=1;ignore["giscloud.address"]=1;ignore["giscloud.addressmodels"]=1;ignore["giscloud.oauth2.uriMismatch"]=1;ignore["giscloud.rest"]=1;ignore["giscloud.ui.ProjectionPicker.init"]=1;ignore["giscloud.ui.ProjectionPicker.options"]=1;ignore["giscloud.ui.customForm.beforeOpen"]=1;ignore["giscloud.ui.Options.init"]=1;ignore["giscloud.ui.Options.addbt"]=1;ignore["giscloud.ui.Options.inpdiv"]=1;ignore["giscloud.ui.Options.keyinp"]=1;ignore["giscloud.ui.Options.keylabel"]=1;ignore["giscloud.ui.Options.template"]=1;ignore["giscloud.ui.Options.ulcont"]=1;ignore["giscloud.ui.Options.valinp"]=1;ignore["giscloud.ui.Options.vallabel"]=1;ignore["giscloud.ui.Options.restOptions"]=1;ignore["giscloud.Color.lab"]=1;category["giscloud.Graphic.*"]=category["giscloud.Map"]=category["giscloud.Layer"]=category["giscloud.Viewer"]=category["giscloud.ViewerLayer"]=category["giscloud.ViewerSelection"]=category["giscloud.Feature"]=category["giscloud.FlagMarker"]=category["giscloud.Marker"]="map";category["giscloud.Task"]=category["giscloud.tasks"]=category["giscloud.forms"]=category["giscloud.Query"]=category["giscloud.search"]=category["giscloud.tables"]=category["giscloud.maps"]=category["giscloud.layers"]=category["giscloud.features"]="resources";category["giscloud.datasources"]="datasources";category["giscloud.ui.map.*"]="ui.map";category["giscloud.ui.*"]="ui";category["giscloud.spatialrelationship"]=category["giscloud.geoutils"]=category["giscloud.Bounds"]=category["giscloud.LonLat"]=category["giscloud.geometry.*"]="geometry";category["giscloud.datasources.*"]=category["giscloud.wms.*"]="datasources";category["giscloud.keys"]=category["giscloud.User"]=category["giscloud.oauth2"]=category["giscloud.options.*"]=category["giscloud.permissions.*"]=category["giscloud.user.*"]="users";objects["giscloud.Graphic"]=new giscloud.Graphic(giscloud.ui.map);objects["giscloud.Color"]=new giscloud.Color();objects["giscloud.Queue"]=new giscloud.Queue([]);objects["giscloud.GraphicFeature"]=new giscloud.GraphicFeature(new giscloud.geometry.Point());objects["giscloud.ui.Options"]=new giscloud.ui.Options(document,{},{});objects["giscloud.ViewerSelection"]=new giscloud.ViewerSelection(giscloud.ui.map);objects["giscloud.Layer"]=new giscloud.Layer({alpha:100,bounds:new giscloud.Bounds(),created:new Date(),encoding:"enc",exportable:true,label:" ",lock:true});objects["giscloud.LonLat"]=new giscloud.LonLat(0,0);var l=new fnLayer();l.source={};l.id="layer0";objects["giscloud.ViewerLayer"]=new giscloud.ViewerLayer(l);objects["giscloud.Promise"]=new giscloud.Promise()}})(window,giscloud.exposeJQuery());delete giscloud.common;